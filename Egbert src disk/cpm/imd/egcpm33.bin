ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее CCP     COM                  BNKBDOS3SPR   j    	 
     HDCPM3  SUB                   BNKBIOS MAC   Ђ         BNKBIOS MAC                  BNKBIOS3SPR   3             BOOT    MAC   '              BOOTER  MAC   <              BOOTGEN SUB   !                CPM3    SYS   Ђ" : ; < = > ? @  CHARIO  MAC   &# $ %            COPY    COM   .& ' (            COPYSYS COM   )                CPM3    SUB   *                CPMLDR  REL   + ,              HDNDF   COM   -                HDDTBL  COM   .                DATE    COM   / 0              DIR     COM   r1 2 3 4 5 6 7 8  CPM3    SYS  0A B C            BNKBIOS REL   9               еBNKBIOS CRF  ЂB C D E Х  ( DO      COM   *F G H            DRIVER  MAC   ЂI J K L M N O P  DRIVER  MAC  ЂQ R S T U V W X  DRIVER  MAC  ЂY Z [ \ ] ^ _ `  DRIVER  MAC  Ђa b c d e f g h  DRIVER  MAC  Ђi j k l m n o p  DRIVER  MAC  Ђq r s t u v w x  DRIVER  MAC  Ђy z { | } ~  Ђ  DRIVER  MAC  ЂЃ ‚ ѓ „ … † ‡ €  DRIVER  MAC  Ђ‰ Љ ‹ Њ Ќ Ћ Џ ђ  DRIVER  MAC	  "‘ ’ “            HD2     MAC   L” • – —         RMAC    COM   j™ љ › њ ќ ћ џ    DISKIO1 MAC   Ђ  Ў ў Ј ¤ Ґ ¦ §  DISKIO1 MAC  !Ё © Є            HDDTBL  ASM   «                XCPM3   LIB   3¬ ­ ® Ї          GENCPM  DAT   ° ±              BOOTHD  SUB   І                DRVTBL1 MAC   і                ERASE   COM   ґ µ              FONT12  MAC   V¶ · ё № є »      FORMAT  COM   aј Ѕ ѕ ї А Б В    GENCPM  COM   ЂГ Д Е Ж З И Й К  GENCPM  COM  (Л М Н            HDBOOT  MAC   'О П Р            HDBOOTERMAC   9С Т У Ф         еBNKBIOS CRF  Ђ*+,-./01 L80     COM   TЦ Ч Ш Щ Ъ Ы      LDRBIOHDMAC   jЬ Э Ю Я а б в    LDRBIOS MAC   =г д е ж          LINK    COM   {з и й к л м н о  M80     COM   Ђп р с т у ф х ц  M80     COM  ч ш              MODEBAUDMAC   щ                MOVE    MAC   $ъ ы ь            RENAME  COM   э ю              RESBDOS3SPR   я                SCB     MAC                   SET     COM   S     SHOW    COM   B	
       T80     COM   Ђ T80     COM                ZDE     COM   Ђ ZDE     COM                еBNKBIOS CRF  23             DRIVER  COM   n!"#$%&'   SCB     REL   6               BOOT    REL   )               CHARIO  REL   H               MOVE    REL   Q               DRVTBL1 REL   S              еSCB     CRF   45             HD2     REL   v              еHDBOOT  CRF   u89:;<>?@ HDBOOT  REL   =              еCHARIO  CRF   ЂABCDEFGI HDBOOTERCOM   7              еCHARIO  CRF  J              еMOVE    CRF   TKLMNOP    еDRVTBL1 CRF   R              еDISKIO1 CRF   ЂTUVWXYZ[ DISKIO1 REL   \              еDISKIO1 CRF  Ђ]^_`abcdеDISKIO1 CRF  ЂefghijklеDISKIO1 CRF  %mno          еHD2     CRF   ЂpqrstuwxеHD2     CRF  Cyz{|}      еDISKIO1 CRF  %{|}          еHD2     CRF                    еDISKIO1 CRF  Ђyz{|}~… BDOS3   SPR   MЂЃ‚ѓ„      еDISKIO1 CRF                   ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееГ   ГГ    LOADER  я  yю;В	БЕ!  91ѕ"љЕл"|µхМ сД0С! ~юЙКћz=іВ_:·В_*
" "”Нш*љщЇogЙю *љщбе%|µл}DА	SН Г  #N#F:Џ·К’#4КќХНбНКНРб е^#V{ІВ‚Н: юЙВї*Ќ.і~цw*DM!  Н&Г_* .  Н&>ks#rлr+6." "”’1Г * D`.45А.F.~·К.^#Vx>`.s#rz·ЕМрБГеђНылбе  	6 #N#fi%$КgеХеН1бхЂ: =”Ъъ<ю@Тv_}·Кv=ъp{ђКъ_ХеН3беН;бСх{<„g"–сКTБ=XН3СхН с*њлВjСб	 	~жюPА#~жюRА#~жЦLА{·Вgbk#N#Fk$ХЕН&БСХZеc x±Кч{жВкг~#гo}oТу„ГЩССЙН1!Ђ Н;ВЏ!ю "њГЏ: =ђюЪw*–јЪwW Йx±И~#Г&*Ќ.ж~sЙлеН *лН "њС·И\Й
Cannot load Program 221282  COPYR '82 DRI                  < bю Ђ  ЂHA$@  €DH  Ђ 	           A @‚! "     $ $@ „                                    1-!еj1Н "Ќ.ъ~2Џ.™~2 : –ВX”НckНК* kН®НлbН ¶Ня<ж—.ё~=Ї>$.Уw.ж6#Їw.П6#w.Ў61.ґ~ж еД б.і~жеМ б~жэwж@е.°pTа~ВєЪВД>я+~.м~б~жЂКз!Ђ хyН®Г‹.µ~жВ~цw2g!ьГЩPROFILE.S НдН	!+щЇ2™!еНд+~жКdхН{	Нр	Мр	ВO!–w+w+е:‚=w!фр	б5ьр	·хcНр	сК‹іНсНр	:p·ДНm>>Н	є±Н§·хЂґДсНN	НосДЁ
НЪВ–.Й~+w.И~2љНц	И¬Н9:¶ю В!¬~#¶#~В
!7®:°ю!ФїВи:Ў·x*l"ќ!ZКXюЪ†!±Ви6 ґНЭКђКщ ЕНzНдсНzНдГ:ю ВиН6:¬ЦЪ%2p°НщН†	:­=шхНЂ	с2rЇГщDIR TYPE ERASE RENAME DIRSYS USER  uф"Q}:\ =тp:rЖAГ¦ RГ‚ЂNХН™СКё}ёФ	!M54И5ГЕНx	НШ
] ю МµН6НГ	БИ:—oGе!
 ~бжЂ№КО>2MГеМxЅМf>:Н¦Н¤НЌН¤ЕеНf	НИ	бБВ№<Й!еНШ
>2џНlНf	НДАюИН	ГуН«НRИГНШ
КLНћВLНI	*› Н*НA	Н	}ж_юYА·ГlНШ
х! лХеН®НШ
бСН’схД6с\ я&Д‘	А%ъё*ќ"lНдНЌ
Г»ѕИ·И45В:wЙю?ИВ ЙНA
АНI	НN	Гц	НГ SUBMIT  COM«Нщ!БН®!х6 #"l¶!cНїА¬·АOЕ ·В!з:r<g.yефяб·ъvКјВ |-ъЕеН‹	бБКґНЭКTНi>:Н¦ХНЌСХ! ~жЂBДI	Н	Сс!p‡Н°Х^#VлСйCOM SUB PRL  ‰Н‰БyЙ!cН°¶Г®! "О*џ%.Ае2P л#Н®!g4*l+Ѓ л"lН·2Ђ НШ
"Q x2S l НЫ
"T x2V !q~·фЂ	:pН†	‡‡‡‡.Ъ¶2 С*џЇoщgе$е2| ПНщ.ђw#w#w#w.і~жЂВ	.¬w#w~ж?w;Г ю
В;	!~#4–В9	w#~·$МA	юКН<	>
_Г НI	Г 	Г !ф6зл
Н !х~#Н°6 Г	Нm	ИГНл	ИГл	Ђ Г _Г аГщ ­!  6 ЕХ =фЂ	ўН{	СБХ*Ќ.зpеН СЇ:rЪеНx	б,СЙГК	\ Н <И=‡‡‡‡‡!Ђ Н°лЇ=ЙЇ2џ\ Н ·ЙsГл	НолЇ2Ў!цНD
лю;Ию!К
ю:В
.¬44К
#4Ил"l~ю[В*
2ЎюaЪ7
ю{Т7
Ц wю!МY
#·В!
*l"l"›~·Ию КU
ю	А#ГD
]Tю!хеМ·бсИ6 л* %.wе#wю!В}
6·Вr
6#w.6Г#6	#t#6Г.woлНР*Ќ.±Сs#r.®rЇЙ±єН§·±јМ§еНm	б.±ВЛ
^#V45+КЛ
·АЇw#w.®f.5Г \ НA
хНд
сЙ"l"›ХlН С|µF#Вю
!(|µВ	!(Н:xю.В+"l!РХН®ў
Н®С~!  ·GК8*›~ю;#В1ЙХЇНA
*lСХ~ю:Кg·КX#ВIСЇ*lхНд
сЙ*l~ю0Ъ…ю:Т…НqСХ·ВXx<ГњюAЪXюQТXСХ·ВX~Ц@#~ю:Вk#СГ^*ЌjT~#В®Й w·yИ#Г№Ї!џ4ьв	·А:џ!Ђ Н°Ї~Й@ґ*Ќh~ЎЙ ґНЭy¶wЙ ґНЭy/¦wЙ*ЌhwЙ*Ќh~ЙНI	E>Н¦>
Г¦Ц
Ъ%0Ц
ТхН<	сЖ:Г	~·И№ИН¦#Г*НA
И!g~·6 А*› Н*>?Н	ГНA
*l"›И~ю0Ъ:ю:Т:Нq"lцxЙ ~Ц0Шю
Рхx‡‡Ђ‡Gс#ЂGюЪsГ:&НН¤&жН¦%ВЙ> ЕХеН	бСБЙ…oР$Й>?В··Йя Хежю!ЪРѕВа> ѕ#ВДбСН®xЙ> ѕ#ВвССя~ЦТВЙEnter User #: $No File$ required$ERASE $ (Y/N)? $

Press RETURN to Continue $  (User 0)$ NON-SYSTEM FILE(S) EXIST$   :   Р   $$$     SUB _Г аГщ ­!  6 ЕХ =фЂ	ўН{	СБХ*Ќ.зpеН СЇ:rЪеНx	б,СЙГК	\ Н <И=‡‡‡‡‡!Ђ Н°лЇ=ЙЇ2џ\ Н ·ЙsГл	НолЇ2Ў!цНD
лю;Ию!К
ю:В
.¬44К
#4Ил"l~ю[В*
2ЎюaЪ7
ю{Т7
Ц wю!МY
#·В!
*l"l"›~·Ию КU
ю	А#ГD
]Tю!хеМ·бсИ6 л* %.wе#wю!В}
6·Вr
6#w.6Г#6	#t#6Г.woлНР*Ќ.±Сs#r.®rЇЙ±єН§·±јМ§еНm	б.±ВЛ
^#V45+КЛ
·АЇw#w.®f.5Г \ НA
хНд
сЙ"l"›ХlН С|µF#Вю
!(|µееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее  .                                                                                                                                                                                                                                                                  л"Ыылy2ЯыюЪ; !  "(:Ъы2¤(=2ј(:жы=К; !• ~·К; №К4#Г. {2ћ(!  "џ"Эы9"2!;(еyю3Т] K!Ж Гo юЂТ\ЦbЪАюТА!,_ ^#V*Ыылй Е!J		^#VлНЂБ:зы·АГ#!"( COPYRIGHT (C) 1982, DIGITAL RESEARCH 151282/В(
яЂы
+
1
7
И=
}!ѓ!–! !‡"›"м"х"ы"##п#х#ы#$$У$$#$-$A$J$S$@Y$u
u
J$Аu
u
}$‹$ђ$Н$Я$*%P%и$И%¦&'('d'с'ю'(('({
‰
•
•
AgXJ    v…‘юА!)$е*Ыы^#VХ#^#VблеЇw# Нl Нl Нl НlНsю:беВ¬НMКаЦAЪцюТц<w#НMКа ю.ККю;КыНВ¶Габе	 	 ю;КыНВФБХНsНMбА!  ·ИюИлЙББ!яяЙбе 	НВ>ђбе 	wГаНMИю ЪхъхВ2ю*К7w#·Й6?#т7Й	 .,:;[]=<>| е!?ѕК]45#ВR·бИюaШю{Тiж_жЙp#ВlЙю Кsю	КsЙеН‚:Є(ЖA2=/НоБ:уыТоНо:Яы0!юdЪЇ61#ЦdЦ
ЪёГЇp#Ж:w#6 !6 :Эы·Ке6 Х*Ыы#л!Н)6.#Н)СН‚ыГо
·ИЕOН(БГоBDOS Function =     File =              !эяГ,Н$-"¬ыГhы  !  9"f!ўеН	Н‰:жых2™(Нt·В™:Яыю!ФюНс=ВHgoЙ  ЗЗЗЗЗЗЗЗЗЗ  :ЯыO*ЫылГ; *ШыЂ Г“*Шы"rЙ*r"ШыГїБ<И:жыђgЙе:Яыю!ФНђС*fщл}DЙ! э~6 ·АГtы!r
еН·НрЪЦхOН(сЙНАюВеН^ГЖюКЖюКЖЙюИю
Ию	ИюИю Й: э·ВљНnыжЙ!Хы6@гйG:ПыжxЙНВя: э·ВP:Мы<КяНА: эюКPННnыб6 жИННtыб6 юВ! эѕВ^6 ННtыб6 юВu:ПыжК)ЇЦИ<Н Г^! эG:ПыТЋ>ѕИxюКќюКќw>ЙЇwЙМ©ДzыЙ:ПыжВ»!Фы>®жwЙЇЙ:Яы=КzыxжВzыГzы:ј
·Вц:ПыжGЕ:Яы=Д/БЕНЅБx·ВцЕ:Фы·ДЂыБy!·ыюИ4ю Р5~·ИyюВ5ЙюА6 ЙyНрТ(х^ННсц@OНАИ:Яы=К7:ПыжВНyю	ВН:ЯыюВIНАИ НН:·ыжВ=ЙНe:ї
юИ НzыГzы#ННН‚:·ы!Ѕ
ѕР ННГrНН
ГН!Уы
ѕИЕOН(БГЊ*(~2**єы}ґК·Н!э#·В¶!  "єы"јыАГ·:¶ы_:·ы»Йл*(л·И#wГОx·ИЕHел!ВН)6 "&бБЙ:ґыР!ВБ
В
лx·И2А
ХЕGHГ)б+6 Й:·ы2,Й:·ы!-ѕР ННГ:,!·ыѕРННГ+Ее*( ~·КL#ГBxѓ№хФzысбБШССГя:*·И:ї
юИюИюИеЕН*(~·К“OНАЪЉ{2·ыГ“еНб#Гw:·ы2.НН+:.2-БбЙ!%"(Ї2*Й!В"&Й!*~·А4:·ы2-ЙНАФ‚:А
G НоНіНЁН^Ї2+>2Яы:·ы2Ѕ
*ЫыN#еЇG2ѕ
№ВяЕе:+·Мњ2ї
бБюКз	ю
Кз	юВ5НА»Тял*(~·Кo#"(лГM	юВљл*(~·К`лНА»лЪUлНoлГj*(~#"(Г‘!*~6 ·Кs!+6 лГя:+·В‚x·ВoНі*&~·2+Кo#"&!+6лГM	юВЕ:Ѕ
W:·ыєКя2ј
x·К	еНєС*(+"(wлГ	юВ:ѕ
ёВЬ>2*2ї
Г:л*(:ѕ
ёКр+wГб"(ЕХНє:·ыG:Ѕ
ёКННГшюВл!%"(лН^ГяюВ-:*·КяГ$юВP:Кы<К\:Ѕ
W:·ыєКя2ј
x·КMГ	юВs:Лы<К9>2ї
:*·В9x·Кя~+Гq	юВ’Еx2ѕ
е:*·ДН‚Н^Ї2Ѕ
ГюВўеЕЇН БбГяюВДб:Ѕ
!·ыѕЪЅ*(~·ВЭГЧ5НWГЁюВХгНШгНjбГЧюВM	Ї2ѕ
лНЁлx·КОл*(Кш+wГн"(ЕХНj>2+2*ГЕНjБбеЕx·К.	#NСХzђWЕе:ѕ
єЬбБГ	е:ј
·К!·ы–2ј
НW!ј
5В=	Н^Гхx№Ъ^	сЕеНzыГ:ї
юКm	:*·Д;с#wЕеOННбБ:ї
юК9юКЊ	Н^:ПыжВ—	~юxВ 	юК)№Та	ЕеНАЪ:*·КА	:ї
юКЕ	юКЕ	>ГбБл*(+"(wл+ЕеН+Ї2+ГЇ2+ГяНЙбpЕНШБяНо!  "єыГННяГr
y<К 
<К
<К%
ГzыНяВАГr
Ня·ИН·Гr
Н6яГr
Н9яГr
лMDГЊ:ПыТo
!Хы6Ђе!h
е: эюКљНnы·ИНtыюК2 эЇЙНr
б6 ЙН2џЙ>Гr
zЈ<*ПыК)$л"ПыЙ!УыzЈ<~Кr
sЙл^#V#N#Fлx±ИЕеN:ЯыюoКІ
НЂыГµ
Н(б#БГћ
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   CP/M Error On  :  Disk I/O Invalid Drive Read/Only File Read/Only Disk Password Error File Exists ? in Filename   ГІГІ>я2©(a.я"џ:Є(2ны:зы<Дыы:ЯыюК5(юК5(Г;(:ј(2эЙЇ2ј(2эЙ{•_zњWРЙ{…_zЊWРЙИ)ЏГчН74А#4А#4ЙНлГ)Н7®(ЙНГѕА#ИГИw#Г*JНя|µИ^#V#"i(##"k(##"m(###"o(#"q(##л"љ(!s(Н)*s(л!Ђ(Н)*…(|!Ј(6я·К~6 7ЙНяЇ*k(w#w*m(w#w#wЙ>2ґ(Н'яГҐЇ2ґ(Н*я·ИOН¶yюЪІГІ<АНлИ*e(НИНІб:Яыю0И!Є(:¤(ѕВжН:ґ(·АГІЇ2ЮыЙ*‹(>ЂјАЇЅЙ*быН«"‘( л!«(s#r#pЙ*k(N#FЕ*m(^#V#F*«(:­(O}“|љyеТ9*Ђ(Ндбг+гГ"*Ђ(Ннб}“|љyЪPг#геГ9ге*Ђ(НдбХЕел*Ќ(DM"ы(НяС*k(s#rБС*m(s#r#pБy“oxљgНќDM*љ(лН0яMD"э(Н!я*эMDГ$я:Џ(OГ«!‚(N:Ё(·В«G>–O:¦(КВ·Г№ЂЙ*Ыы ЙНД	:Ј(·КЪn`Й	~#foЙН¤2џ(O НМ"«(}ґЙ:‚(O*«(ЇНц"«(2­("±(:ѓ(O:Ё(ЎG2“(!«(¶wЙ*Ыы ~‡хzWсw+В!zЙН?#~Й*Ыы! Й*Ыы Й*Ыы ЙНGл! ЙНO~2Ё(л~·ВmН—OНэ~юЃЪt>Ђ2Ґ(Н?:„(¦2¦(ЙНO:Ё(w:ЯыюТ’4л~юЂР:Ґ(wЙН?r##rЙp#ИГ¤И|·g}oГ¬*g(  Ї†#ВБЁGВѕЙН1*q(ѕДг:µ(·И*ЫыЇwЙ*эл*юыНТч*’ыНИбб>
Гr
И)Гяe(:©(O! НюµґЙ*c(:©(OН«}жЙН@Н2РГ¦	 ~ЙНИГЎ*g(:·(…oР$Й*Ыы ~ЙНK6 ЙН?~жwЙНKцЂwЙ*был*i({–#zћЙНiШr+sЙ{•ozњgЙю*‘(л*‹(|жgНРЕНё*u(л*‘(БКЖКСѕИН НR>я2Юы2њыНиНГZ$ѕwИ*q(>¶wЙwЙ:¤(c(Н*‡(#л*i(s#rЙ*ђыНИ’ыГ:Њ(жЂА!А(:ЯыG~ёИ#·В<Й*q(#~·Й!;(е!Н(НюКщ!Ф(НюКАбЙ!Юы~·И6 Нk!  "быЇ2·(Й*q(NН1qЙ*{(Г]*{(Г[*y(}¤<И^#VлеЕЄ(НБбВt6я ^#Vл}ґИГeХ
 ^#V#~2ъ(лСЙНх>ГўН9Н†>!  "–(*y(юВі*р(НX)*ШыГїН‚"эЙ*g(л*эЂ НKя!џ~<И:быжwЙНb##>яw#wЙНДГыНиАб>	Гr
!бы~#ѕА<Й!яя"быЙНГ@*‡(л*бы#"быНЪ:быж‡В&2·(·АЕН’Б:Юы·АГ€Н0:Юы·ИНН+Г’yж<_W`iН«DM*w(	~ВbЙХНNжюБ±ВpwЙхНЮDM*w(T]	сКKялГKяЕН¦БЕНЮл*w(Бе"w(Н¦б"w(ЙН@ ЕСИХ:Ј(·КГЕеN ГЙЕN#Fеy°КШ*…(}‘|Фhб#БГ°*…(Н«#ЙН6 НлВя*q(ѕ  КяГ@-НRНXНЮDM*w(6 #x±В*o(w*‰(л*w(s#rНЂ*i(6#6 Н*}("±(яННшКj-Н@л*±(|Ґ<лДЏ+>!ѕК8>еѕК8> ѕКt>¦ВnН¦НvГ8 ~*o(wГn:ќ(Гr
Ех:„(/Gy Oс ‘жБЙНOAЕБЇ+ѕВ¬Вўy2џ(:Ј(·xВ№Ееo& :‚(W>’OН«E:„(ёбЪџН?N/жЎ°БЙ*Ыы" (y2еыН¦+>я2ќ(ЙГчНЭННхМЂЇ2ѕ(Нk,Вє ННшКє* (люеК*ХНiСТєН@:еыO ~юеМнЇ2ў(~жпѕКWлѕлВW:э·К2ў(Г”y·К›ю?К”xюК”юК|юМ·–жВЗГ”ЕNН†G:ѕ(<КЮЇ2Ѕ(xБ·В#ГW:ў(<В­:эююМкГЇ2ќ(2џGЙж?ЙНнН>яGГr
x·В~·В:Ѕ(·К2ѕ(Г”°БЕА##~·АНхе*э$Вы*бы"эбЙ>я2э>ю2эЙ:эююИН
ЇНя* (~цwНгГ*бы"эЙН
НЭГН2і(>юНяНхИК„Н@~жВk:і(Ф(НsЪ~*ЫыН9К~ГЉНsТ~НФ К~Н…Г<НГEНхКЂН@~жВ›:і(жЂВќ6ехН!·В¦wНљ сМ‹НИ,НГ‡PY*…({•zњТоЕХBKНNТжСБy°КєХЕНNТжБСГє<НpбСЙy°ВТ!  ЙЂНКљ~ ЕGж°wБ#ГэХ *Ыы	#~Ц$М%+лН@БЙіыцЙ*ЫыН9А>	Ге##>?–жИВ;·Й*Ыы~ 	wЙН-НxД…НэНH" (Н0* (НгНъВг#НДЉНHНэНхИН(НчНИ,НВ€НКЂНHГ€Н2і(НxД…НхИ НН):і(ж@КОеНO~б#wНљНКЂГґНѓ-ИНb_е++VХН@л*Ыы Н)Н—OСбs++r л! ‘КxТ>Ђ¶wЙ~·А6 :џ(·И6ЂЙ~#¶+Аw#w+Йе ~юЃЪ;жwбЙЇ2џНАНKжЂАНиКтНь,OFЕqН-yёЬэНlН?БNpГэНрИ Нg&:Ј(·К“~·В†w·ВЊ~ѕВтГЁНлНлѕВт#ѕВт#Вxлмя	еН—СНшwЕ 	л	БКЩКЪѕЪЩ·ВЪНлwН@ ~жwНbНђГљНЭГАѕАлѕлАЙ!яя"эЙ*э>ьҐo+"быЙНv-НыД
*Ыые!b("ЫыНЭНб"ЫыИ:э·А r#~хеж?w#>r#ВL=JМ!·
КLНv   НщбсwНИ,ГbНЬН?~OН†КЪеЕН=Бб:џ<И>Ўw##~2§(В 4~ж?КЙННѓ-В№:њ(<КЙНКЙГјНЮНAНXЇ2Ё(Гr
НK:§(w++~=жwГv
4Н—OѕТм5:њ(<Кv
4Н-НэГјНо>я2њ(НX:Ё(!Ґ(ѕЪюЂВv
Нq:џ·Вv
НХНаКv
НтНMЪ‚В?Н¶Н>НTяН“Г‚!  "–(>Ня(Г‚:“(G:ђ(O х:(юЪh=2(с7АЇЙсКry·ИцЙy/W!Ё(:™(юЪl†юЂЪ€>ЂЕF6Еех:ѓ(_/ Gб:њ(·К§:Ґ(ўјЪЁ|ђO»ЪЕН¤G:џ(ё_КэOЕ НМеНМСz”W{•ІКВ|µВх:њ(·Вх*…(}“|љЪхЕХBKНNбБТВСz№Ъэy“G:ѓ(<OКЃГБAO:њ(·Кx№ЪyбБpБ!™(VђєТ+Wy/ў2(Кoх:њ(·КBН %Н¶сgНќ|юOДEяЇЙНKжwЙНKж@х~ц@wсЙ> 2њ(Н9:¶(·>Ве#:µ(·>Ве#*ЫыН+НоНS!НX:Ё(юЂЪњНq:џ·АНаКє!Є(•(НКµ>я2”( ГНЬН¤2џ(  ·КСOНМDMНё}ґВЮ>Гr
"«("–(Ї2”(:Є(2•(л*Ыы 	:Ј(·:џ(КНFsГO 		s#rЕНт:Яыю(В„y==В„Бх*«(е!ђ(^WХ*y(^#VлеНx+СВ7л=2”(wНјСХЇw#тKWВK*±("«(ЕНJНЇНTяБНћ*«(СХ:ѓ(Ґ В[бб"«(Н¶С:Ё(WХНMЪєК›>Ня(ГєН¶Н>НTяНJБЕ:«(!ѓ(¦К· НћБx!Ґ(ѕЪЗw4ВПНPНWВЮНPНЬГ‚НХГ‚Е*Ыыл!! ~жх~#~жO~жр#¶G~жьб.|В°!  w:ЯыюcКkХНиСК[! x–ж?В[! ~№К¤Н†В[ЕН—Б№ТPСХВPСГv
qOН-НэГЎЕХН=СБ.:џ<К°Н! еVq##~_Хж@°wНЪ:џ<ВњСбБЕеХ.К©Н.К©ББНAНЬБЇГr
Сгr##sбНЬ<Б}Гr
яНдМхЙ НдМcЙлN ! ~жЂЃO> €G~жЂG! ~‡‡‡‡·ЂGх~жoс> ЌЙ_y–W#xћ#хІWс{ћЙs+p+qЙН7еr#r#rНхК>Н@ НЛбеНюФН> 2џГбЙл  НЛ!! q#p#wЙ2Є(wW*e(Н_ХН3бТ«-Й!¤(s:¤(!©(ѕВxюяАНQИНи*q(~жх†wсДиНЙЇ2µ(2¶(Г№Ђ*Ыы л~ 2¶(~Ўw#~ 2µ(~ЎwНZ!  "э"эЇ2Ѕ(=2Эы*Ыы~2ї(ж=2ћ(юяКЯ2¤(Нk:аы*ЫыwНхМXНхГ/НИ6 НX*быеНЂН Н!Юы~·К$6 б:Яыю0ИН3ГНiЪб"быЙ!ры~·И6 *e(>=)ТQхе!©(НQНXДхбс·В<Гk*{(}¤<И^#V{ІИ! ~·А! Г_*o(~ЙНsжЂИНѓ ИГ Ї2эН@л!Ч(еН)#wС*Ыы~ел"ЫыНрКдН!·ВТл!д(Fw·КдЁжаКТНѓ КТ:д(wНМљб"Ыы:ЯыюИюИ>Ге#Ї2д(НВэНѓ х*Ыы~цwсД‡б"ЫыЙ#Fx·В T]##	#~И·К ю К л
 л*эЁѕВ4 #В' ЙВ4 !з(Ге  л*эЇх~·К^ ю К^ 33хЂG#ВP с°бВv :ЯыюdКv 6 ЁВy #Й*Ыы~хцwНх> 2џ*ЫыБpИН@л! ~жацЙе*э"эбЙНvЕН@л*Ыыл°w#Н)БИ6 #ГМ Н™ еН бЙ Гд Н!·АљХфыеХ НNяНСбВ)бЙН@	u
ХГн :быжюИG*g(` ~Ц!Аx‡_‡‡ѓ<Ѓ_ЇЙН@!А*o(y¦В<Й:„(ца/GН?~ А##~ж?Й Н6!АНKж@АН?F6 е##N6 ЕНрДв Ї2џБбp##qЙ:ЎыГr
!яяНZ$Ї2Ъы!Ђ "ШыГ¶Нg:¤(2ЪыЙНTНђН-:аы·К№!>ю2э<2Ѕ(НЪНз!!Ѕ(ѕИw:эююИН
>Ђ2µ(*Ыы6 НЭННЭНз!ЙНшИНO~<Вч!wб:µ(Т"*Ыы
 ~жЂВ"2µ(ГАНAНsжЂКv"Н@!ВN"Н!·ВN"~жАКv"Н$Нѓ ВW"Н+ИН!·Вv"wНМљГv"Н$Нѓ Кr"Н Кr"Н…:д(жАКr"жЂВЯ>Ђ2¶(Н+ИНA@Н2!МЭ ђыГНљНAНШН=:џ<ИГ%лЇх~ю?ВЇ"НkНй ГГ"Н?~ю?Кѕ"НZНTНђсхКЪ"*бые>ьҐo"быН’б"быс!ГеКч:еыOНЭГл" (цГќ"Н}-Г6НљНОГхНљНОГcН2і(НZНTНђН-ННЪНш·К3#Н—ѕТг#хН@!КY#НsжЂКY#Нѓ КY#НЧ КY#Н…:д(жАВЯсФНшИНAНsжЂКТ#:і(ж@КТ#Н@!ВТ#Н$Нѓ В—#>я2эНВ—#НрН‡ГАН± л*э 	лжаВ«#>Ђ2д(хН™ сwНB pН'Н+ИН!·ВТ#:д(wНљНAPН{" Н2!АНв ГW>O2 НАГёН}-ГR*e(Г)$:¤(Гr
л"ШыГ¶Нk*w(Г)$*c(Г)$Н-Н}-Н¤ГЂНk*s("џЙ:ћ(юяВ;$:аыГr
ж2аыЙНљНОГ№НљНОГВНљГл}/_|/*e(¤W}Ј_*c(л"e(}Јo|ўg"c(>я2©(Й{·КАюЃТА2жыЙ{2зыЙНg*w(лНЮ  ·КЄ$Тў$Гћ$+}ґВќ$*…(#}‘o|g:‚(OЇНцл*эs#r#wЙ!іы~цЂwВ/~ц@wГ/Н/НHяНҐ*e(>=)Т%хе_Нg:Яыю0К%НwГ:-Н %:ћ(<В%НRбс·Вн$ЙНHяНҐ:ђ(·И>Гя(л~юcРл!њы…oл#~ююТE%л^#VлГ)$G#~И#~Й!°%ел~юИюВb%‹%Хю	Вk%ђ%Хе##N#F#^#V#~#foг~еo‡…! я…oг#~бгЙ>ГTя}ґИл!
 6 *щыНлРл*Ыы#е НKябЙ"џG*Ыы~ю	ИюИюИюИxГr
НђН-НxД…яНдВАН@ НЛН7НюЪАІКАН(НљНS!НхКЂНq&Ъ&х Н‹сК"&Н@6еНИ,НљНГю%НXН¤Н‹&Н—ѕwхНO~<слД:џ(·М Нg&л~жw#w#6 ##Н)Н‹Г&Н@	л*Ыы	Й Нg&~ж?GёА++NН†ИѕЙ<!Ј(4К”&‡5НДO 	>№Иp#Гћ&Нђ*Ыы6!НчВї&Н?~жpВА*Ыы6 ННчВд&>я2эНИН±  Н!НЭ  Н!Нв НФ ВЯ  Н· цwе*o(wбжК' Н§ НB pшяН§ НИ,ГљНgНsГr
НђН-НњНрИНД Н¤е Н!·ВS'СлН)Г_'б Н¤Нѓ И~Н?wЙНђНsТАН-Н?FеЕНњНрБбpИНН!·Кд'Нѓ ВЎ'>я2эНхИНИН± НФ ВЯеН?Сл~·Вѕ'жВѕ'Н'ГК'жаВЖ'>ЂwН'Н™ =2д(НњНрИН!·А:д(wГљ~хНѓ БК‘'pГЎ'!фыН(6 яГNя НNя!фылН(Гr
Г)!о(л еГN !  лГ)zЈ<*¬ыК)$л"¬ыЙ!яя"џ:Эы·КX(*Ыы:ї(w :¶(¶w#:µ(¶w*2щ*џ}DЙе                                                                      яя                     #cdfg !"()                                          *{(юВX)^#V!яя"ы(л:Є(ѕВ<)л! ~л<В<)ел^#V*ы(НбТ<)л"ы(л"э(Нx+В)!ы(НыИ*э(Ї>НX)*{(Г)хНQ*:«(_ 2п({Ў2«(схД’*"р(Н‚"эНX*~<КВ)схюТЌ)Н-Кт)ЇНa*юКљ)~·КВ)6 *«(е:­(хНX*лН)!©(:Є(ѕДT>Мq*БСННkсюРхюВЦ)!”(:“(ѕТа)Н-6я>Гг)<wЇНq*НX*Н)6 #Нѓ+:п(<Ђ !Ђя=Вь)л*эсюВ*"g(Йл*ШыЂ юВ3*:ъы=єЪэ:ъ(OНi*Ђ Гэл:ъы=јЪH*:ъ(GНi*Ђ НэНa*6яЙ:ђ(G/OЙ*р(Є(Й *р(ЙеХНWяСбЙхН:ъ(НTяс=Кћф“Нa*##ы(Г)Н0-уя"т(Нx+еНx+бИл!  "ц("ш(л"р(НX*НКC+*р(~<ВО*л*т("ц(Гу*:Є(ѕВф*л! :ђ(·Ку*ѕВу*:9-· Ву**т("ш(леНx+СК+л"т(лГ°**ц(}ґВ+*ш(}ґК+"т(*т(Нx+"р(Нx+лНm+*ф(^#V*р( 	s#r*р(л*ф(s#rлЙ*р( :п(ѕКY+4ѕКY+Нѓ+*р(л*ф(~#ngНµлИГ+*т( 	s#rЙ 	^#Vл|µЙ:п(w·И:ђ(<wЙеХНа+бќы :(Н	э"±(бЙ·ИюЪЬ+>Кґ+>2њылНd,Ил:ЯыюКа+ю#КП+юТа+>2њыеН9бВа+Ї2њы~2ќы#л!  ж В,ЕК,К,)ЏхxЪ,с)ЏхжЦ Т,O с	О БВс+"ћы!ќыж¶wж В[,жOж?WжGzжа±O:„(ТV,хxGyOсГG,xж¶w qЙ*}(}ґ<ЙНd,И:њы<И:еы·И*i(^#Vл=В‡,*‡("э:(*}(НэВ®,:э· Д=:ЯыЦИ:њы<МЇЙНшАНхА>я2њы*i(^#Vл+НЇЙНd,И!ё(ќы еХЕНKя*}(еН@На+*бы))СБСХЕ:(Н	эБбСГKя:Њ(Ъ—>я2#-Г—юВ:#-<ВбГЦ)Ї2#-*р(Й !  "єы"±ы++Й"ф(Ц29-Й НC-Г%Нw*{(}¤<И^#VzіИ!Є(ѕВc-! >яѕВc-! ГJ-Нw*q(~·А6ЙН9!эЙНђГ9НbГр                                                                                                                        BI$""	HB @      UUUUUUUUUUUUUUUUUAPD  A$! ’@ IЂ    ђ!@  D @BDI@ !B$      ’@$I$$  "@’$‚$@@H’‚HB  D‚‘"D$ЂH	ђD@Ђ!ђIB€@  A"B		„HBIB$$ ‘" $ „€DЃ$Ѓ!„ "D$’H$D€$‚I’@D B€D"‰	 H$BHHђBDHB"H„‘Ѓ!"!!$$HH‘	‘!‰"BB$HHђ€€DAЃ!	" „D‰"H $„€B’!’$! ‰A’I!$’	„„$ H ‘  H                                                                                             A$‰I!   ЂI Ђ" „ €$$BD"$H „"AH’D	Ђ@’ Ѓ	€ €I	 Ђ€B" $‰$€H  @@@@"	BH‰ЂB   ‘!I$	 @	$@$ Ђ "$A€I$’$IЂBI$„I  H@ @I!$’DA Ѓ $Ѓ $€’@$	!$ !!"€Ђ  Ѓ„!$I€‚@I	$@‚ „ђ$  @! Ђ€H"BI"HI DI €H’A ђDD$HHђ	‘$ ‰ B ‰ ’D$ђ‘ ‘"I$I$’H$ €‚I„  Ђ! Ђ 	$’I$‘I$’I $„@’HЂD$  € @   ‘ђ!$"A$A  €D‚ BI  €’D„€Ђ  B	’	@Ѓ$‘$’D’ D""I	$BH’I$ђ’IB ! @"BD B BDЃ €"@‘B @$	$’BI	I B„‘$@‰" 	! " „„H‰‘	!$„„€B I$‘    D@‘!	!$  ‘ ђЂ „‚@        H!$$ ђ€D€"@A @ ‚DH‚II‰	 ’D@@„’	   $ €ђDH€I"DЂ$€ЂЂ €@  „$ "" @ B!  „ @@D €$’$‘’A$	$D "@I	$A$‘$’I!H„’I$ BA$Ѓ $DH‘	$’I$’I"HI$ђ‰I!$’D „B$"B ’I$‰$’I$‘	!I$Ђ@DBB$@D@ђ"I A!$‘ ‰ @   ‚@    	" $ђ’	$I$’ђ’I$ Ђ B ! ђ$‚@’ ђI ЂЂ‚@’I$‘ HBDђH$„€’ A$H’!€’$D$‚	$I"                    B  	II„’B‘B"$€B@DЃђH €"$$	 IH $’$€‰	!I"A D„‘	  ђB!B   ђ    BI$‚A€$"@$I $!!""@H!	$ ! @I ‘$Ђ              $€H  @@@@"	BH‰ЂB   ‘!I$	 @	$@$ Ђ "$A€I$’$IЂBI$„I  H@ @I!$’DA Ѓ $Ѓ $€’@$	!$ !!"€Ђ  Ѓ„!$I€‚@I	$@‚ „ђ$  @! Ђ€H"BI"HI DI €H’A ђDD$HHђ	‘$ ‰ B ‰ ’D$ђ‘ ‘"I$I$’H$ €‚I„  Ђ! Ђ 	$’I$‘I$’I $„@’HЂD$ ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееM80
<BNKBIOS,BNKBIOS=BNKBIOS/C
<SCB,SCB=SCB/C
<HDBOOT,HDBOOT=HDBOOT/C
<CHARIO,CHARIO=CHARIO/C
<MOVE,MOVE=MOVE/C
<DRVTBL1,DRVTBL1=DRVTBL1/C
<DISKIO1,DISKIO1=DISKIO1/C
<HD2,HD2=HD2/C
<

era *.crf

LINK BNKBIOS3[B,NR]=BNKBIOS,SCB,HDBOOT,CHARIO,MOVE,DRVTBL1,DISKIO1,HD2

Gencpm auto
@!$€  @I @ђ‘ ’   ЂЂ  @  Ђ  I	 ’D’I ‚BI€   „!  @„Ѓ"	’D  ђ$’I$H ‘$‚€’  Ђ‰"Ѓ		 D	ЂЂЂ      ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее;******************************************************************************
;*  B N K B I O S  *  C P M S Y S 4  *  T h o m a s   H o l t e * 8 5 0 7 1 7 *
;******************************************************************************
;*									      *
;*   R O O T   M O D U L E   O F   R E L O C A T A B L E   B I O S   F O R    *
;*   =====================================================================    *
;*									      *
;*  	      C P / M   3 . 0   O N   T H E   G E N I E   I I I s 	      *
;*	      ===================================================	      *
;*									      *
;* 		    M I C R O C O M P U T E R   S Y S T E M		      *
;*		    =======================================		      *
;*									      *
;*									      *
;*  Thomas Holte						 Version 1.0  *
;*									      *
;******************************************************************************

	.Z80

	TITLE 'ROOT MODULE OF RELOCATABLE BIOS FOR CP/M 3.0'

;version 1.0  15 Sept 82

;			Copyright (c), 1982
;	       	       Digital Research, Inc
;		   	   P.O. Box 579
;	      	      Pacific Grove, CA 93950

;This is the invariant portion of the modular BIOS and is distributed as source
;for informational purposes only. All desired modifications should be performed
;by adding or changing externally defined modules. This allows producing
;"standard" I/O modules that can be combined to support a particular system
;configuration.


;ASCII control codes
BEL	EQU  07H		;bell
DC1	EQU  11H		;device control 1
DC3	EQU  13H		;device control 3
ESC	EQU  1BH		;escape

CCP	EQU  0100H		;Console Command Processor gets loaded 
				;into the TPA

	CSEG			;GENCPM puts CSEG stuff in common memory

;Variables in system data page
	EXTERNAL @COVEC,@CIVEC	;I/O redirection vectors
	EXTERNAL @AOVEC,@AIVEC,@LOVEC
	EXTERNAL @MXTPA		;addr of system entry point

;Initialization
	EXTERNAL ?INIT		;general initialization and signon
	EXTERNAL ?LDCCP,?RLCCP	;load & reload CCP for BOOT & WBOOT

;User defined character I/O routines
	EXTERNAL ?CI,?CO,?CIST	;each take device in reg. B
	EXTERNAL ?COST
	EXTERNAL ?CINIT		;(re)initialize device in reg. C
	EXTERNAL @CTBL		;physical character device table

;Disk communication data items
	EXTERNAL @DTBL		;table of pointers to XDPHs
	GLOBAL @ADRV,@RDRV,@TRK	;parameters for disk I/O
	GLOBAL @SECT,@DMA,@DBNK

;Memory control
	GLOBAL @CBNK		;current bank 
	EXTERNAL ?XMOVE,?MOVE	;select move bank, and block move
	EXTERNAL ?BANK		;select CPU bank
	EXTERNAL ?USERF		;call hardware drivers

;Clock support
	EXTERNAL ?TIME		;signal time operation

;General utility routines
	GLOBAL ?PMSG,?PDEC	;print message, print number from 0 to 65535
	GLOBAL ?PDERR		;print BIOS disk error message header
	INCLUDE MODEBAUD	;define mode bits

;External names for BIOS entry points
	GLOBAL ?BOOT,?WBOOT,?CONST,?CONIN,?CONO,?LIST,?AUXO,?AUXI,?HOME,?SLDSK
	GLOBAL ?SLDSK,?STTRK,?STSEC,?STDMA,?READ,?WRITE,?LISTS,?SCTRN,?CONOS
	GLOBAL ?AUXIS,?AUXOS,?DVTBL,?DEVIN,?DRTBL,?MLTIO,?FLUSH,?MOV,?TIM
	GLOBAL ?BNKSL,?STBNK,?XMOV


*EJECT
;BIOS jump vector.

;All BIOS routines are invoked by calling these entry points.

?BOOT:	JP   BOOT		;initial entry on cold start
?WBOOT:	JP   WBOOT		;reentry on program exit, warm start

?CONST:	JP   CONST		;return console input status
?CONIN:	JP   CONIN		;return console input character
?CONO:	JP   CONOUT		;send console output character
?LIST:	JP   LIST		;send list output character
?AUXO:	JP   AUXOUT		;send auxiliary output character
?AUXI:	JP   AUXIN		;return auxiliary input character

?HOME:	JP   HOME		;set disks to logical home
?SLDSK:	JP   SELDSK		;select disk drive, return disk parameter info
?STTRK:	JP   SETTRK		;set disk track
?STSEC:	JP   SETSEC		;set disk sector
?STDMA:	JP   SETDMA		;set disk I/O memory address
?READ:	JP   READ		;read physical block(s)
?WRITE:	JP   WRITE		;write physical blocks

?LISTS:	JP   LISTST		;return list device status
?SCTRN:	JP   SECTRN		;translate logical to physical sector

?CONOS:	JP   CONOST		;return console output status
?AUXIS:	JP   AUXIST		;return aux input status
?AUXOS:	JP   AUXOST		;return aux output status
?DVTBL:	JP   DEVTBL		;return address of device def table
?DEVIN:	JP   ?CINIT		;change baud rate of device

?DRTBL:	JP   GETDRV		;return address of disk drive table
?MLTIO:	JP   MULTIO		;set multiple record count for disk I/O
?FLUSH:	JP   FLUSH		;flush BIOS maintained disk caching

?MOV:	JP   ?MOVE		;block move memory to memory
?TIM:	JP   ?TIME		;signal time and date operation
?BNKSL:	JP   BNKSEL		;select bank for code execution and default DMA
?STBNK:	JP   SETBNK		;select different bank
				;for disk I/O DMA operations
?XMOV:	JP   ?XMOVE		;set source and destination banks
				;for one operation

?USER:	JP   ?USERF		;call hardware drivers (user function)
	JP   DUMMY		;reserved for future expansion
	JP   DUMMY


*EJECT
	DSEG			;this part can be banked

BOOT:
;====

;Initial entry point for system startup.
	LD   SP,BOOT$STACK	

	CALL ?INIT		;perform any additional system initialization
				;and print signon message 
	
	LD   BC,16*256+0	;init all 16 logical disk drives
	LD   HL,@DTBL
D$INIT$LOOP:
	PUSH BC			;save remaining count and abs drive
	LD   E,(HL)		;grap @DRV entry
	INC  HL
	LD   D,(HL)
	INC  HL
	LD   A,E		;if null, no drive
	OR   D
	JR   Z,D$INIT$NEXT
	PUSH HL			;save @DRV pointer
	EX   DE,HL		;XDPH address in <HL>
	DEC  HL			;get relative drive code
	DEC  HL
	LD   A,(HL)
	LD   (@RDRV),A
	LD   A,C		;get absolute drive code
	LD   (@ADRV),A
	DEC  HL			;point to init pointer
	LD   D,(HL)		;get init pointer
	DEC  HL
	LD   E,(HL)
	EX   DE,HL		;call init routine
	CALL IPCHL
	POP  HL			;recover @DRV pointer
D$INIT$NEXT:
	POP  BC			;recover counter and drive #
	INC  C			;and loop for each drive
	DEC  B
	JR   NZ,D$INIT$LOOP

	JP   BOOT$1

	CSEG			;following in resident memory

BOOT$1:	CALL SET$JUMPS
	CALL ?LDCCP		;fetch CCP for first time
	JP   CCP


WBOOT:
;=====

;Entry for system restarts.

	LD   SP,BOOT$STACK
	CALL SET$JUMPS		;initialize page zero
	CALL ?RLCCP		;reload CCP
	JP   CCP		;then reset jmp vectors and exit to CCP

SET$JUMPS:
	LD   A,1
	CALL ?BNKSL
	LD   A,0C3H
	LD   (0000H),A		;set up jumps in page zero
	LD   (0005H),A		
	LD   HL,?WBOOT		;BIOS warm start entry
	LD   (0001H),HL
	LD   HL,(@MXTPA)	;BDOS system call entry
	LD   (0006H),HL
	RET

	DEFS 64
BOOT$STACK EQU $


*EJECT
CONST:
;=====

;Console input status. Return true if any selected console input device has an
;available character.

	LD   HL,(@CIVEC)	;get console input vector
	JP   IST$SCAN


CONIN:
;=====

;Console input. Return character from first ready console input device.

	LD   HL,(@CIVEC)
	JR   IN$SCAN


CONOUT:
;======

;Console output. Send character in reg. C to all selected devices.

	LD   HL,(@COVEC)	;fetch console output bit vector
	JR   OUT$SCAN


LIST:
;====

;List output. Send character in reg. C to all selected devices.

	LD   HL,(@LOVEC)	;fetch list output bit vector

OUT$SCAN:
	LD   B,0 		;start with device 0 
CO$NEXT:ADD  HL,HL		;shift out next bit
	JR   NC,NO$OUT$DEVICE
	PUSH HL			;save the vector
	PUSH BC			;save the count and character
NOT$OUT$READY:
	CALL COSTER
	OR   A
	JR   Z,NOT$OUT$READY
	POP  BC			;restore and resave the character and device
	PUSH BC
	CALL ?CO		;if device selected, print it
	POP  BC			;recover count and character
	POP  HL			;recover the rest of the vector
NO$OUT$DEVICE:
	INC  B			;next device number
	LD   A,H		;see if any devices left
	OR   L
	JR   NZ,CO$NEXT		;and go find them ...
	RET


AUXOUT:
;======

;Auxiliary output. Send character in reg. C to all selected devices.

	LD   HL,(@AOVEC)	;fetch aux output bit vector
	JR   OUT$SCAN


AUXIN:
;=====

;Auxiliary input. Return character from first ready auxiliary input device.

	LD   HL,(@AIVEC)

IN$SCAN:PUSH HL			;save bit vector
	LD   B,0 
CI$NEXT:ADD  HL,HL		;shift out next bit
	LD   A,0		;insure zero a (nonexistent device not ready)
	CALL C,CISTL		;see if the device has a character
	OR   A
	JR   NZ,CI$RDY		;this device has a character
	INC  B			;else, next device
	LD   A,H		;see if any more devices
	OR   L
	JR   NZ,CI$NEXT		;go look at them
	POP  HL			;recover bit vector
	JR   IN$SCAN		;loop til we find a character
CI$RDY:	POP  HL			;discard extra stack
	JP   ?CI


*EJECT
;Utility subroutines

IPCHL:	JP   (HL)		;vectored CALL point

;print message (^ in reg. HL) up to a null
?PMSG:	PUSH BC			;saves reg. BC & reg. DE
	PUSH DE
PMSG$LOOP:
	LD   A,(HL)
	OR   A
	JR   Z,PMSG$EXIT
	LD   C,A
	PUSH HL
	CALL ?CONO
	POP  HL
	INC  HL
	JR   PMSG$LOOP
PMSG$EXIT:
	POP  DE
	POP  BC
	RET

;print binary number 0-65535 from reg. HL
?PDEC:	LD   BC,TABLE10
	LD   DE,-10000
NEXT:	LD   A,'0'-1
PDEC1:	PUSH HL
	INC  A
	ADD  HL,DE
	JR   NC,STOPLOOP
	INC  SP
	INC  SP
	JR   PDEC1
STOPLOOP:
	PUSH DE
	PUSH BC
	LD   C,A
	CALL ?CONO
	POP  BC
	POP  DE
NEXTDIGIT:
	POP  HL
	LD   A,(BC)
	LD   E,A
	INC  BC
	LD   A,(BC)
	LD   D,A
	INC  BC
	LD   A,E
	OR   D
	JR   NZ,NEXT
	RET
TABLE10:DEFW -1000,-100,-10,-1,0

?PDERR:	LD   HL,DRIVE$MSG	;error header
	CALL ?PMSG
	LD   A,(@ADRV)		;drive code
	ADD  A,'A'
	LD   C,A
	CALL ?CONO
	LD   HL,TRACK$MSG	;track header
	CALL ?PMSG
	LD   HL,(@TRK)		;track number
	CALL ?PDEC
	LD   HL,SECTOR$MSG	;sector header
	CALL ?PMSG
	LD   HL,(@SECT)		;sector number
	JR   ?PDEC
	
	
XOFFLIST:
	DEFB -1,-1,-1,-1	;CTL-S clears to zero
	DEFB -1,-1,-1,-1	
	DEFB -1,-1,-1,-1	
	DEFB -1,-1,-1,-1	


*EJECT
	DSEG			;following resides in banked memory

HOME:
;====

;Home selected drive. Treated as SETTRK (0).

	LD   BC,0		;same as set track zero
	JR   SETTRK


SELDSK:
;======

;Select disk drive. Drive code in reg. C. Invoke login procedure for drive if
;this is first select. Return address of disk parameter header in reg. HL.

	LD   A,C		;save drive select code
	LD   (@ADRV),A
	LD   L,C		;create index from drive code
	LD   H,0		
	ADD  HL,HL
	LD   BC,@DTBL		;get pointer to dispatch table
	ADD  HL,BC
	LD   A,(HL)		;point at disk descriptor
	INC  HL
	LD   H,(HL)
	LD   L,A
	OR   H			;if no entry in table, no disk
	RET  Z
	LD   A,E		;examine login bit
	AND  1
	JR   NZ,NOT$FIRST$SELECT
	PUSH HL			;put pointer in stack & <HL>
	EX   DE,HL
	LD   HL,-2		;get relative drive
	ADD  HL,DE
	LD   A,(HL)
	LD   (@RDRV),A
	LD   HL,-6		;find LOGIN addr
	ADD  HL,DE
	LD   A,(HL)		;get address of LOGIN routine
	INC  HL
	LD   H,(HL)
	LD   L,A
	CALL IPCHL		;call LOGIN
	POP  HL			;recover DPH pointer
NOT$FIRST$SELECT:
	RET


SETTRK:
;======

;Set track. Saves track address from reg. BC in @TRK for further operations.

	LD   (@TRK),BC
	RET


SETSEC:
;======

;Set sector. Saves sector number from reg. BC in @SECT for further operations.

	LD   (@SECT),BC
	RET


SETDMA:
;======

;Set disk memory address. Saves DMA address from reg. BC in @DMA.

	LD   (@DMA),BC
	RET


READ:
;====

;Read physical record from currently selected drive. Finds address of proper
;read routine from extended disk parameter header (XDPH).

	LD   HL,(@ADRV)		;get drive code and double it
	LD   H,0
	ADD  HL,HL
	LD   DE,@DTBL		;make address of table entry
	ADD  HL,DE
	LD   A,(HL)		;fetch table entry
	INC  HL
	LD   H,(HL)
	LD   L,A
	PUSH HL			;save address of table
	LD   DE,-8		;point to read routine address
	ADD  HL,DE
	JR   RW$COMMON		;use common code


WRITE:
;=====

;Write physical sector from currently selected drive. Finds address of proper
;write routine from extended disk parameter header (XDPH).

	LD   HL,(@ADRV)		;get drive code and double it
	LD   H,0
	ADD  HL,HL
	LD   DE,@DTBL		;make address of table entry
	ADD  HL,DE
	LD   A,(HL)		;fetch table entry
	INC  HL
	LD   H,(HL)
	LD   L,A
	PUSH HL			;save address of table
	LD   DE,-10		;point to write routine address
	ADD  HL,DE

RW$COMMON:
	LD   A,(HL)		;get address of routine
	INC  HL
	LD   H,(HL)
	LD   L,A
	POP  DE			;recover address of table
	DEC  DE			;point to relative drive
	DEC  DE
	LD   A,(DE)		;get relative drive code and post it
	LD   (@RDRV),A
	JP   (HL)		;leap to driver


*EJECT
	CSEG

LISTST:
;======

;List output status. Return true if all selected list output devices are ready.

	LD   HL,(@LOVEC)	;get list output bit vector

OST$SCAN:
	LD   B,0 		;start with device 15
COS$NEXT:
	ADD  HL,HL		;check next bit
	PUSH HL			;save the vector
	PUSH BC			;save the count
	LD   A,0FFH		;assume device ready
	CALL C,COSTER		;check status for this device
	POP  BC			;recover count
	POP  HL			;recover bit vector
	OR   A			;see if device ready
	RET  Z			;if any not ready, return false
	INC  B			;drop device number
	LD   A,H		;see if any more selected devices
	OR   L
	JR   NZ,COS$NEXT
	LD   A,0FFH		;all selected were ready, return true
	RET

;check for output device ready, including optional XON/XOFF support 
COSTER:	LD   L,B		;make device code 16 bits
	LD   H,0
	PUSH HL			;make it in stack
	ADD  HL,HL		;create offset into device characteristics tbl
	ADD  HL,HL
	ADD  HL,HL
	LD   DE,@CTBL+6		;make address of mode byte
	ADD  HL,DE
	LD   A,(HL)
	AND  MB$XON$XOFF
	POP  HL			;recover console number in reg. HL
	JP   Z,?COST		;not a XON device, go get output status direct
	LD   DE,XOFFLIST	;make pointer to proper XON/XOFF flag
	ADD  HL,DE
	CALL CISTL		;see if this keyboard has character
	LD   A,(HL)		;get flag or read key if any
	CALL NZ,CIL
	CP   DC1		;if its a CTL-Q,
	JR   NZ,NOT$Q
	LD   A,0FFH		;set the flag ready
NOT$Q:	CP   DC3		;if its a CTL-S,
	JR   NZ,NOT$S
	XOR  A			;clear the flag
NOT$S:	LD   (HL),A		;save the flag
	CALL COSTL		;get the actual output status
	AND  (HL)		;and mask with CTL-Q/CTL-S flag
	RET			;return this as the status

CISTL:	PUSH BC			;get input status with regs. BC and HL saved
	PUSH HL
	CALL ?CIST
	POP  HL
	POP  BC
	OR   A
	RET

COSTL:	PUSH BC			;get output status, saving reg. BC & reg. HL
	PUSH HL
	CALL ?COST
	POP  HL
	POP  BC
	OR   A
	RET

CIL:	PUSH BC			;get input, saving reg. BC & reg. HL
	PUSH HL
	CALL ?CI
	POP  HL
	POP  BC
	RET


*EJECT
	DSEG

SECTRN:
;======

;Sector translate. Indexes skew table in reg. DE with sector in reg. BC.
;Returns physical sector in reg. HL. If no skew table (reg. DE = 0) then
;returns physical = logical.

	LD   L,C
	LD   H,B
	LD   A,D
	OR   E
	RET  Z
	EX   DE,HL
	ADD  HL,BC
	LD   L,(HL)
	LD   H,0
	RET


*EJECT
	CSEG

CONOST:
;======

;Console output status. Return true if all selected console output devices are
;ready.

	LD   HL,(@COVEC)	;get console output bit vector
	JR   OST$SCAN


AUXIST:
;======

;Auxiliary input status. Return true if any selected auxiliary input device has
;an available character.

	LD   HL,(@AIVEC)	;get aux input bit vector

IST$SCAN:
	LD   B,0 		;start with device 15
CIS$NEXT:
	ADD  HL,HL		;check next bit
	LD   A,0		;assume device not ready
	CALL C,CISTL		;check status for this device
	OR   A			;if any ready, return true
	RET  NZ
	INC  B			;drop device number
	LD   A,H		;see if any more selected devices
	OR   L
	JR   NZ,CIS$NEXT
	XOR  A			;all selected devices were not ready,
	RET			;return false


AUXOST:
;======

;Auxiliary output status. Return true if all selected auxiliary output devices
;are ready.

	LD   HL,(@AOVEC)	;get aux output bit vector
	JP   OST$SCAN


DEVTBL:
;======

;Return address of character device table.

	LD   HL,@CTBL
	RET


*EJECT
GETDRV:
;======

;Return address of drive table.

	LD   HL,@DTBL


MULTIO:
;======

;Set multiple sector count (not implemented).

DUMMY:	RET


	DSEG

FLUSH:
;=====

;BIOS deblocking buffer flush. Not implemented.

	XOR  A			;return with no error
	RET


*EJECT
	CSEG

BNKSEL:
;======

;Bank select. Select CPU bank for further execution.

	LD   (@CBNK),A		;remember current bank
	JP   ?BANK		;and go exit through users 
				;physical bank select routine
  

	DSEG

SETBNK:
;======

;Set disk memory bank. Saves bank number in @DBNK for future disk data
;transfers.

	LD   (@DBNK),A
	RET 	


;error message components:
DRIVE$MSG:
	DEFB ESC,'E',BEL
	DEFM 'BIOS Error on '
	DEFB 0
TRACK$MSG:
	DEFM ': T-'
	DEFB 0
SECTOR$MSG:
	DEFM ', S-'
	DEFB 0


@ADRV:	DEFS 1			;currently selected disk drive
@RDRV:	DEFS 1			;controller relative disk drive
@TRK:	DEFS 2			;current track number
@SECT:	DEFS 2			;current sector number
@DMA:	DEFS 2			;current DMA address
@DBNK:	DEFB 0			;bank for DMA operations

	CSEG			;common memory

@CBNK:	DEFB 0			;bank for processor operations

	END
 	;return with no error
	RET


*EJECT
	CSEG

BNKSEL:
;======

;Bank select. Select CPU bank for further execution.

	LD   (@CBNK),A		;remember current bank
	JP   ?BANK		;and go exit through users 
				;physical bank select routine
  

	DSEG

SETBNK:
;======

;Set disk memory bank. Saves bank number in @DBNK for future disk data
;transfers.

	LD   (@DBNK),A
	ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее Ј       Л                                                                                                                                                                                                                                                    Г Гl ГТ ГШ ГЭ Гв Гя ГГ2Г7ГeГjГoГtГ‰Г—ГЁГшГэГГГ…ГГГіГ†ГЋГГµГuГзГГНx Н&Г 1Т Нx НrГ >НQ >Г2  2 ! " *bю" Й                                                                *"юГ *"ю**$ю**ю )0еЕН°·(ъБЕНпБб|µ йЙ*(юб*&юе )> ЬЮ· |µ тбмбГЁйЕХ~·(	OеН б#уСБЙWрШ>/е<033чХЕOН БСб
_
W{І вЙьњяцяяя  !№Н :ХЖAOН !ЛН *ЧН2!РН *Щ«яяяяяяяяяяяяяяяя**ю )еЕ>яЬ°Бб·И|µ п>яЙh& е)))B~жбК‡НЮ~Дрю >яю ЇwНз¦ЙЕеНКбБ·ЙЕеНбБ·ЙЕеНЁбБЙ*$юќ*&ю )> ЬЮ·А|µ уЇЙ*(юГљ!<Й!"Й2%Г¤ Ї2q!  "‚bН­<(. НІЂ Н·bНј!  5Е>ЂНзЂ 	л	лБнЙ!?Н Н	 ґ! 5 Е>ЂНзЂ 	л	лБнЙеХ(!Xю*Xю:ZюW:[ю_НзСбЙГ Г ,Г Г 







R C P / M   V e r s i o n   3 S

GENIE IIIs SYSTEM
Version b of BIOS (851120)
Thomas Holte  1985











 

BIOS Err on C: No CCP.COM file CCP     COM                       yюРЦШИ=Gi& )))Cn& e^>ДГзx·(=(=(= G= ГзГз>Йx·(=(=(= G= Нз·И>яЙЇЙx·y(( (А
ГзГзГзx·(Ф= G= = G= Б	Нз· і®CRT    LPT1   LPT2   TTY1  TTY2    
 	  >я2…y‡‡‡‡Ђ2„Й  л:…·(Ї2…:„ЕAНзБ	л	Йн°лЙЕжАцOЫщж=±УщБЙ                                                  нs1зЕХеЭеэехЫщ2!ж=цУщсЗых:!УщЫъжЧцEУъсэбЭббСБн{Й   )o’                L    µP  …ї а 0  ї 7  Ђ  Ђ    P ї я А @  
яя  Ђ 9
яя  Ђ3*Ы:ЭН¤@ нІнІ*Ы:ЭН¤@нЈЫAюП(юЙ цнЈтЇН¤Г>                                                     1Т НЮ !"Е^#V#{І(ел++~2Цy2Х+V+^лНбБ ЭГc   .y2Хi& )"	~#foґИ{ж ел!юя~2Ц!ъя~#foНбЙнCЧЙнCЩЙнCЫЙ*Х& )"~#foешя*Х& )"~#foеця~#foС2Цйi`zіИл	n& ЙЇЙ2ЭЙEBIOS Error on  : T- , S-          ! Ђ""ю"$ю! @"*ю! "&ю"(ю!БГ Lр®®              Bюяюяюяюяюя Lр®®             Bюяюяюяюяюя ОК®Н             S  юяюяяяюя $	®^             u  юяюяюяюя $	®^            †  юяюяюяюя 
®®У          dG«­юя pА
P 	
 !"#$%&'()*+,-./0123                                                                                                                                                                    Їѕя         Н   я         Н                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   :·И Ђ ЕХ!п>Нзб  лБ йЙе:ЩG:Ч_:ЦO:ЭЛ'Л'Л'Л'±*ЫНз2Й·ВЙ:Kю<(+Нa*Й& -)I	~#foН !хН НЇO!Н yюYКр>Й:ЩG:Ч_:ЦO:ЭЛ'Л'Л'Л'±*ЫНз2Й·ВtЙ:Kю<(+Нa*Й& -)[	~#foН !хН НЇO!Н yюYКL:Йю>А<ЙН ·(Н	 хН	 хOН сюAШжЯЙ >яЇ2:ЧЖ‡‡‡‡!Э†хн[Ы*Щ#)эЂ:· схлсНзЇЙ э!рэ!L:і‡O‡Ѓ O!Ч	еD н°!ОСХ н°!5еэй!DС н°!ПЛЖЙ     m’¦ЅѕЦо	!3FZqЊЁАЬ Illegal drive #,  Track # too high,  Sector # too high,  Device not available,   Locked/deleted record,  Data record not found,  Parity error during read,  Lost data during read,  Illegal drive #,  Track # too high,  Sector # too high,  Device not available,  Write protected diskette,  Write fault on disk drive,  Data record not found,  Parity error during write,  Lost data during write,  Retry (Y/N) ?  D !IНЄуНЫAюПК>юЛ хГ—!QНЄу
НЫAюП(юЙ цГ©ы ЫAюП(ш!kЫ@жИ!ZУAНЦ>ЙУAЫAюА ъЇУCЫAюА ъ!BН!:@ЫAюЙ ъН~нy#чЫAюП ъЫ@ЛW(УA!ZГс!„Гс"GнKЧy27 ЛЛЛЛ :Щю8Цч±26x25Й:Kююя с>ыЙНa*GН Нх!џН ЙН ·(Н	 хН	 хOН сюAШжЯЙЫAЛG(ъЙЫAюА(УAцУB!5НyУ@Н~У@#чЙ   fff      I, Read  , Write  Hard Disk Error Command Terminate Error Seagate ST 225 - 21.4 MB
 D $’I$’I$’I$’I$‚H        	! B     Ђ  A$’H  @  @H€  ! DHA$	   I    	@                               B      @           @ @ђ          $    @ @          I @        $ ЂЂ@ @   „" @       $•P  Є  @ @Ё  U  
ў *                            
   @                                                                                                                                                                                                                                                                  "" !" ђ $‘ ‚" "	I	 A@ H   ЃЂ A Ђ*ЄЄЄЁ                                                   @Ђ    A  @  ’H€  €Ђ	$‘!   	   Ђ           AюЙ ъН~нy#чЫAюП ъЫ@ЛW(УA!ZГс!„Гс"GнKЧy27 ЛЛЛЛ :Щю8Цч±26x25Й:Kююя с>ыЙНa*GН Нх!џН ЙН ·(Н	 хееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее;******************************************************************************
;*  B O O T  *  C P M S Y S 4 b  *  T h o m a s   H o l t e   *  8 5 1 0 2 3  *
;******************************************************************************
;*									      *
;*  	 B O O T   L O A D E R   M O D U L E   F O R   C P / M   3 . 0	      *
;*       =============================================================        *
;*									      *
;*									      *
;*  Thomas Holte						 Version 1.0  *
;*									      *
;******************************************************************************

	.Z80

	TITLE 'BOOT LOADER MODULE FOR CP/M 3.0'

;ASCII control codes
BEL	EQU  07H		;bell
LF	EQU  0AH		;line feed
CR	EQU  0DH		;carriage return
SUB	EQU  1AH		;substitute
ESC	EQU  1BH		;escape
RS	EQU  1EH		;record separator

        GLOBAL ?INIT,?LDCCP,?RLCCP,?TIME
	EXTERNAL ?PMSG,?CONIN,?USERF
	EXTERNAL @CIVEC,@COVEC,@AIVEC,@AOVEC,@LOVEC
	EXTERNAL @DATE,@HOUR,@MIN

BDOS	EQU  0005H

	DSEG			;init done from banked memory

?INIT:  LD   HL,8000H           ;assign console to CRT 
        LD   (@CIVEC),HL
        LD   (@COVEC),HL
	LD   HL,4000H		;assign printer to LPT1
        LD   (@LOVEC),HL
        LD   HL,1000H           ;assign AUX to TTY1
        LD   (@AIVEC),HL
        LD   (@AOVEC),HL
	LD   HL,SIGNON$MSG	;print signon message
	JP   ?PMSG


	CSEG			;boot loading must be done from resident memory

;This version of the boot loader loads the CCP from a file called CCP.COM on
;the system drive (A:).

;First time, load the A:CCP.COM file into TPA
?LDCCP:	XOR  A                  ;zero extent
	LD   (CCP$FCB+15),A
	LD   HL,0               ;start at beginning of file
	LD   (FCB$NR),HL
     	LD   DE,CCP$FCB		;open file containing CCP
        CALL OPEN
	INC  A                  ;error if no file ...
	JR   Z,NO$CCP
	LD   DE,0100H 		;start of TPA
	CALL SETDMA
	LD   DE,128  		;allow up to 16k bytes
	CALL SETMULTI
	LD   DE,CCP$FCB		;load the thing
	CALL READ		;now, copy CCP to secret bank for reloading

;move copy of CCP into secret bank:
	LD   HL,0100H		;source      address --> reg. HL
	LD   DE,3500H		;destination address --> reg. DE
     	LD   B,25		;record count        --> reg. B
LDLOOP: PUSH BC			;save record count
	LD   A,10H		;source      bank = 1
        			;destination bank = 0
	LD   BC,128 SHL 8+15	;byte count --> reg. B
	          		;function # --> reg. C
	CALL ?USERF		;move CCP record
	LD   BC,128		;record length --> reg. BC
	ADD  HL,BC		;bump source address
	EX   DE,HL
	ADD  HL,BC		;bump destination address
	EX   DE,HL
	POP  BC			;restore record count
	DJNZ LDLOOP		;move next record	
	RET			;return to caller
	
;here if we couldn't find the file:
NO$CCP:	LD   HL,CCP$MSG		;report this ...
	CALL ?PMSG
	CALL ?CONIN		;get response
	JR   ?LDCCP		;and try again

;reload CCP:
?RLCCP:	LD   HL,3500H		;source      address --> reg. HL
	LD   DE,0100H		;destination address --> reg. DE
     	LD   B,25		;record count        --> reg. B
RLLOOP: PUSH BC			;save record count
	LD   A,01H		;source      bank = 0
        			;destination bank = 1
	LD   BC,128 SHL 8+15	;byte count --> reg. B
	          		;function # --> reg. C
	CALL ?USERF		;move CCP record
	LD   BC,128		;record length --> reg. BC
	ADD  HL,BC		;bump source address
	EX   DE,HL
	ADD  HL,BC		;bump destination address
	EX   DE,HL
	POP  BC			;restore record count
	DJNZ RLLOOP		;move next record	
	RET			;return to caller
	

*EJECT
;External clock.
?TIME:	PUSH HL			;save reg. HL & DE
	PUSH DE
        INC  C  		;time get/set flag ?
	JR   Z,SET$TIM		;set time
	LD   HL,@DATE		;^(time & date buffer) --> reg. HL
	LD   C,18		;function # 	       --> reg. C
	JR   GET$TIM		;get time & date and return to caller
SET$TIM:LD   HL,(@DATE)		;date		       --> reg. HL
	LD   A,(@HOUR)		;hours		       --> reg. D
	LD   D,A
	LD   A,(@MIN)		;minutes	       --> reg. E
	LD   E,A
	LD   C,19 		;function #	       --> reg. C
GET$TIM:CALL ?USERF		;set time & date and return to caller
	POP  DE			;restore reg. HL & DE
	POP  HL
	RET


;CP/M BDOS function interfaces
OPEN:	LD   C,15		;open file control block
	JP   BDOS
SETDMA:	LD   C,26		;set data transfer address
	JP   BDOS
SETMULTI:
	LD   C,44		;set record count
	JP   BDOS
READ:	LD   C,20		;read records
	JP   BDOS
	

*EJECT
SIGNON$MSG:
        DEFB CR,LF,LF,LF,LF,LF,LF,LF,LF,RS,ESC,'R'
	DEFM ' C P / M   V e r s i o n   3 '
	DEFB ESC,'S',CR,LF,LF
	DEFM 'GENIE IIIs SYSTEM'
	DEFB CR,LF
	DEFM 'Version b of BIOS (851120)'
	DEFB CR,LF
	DEFM 'Thomas Holte '
	DEFB 98H
	DEFM ' 1985'
	DEFB CR,LF,LF,LF,LF,LF,LF,LF,LF,LF,LF,LF,LF,0
ENDMSG	EQU  $

CCP$MSG:DEFB CR,LF,CR,LF
	DEFM 'BIOS Err on A: No CCP.COM file'
	DEFB 0

CCP$FCB:DEFB 1
	DEFM 'CCP     COM'
	REPT 20
	DEFB 0
	ENDM

FCB$NR:	DEFB 0,0,0

	END
 C,19 		;function #	       --> reg. C
GET$TIM:CALL ?USERF		;set time & date and return to caller
	POP  DE			;restore reg. HL &ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее;******************************************************************************
;*  B O O T E R  *  C P M S Y S 2  *  T h o m a s   H o l t e  *  8 5 1 1 2 0 *
;******************************************************************************
;*									      *
;*    B O O T S T R A P   L O A D E R   F O R   C P / M   3   O N   T H E     *
;*    ===================================================================     *
;*									      *
;*        G E N I E  I I I s   M I C R O C O M P U T E R   S Y S T E M        *
;*	  ============================================================        *
;*									      *
;*									      *
;*  Thomas Holte			                         Version 1.1  *
;*									      *
;*  ge{ndert von Volker Dose f}r Egbert Schr|er.			      *
;*  									      *	
;*  Die ]bertragung der Seriennummer vom Bildschirm in den Speicher           *
;*  zur Copyright-Protection wird gel|scht. Statt dessen werden NOPs          *
;*  eingebaut, um dort eventuell Code f}r Z180 Betrieb zu patchen.            *
;*									      *
;******************************************************************************
  
	.Z80

	ASEG
	ORG  0000H
	.PHASE 0FC00H

;load CP/M-system:
SECLEN	EQU  512		;length of a disk sector
$BUZZ	EQU  3860H		;buzzer address
$SYS0	EQU  0F9H		;port of system byte 0
$SYS1	EQU  0FAH		;port of system byte 1

	DI			;disable interrupts
	IM   1
	LD   SP,0FC00H		;init stackpointer

;clear screen:
	LD   A,00000001B	;enable bank 0
				;disable character RAM
	OUT  ($SYS0),A		;write system byte 0
	LD   A,01010100B	;enable memory mapped I/O
				;disable graphic display
				;disable boot EPROM
				;disable graphic page
				;enable full screen
				;disable video display
	OUT  ($SYS1),A		;write system byte 1

	.XLIST
	.XCREF

;	DEFB 0DDH,2EH,7		;LD LX,7     length of serial # --> reg. LX
;	LD   HL,3CB7H		;location of displayed serial # --> reg. HL
;	LD   DE,SERNO		;save location			--> reg. DE
;MOVE:	LD   A,(HL)		;get first byte of serial #
;	LD   (DE),A 		;store it
;	INC  HL			;inc ^source 
;	INC  DE			;inc ^destination
;	DEFB 0DDH,2DH		;DEC LX      dec counter
;	JR   NZ,MOVE		;get next byte

	nop			; Nops, damit das File dir selbe  
	nop			; L{nge beh{lt, und um dort die
	nop			; Einstellung der Waitzyklen f}r	
	nop			; Betrieb mit Z180 zu patchen.
	nop			;	
	nop			; Kann bei Betrieb mit Z80 aber auch
	nop			; wieder ge{ndert werden.
	nop
	nop
	nop
	nop
	nop
	nop
	nop
	nop
	nop
		





	.CREF
	.LIST

	LD   HL,3800H
	LD   DE,3801H
	LD   BC,7FFH
	LD   (HL),' '
	LDIR
	LD   A,11000101B	;disable memory mapped I/O
				;disable graphic display
				;disable boot EPROM
				;disable graphic page
				;enable keyboard
				;enable video display
	OUT  ($SYS1),A		;write system byte 1

;read first two tracks:
	LD   B,34              	;sector counter	        --> reg. B
LOOP: 	PUSH BC        		;save it
	CALL RDSEC 		;read selected sector into main memory
	OR   A			;disk error ?
	JP   NZ,ERROR
	LD   HL,(BUFFER)
	LD   BC,SECLEN
	ADD  HL,BC		;calc new load address
	LD   (BUFFER),HL
	LD   A,(SECTOR)
	INC  A			;increment sector #
	CP   20			;track exhausted ?
	JR   NZ,NXTSEC		;jump if not
	CALL STEPIN		;step in one track
	XOR  A			;reset sector #	
NXTSEC: LD   (SECTOR),A		;store sector #
	POP  BC			;restore sector counter
     	DJNZ LOOP		;read next sector

;move common code to the right place:
	LD   HL,3505H          	;source address      --> reg. HL
	LD   DE,0FE05H		;destination address --> reg. DE
	LD   BC,1FBH            ;byte count	     --> reg. BC	
	LDIR

;move CP/M loader to the right place:
	LD   HL,3700H          	;source address      --> reg. HL
	LD   DE,4400H		;destination address --> reg. DE
	LD   BC,0C80H           ;byte count	     --> reg. BC	
	LDIR
	JP   4400H		;jump into CP/M loader


*EJECT
;micro disk driver:

;FDC registers:
$FDSEL  EQU  0E0H               ;FDC select  register
$FDCMD  EQU  0ECH               ;FDC command register
$FDSTAT EQU  0ECH               ;FDC status  register
$FDSEC  EQU  0EEH               ;FDC sector  register
$FDDATA EQU  0EFH               ;FDC data    register

;FDC commands:
$STPIN	EQU  54H		;step in one track
$RDSEC  EQU  88H                ;read sector
$FCINT  EQU  0D0H               ;force interrupt


RDSEC:  LD   A,$FCINT           ;force interrupt
        OUT  ($FDCMD),A         ;reset FDC
        LD   A,(SECTOR)         ;sector #       	 --> accu
        CP   10                 ;front or back side ?
        LD   A,1                ;select code for drive 0 --> accu
        JR   C,SELECT           ;jump if front side
        SET  4,A                ;set side select bit
SELECT: OUT  ($FDSEL),A         ;select drive and side
	LD   A,$FCINT		;force interrupt
	OUT  ($FDCMD),A
	LD   A,(SECTOR)		;sector # --> accu
	CP   10			;back side ?
	JR   C,SETSEC		;jump if front side
	SUB  10			;adjust sector # 
SETSEC: OUT  ($FDSEC),A         ;store sector # in FDC reg
        LD   HL,(BUFFER)        ;get buffer pointer
        LD   A,$RDSEC        	;issue "read" command
	OUT  ($FDCMD),A
        LD   BC,12              ;56 usec delay
        CALL DELAY
        LD   C,$FDDATA          ;data register
READ1:	IN   A,($FDSTAT)	;get FDC status
        BIT  1,A                ;data request ?
        JR   NZ,READ2           ;yes, get byte
        BIT  0,A                ;full sector transferred ?
        JR   Z,STATUS           ;yes, go end process
	IN   A,($FDSTAT)	;get FDC status
        BIT  1,A                ;data request ?
        JR   NZ,READ2           ;yes, get byte
        BIT  7,A                ;drive not ready ?
        JR   Z,READ1            ;no loop
        RET                     ;return with error
READ2:  INI                     ;read char
        JR   READ1
STATUS: IN   A,($FDSTAT)        ;get FDC status
        AND  1CH                ;any errors ?
        RET

STEPIN: LD   A,$STPIN		;step in one track
	OUT  ($FDCMD),A
       	PUSH BC			;save reg. BC
        LD   BC,5               ;24 usec delay
        CALL DELAY
	POP  BC			;restore reg. BC
STEPIN1:IN   A,($FDSTAT)	;get FDC status
	BIT  0,A		;busy ?
	JR   NZ,STEPIN1		;jump if yes
	RET

DELAY:	DEC  BC			;decrement cycle count
	LD   A,B		;test if count zero
	OR   C			;combine LSB/MSB of count
	JR   NZ,DELAY		;loop until delay count exhausted
	RET			;rtn to caller


SECTOR:	DEFB 1			;current sector #
BUFFER:	DEFW 0000               ;current load address


*EJECT
ERROR:	LD   A,11000100B	;enable memory mapped I/O
	OUT  ($SYS1),A		;write system byte 1

	LD   HL,MSG		;^message		--> reg. HL	
        LD   DE,3C00H		;^first screen position --> reg. DE
	LD   BC,COPYRGT-MSG	;length of message	--> reg. BC
	LDIR			;output error message
	LD   B,100		;beep counter  --> reg. B
ALARM:	PUSH BC			;save counter

	LD   BC,0     		;repeat counter --> reg. B
                                ;  wait counter --> reg. C
BEEP:	LD   A,($BUZZ)		;turn on buzzer
	PUSH BC			;save base value of wait counter
BUZZON:	NOP			;little delay for lower frequency
	NOP
	NOP
	DEC  C			;decrement wait counter
	JR   NZ,BUZZON		;wait `til end of buzz
	POP  BC			;restore wait counter
	DJNZ BEEP		;turn on buzzer eleven times
	
	LD   BC,8000
        CALL DELAY

	POP  BC			;restore beep counter
	DJNZ ALARM		;beep 100 times
	JR   $			;hang up		

MSG:	DEFM 'DISK ERROR'

COPYRGT:DEFM 'Enhanced BIOS written by Thomas Holte  (c) 1985'
SERNO:	DEFS 7			;serial number field
	.DEPHASE


*EJECT
	ORG  01E0H

LDRBYTE:DEFB 2


	END
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееM80
<=BOOTER
<=DRIVER
<=LDRBIOS
<

L80 BOOTER/N,BOOTER/E
<N
L80 DRIVER/N,DRIVER/E
<N

LINK CPMLDR[L4400,NR]=CPMLDR,LDRBIOS

ERA BOOTER.REL
ERA DRIVER.REL
ERA LDRBIOS.REL
ERA $$TEMP$$

T80
<LOAD BOOTER 1000
<LOAD DRIVER 1200
<LOAD CPMLDR 4900
<A 49A8
<JR 49A8
<
<A 4C23
<JR 4C23
<
<SAVE $$TEMP$$. 100 557F
<BYE
copysys $$temp$$
<A
<N


  A,($BUZZ)		;turn on buzzer
	PUSH BC			;save base value of wait counter
BUZZON:	NOP			;little delay for lower frequency
	NOPееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееюаK ш          Copyright (C) 1982, Digital Research                                                                           
 RESBIOS3 SPR  F800  0600
 BNKBIOS3 SPR  C300  1D00
 RESBDOS3 SPR  F200  0600
 BNKBDOS3 SPR  9500  2E00
 
 60K TPA
$$$$$ Ђ 9
яя  Ђ3*ЫГ:ЭГН¤ь@ нІнІ*ЫГ:ЭГН¤ь@нЈЫAюП(юЙ цнЈтЇН¤ьГ>С                                                     щсЗых:!эУщЫъжЧцEУъсэбЭббСБн{эЙ   Д)ДoД’Д                LД    µДP  …ї а 0  ї 7  Ђ  Ђ    P ї я А @  
яя 2„ьЙ  л:…ь·(Ї2…ь:„ьЕAНзьБ	л	Йн°лЙЕжАцOЫщж=±УщБЙ                                                  нsэ1зьЕХеЭеэехЫщ2!эж=цУА
ГзьГзьГзьx·(Ф= G= = G= Б	Нзь· і®CRT    LPT1   LPT2   TTY1  TTY2    
 	  >я2…ьy‡‡‡‡Ђ     yюРЦШИ=Gi& )))Cьn& eь^>ДГзьx·(=(=(= G= ГзьГзь>Йx·(=(=(= G= Нзь·И>яЙЇЙx·y(( (
Version b of BIOS (851120)
Thomas Holte  1985











 

BIOS Err on C: No CCP.COM file CCP     COM                  НзьЂ 	л	лБнЙеХ(!фч*фч:цчW:чч_НзьСбЙГ Г ,Г Г 







R C P / M   V e r s i o n   3 S

GENIE IIIs SYSTEM )> ЬЮщ·А|µ уЇЙ*ДчГљщ!<ьЙ!"эЙ2%ъГ¤ь Ї2qы!  "‚ыbыН­ъ<(. НІъЂ Н·ъbыНјъ!  5Е>ЂНзьЂ 	л	лБнЙ!?ыН щН	шґ! 5 Е>Ђ щ*ЩГ«яяяяяяяяяяяяяяяя*Жч )еЕ>яЬ°щБб·И|µ п>яЙh& е)))Bь~жбКь‡щНЮщ~Дрщю >яю ЇwНзщ¦ЙЕеНКыбБ·ЙЕеНьбБ·ЙЕеНЁыбБЙ*Ачќ*ВчДчб*Вче )> ЬЮщ· |µ тбмбГЁыйЕХ~·(	OеНшб#уСБЙWщрШ>/е<033чХЕOНшБСб
_
W{І вЙьњяцяяя  !№ГН щ:ХГЖAOНш!ЛГН щ*ЧГН2щ!РГН  2 !ш" *юч" Й                                                                *ѕчГ ъ*ѕч**Ач*Жч )0еЕН°щ·(ъБЕНпыБб|µ йЙ*Г ГГlшГТшГШшГЭшГвшГяшГщГ2ГГ7ГГeГГjГГoГГtГГ‰ГГ—щГЁГГшщГэщГъГъГ…ыГъГъГіГГ†ьГЋъГъГµГГuьГзьГъГъНxшН&ъГ 1ТшНxшНrъГ >НQш>Г2ГшГѓу                 т       1                   O                         jц$  њчЂ               яяя       Ђ    аГ|•т                                                                                                        ГшГѓуГшГѓуГ	шГѓуГшГѓу;******************************************************************************
;*  C H A R I O  *  C P M S Y S 4 c  *  T h o m a s   H o l t e * 8 5 0 7 1 7 *
;******************************************************************************
;*									      *
;*    C H A R A C T E R   I / O   H A N D L E R   F O R   Z 8 0   C H I P     *
;*    ===================================================================     *
;*									      *
;*  	       		    B A S E D   S Y S T E M			      *
;*	                    =======================              	      *
;*									      *
;*									      *
;*  Thomas Holte						 Version 1.0  *
;*									      *
;******************************************************************************

	.Z80

	TITLE 'CHARACTER I/O HANDLER FOR Z80 CHIP BASED SYSTEMS'

;Character I/O for the modular CP/M 3 BIOS

;ASCII control code
SUB	EQU  1AH		;substitute

	INCLUDE MODEBAUD	;define mode bits and baud equates

	GLOBAL ?CINIT,?CI,?CO,?CIST,?COST,@CTBL
	EXTERNAL ?USERF

MAX$DEVICES EQU 5


	CSEG

?CINIT: LD   A,C		
	CP   MAX$DEVICES
	RET  NC			;illegal device
        SUB  2          	;RS232C interface ?
	RET  C 			;no initializing
	RET  Z
	DEC  A
	LD   B,A		;number of RS232C interface --> reg. B
	LD   L,C		;make 16 bits from device number
	LD   H,0
	ADD  HL,HL		;* 8
	ADD  HL,HL
	ADD  HL,HL
	LD   DE,@CTBL+7		;get baud rate
	ADD  HL,DE
	LD   L,(HL)
	LD   H,0		;get baud rate	
        LD   DE,SPEED$TABLE     ;point to counter entry
        ADD  HL,DE
        LD   E,(HL)             ;get baud rate factor
	LD   A,11000100B        ;load data format
	LD   C,1       		;function # --> reg. C
        JP   ?USERF		;init RS232C interface and return to caller

;character input
?CI:	LD   A,B
	OR   A
	JR   Z,CON$IN		;jump to console input
	DEC  A
	JR   Z,NULL$INPUT	;can't read from centronics
	DEC  A
	JR   Z,NULL$INPUT      	;can't read from centronics
	DEC  A
	JR   NZ,RS$1IN
	LD   B,A		;RS232C interface 0
	JR   TTY$IN 
RS$1IN:	DEC  A
	JR   NZ,NULL$INPUT
	LD   B,1		;RS232C interface 1
TTY$IN:	LD   C,8		;function # --> reg. C
	JP   ?USERF		;receive char from RS232C interface 
CON$IN: LD   C,3                ;function # --> reg. C
	JP   ?USERF           	;wait for keyboard character

NULL$INPUT:
	LD   A,SUB		;return a CTL-Z for no device
	RET


;character input status
?CIST:  LD   A,B
	OR   A
	JR   Z,CON$ST		;jump to console input status
        DEC  A
	JR   Z,NULL$STATUS      ;can't read from centronics
	DEC  A
	JR   Z,NULL$STATUS      ;can't read from centronics
	DEC  A
	JR   NZ,RS$1IST
	LD   B,A		;RS232C interface 0
	JR   TTY$IST
RS$1IST:DEC  A
	JR   NZ,NULL$STATUS
	LD   B,1		;RS232C interface 1
TTY$IST:LD   C,7		;function # --> reg. C
	JR   CON$ST+2
CON$ST:	LD   C,2		;function # --> reg. C
        CALL ?USERF		;check input status
	OR   A			;char ready
	RET  Z
STAT$OK:LD   A,0FFH
	RET

NULL$STATUS:
        XOR  A
	RET


;character output
?CO:	LD   A,B
        OR   A
        LD   A,C		;char --> accu
	JR   Z,CON$OUT		;jump to console output
        DEC  B
	JR   Z,LST$OUT 		;parallel printer 0
        DEC  B
	JR   NZ,RS$0OUT
	INC  B			;parallel printer 1
	JR   LST$OUT
RS$0OUT:DEC  B
	JR   Z,TTY$OUT		;RS232C interface 0
	DEC  B
	RET  NZ
	INC  B			;RS232C interface 1
TTY$OUT:LD   C,10		;function # --> reg. C
       	JP   ?USERF             ;transmit char to RS232C interface
CON$OUT:LD   C,4  		;function # --> reg. C
      	JP   ?USERF		;display char
LST$OUT:LD   C,6                ;function # --> reg. C
      	JP   ?USERF		;output char to printer


;character output status
?COST:  LD   A,B
        OR   A
        JR   Z,STAT$OK
        DEC  A
        JR   NZ,PR$1ST		;jump to list status
	LD   B,A		;parallel printer 0
	JR   LST$ST
PR$1ST: DEC  A
	JR   NZ,RS$0OST
	LD   B,1		;parallel printer 1
	JR   LST$ST
RS$0OST:DEC  A
	JR   NZ,RS$1OST
	LD   B,A		;RS232C interface 0
	JR   TTY$OST
RS$1OST:DEC  A
	JR   NZ,NULL$STATUS
	LD   B,1		;RS232C interface 1
TTY$OST:LD   C,9		;function # --> reg. C
       	JR   LST$ST+2
LST$ST:	LD   C,5		;function # --> reg. C
        CALL ?USERF		;check output status
        OR   A			;ok ?
        JR   NZ,NULL$STATUS
	JR   STAT$OK


*EJECT
@CTBL:  DEFM 'CRT   '		;device 0, CRT
	DEFB MB$IN$OUT
        DEFB BAUDNONE
	DEFM 'LPT1  '		;device 1, LPT1
	DEFB MB$OUTPUT
	DEFB BAUDNONE
	DEFM 'LPT2  '		;device 2, LPT2
	DEFB MB$OUTPUT
	DEFB BAUDNONE
        DEFB 'TTY1  '		;device 3, TTY1
	DEFB MB$IN$OUT+MB$SERIAL+MB$SOFT$BAUD
	DEFB BAUD1200
        DEFB 'TTY2  '		;device 4, TTY2
	DEFB MB$IN$OUT+MB$SERIAL+MB$SOFT$BAUD
	DEFB BAUD9600
	DEFB 0			;table terminator

SPEED$TABLE:
	DEFB 0,2,3,15,4,14,13,6,11,10,7,0,9,0,8,0

	END

PR$1ST: DEC  A
	JR   NZ,RS$0OST
	LD   B,1		;parallel printer 1
	JR   LST$ST
RS$0OST:DEC  A
	JR   NZ,RS$1OST
	LD   B,A		;RS232C interface 0
	JR   TTY$OST
RS$1OST:DEC  A
	JR   NZ,NULL$STATUS
	LD   B,1		;RS232C interface 1
TTY$OST:LD   C,9		;functееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееГ@Z3ENV   ACOPY33     яя/1 2 3 4 5 6 7 N U AяE X O R M Y S D CяVяQ  Н9
ACOPY File Copy Utility vers 3.3 - Copyright (c) 1986-91 by Terry Hazen

Syntax: 
	 Н1 [dir:]source [[dir:]dest] НqН9
	or  Н1 [[dir:]dest=][dir:]source НqН9

Options: З!њН9
	 ·К·:ЗGё($Щ!Й н±Щ(
Л(
НkНkЩНOН9 -  ·(~· еН9Don't  бНFНkНkНFГ
~#· ыЙН9 [ :НOН9option(s)] [excluded list] Й1 - 7 1 - 7 Copy only files with any of the selected attributes F1-F7 set Ignore archive status Copy only non-archived (changed) files  Update older files Copy only directory files Copy directory and system files  Copy and overwrite only if files already exist  Skip copying if files already exist  Overwrite existing R/W files without asking  Overwrite existing R/O and R/W files without asking  Move files (delete source files)  Make destination files system  Archive source files  Archive destination files  Copy datestamps  Verify copies Display status messages Quiet  !Ђ ~юЪKНјНU	ю8.O:р· %Н9
Ignoring:
 >	НOxН	НFН?x№8м>Н!<gя> Н!o"Ж"p:Ь·(2аЇ2Ю:Кц(:Ш·(2а2м:м· !КЛ†ЛЋ!ѓ :Ђ ЦO >=н± :Ыю8ЇНC	ЇН	PНј
Ъќ:Ыю0r!Q# н°>Н	qНј
Ъќю (в:Ыю8/>Н	–Нј
:Ыю8>Н	»Нј
:Ыю8>Н	аНј
НNН¦	ЪљНђ:о·ДўЇ*+н[.нRл! @нR>Ђ8лЂ ЇнR8<щ2-:2У*)O н°е:КЛG(
P:м·Д!P qНW:р· %Н9Copying  !PНeН9 to  ! НeН9  !OН8 Н9- Same as Source!
 Г—!Н8 :р·ВfН9- Duplicate! Г_Нќ0
:О·В—Г_:р· Н9-  :о·КN*т"ф:р· Н9Verifying   НTЇ*фн[тнR(%Н9 - Failed!
 :У·К‹=2Уб НГr:р· $>
НрН9Ok  :р· Н9Done  *Ф#"Ф:2У:КЛO ЛG(D!tН™ Н6Н7>gН!8.:р· (:Ш·(:М·(Н9(Updated)  Н9(Dated)  ! н°:М·(:Н·(!)ЛюQ!!ЛѕлЛ~л(Лю#т:и·(&![ЛюPН:д· Н9- Source Archived !+:к·(ЛюЛѕ!*:ж·(Лю Н:д·( PН:р· Н9- Source Deleted :р·М?*'+"'|µб(%Н`К(Н[юВ(Н9User abort -
 >ННВНг:р· *ФНы*Ж%\Нў] Н н{ЕЙ!Ђ ~·И#	~#ю=(ъю (цШ+НЧпЙе:ЫН	л<2Ыб~ю!8ю= ##пл6 #:ЫН	лЙЕO !Ь		БЙхН	Н1сЙХлН	s#rлСЙЩG:Ы·(=2ЫOx№(Н	л<Н	Ен н БнЩЙН	л<Н	=Н	<лН	Й :ЫOx№РН	:ѕ(нxН 	#~·(дЗ·(ѕ("х~хН9Invalid option:  сНOН?О/И*.")!P>?wлН§!Ђ "Ч~юеК|
 :5/¦В|
:Ъ· *Ч
 Л~В|
:Ц·(*Ч Л~В|
:Oю?*Ч(ѕ }#QН6 t*Ч#—·(#еН6б(bј·(еН6б(Tб·(еН6б(F  Иyю(·(ф*Ч	Л~ >я2Пе:П· *Чн[.н :0< н°нS.*'#"'>Н!8	НG"ЧГј	:0<2P*'|µАН9
No source file  !PНz!  Нm еН0Н;0Нl8$НЁ8БННРНfInvalid characters in  бНfInvalid du: in  нKЖxyЕХе	 Н!	~#ю:(·(ю.(пЇбСБЙ7СщЩ*	 Н0|µ(~·(е##Н8б(	 иЩ7ЙF#NЕЩБЇЙХе!~ЦA8<G#~ю?(ю* ?#Н8O#Н8
W#yOЃ‚O> ѕбС ЇЙ7ЙЕЩБ*НMЩ0yю?(
ю*(:№8xyЇЙ7ЙН+еХ~НF(M#ю.( ю*(ю!84й~#ю.(ю!8&ф>?ьмэ~НF(#ю.(ю*(ю!8йЇСбЙ>?ъф7тХЩС Н!ЩХЩС! л Н%ЩЙЩ!Q н±ЩЙ<>,;:=Н+
ю? :O
#Х>Н‡>.>Н‡Ї!СННЙх
ю? ~жю (#с= лЙЇ2Л2т2уPНД0!ш/:КЛO(
Хt
 н°СНPнC# НMШН:Л·(чНхР!нНfCan't  close dest open source PН7*.:-G Н™Н(2Л:о·Д|ХЂ Сг y·ИA*.Н7Н™Н	АХЂ СсЙЇ2М2ННЎ0:Ь·КUН9- No Dest File >ГхНЫсНі>я2МЩ!)Л~ЛѕЩ()>я2Н:в· :р·В‰Н9- R/O НДШ>НрН(:а· ":в· :р·В‰Н9- Exists НДШ>НреХ:Ш·(U:КЛG(НЯ8IНЄ8Bх:р·(с4Н9- No Update (S с(Н9ource Older) Н9ame Date) Сб7ЙСбНPе*%	"%бНw8
Н#Нw0Ї2рН9- Disk too full! >ГНьРН9- Directory full!
 >	Г|л>Н!лЙН6Н7е!Ђ Н™б>nЕХеНG# н°бСБЙН6Н7>Н!Ш:КЛO ЙХ>6Н)"ЩСЙ:КЛOИ:м·И>7,Нж>%Н6Н7Нж>Нж>>Г!Н7>Н7>еХН)СбЙЭеЕOН Ж=БЭбЙХ_Ж02ѕ> Н!СЙЖЂo& ЙХе>#Н!!! ^#V#N*& :GЛ9ЛЛшDMбСЙЩн[#*%|є }»8нR"%ЩЙ! : ·(G)эл>%Г!_х>Н!сЙ*ЩеD
 н°С!t
 н°!FvеХлН1лН1ЇнRСбА##л,!DН#0ЇЙ!N~еХ_·ДW~o·ДgЇнRСбА#лѕША#шЇЙюx>Р> ЙН7!tН™! Їw>fГ!!НЌгНFгЙН9
 Й~#·ИНOчжХ_>Н!{СЙ>Г!>Г!Н™Нr>.НO~#НOщЙН™НЌ~жю И>.НO~ж#ю ДOхЙ~+NЖ@НOy/ю
8Ц
0ыЖ
OxНOyЖ0НO>:НO##Й:Ю· Н9: Overwrite?  Н[ю(НюYИ7ЙН?ГЂGН9  чЙ'НCиНCd НC
 НC}Ж0НOН9 file *Ф|· }ю(Н9s Н9 copied
 Й нR8щ}ѓo|Љgy· °(> ГO yЖ0ГOН9
 гНFб|µДFН?>я2ОG*И}ґ(xw7ЙНг>яН!¤~#·КъOеНбт
DISK ERROR:  Directory A0: not updated - no files copied!
 *Д|µ(
Э*	Эu~ЭtНИ!ън[ц0 н°Й:·Й:КЛoЙ>9ѕШ~Ц0ЙюaШю{Рж_Й> Їеbkwн°бЙ~#foЙ~жOжю?(№А#пЙ·ИGЛ<ЛъЙ!  "тНДТj!—е!шГг!Ђ Н™Н Н|цЇЙЕеЂ~НЉ#щбБЙЩн[т ЄO!т	~«W$^нSтЩЙ!т л!  yЕ¬g)0>¬g>!­oуБлr$s%# ЯЙЇ2L2yЖA2Ѕ:0‘ =2L
: ‘ =2ГЭеНB ЭбГНW цх(ЛюЭnЭfQ Л:Лн[.с(лЂ н°ЇЭбЙЭеy=(ЭбГ!НB(цНW с=Эw2Тѕ:L·(Э!1Й:·ИЭ!ЙЇн[,ХЭnЭfнRбШ:*Эѕ8цяЙЇЭNЭFнBEЭ^ ЭVЇgo°(эЇMDлЭngнBШEЭnЭf:*W~ж’И#ч±ЙнC,ГнC*ГнC.ГНИ:Т·И:р· Н9(Updating directory)
 Э!1:M·Дя:С·АЭ!Э~яНЎН`ЭnЭfЭеЕе:*O <2**Ч~Л~#"Ч(жНyН!·В‹бБЭбНCПЙ—иц:Н%! З+ н°Э*	Э~юZ eЭ~(2рЭn$Эf%|µ(#"2Эn"Эf#}ґ( "И6 #6Э~жЂ(Эn4Эf5:· !  ЭF,7ЛЛщ"Э~-2Эn~Эf"ДЇЭw~Эw:2К>Н)ю08	Ї2:zю8:(>0Н)(A|·(=юS(юD 5:2КtЛO(>iН!лН1ґ(<$ґ !!КЛЋЛG(>bН!0!КЛ†!лЛю!ЧЛю!р"Ь!0".нsЕ1ЕГЭЭnЭf	~жЂ(Эn?Эf@*  эйен[ нRб8л%"+* "цН
 е "шбъ0 н°Н(*ц#‹{w#zw!‹н[ш н°:P=20НЎ!1ехеН С н°Н
(сбЙсOНЙЭб~Эw#~Эw Н0ЭuЭtНИЭn& Л=Л=,ЭuееяяЭN ЭFЇнB(0щ·бХенB(8СцбЭuСЭnЭfЭuЭtБ*. }жрoЭuЭtеQXЛ:ЛЭuЭt	".Н`бЭеЕеЭ^ЭV:*O <2*Н'}*Чw#"ЧНyН·В‹бБЭбНCНЙ:q=2 хН сеНJЛEб() >НJЛE(: »(НўНЋ{ю8гНЋ>Н): НЎ:0» >я2L2С!0  н°	: !НЅН
(!Ђ Н™: _>.Н)!>ее!Ђ Н[н[!Н1#  Х8W+}ґ(z тСкСнC%ЙЂ :*Э^ ЭV»Шн[,нS,Ї2*ЙН[ЭnЭf",ЭnЭf"ЧЭFЙOНнK,НбБЕеГГЙГ­ГґГ»ГпГ$                                                                                                   ~яНЎН`ЭnЭfЭеЕе:*O <2**Ч~Л~#"Ч(жНyН!·В‹бБЭбНCПЙ—иц:Н%! З+ н°Э*	Э~юZ eЭ~(2рЭn$Эf%|µ(#"2Эn"Эf#}ґ( "И6 #6Э~жЂ(Эn4Эf5:· !  ЭF,7ЛЛщ"Э~-2Эn~Эf"ДЇЭw~Эw:2К>Н)ю08	Ї2:zю8:(>0Н)(A|·(=юS(юD 5:2КГY                                                                             COPYRIGHT 1982, DIGITAL RESEARCH151282    654321 	
                                            {Ц_ѓѓ_Й29:8юя:9Во2к!  "м>	2и2иГ O* 	 НВй29:8юя:9В> 2лy2к>
2и2иГ * 
 НВй29:8юя:9ВM> 2лy2к>2и2иГ *  НВй29:8юя:9В{x2лy2к>2и2иГ *  НВй29:8юя:9ВЎ>2и2иГ *  НВй29:8юя:9ВЗ>2и2иГ *  НВйo& )))))))))ЙН юaШю{Рж_Й_Н Й>Нн>
НнЙХНфС	Г Г Г Г Г Г Г Г Г bНяНЯюК_юКЦЦAюЪQНбГ1ЖA2—ЦA_НКГuН ЖA2—НфЌНГ~НфЌННЯюВЦНфЙ«НяНЯюКЦЦAюЪҐНбГДЖA2иЦA_НКЩНяНЯюВЦНфЙ! "B>я2>!>4:ЂѕКXNНъ>я2@:Ѓ!@4ѕКG!@^ !‚FNЕН)БyђНТл*BDMНXЇ2D:DюЪ,ЗННЯюВЦНфГб<2D:A·К=Н¬Г@Н†·КбГ:ЃНТл*B"BГНЙ1kEНН }ю0Ъu>я28Гz> 28:] ю Кґ\ Н<В•[НяГЦЇ2| ! еDMНX\ Нб·ВД ГњН1Ї2AНВННЉ!A6НВНьНяНЯюYВЦН <ЗМУН1:—ЦA _Н	$р!w#В:—Ц@!рw:и!Ц@wЇ24рН[<МУ л";:;o:<gлН,рН·Вf:?<2?:;o:<gЂ ";Г?ННЉл:иЦ@wлН'Н"z<МУ л";:;o:<gлН,Н•·ДУ:?=2?ю КИ:;o:<gЂ ";Г™Н НН НфГ  -НяЙ         CPM3    SYS                                                                         CP/M 3 COPYSYS - Version 3.0$Source drive name (or return for default) $Source on   then type return $Destination drive name (or return to reboot) $Destination on   then type return $Do you wish to copy CPM3.SYS? $Function complete$ERROR: Invalid drive name (Use A, B, C, or D)$ERROR: No source file on disk.$ERROR: No directory space.$ERROR: Out of data space.$ERROR: Write protected?$ERROR: Possible incompatible disk format.
 Type return to ignore.$ERROR: Close operation failed.$                                                                                       ґ\ Н<В•[НяГЦЇ2| ! еDMНX\ Нб·ВД ГњН1Ї2AНВННЉ!A6НВНьНяНЯюYВЦН <ЗМУН1:—ЦA _Н	$M80
<=BNKBIOS
<=SCB
<=BOOT
<=CHARIO
<=MOVE
<=DRVTBL1
<=DISKIO1
<=HD2
<

LINK BNKBIOS3[B,NR]=BNKBIOS,SCB,BOOT,CHARIO,MOVE,DRVTBL1,DISKIO1,HD2

Gencpm auto
                                                                     CP/M 3 COPYSYS - Version 3.0$Source drive name (or return for default) $Source on   then type return $Destination drive name (or return to reboot) $Destination on   then type return $Do yееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее…ђФSҐ  P ©h  ЖАЂіh P8Н±  аHF’Ђіlh8µ`Ыю„nx*С lы6ЗЂ3lЁ †А„l8~	Д`Ц4 fЩP p$#`?Щ¶4u`ЂLг«Н®`«·eUр8кБЂіk †®яџџВFo џџД&e© ШPJЬ® жwX яєЪ®VmЏ fЩPDJВЇ@ђpi›c@Y а FХЂ3lh
Ь#~Ђ аK6ЖЂјОПцH †P&ЊД Ђ¦Y)Ђ                          AD2Ѓ4D)§#‘јд:ЖI°КdвyАКnКСё¦Y)ѓAB@h(†P&“…!”дr7њ‡BВi6L‚Ўј@r2L‚@љ3Л%0h(HЃ@ P(
Ѓ@ P(
Ѓ@ P(
!”дСXf.	†у	ђКr‚€fуЃддi3љ‚AR ЋG!`Ђ€i3љN†`Ђ¤e9™L'# 
C€аd    Ш l¶[
-‡      Ц"»біЛшЪґ #+ДЇ[pЃХЮ[аѓШКЭ@ 	^ЃИЉ lђ†§9O/б“Jе ’Д7p‡sА[ЖFХ›/…ЂђЙxFV]р‡[¦ф^Ђ+vz Ї@иЅ W 
ф]р+Рz Ї@ ўбt"ф^Ђ+Рz ©ШEиЅ W 
фTЉЋz Ї@иЅ W 
ф^Ђ+Рz Ї@иЅ W 
ф^Ђ+Рz Ї@иЅ W 
ф^Ђ)jЋЗc±Шмv;ЋЗc±Шмv;ЋЗc±Шмv;ЋЗc±Шмv;ЋЗc±Шмv;ЋЗc±Шмv;ЋЗc±Шмv;ЋЗc±Шмv;ЋЗc±Шмv;ЋЗc±Шмv8кч-ШVx	ЉНЎЃLИ†н?ЏмЃЈш@Рџ–мѓЛшВ¶ CVKшА '—р%…dЂЃВm’] ‡0…p@™"¶
_2 lR{6ЭЃ0Xw<	ЦM"0оxК„ЃІGАе AD"!<¦ "”ЉCЎ ђ¦e6LgA!@Кr6‹„’Р°0пfЬр ьaТ 0пfЬр fЬр'™Шц•/ћ“…vЂ’{B—ПHВ»@ЙY”{њ†—МLИaУр0`5ђ;„Дl:”JfС°ЈвХђ^•„b1ЉИДb+$#€Дb1¬En6` fФђ1Uu€m(@8"Н© b«T|ЫРЃіэnКІ c` Э’НЈJсUђ;€Ов«$wќДgvH†б„„ea’Нµ@lЪN·dЯА6Х Xt\UxВА&m& b†sњ„gHЄИ„df(ЄЙ„eaUpВW ћ}IџG”Г•ҐAБV”!›I@Ь.1[Ќ‡| ЕV”!›KЂЬ'Ф™с4yL6Ёр#ЊFгr°и8#ЌК*ґЎЪJбj±\®±UІ‘	ў+њНЈБMUђ9€ОL€ЄЙДg!Б‚yI›П	Ј;6µ‚	ў«pлfУ ўiEtґ„(Ub‚	¤F$
[@‚{“€m8A8upBбрk
ј‚ЗА„±<up¬« ·°м8"’*»бЂ 2ЙfЩ @HкЮ„-ЩV Ь`d‚OВ31Ѕ’Н®@ѓ+vO ¶hEpВ«FHкУ„ЕW!^Н¦аb+†2ёЎ+Њ:µсХБP‘ЖVШ CpВЗvHЄп„AЂ Л$UwВ р e’НЅАЋ±D dіo°!шepBgб•їfЮ`AХ©S® C%›}ЃАХБ@ќЭc«~wdѓ¬ѓвЬ>g>‡Нм:N
І,:h
:»БRx„ fУ0V	еjo<-м‘ХЮ'іi0)хМdЉ¬`@кд„!Mн#%›yЃО`щЭ’{J›ПIГ;%Є %бYЦСdіn0кЪ„-ЩV<|fЮЂ†›fЪQЊfЭ 6mі]А†§Yа†mrX †H†с„„kж с’!їДWЊ!’*µЃ±Uг€ЇC6µ‚¶­ (кс„9Ђ``*
Вє`Ј+’·`1Yµф‚ЙbЅGV¤ ^G<Ё	пEМ`ІY·Ш ѓ¬jјV_0ЁH05…БO#+v:·ЎsГ
‹Ш®Sx :ґбqр$OfТ`R(кФ„.-«ш
НјА„б{>ЎX0Y"«ѕ"јЎ‘•зfЫ@Vm— ¶м›jБYVlUyBlЪ°
:јбр0 ьюrІЄP1еnКІЂЗ‡р5•cAџАЖU‚%њЗцJaШР`УњНј`¬»
ҐД`@kґ+ЖT$ЋdЏџдp#тЃЃмЪtИfЮ`CуХ›V]b«ѕ3jH6ъ“Ю'p0Ц!Ђ!¤‹*мWH|Ђ#П+xЙ[АѓтЭЂ:·av@кс?ЃмЃІ’е[А…»*юѓ@` ЙЭ^2·ЃK6у‰аЖmгeRqр}BwЩґи›j™·ь^2ё!;К4fЯ@RzщҐKЃЖ¬;ТНЅЂМЫ~ГўамЫю:ё!~ѕmU0wт…z@™·ьuB@Цм+ТНµАЊ«ТНё ѓ«j·a] †m›fЭ 6mіaС`QХЮ2ЁXфCp‚Мѓ№\Ubµ4ѕХfХ07J…Ѓ‹Y«M"3iР(ЉД2GVи ew‚*с•ИaЭ qт Ћ='Љ®ш@D u†OКт„о#?(W  ьЎ;іk+6ч”«¤~PњVр B  ®P@щю2ј!«ѕ~sЗЈ+tюІЇ°9шer‚¶l›[БЗАUЯ;ІD   ЉД+ЖWx z2ёA  Ewvl›fБШuј›hЃЩ¶€›IВ,ЫV
ИfЯ`Cрс…MВa°СЭВ 2Y¶¤‡MБЗWx!‡y@ќb+ёГі`Ј«Дю¶«р@кЯ®р@кр„-ЩUш UwВАХК[І«ЂAЬF:№c»6ч­аBШо*Ё O‘U	>‘  ¶0"[-ђ–ЙKe%ІБЩЂ‰lРD¶p"[<- –СKi%ґЎЪp‰m@D¶¤"[T-¬–ЧKl%¶AЫ@‰mЁD¶Ш"[n-ё–ЭKnВ%·ЃЫР‰mрD¶ь"[Ђ-Б–б?еёЎЬ`‰n@D·$"[”-Л–жKs‚%єЭ Ѓр›{‚tX $@            UћaЯЃU zіj Hкб„Ф+–{PЊ®@Љж3kђ(ЉЕ3jШKЕкю4ЁаK6џЃІ©`JЅ›YGА&ml	fХ°–mI W, x@ (шdzВ¦Б.±UЉј_А6J	XА†K¬Uw ( Ґ…­ЁA^OdЉ®`@FбЂЊђ€ *№Ѓ–KХ›vЂЮ#ЧҐіfЦ@‘Њ#s‚АFI–я„Ђ'   ћАЖU‚%њЗцJaШР`УњНј`¬»
ҐД`@kґ+ЖT$ЋdЏџдp#тЃЃмЪtИfЮ`CуХ›V]b«ѕ3jH6ъ“Ю'p0Ц!Ђ!¤‹*мWH|Ђ#П+xЙ[АѓтЭЂ:·av@ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееНU>еН{ГћЫAЛG(ъЙУBНyУ@@НнЈ щЙНЫ@ЛO(&еХЕ!іНН@нxНн@Нн@Нн@БСбЙЇЙЇУAУCеХЕ!ёН!С@НнЈ щН$БСбЙеЕх!ЗНс! G@НнA+}ґ цБбН$ЙеХЕх!МНН$сБСбЙ                      ВgX, НUСБб>ЙНUСБб>Й                     ьЎ;іk+6ч”«¤~PњVр B  ®P@щю2ј!«ѕ~sЗЈ+tюІЇ°9шer‚¶l›[БЗАUЯ;ІD   ЉД+ЖWx z2ёA  Ewvl›fБШuј›hЃЩ¶€›IВ,ЫV
ИfЯ`Cрс…MВa°СЭВ 2Y¶¤‡MБЗWx!‡y@ќb+ёГі`Ј«Дю¶«р@кЯ®р@кр„-ЩUш UwВАХК[І«ЂAЬF:№c»6ч­аBШо*Ё O‘U	>‘  ¶0"[-ђ–ЙKe%ІБЩЂ‰lРееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее               5юяюяюяюяюя            Fюяюяюяюяюя 
яяя Ђ 9
яяя Ђ3„  Pшr
ЃЯпр f з   ћX $@            UћaЯЃU zіj Hкб„Ф+–{PЊ®@Љж3kђ(ЉЕ3jШKЕкю4ЁаK6џЃІ©`JЅ›YGА&ml	fХ°–mI W, x@ (шdzВ¦Б.±UЉј_А6J	XА†K¬Uw ( Ґ…­ЁA^OdЉ®`@FбЂЊђ€ *№Ѓ–KХ›vЂЮ#ЧҐіfЦ@‘Њ#s‚АFI–я„Ђ'   ћАЖU‚%њЗцJaШР`УњНј`¬»
ҐД`@kґ+ЖT$ЋdЏџдp#тЃЃмЪtИfЮ`CуХ›V]b«ѕ3jH6ъ“Ю'p0Ц!Ђ!¤‹*мWH|Ђ#П+xЙ[АѓтЭЂ:·av@ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее1_Г•                                                          CP/M Version 3.0COPYRIGHT 1982, DIGITAL RESEARCH151282    654321   ; Z x — µ Ф у 0NSun$Mon$Tue$Wed$Thu$Fri$Sat$       : : Enter today's date (MM/DD/YY): $ Enter the time (HH:MM:SS):     $ Press any key to set time $ я      Strike key to set time$ я      ERROR:  Requires CP/M3.$ERROR: Illegal time/date specification.$1_1_Н“"Ф*Ф}!Ц–џ/*Фх|!Ч–ЖяџБHЎТsИ1Н "ЖК1Н X "И:] юCВ:] юCВЕНШDM¬НC
ю ВыНн	НХТНњo& "Л!] 6 ГЭГm:] ю В$Нн	Гm:] юSВ"НзМНµ.fм
-В=dНЕ> !eѕТ–.±f
-В\!«"{ *{	"}!6 *}~2€Н.е*Ил¬б
-ВЋНзнНµ.f
-В§dНЕ> !eѕТ.±f
-ВЖ!«"{ *{	"}!6 *}~2€НДНзНµНњo& "Л.е*И##л®б
-В)2Н НзГm.±Ѓ 
-В*!«6«НЂ	Нз2НµНњo& "Л.е*Ил¬б
-ВZI2Н НзНЮГ‚НзRНµНзНЮ1_НзjНµНЮыv  Н Й  Н Й!_q*_& лН Й!ap+q*`л	Н Й!cp+q*bл
Н Й  Н Й   Н ЙНҐ
НҐЙ!Ђq:<2O *}	:ЂwЙ!‚p+q*Ѓ~ю$К7*Ѓ:<2O е*}	Б
w*Ѓ#"ЃГЙ!ѓq:ѓЖ0OНтЙ!„q:„жшOН8:„жOН8Й!…q*…MНF:НтЙ!†q*†& л!
 Нљ
KН8*†& л!
 Нљ
MН8Й!‡q*‡MНr/НтЙ:€ю В±Й:юВї!€6 Й:<2O *}	~2€Й:€ю ВаНЁГТЙ:€Ц0Ц
џЙ!Љs+q!‹6 НТНбЪГ‚НбТG:‹жаю КГ‚:‹‡‡‡х:‹‡БHЃ2‹џТ/Г‚:€Ц0!‹†wџТAГ‚НЁГ!‰:‹–џ#х~!‹–џБH±ТaГ‚:‹Й!Ћs+q+СБqХНТ!Њ:€ѕКЂГ‚НЁ*ЌM*ЋлНкЙ!ђs+q:Џжю2‘:ЏжЦ Цџ*ђ& Њ)	лх>;Нд
џБHЎТЗ:‘=Й:‘Й*’л!
 Нљ
л!”s*’лНњ
л"’:”Й!•q*•& л!
 Нљ
л))))е*•& лНњ
Б	}ЙНк=2–:–ЦЦџ2ќТ.!њ6Г;*–& Ђ	~2њ/Е*њлНe2—/ЕcNНe2:—ЦЦџ!ќ¦х:жЦ ЖяџБHЎТxГ‚*–& Њ)	:ЦN_ е!mН№
СН’
е*—& Б	е NНЏСНН
е*M*–лНЏ_ бе*{#Бq#pЙ НкOНй *{	w:Е; НeOНй *{	w*{~юВ:€ю:В:Е; Нe2К *{	6 Г-:Е; НeOНй *{	wЙ!џs+q:ћ‡‡‡‡!џ¶Й!6N!m" :жю В[!n"  ’НЧ
ЪhЙ ’НЧ
л+s#r!4ГEЙ!–6> !–ѕТ»:–=2–юТќ!Ј6 *–& Њ)	:ЈНЋ
л!’Нт
ТёЙГѓЙ *{	~2™*{	~2љ*{	~2›*{#^#Vл"’+л! Нљ
л!ўsН@!Ј6 :жЦ Цџх>;!’Нп
џБHЎТ	!Ј6Н~*–& Њ)	:ЈНЋ
’Нз
л!—s+4Й:ў‡‡O !¤	DMН	 Нт*–MН—*—MН—*MНr Нт*™MНa*љMНa*›MНFЙ!Ёp+q!  "©*§"{ 	"}*{~ю В°	Нј!6яН:	Гм	*{~ЦЦџх~ЦЦџБH±Тй	!6 *}~2€ННД*& л*}"©Гм	Г‚Й!«6 А2Н .е*ИDM¬б
-В
«НЂ	НҐ!К6 >!КѕЪB
*К&  	«	NНҐ:К<2КВ
Й!Сr+s+p+q+СБqХ!Т6 :Н=!ТѕЪЉ
*Т& л*Ое*Т& л*РБ
ѕКЂ
> Й:Т<2ТВW
>яЙл_ л…oЊgЙDM!  >х)л—)лЌ‘o|gТі
	с=ВЎ
ЙDM!  >)л)лТИ
	=ВА
ЙO {‘ozgЙi`N#F‘ogЙo& •oњgЙ_ {–_z#ћWлЙ                                                                                                                                                                                                                          0А2Н *ИЙЕ; Нe2К *{	6 Г-:Е; НeOНй *{	wЙ!џs+q:ћ‡‡‡‡!џ¶Й!6N!m" :жю В[!n"  ’НЧ
ЪhЙ ’НЧ
л+s#r!4ГEЙ!–6> !–ѕТ»:–=2–юТќ!Ј6 *–& Њ)	:ЈНЋ
л!’Нт
ТёЙГѓЙ *{	~2™*{	~2љ*{	~2›*{#^#Vл"’+л! Нљ
л!ўsН@!Ј6 :жЦ ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее1х6ГO                                                          CP/M Version 3.0COPYRIGHT 1982, DIGITAL RESEARCH151282    654321ERROR: Illegal Option or Modifier.
$File Spec Limit is $ERROR: Illegal Global/Local Drive Spec Mixing.
$Requires CP/M 3
$ERROR: Options not grouped together.
$ERROR: Illegal command tail.
$No File
$1х61х6Н|2ц7Н}2ч7:ч7Ц0џх:ц7ЦЦџБH±Т‚кНв0НuГ…НlН92•8°8Н°8Н,НT28!є86 яяІ8Н—6µКс:¶8жю КХ:є8ю ВЙНЫГТьНв0НuГо:¶8ж@ю КеНI
Го#Нв0НuГ¤Н9Н‰!Љ8НЋ2•8юяК*•8MН)*†8"Ѕ8!  "€8†8НЋ2”8!„86 > †8Нџ6µЖяџх:Њ8Ц ЖяџБHЎТЊ!\ 6?\ Нў2Б8!  "ї8:Б8юяКn*ї8#"ї8НІ2Б8ГV*ї8DMНх!е*ї8)Б	л! Н­6ТЊ!„86я!…86я!яя"€8:”8юяКщ*”8лї8Н*€8ї8Н6> Н~6µКн:Њ8Ц Жяџх:„8/!…8¶БHЎТкНЋ !…86 !96 :“8ТкНЊ$Нe.†8НЋ2”8Г—*Ѕ8"†8Гч:o9/х:Џ8/БHЎТBНв0Нuыv  Н o& Й!–8q*–8& лН Й  Н Й  Н Йя  Н Й!—8q:—828!™86 81Н Й mН Й   Н Й!њ8q:њ8Ц0џ/х>9!њ8–џ/БHЎЙ!Ў8r+s+q+СБp+qХ* 8> w#6 ! "ў8}2¤8:џ8!¤8ѕЪ!¤8:џ8–O *ќ8	NН~ЪЫ> Й* 8е!¤8:џ8–O *ќ8	~Ц0_ *ў8НC6СН6л+s#r!ў8Н86л+s#r#4Вё>яЙ!§8s+p+q:§8ю В5*Ґ8>НX6л+s#rГL*Ґ8е*§8M! Нh6СН\6л+s#rЙ!©8p+q!Є86 :Є8Цџ !Ё8хН6> Н~6µЦџБHЎТЉ!Ё8Нn6л+s#r#4ГX:Є8Й!¬8p+q*«8N#FНM2­8O>№ТЄ>яЙ! "®8> !­8ѕТИ*­8M!®8Нd6л+s#r*«8®8еНё6лбs#r:­8ЙяяІ8Н—6µЖяџх:¶8жЦ ЖяџБHЎТ9
:№8юК**ґ8#~юAВ!’86яГ!*ґ8#~ЦDЦџ*ґ8##х~ЦIЦџБHЎТ9!ш76яГ!*ґ8#~ЦDЦџ*ґ8##х~ЦAЦџБHЎТc!Њ86!‘86яГ!*ґ8#~юEВu!я76яГ!*ґ8#~юFВ«*ґ8##~юFВ’!ђ86яГЁ*ґ8##~юUВҐ!Њ86ГЁГ?
Г!*ґ8#~юGВ:·8юТЛ*ґ8##~Ц02»8Го*ґ8##~Ц0o& Н<6 е*ґ8	~Ц0_ бл!»8s:»8Ц џ/х>!»8–џ/БHЎТ*»8л†8НГГ?
Г!*ґ8#~юMВ*!Џ86яГ!*ґ8#~юNВy *ґ8	~юXВI!ю76яГv *ґ8	~юPВ^!86яГv *ґ8	~юSВs!“86 ГvГ?
Г!*ґ8#~ЦRЦџ*ґ8##х~ЦOЦџБHЎТћ!ъ76яГ!*ґ8#~ЦRЦџ*ґ8##х~ЦWЦџБHЎТГ!ы76яГ!*ґ8#~юSВ*ґ8##~юYВа!щ76яГ	*ґ8##~юIВу!Њ86Г	*ґ8##~юOВ!“86яГ	Г?
Г!*ґ8#~юXВ!э76яГ!Г?
°8НГ6
*ґ8#~юLВz°8Н:¶8ж ю Кt*ґ8#е*·8MЌ8Н–Тn>Ќ8Нџ6ТeГ?
°8НГqГ?
ГwГ?
Г6
*ґ8#~юUВp	°8Н:¶8жЦ Цџх:ч7Ц џБH±ТҐГ?
:¶8жЦ ЖяџяяІ8хН—6µЖяџБHЎТm	*ґ8#~ЦAЦџ*ґ8##х~ЦLЦџБHЎТк!яя"†8Гd	:¶8ж Ц Жяџх:·8ЦџБHЎТa	:·8юВ	*ґ8#~Ц02»8Г7	*ґ8#~Ц0o& Н<6е*ґ8##~Ц0_ бл!»8s:»8Ц џ/х>!»8–џ/БHЎТ[	*»8л†8НГ^	Г?
Гd	Г?
°8НГҐГ6
*ґ8#~ЦDЦџ*ґ8##х~ЦRЦџх~ЦIЦџБH±БHЎТ3
°8Н:¶8жю ВЄ	Г?
:¶8жЦ ЖяџяяІ8хН—6µЖяџБHЎТ0
*ґ8#~ЦAЦџ*ґ8##х~ЦLЦџБHЎТэ	!яя"Љ8НBЉ8Н6л+s#rГ'
*ґ8#~ЦAџ/х>P–џ/БHЎТ$
*ґ8#~ЦA_Љ8НГ'
Г?
°8НГЄ	Г6
Г?
ГЫ!є86яЙЂНв0НuЙ: 8ю
Т.е*ґ8# е* 8& НC68	 	лБб
-Вo
 * 8& НC68	 	~Ц Цџ * 8& хНC68		 	~Ц ЦџБHЎТЙ
 * 8& НC68	 	6яГЮ
 * 8& НC68	 	6 *ґ8~ю Вы
 * 8& НC68	6яГ*ґ8~= * 8& хНC68	БHq: 8<2 8Г2ҐНв0
 Еяd Н[1Нш0°8НЙ:щ7!ш7¶/ТM!ш76я#6я:ы7!ъ7¶/Тa!ы76я+6я:ю7!э7¶Т|:Њ8ю Вy!Њ86Г„!ю76я+6я: 8ю В· * 8& НC68	 	6я * 8& НC68	6я! 86> Љ8Нџ6µВ!Б86 : 8=!Б8ѕЪ *Б8& НC68	~юяВы *Б8& НC68	:•8w *Б8& НC68	^Љ8Н:Б8<2Б8ВИГt!Б86 : 8=!Б8ѕЪt *Б8& НC68	~ЦяЖяџ *Б8& хНC68	:•8–ЖяџБHЎТj№Нв0Нu:Б8<2Б8В#> †8Нџ6µВЉНK_†8Н>0!ч7ѕТД:ђ8/ТДяяЌ8Н—6µВДНTo& "Ќ8>Ќ8Нџ6ТД! "Ќ8Й
state8, char = $
state7, char = $
state6, char = $
state5, nxtchar = $
state4, char = $
state3, char = $
state2, char = $
state1, char = $
startstate, char = $!Ж8p+q!З86 *З8& л*Е8~Ц Цџх~Ц	ЦџБH±Тћ!З84Гy:З8Й!И8q:И8Ц[Цџх:И8Ц]ЦџБH±х:И8Ц(ЦџБH±х:И8Ц)ЦџБH±х:И8Ц=ЦџБH±х:И8Ц,ЦџБH±х:И8Ц ЦџБH±Тэ>яЙ> Й!К8p+q!П86 *Й8#DMНn2О8O> №ТG*Й8~!О8–<oе*О8&  	л*Й8е*Й8#лБб
-В?!Н86*Н8& л*Й8~ю К*Н8& л*Й8DMНn2О8Ц Цџ*Н8& л*Й8х~Ц ЖяџБHЎх:П8/БHЎТѕ*Н8& л*Й8~ю"Вґ!П86я*Н8& л*Й86\:Н8<2Н8Г\*Н8& л*Й8~Ц Жяџ!П8¦ТG*Н8& л*Й8~ю"В=*Н8&  	л*Й8~ю"В,*Й8~!Н8–<oе*Н8&  	л*Й8е*Н8& л*Й8лБб
-В!Г=*Н8& л*Й86\!П86 :Н8<2Н8Гѕ*Н8& л*Й8DMНn2О8O> №Т*Н8& л*Й86 *Н8&  	л*Й8"Л8>!Н8ѕТ¶:Н8=O *Й8	NНўх:О8!Н8†O *Й8	NНўБH±Т¶*Л8+"Л8*Й8~<х:О8!Н8†=Oс‘o:О8е!Н8†O *Й8	DM*Л8лб
-ВЮ*Н8& л*Й8~ю"Вы!П86я:Н8<2Н8ГL:Н8=O *Й8	~ю В#:Н8=O *Й8	6 Й!С8p+q!Т86 *Т8& л*Р8~ю К‡*Т8& л*Р8~Цaџ/*Т8& л*Р8х>z–џ/БHЎТ}*Т8& л*Р8~Ц *Т8& л*Р8w:Т8<2Т8Г/Й!Ю8q:Ю8Ц0џ/х>9!Ю8–џ/БHЎЙ!Я8q:Я8ЦAџ/х>Z!Я8–џ/БHЎЙ:Ч8<2Ч8O *Х8	~2Ы8*Ч8&  	л*Х8~2Ь8Й!а8q *У8	яяН­6µК:Ъ8<2Ъ8O *Ш8	:а8wЙ!б8q!Э86 *Ы8MН /х:Ы8Ц$ЖяџБHЎТ*:Э8Й*Ы8MН х*Ы8MН€БH±х:Ы8Ц_ЦџБH±х:Ы8Ц$ЦџБH±х:б8!Э8–џ/БHЎТy*Ы8MНЭНё:Э8<2Э8Г**Ы8MН х*Ы8MН€БH±х:Ы8Ц_ЦџБH±х:Ы8Ц$ЦџБH±ТґНё:Э8<2Э8Гy *У8	6*У8	:Э8w:Э8Й!в8q*в8MН х*в8MН€БH±х:в8Ц*ЦџБH±х:в8Ц?ЦџБH±х:в8Ц_ЦџБH±х:в8Ц$ЦџБH±Й!г8q:Ъ8!г8†w*Ы8MНК!г8х:Ъ8–џБHЎТІ:Ы8ю*ВҐ:Ъ82е8*Ч8& "ж8Нё*Ы8MНКТe:е8<2е8НёГM!г8:е8ѕЪz*ж8л!Ч8s> Й!д86!е8:г8–+ѕЪљ?НЭ:д8<2д8В*ж8л!Ч8sГ¬*Ы8MНЭНёГ>яЙ!и86>!и8ѕЪЩ*и8& л*Ш86 :и8<2и8Вє:Ь8ю:В:Ы8ЦAџ/х>P!Ы8–џ/БHЎТ:Ы8ЦA<OНЭНёНёГ> ЙГ НЭ*Ы8MН х:Ы8Ц$ЦџБH±х:Ы8Ц_ЦџБH±х:Ы8Ц*ЦџБH±х:Ы8Ц?ЦџБH±/Т^*Ш8~ю В^> ЙН/Тk> Й:Ы8ю.В“Нё*Ы8MНКТ“!Ъ86Н/Т“> Й *У8	6*У8	6@>яЙ!й8q*Ы8MН€/Т№> Й*Ы8MН€ *У8	х:й8–џ/БHЎх:Ы8Ц ЖяџБHЎТь*Ы8MНЭНё *У8	~<*У8	wГ№:Ы8ЦHЦџх:Ы8ЦDЦџБH±х:Ы8ЦBЦџБH±ТM *У8	~!й8ѕТJ*Ы8MНЭНё *У8	~<*У8	wГM> Й *У8	6 >яЙ!к8q:Ы8ю\Кh> ЙНё:Ы8Ц\Жяџх:Ы8Ц ЖяџБHЎ *У8	х~ЦџБHЎТ­*Ы8MНЭНё *У8	~<*У8	wГk:Ы8Ц\Жяџх:Ы8Ц ЖяџБHЎТЛНёГ­:Ы8ю\КЦ> Й *У8	6Нё>яЙ:Ч82л8НµТх>яЙ:л8=2Ч8Нё!Ъ86я НЭНю В*НY/Т*Н¦/Т*> Й>яЙ:Ы8Ц,Цџх:Ы8Ц)ЦџБH±х:Ы8Ц ЦџБH±Т] *У8	6>яЙНеТv *У8	>¶*У8	w>яЙ> Й НЭНO> №Т° *У8	>¶*У8	w*У8	>ѕТ­ *У8	6>яЙ> Й:Ы8Ц,Цџх:Ы8Ц)ЦџБH±х:Ы8Ц ЦџБH±Тг *У8	6>яЙНеТь *У8	>¶*У8	w>яЙ> Й:м8Т*У8яq#p>яЙ *У8	6 *У8##яяq#p>яЙ:Г8Т?Е	Н *Ы8MНТ0:Ы8ю ВKНяЙ:Ы8ю]В‘Нё:Ы8Ц,Цџх:Ь8Ц(ЦџБH±х:Ь8Ц)ЦџБH±Т~Н›Й:Ы8ю ВЉНяЙН/ЙГ°:Ы8Ц Цџх:Ы8Ц,ЦџБH±Т°НёНCЙНCЙ:Г8ТКЧ	Н *Ы8MНТ0:Ы8ю ВЦНяЙ:Ы8Ц Цџх:Ы8Ц,ЦџБH±ТшНёН
ЙГ:Ы8ю)ВНёН)Й> Й:Г8Т й	Н *Ы8MНТ0:м8Т<*У8
q#p	 *У8	6>яЙН-2м8ТJНґЙ> Й:Г8Тcы	Н *Ь8MНТ0:Ы8ю(ВrНёН
Й:м8ТЋ*У8Mq#p	 *У8	6>яЙН-2м8ТњН)Й> Й;:Г8Т¶	Н *Ы8MНТ0:Ы8ю ВГНя3Й:Ы8!  9wНё!  9~Ц,Цџх~Ц ЦџБH±ТлНC3Й!  9~ю]В0:Ы8Ц(Цџх:Ы8Ц,ЦџБH±х:Ы8Ц)ЦџБH±ТН›3Й:Ы8ю В+Ня3ЙН/3Й!  9~ю=В?НM3Й> 3Й:Г8ТY"	Н *Ы8MНТ0:м8Тu*У8Cq#p	 *У8	6>яЙ *У8	:н8wO>Ђ№ТЉ> ЙНy2м8ТНџЙ> Й:Г8Т±4	Н *Ы8MНТ0:Ы8Ц)Цџх:Ы8Ц ЦџБH±Тв:Ы8ю ВХНяЙНё:н8=2н8Г±:Ы8ю[ВсНёНCЙ:Ы8Ц Цџх:Ы8Ц,ЦџБH±х:Ы8Ц(ЦџБH±Т+:Ы8ю(В$:н8<2н8НёН/ЙН/Й:Г8ТEF	Н *Ы8MНТ0:м8Тa	 *У8	6*У8/q#p>яЙ:Ы8ю(Вv:н8<2н8НёГa *У8	:н8wO>Ђ№Т‹> ЙНі2м8Т™Н›Й> Й:Ы8ю@В»!Г86яНёX	Н *Ы8MНТ0:Ы8ю ВЗНяЙ:Ы8ю)ВТ> Й:Ы8ю(Ви:н8<2н8НёН/Й:Ы8ю[ВчНёНCЙНі2м8ТН›Й> Й!п8p+q*о8"У8*У8##^#Vл"Х8 *У8	^#Vл"Ш8!Ч86я!Ъ86яНё!м86 	 *У8	6  *У8	6 *У8	~юЂВ^Й*У8њН­6µВtНњ2р8Гз*У8/Н­6µВЉН/2р8Гз*У8CН­6µВ НC2р8Гз*У8MН­6µВ¶НM2р8Гз*У8
Н­6µВМН
2р8Гз*У8яН­6µВвНя2р8Гз!р86 :р8/Тш *У8	6Ђ*У8##яяН­6µК*У8##:Ч8Н 6е*У8##Бq#pЙ!т8p+q*с8"У8*У8##N#FН *У8##N#F*У8##q#pН$*У8њq#pЙ
Scanning Directory...
$Out of Memory
$Not Enough Memory
$  Н Й  Н Й!щ8p+q*ш8лН Й  Н ЙН™ТЛНђ2ъ8НuЙ!9r+s+p+q+СБqХ!96 :9=!9ѕЪ$*9& л*	9>¦*9& л*9х>¦БH‘Жяџх~Ц?ЖяџБHЎТ> Й!94Ва>яЙ*ы8>¦29!”8ѕКf:„8ЪA> Й!  "9*9л9Н*†89Н6> Н~6µВf> Й> †8Нџ6µЖяџх:9Ц ЖяџБHЎх:…8Ц ЖяџБHЎТ*9л€8Н!96 : 8=!9ѕЪ *9& НC68	~ЦяЦџх:•8–ЦџБH±Т *9& НC68	 	~юяВк:я7/ЙЕ*ы8# е*9& НC68	 	лБНМТ:я7/Й!94Вќ:я7Й!96 !96>!9ѕЪJ*9& л*ы8>¦!9†w!94В(:”8!9†wжwO !ь9		"9O !ь9		^#Vл"я8!96 > я8Нџ6µЖяџх:9/БHЎТФ*я8е*ы8>¦б–ЦџхЕ*я8#е*ы8#лБНМБHЎТј!96яГС *я8	"9*я8	^#Vл"я8Гt> я8Нџ6µВг> Й>яЙЙ*ы8~ю!КЎН/ТЎ*х8#DMНх!"99Нў6Т> Йэ89Н’6Т> Й *9"9"я8*х8#"х8.е*ы8#е*я8#лБб
-ВB*ы8>¦*я8w *я8	> w#6  *я8	w#6  *я8	w#6  *я8	w *я8	w#6  *я8	w#6 *9е*я8лбs#r:9Т#*ы8>¦ю В *ы8~ю!К  *ы8	еН;2бѕЪ *9	 9еН—6лбНЃ6Тк> Й	 9Н—6л+s#r.	е*9л*9DMб
-В *я8	е*9лбs#rН7Г4*ы8>¦ю К1Г4Н7>яЙ.е*ы8#е*я8#лБб
-ВF *я8	е*ы8	~б¦*я8	w!96 !96НK2>яН~6Т~!96!96>!9ѕЪеГќ:9!9†wТѓГе*9& л*ы8n& "9:9юВП*9&  	л*ы8~9НW6л+s#r> 9Нџ6µКв:9<29ГЏ> !9ѕТЌ  *я8	еН;2<_ *9& НC6 е*ы8	>Ђ–хН;2БHЎСН€6лБН<0 *я8	е*°9& л*9& НC6СН6 е*ы8	>Ђ–хН;2БHЎжьСН€6 е*я8	Бq#p *я8	е*°9& л*9& НC6СН6 е*я8	Бq#pЙRНв0 э8Н—6"9!96 >!9ѕЪИ *9& ь9)	> w#6 :9<29ВҐ * "9Нy2!ч86 !  "х8"у8!\ 6?\ Нў29!а "9*9~ю!В!!96яГ	!!96 :9юяК€!:9ж‡‡‡‡‡o& Ђ "ы8:9Т?!*9& Н<6a 	Ђ "9*ы8~юеК|!*у8#"у8*ы8~ю Вf! *ы8	~2ч8Г|!Н'Т|!Нз/Т|!lНв0ЙН»НІ29Г	!Й!ь:"э8 ;Н—6Т¤!|Нв0НuЙ

Sort Stack Overflow
$Not Enough Memory for Sort
$
Sorting  Directory...
$! 9p+q*9))))е*9))Б	е*9)Б	е*9Б	е*э8Б	Й!$9r+s+p+q!%96>!%9ѕЪm"*%9& л*!9>¦2&9*%9& л*#9х>¦2'9БH№Кf"!'9:&9–џЙ!%94В-"> Й!-9r+s+p+q!l96 **9"49*,9"69:l9юТu$*l9& ))49е	^#Vл"*9б	 	^#Vл",9!l95,9*9Н’6Тr$**9".9*,9"09*,9л**9Нr6)л*(9N#FНх!"909.9Н’6ЪШ#*.9)л*(9N#FНх!"я8*я8DM*9лН"Т5#*.9#".9*.9)л*(9N#FНх!"я8Г	#*09)л*(9N#FНх!"я8*9DM*я8лН"Тs#*09+"09*09)л*(9N#FНх!"я8ГG#09.9Н’6ЪХ#*.9)л*(9^#Vл"29*09)л*(9е*.9)л*(9гN#Fбq#p*09)л*(9е*29лбs#r*.9#".9> !09НЄ6ТХ#*09+"09Гл"*909Н’6.9,9еН’6СНЃ6Т2$,9.9Н’6Т)$!l94n& ))49	е*.9лбs#r*l9& ))	 	е*,9лбs#r*09",9Гo$09*9Н’6Тi$!l94n& ))49	е**9лбs#r*l9& ))	 	е*09лбs#r*.9"*9Г·"Г‹":l9юяК†$Ґ!Нв0Г‹$!96яЙ *9"(9>х8Нџ6Тў$Й(99Н’6Нr6л!х8Н­6ТБ$ѕ!Нв0Й!  "m9*х8+л!m9Н­6Ъф$*m9)л*(9е*m9лбs#r *m9"m9ТЗ$Ы!Нв0*х8+л  Нp"!96яЙ    Name     Bytes   Recs   Attributes $------------ ------ ------ ------------$  Prot      Update    $ ------ --------------  --------------$      Access    $      Create    $
Press RETURN to Continue $Sys$Dir$RO$RW$Arcv $     $Read  $Write $Delete$None  $              $Directory For Drive $  User $: $k$ERROR: Illegal Format Value.
$ERROR: Date and Time Stamping Inactive.
$Total Bytes     = $  Total Records = $  Files Found = $
Total 1k Blocks = $   Used/Max Dir Entries For Drive $No File
$я Н ЙН '2v9:v9ю В 'Н '2v9Г':v9юВ+'НuЙ:8ю ВW'*Ќ8+л:w9Н€6ТW'»%Нв0*‚9#"‚9Н	'!w96 Нш0!w94Й *я8	^#Vx9Н<0 *я8	л{9Нo0 *я8	^#V~9Н<0Й*я8#DMН1Нт0 *я8	N#FЕя'Н[1kНТ0Нт0 *я8	DM НН1Нт0
 *я8	~ТЭ'Ч%Нв0Гг'Ы%Нв0Нт0	 *я8	~Ть'Я%Нв0Г(в%Нв0Нт0:’8Ъ+( *я8	~Т"(е%Нв0Г((л%Нв0Гћ( *я8	~Т@(AНТ0ГC(Нт0*я8#~ТU(1НТ0ГX(Нт0*я8##~Тk(2НТ0Гn(Нт0 *я8	~Тѓ(3НТ0Г†(Нт0 *я8	~Т›(4НТ0Гћ(Нт0Й *я8	> НЄ6µКl)Нт0 *я8	^#Vл"9 	>Ђ¦ю КХ(с%Нв0Г) *9	>@¦ю Кн(ш%Нв0Г) *9	> ¦ю К)я%Нв0Г)&Нв0Нт0 *9	~Ц Жяџ*9	х~Ц ЖяџБH±Т=) *9	DMНЈ5ГC)&Нв0Нт0Нт0*9~Ц Жяџ*9#х~Ц ЖяџБH±Тl)*9DMНЈ5Й:ђ8Т|)НТ0Г†):„9Ъ†)Н,'&Нв0:•8ЖAOНТ0:НТ0:ч7ю Ъ¶)1&Нв0*”8& ея
 Н[1Н,'! "‚9!„96 Й!†9p+q*p9л*Ѓ9& Н6> Н~6µВ'**‚9л*Ќ8Н6> Н~6µЦџ!t9хН­6µЦџБHЎТ*Н,'Нm)Н,'Г*Н,'*‚9#"‚9:•8ЖAOНТ0Г**Нт09&Нв0*…9DMН1Н»*p9#"p9*t9#"t9Й!‰9s+q+СБqХ:‡9жЂЦЂЖяџ!€9¦Тj*>яЙ:‡9жЂЦЂЦџ!‰9¦Т*>яЙ> Й!‹9p+q *Љ9	NЕ*ы7M*ъ7лНJ*х	 *Љ9	NЕ*ш7M*щ7лНJ*БHЎЙ!\ 6?!Ѓ96\ Нў2Њ9:Њ9юяК5+:Њ9ж‡‡‡‡‡o& Ђ "ы8>р¦Ц Цџ *ы8	х~Ц ЦџБHЎхеН;2б–џ/БHЎТ,+Н'Т,+*ы8#DMН‚*Т,+*ы8#DMНЕ)НІ2Њ9ГИ*Й!‘96 :9Т¬+*Џ9#"Џ9*Џ9)л*(9N#FНх!"я8*я8:”8–Жяџх8Џ9хН’6µЖяџБHЎТ–+*Џ9#"Џ9*Џ9)л*(9N#FНх!"я8Г[+х8Џ9Н’6µВ©+*Ќ9"я8Гв+ *я8"я8*я8:”8–ЖяџЌ9я8хН’6µЖяџБHЎТв+ *я8"я8Г¶+Й:Њ8жю Кх+!Ѓ96Гъ+!Ѓ96Ќ9я8Н’6µКi, *я8	> НЄ6µЖяџ!э7¦х> Нџ6µЦџ!ю7¦БH±х*я8#DMН‚*БHЎТc,Н_'*я8#DMНЕ) *я8	N#FЕя'Н[1<&Нв0Н6+Гъ+Й!Ѓ96!  "t9Ќ9я8Н’6µКq- *я8	> НЄ6µЖяџ!э7¦х> Нџ6µЦџ!ю7¦БH±х*я8#DMН‚*БHЎТk-*p9л*Ѓ9& Н6> Н~6µВX-*‚9л*Ќ8Н6> Н~6µВK-:8Ц Цџх> t9Нџ6µЦџБH±Т>-Н,'Нm)Н,'%Нв0Нт0%Нв0Н,'3%Нв0Нт03%Нв0Н,' *‚9"‚9*t9#"t9ГH-Н,'*‚9#"‚9ГU-Н,'*‚9#"‚9Г[-Нт0НЋ'*p9#"p9Н_'Н»Н6+Гu,Й!Ѓ96!  "t9Ќ9я8Н’6µКd. *я8	> НЄ6µЖяџ!э7¦х> Нџ6µЦџ!ю7¦БH±х*я8#DMН‚*БHЎТ^.*‚9л*Ќ8Н6> Н~6µВA.:8Ц Цџх> t9Нџ6µЦџБH±ТA.Н,'Нm)Н,'%Нв0[%Нв0:ч8ж@ю К.™%Нв0Г.Є%Нв0Н,'3%Нв0r%Нв0Н,' *‚9"‚9*t9#"t9Н,'*‚9#"‚9НЋ'Нџ(*p9#"p9Н»Н_'Н6+Г}-Й!  "‚9"p9"x9}2z9o& "{92}9o& "~92Ђ9 э8Н—6"я8*9	"Ќ9!яя"Џ9Н6+>!Њ8ѕТµ.>&Нв0Нu*Њ8M !D/		^#VлйНµ*ГJ/Нг+ГJ/:‘8Т&/:ч8жЦ Жяџх:ч8ж@Ц Жяџх:ч8ж Ц ЖяџБH±х:ч8жЦ ЖяџБH±БHЎ!9¦Т/Нr-Г#/]&Нв0НuГA/:ч8жЦ Жяџ!9¦Т>/Нr-ГA/Нj,ГJ/Е.Л.С.:Њ8Ц Жяџх> !p9НЄ6џБHЎТ0 *‚9Ќ8Нў6џ!ђ8¦Т†/НТ0НТ0ГЊ/Н,'Н,'‡&Нв0 x9НН1kНТ0љ&Нв0
 {9НН1­&Нв0*p9еяиН[1ѕ&Нв0 ~9НН1У&Нв0:•8ЖAOНТ0:НТ0Нт0*у8еяиН[1/НТ0НK2#еяиН[1> p9Нџ6µВ,0:Џ8Т&0Н,'Нm)ц&Нв0Н»Г;0!o96я:ђ8Ъ;0Н,'Й!•9r+s+p+q*’9^#Vл"–9*’9”9еНф5лбs#r!–9Н­6Тn0*’9##4Й!›9r+s+p+q*љ9^#V*9DMН<0*љ9##е*9##~Бе`i†бwЙ!ќ9p+q*њ9##~жа2ћ9*њ9##~жьw*њ9Нn6л+s#r*њ9#:ћ9¶wЙ!џ9q*џ9& лН Й!Ў9p+q* 9л	Н Й НТ0ЙНТ0
НТ0Й!Ј9p+q!¤96 >!¤9ѕЪ/1*¤9& л*ў9>¦OНТ0!¤94В1 НТ0!¤96>
!¤9ѕЪZ1*¤9& л*ў9>¦OНТ0!¤94В91Й!©9s+p+q+СБp+qХ> §9Нџ6µКМ1*Ґ9л*§9Н6!Є9s*Ґ9лН6"Ґ9PY!
 Н6л"§9> Н~6µЖяџ!©9¦#х~“ЦџБHЎТ»1Нт0ГЙ1!©96 :Є9Ж0OНТ0Гj1Й!®9r+s+p+q*«9##~ю К2*«9##N Е*­9DMяН[1*«9N#FЕ 'Н[1Г:2!Ї96­9:Ї9Нџ6Ъ+2Нт0*Ї9& Н<6л!Ї9sГ2*«9N#FЕя'Н[1Й!ґ9q*ґ9& л*І9~Й!µ9q*µ9& л*І9е*µ9&  	л*І9N `iНh6гn& СЙ  Н "І9Н;2<жьo& "°9Й   ; Z x — µ Ф у 0NSun$Mon$Tue$Wed$Thu$Fri$Sat$!»9q:є9<2є9O *ё9	:»9wЙ!Ѕ9p+q*ј9~ю$К3*ј9:є9<2є9O е*ё9	Б
w*ј9#"ј9Гз2Й!ѕ9q:ѕ9Ж0OНК2Й!ї9q:ї9жшOН3:ї9жOН3Й!А9q*А9MН3:НК2Й!Б9q*Б9& л!
 Н6KН3*Б9& л!
 Н6MН3Й!В9q*В9MНJ3/НК2Й!Д9s+q:Г9жю2Е9:Г9жЦ Цџ*Д9& –2)	лх>;Нџ6џБHЎТё3:Е9=Й:Е9Й*Ж9л!
 Н6л!И9s*Ж9лН6л"Ж9:И9Й!Й9q*Й9& л!
 Н6л))))е*Й9& лН6Б	}Й!С9s+q:Р9‡‡‡‡!С9¶Й!М96N!m"Т9:М9жю В*4!n"Т9Т9Ж9Н’6Ъ74ЙТ9Ж9Н’6л+s#r!М94Г4Й!К96> !К9ѕТЉ4:К9=2К9юТl4!Х96 *К9& –2)	:Х9Н 6л!Ж9Н­6Т‡4ЙГR4Й *¶9	~2Н9*¶9	~2О9*¶9	~2П9*¶9#^#Vл"Ж9+л! Н6л!Ф9sН4!Х96 :М9жЦ Цџх>;!Ж9НЄ6џБHЎТи4!Х96НM4*К9& –2)	:Х9Н 6Ж9Нў6л!Л9s+4Й*¶9~ю В(5:Ф9‡‡O !®2	DMНб2 НК2*К9MНo3*Л9MНo3*М9MНJ3 НК2*Н9MН93*О9MН93*¶9~ю В`5*П9MН3Й!Ъ9p+q!  "Ы9*Щ9"¶9 	"ё9*¶9~Ц Цџх~ЦЦџБH±Тџ5Н‹4!є96яН	5Гў5НuЙ!щ9p+q!Э96.е*ш9DMЮ9б
-Вє5Э9Нa5!ъ96 >!ъ9ѕЪс5*ъ9&  	Э9	NНТ0:ъ9<2ъ9ВН5Йi`N#FЃo€gЙл_ л…oЊgЙл_ лҐo¤gЙDM!  >х)л—)лЌ‘o|gТ26	с=В 6Й^#Vл)е))Б	ЙDM!  >)л)лТR6	=ВJ6Йл_ лµoґgЙ^#Vл)Вh6Й^#Vл|·g}oВr6Й_ {•ozњgЙO {‘ozgЙi`N#F‘ogЙo& •oњgЙ_ {–_z#ћWлЙi`N#F©oЁgЙ                                                                                                                                                                                                                                                                                                                                                                                                                                                                         яя    я                              Ђ \                                                                                                                                                                                                              я                                                                                                                       _ л…oЊgЙл_ лҐo¤gЙDM!  >х)л—)лЌ‘o|gТ26	с=В 6Й^#Vл)е))Б	ЙDM!  >)л)лТR6	=ВJ6Йл_ лµoґgЙ^#Vл)Вh6Й^#Vл|·g}oВr6Й_ {•ozњgЙO {‘ozgЙi`N#F‘ogЙo& •oњgЙ_ {–_z#ћWлЙi`N#F©oЁgЙ                                                             ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее…IФ“УХ TE%hIIZ@TRKЃPСPХ DDФ	9.@CBNKЃOФTСаSхDT8эAIJ?BOOTЃЏХР“УХ cф4фе5Hэ=9%:?CONOЃOУTХ SфU„шэUa&?HOMEЃЏФУТаcх5EE$ёэMQM?STDMAЃOФ‘PQ cхu$•DXэ1%MQN?SCTRNЃЏРУУ“ФаcфU„•8эUa=N?DVTBLЃЏСU’S cфE%D$Иэ51Q%>?FLUSHЃУSХ CхD”Шэ	9-M2?STBNKЃOЦSХҐАR`)h   0л`й 0оАоЂ0пяЂ0и  0сё2Ђ0уP7Ђ0у DЂ0мёT 0пАюЂ°и€‹Ѓ0А aСа&і aЂ 0 ‡GАzФ†  0А aСа)p  Жй 3@    !  ҐбXF{Y
®WX¬V~m`ИЛjЂ
КВІу­›GА\,`@ЭaЦ0	k6ј 3@  1є@Ър Н  ` шНЄ жИ  @ " Ђ@  € dЛtЂ@ Ђ
® `T*   1P   
F ч+›l Vв‡УЉН  .!сj tІE@  aВ*   ` ¤| n]аёЂ>-D'aШбaЂ –+Tь·IоVm p€Г6‹’Єа!ѓ`|/rЏ#  Мf{µX¤цm `ґ\ ўшWћЦB$0ьN?ЮПчыь  лђm mP1ћНЎЂ– Н¤ "­® Н¦@"  Н¤ "­І UїЯпчыэюяїЯпчыэюяЛЊЂ    `\ymPH ) а  IшFf7­·0@rєД/зшdь2ЪАУь2~™ЌмЪ>бd»H{\’н!нђKґ‡¶А"­Є & 
B9  2~™ЌоP‹бюЕ[T L „sШ dь#3ЬЎіь2~™ЌнШl42ЪА™lёЄсЂЂ—+|яn[ …nИўxщюЙ4	ЂQH¤R’   “у бe  fЭауш ї‚" щюю	€ *у»6уЂ©™,W+4  p°Vм–+•›p \,»%ЉеfСР“.Ё 4K6C¬n 2ЯЂUЮ 'ET ЏЂЛј·`‹QН^ЙP љЫЂH‡H 2eЦ`
цLґ|eI@` єФ e·@!І(„I'”ДS‘ИЮrНВ  и@TЂ‚ґ.Ц —kЂK¶@%Ы`нР ґ” §и*«	1У`~‚Є°’§ §и*«	сУђ~‚Є°ћ§#§иH)ЙqХ~„њ–¦™  §иIйк‘џ0~†“@ Зиi)Й*‘ћ~†’¦©х gиiсРђ~†ћњ’ќ §иiйЙсУ0~†ћњћ§ ЗиiйКj‘ћ ~†ћ¦©? Зи€ЄЙ)СФ ~€¤Ё„™< ЗиЉК€I‘ФЂ~ЊЄ¦‘ §й	йЁ± @
~’њ’©g Зй€€hjРр
~’¦©- Зй‰*jЉqФP~љЁ’џK ‡й©кС”А
~љћ¬‹2§к€ЁqЦ~ €Љ¤Ґ §к	ЄhсТp
~¤Љ‚‰s ЗкI€hjУ ~¦†Ё¤ќ Зкi€ЉiqХ@~¦Ё„њ—$ Зкj€‰Ё1Т~¦Ё¦Љ‡ ЗкjЉЉIqФа~Ё’›O §к‰)Ё±•°~Є¦Љ¤Ќ ЗкиIйк‘Т ~®¤’Ё‹W §л	©кС•Ђ~°љћ¬‹Х Ё(ЉJСџаЂ‚’¬Љ‡И)кИЁqТP*Ђ†„њ—Щ Иi*ИЁqџђЂ†ћ¬Љ‡Ёj€I‘нР
Ђ€„њ—Ы €‰Ё1‘А*Ђ€Ё„™И	‰кИЁqАЂљ°Ё ѓЦ Ё
HЉJСнђ
Ђ¦Љ†©Ч €
ЉIsЂ  ћУ ~¦†Ё¤ќ Зкi€ЉiqХ@~¦Ё„њ—$ Зкj€‰Ё1Т~¦Ё¦Љ‡ ЗкjЉЉIqФа~Ё’›O §к‰)Ё±•°~Є¦Љ¤Ќ ЗкиIйк‘Т ~®¤’Ё‹W §л	©кСжH~OНгIК!K>ЎwН:JНЁJНяHЇ2БLГеF4НфIOѕТ.K5ГйFНмJНїJГKНяH:БL!їLѕЪSKюЂВйFНяJ:	G·ВйFН®HКйFНАH:µL·ВТLН›IНЪGНіGГI:ЮL<КG=!ВLѕИwW*€LНMI_ХНSGбТG-И*€LMDН:I"€LЙ:єL2ЮLЙЇ2ИLГТK>ЂG=O*ЯL л~ ~Ўw#~ 2ИL~ЎwНcIНоH~ КТK~Ўp2јL!  "КL>я2бL*ЯL~ж=2єLюяКцK~2КLН›KНoK> *ЯLwЙ                                                                                                                                ѓ  ‚‚BB   ‚‚        ѓ                                                                                                 члб+"бчБ}жюИ{жь_}жьoНЭхµИ>я2тЇЙ~жК7х®жВ7хГёх~юхВ7хлб"тГ9х:њч·ИOG® Ае#НдхбЙхЇНQшсЙ{•ozњgЙѕА#ИГдх   ѓ‚""‚‚ѓ      !ЦхеЇ2т*%цDM*тл*бчеНЭхСµИеле+))	 ќч®жВHхНАхК~хлб#г+}ґгелВ#х<ббЙ:т<КІх<В7хХНАхСВ7х:т<Кўх<Кoх~жВ7хГ~х®жВ7х~ж0ю0К7х*бЕХ",ц!.ц"*цЂ НKш6 *цНХфБ}ґКґф}¤<Кґф.ц}“o|љg	"(цбС$ ГKшюКtф> ЪИф=2(ц*fчщ*(ц}DЙЇНQшН•"(ц>ГQш·КKшНQшНKшЇГQш>НQшГлф"%цНQш!*ц$ НKш*цбБЕе"тНХфСБxжьИ!*цл! Ъ@ф$Ъ@фЪhфЪKшЪ\фГKш:т·КKш 	л	~#~	л	wЙ*Шч NцГKш*ШчЂ NцГKшл^#V#N#F!ЇцешxЙЌуХ>НQшйGЇНQшxЙю3Ъ°уюbЪјфюqТјфюoК5уюpК5уГПуюКЗуюКЛуюВПул"Шч"тЙл"гч*гчл!вхyюbЪЫу!іх 	~GЕХЪнуЪьуГф*Шчл!Nц НKшСХЇ2ттл}ґВу!,ц"єч*Шче*цХ NлНKш6 СХ
НХф:+цO СбГKш2$цл^#V#N#Fлx±ИЕеNpуХ:$цюpКш:ПчGжКjуxжКjужВшГшYГХфб#БГAу>НQшFЇНQ      шХфХфћт¤тЁт¬тгтйтптуХфНшГИфKГшKГш{<КГт<КЅт<КИтKГшНОтГИфНОт·ИНШтГИф: т·>яАГш! т~6 ·АГ	шН6шГИфН9шГИфBK!Уч
ѕИЕOНSуБГс     Г$тГдфГтфГъф       Nц      Гwуy!  "(ц9"fч1fч!ЛфеюТ”у2Яч!†т 		~#foйCOPYRIGHT (C) 1982, DIGITAL RESEARCH 151282                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ‚Шя          Ў‘Шя          Ј Шя          ҐЇШя          §ѕШя          ©НШя          «ЬШя          ­  я          ’               Џ
Шя          ‘Шя          “(Шя          •7Шя          —FШя          ™UШя          ›dШя          ќsШя          џѓЧя          ’Чя          ЃЎЧя          ѓ°Чя          …їЧя          ‡ОЧя          ‰ЭЧя          ‹мЧя          ЌыЧя           Ћ Чя          ђ   я          q)Чя          s8Чя          uGЧя          wVЧя          yeЧя          {tЧя          }| „Ця          ~ “Ця          Ђ ўЦя          ‚ ±Ця          „ АЦя          † ПЦя          € ЮЦя          Љ нЦя          Њ ьЦя           kЦя          mЦя          o  я          r 9Ця          t HЦя          v WЦя          x fЦя          z uЦя           Y…Хя          [”Хя          ]ЈХя          _ІХя          aБХя          cРХя          eЯХя          gоХя          iэХя           IХя          KХя          M+Хя          O:Хя          QIХя          SXХя          UgХя          WvХя           7†Фя          9•Фя          ;¤Фя          =іФя          ?ВФя          AСФя          CаФя          EпФя          GюФя           f Фя          h Фя          j ,Фя          l ;Фя          n JФя          p   я          3hФя          5wФя           T ‡Уя          V –Уя          X ҐУя          Z ґУя          \ ГУя          ^ ТУя          ` бУя          b рУя          d яУяя          -  я          J Уя          L -Уя          N <Уя          P   я          /ZУя          1  я          R xУя       ror Seagate ST 225 - 21.4 MB
 D µТсТУKУiУYФ*ЦЧлШя          B ДТя          D УТя          F вТя          H   я          + УН	шхOНшсюAШжЯЙЫAЛG(ъЙЫAюА(УAцУB!5ТНТyУ@НТ~У@#чЙ   fff      IТ, Read  , Write  Hard Disk Error Command Terminate ErAюЙ ъНТ~нy#чЫAюП ъЫ@ЛW(УA!ZТГсС!„ТГсС"GТнKЧГy27Т ЛЛЛЛ :ЩГю8Цч±26Тx25ТЙ:зчюя с>ыЙНaщ*GТН щНхС!џТН щЙНш·(Н	шх) ?  D !IТНЄСуНТЫAюПК>СюЛ хГ—э!QТНЄСу
НТЫAюП(юЙ цГ©эы ЫAюП(ш!kТЫ@жИ!ZТУAНЦС>ЙУAЫAюА ъЇУCЫAюА ъ!BТНТ!:Т@Ыd diskette,  Write fault on disk drive,  Data record not found,  Parity error during write,  Lost data during write,  Retry (Y/Nng read,  Lost data during read,  Illegal drive #,  Track # too high,  Sector # too high,  Device not available,  Write protecteTrack # too high,  Sector # too high,  Device not available,   Locked/deleted record,  Data record not found,  Parity error duriьЇЙ э!рНэ!LО:іД‡O‡Ѓ O!Ч	еDП н°!ОДСХ н°!5Пеэй!DПС н°!ПДЛЖЙ     mПП’П¦ПЅПѕПЦПоП	Р!Р3РFРZРqРЊРЁРАРЬР Illegal drive #,  & -)[П	~#foН щ!хРН щНЇОO!СН щyюYКLО:ЙОю>А<ЙНш·(Н	шхН	шхOНшсюAШжЯЙ >яЇ2П:ЧГЖ‡‡‡‡!ЭГ†хн[ЫГ*ЩГ#)эЂ:П· схлсНз'Л'Л'Л'±*ЫГНзь2ЙО·ВОЙ:зч<(+Нaщ*ЙО& -)IП	~#foН щ!хРН щНЇОO!СН щyюYКрН>Й:ЩГG:ЧГ_:ЦГO:ЭГЛ'Л'Л'Л'±*ЫГНзь2ЙО·ВtОЙ:зч<(+Нaщ*ЙО                                                                             :·И Ђ ЕХ!пН>Нзьб  лБ йЙе:ЩГG:ЧГ_:ЦГO:ЭГЛ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ЇЕѕЕя         НЕ   я         НЙ                                                      -./0123                                                                                                                         Ъ«Т­Т $С	С®О^С            †э  ¦ЬЇТ±Т 
ПП®О®ОУД          dэЕGЕ«Е­Е 'pА
P 	
 !"#$%&'()*+,®О®О              Bэ\ЩъШЈТҐТ LОрН®О®О             BэоЩЊЩ§Т©Т ООКО®ОНН             Sэ  6ЯіТяяяя $С	С®О^С             uэ  foешя*ХГ& )"э~#foеця~#foС2ЦГйi`zіИл	n& ЙЇЙ2ЭГЙEBIOS Error on  : T- , S-          ! Ђ"ѕч"Ач! @"Жч! "Вч"Дч!БъГ щLОрН1ТшНЮГ !"эЕ^#V#{І(ел++~2ЦГy2ХГ+V+^лНщбБ ЭГcш  .y2ХГi& )"э	~#foґИ{ж ел!юя~2ЦГ!ъя~#foНщбЙнCЧГЙнCЩГЙнCЫГЙ*ХГ& )"э~#Г9¦Нb¦Гр©                                                                                                                       Ъ—©>я2#ВГ—©юВЈ:#В<ВЈбГЦѕЇ2#В*рЅЙ !  "єч"±ч++Й"фЅЦ29ВЙ НCВГєНwЁ*{Ѕ}¤<И^#VzіИ!ЄЅѕВcВ! >яѕВcВ! ГJВНwЁ*qЅ~·А6ЙН9¦!тЙНђі=В‡Б*‡Ѕ"т:Ѕ*}ЅНтВ®Б:т· Д=Ё:ЯчЦИ:њч<МЁЇЙНш§АНх¦А>я2њч*iЅ^#Vл+Н®ЇЙНdБИ!ёЅќч еХЕНKш*}ЅеН@¦НаА*бч))СБСХЕ:ЅН	тБбСГKш:ЊЅЪБс)ЏхжЦ ТБO с	О БВсА"ћч!ќчж¶wж В[БжOж?WжGzжа±O:„ЅТVБхxGyOсГGБxж¶w qЙ*}Ѕ}ґ<ЙНdБИ:њч<И:еч·И*iЅ^#Vл|µЙ:пЅw·И:ђЅ<wЙеХНаАбќч :ЅН	т"±ЅбЙ·ИюЪЬА>КґА>2њчлНdБИл:ЯчюКаАю#КПАюТаА>2њчеН9¬бВаАЇ2њч~2ќч#л!  ж ВБЕКБКБ)ЏхxлГ°ї*цЅ}ґВА*шЅ}ґКА"тЅ*тЅНxА"рЅНxАлНmА*фЅ^#V*рЅ 	s#r*рЅл*фЅs#rлЙ*рЅ :пЅѕКYА4ѕКYАНѓА*рЅл*фЅ~#ngН¦µлИГА*тЅ 	s#rЙ 	^#VлћЈф“ЈНaї##ыЅГ)ЈН0Вуя"тЅНxАеНxАбИл!  "цЅ"шЅл"рЅНXїНЈКCА*рЅ~<ВОїл*тЅ"цЅГуї:ЄЅѕВфїл! :ђЅ·КуїѕВуї:9В· Вуї*тЅ"шЅлеНxАСКАл"тЅѕл*тсюВї"gЅЙл*ШчЂ юВ3ї:ъч=єЪт:ъЅOНiїЂ Гтл:ъч=јЪHї:ъЅGНiїЂ НтНaї6яЙ:ђЅG/OЙ*рЅЄЅЙ *рЅЙеХНWшСбЙхН¤:ъЅНTшс=КхюТЌѕНВКтѕЇНaїюКљѕ~·КВѕ6 *«Ѕе:­ЅхНXїлН)Ј!©Ѕ:ЄЅѕДTі>МqїБСН¤НkісюРхюВЦѕ!”Ѕ:“ЅѕТаѕНВ6я>Ггѕ<wЇНqїНXїН)Ј6 #НѓА:пЅ<Ђ !Ђя=Вь{ЅюВXѕ^#V!яя"ыЅл:ЄЅѕВ<ѕл! ~л<В<ѕел^#V*ыЅН¦бТ<ѕл"ыЅл"эЅНxАВѕ!ыЅНы§И*эЅЇ>НXѕ*{ЅГѕхНQї:«Ѕ_ 2пЅ{Ў2«ЅсхД’ї"рЅН‚§"тНXї~<КВѕс                                         яя                     #cdfg !"()                                          *НNш!фчлНЅГrџГ)Ј!оЅл еГNµ! •лГ)ЈzЈ<*¬чК)№л"¬чЙ!яя"џў:Эч·КXЅ*Ыч:їЅw :¶Ѕ¶w#:µЅ¶w*2щ*џў}DЙе                             ИН®Н¶·КдјНѓµВЎј>я2тНх©ИН®ИН±µНФµВЯґеН?ҐСл~·ВѕјжВѕјНјГКјжаВЖј>ЂwНјН™µ=2дЅНњҐНр©ИН¶·А:дЅwГљ§~хНѓµБК‘јpГЎј!фчНЅ6 яГNш ЅwбжКј Н§µНBµpшяН§µНИБГљ§НgіНsґГrџНђіН-¬НњҐНр©ИНД¤ Н¤Ґе Н¶·ВSјСлН)ЈГ_јб Н¤ҐНѓµИ~Н?ҐwЙНђіНsґТАЄН-¬Н?ҐFеЕНњҐНр©БбpNН†©ИѕЙ<!ЈЅ4К”»‡5НД¤O 	>№Иp#Гћ»Нђі*Ыч6!Нч©Вї»Н?Ґ~жpВАЄ*Ыч6 Н®Нч©Вд»>я2тН®ИН±µ Н¶НЭµ Н¶НвµНФµВЯґ  Н·µцwе*o©Нq»Ъ»х Н‹ЁсК"»Н@¦6еНИБНљ§НЄГюєНXҐН¤¤Н‹»Н—©ѕwхНOҐ~<слД­:џЅ·М­ Нg»л~жw#w#6 ##Н)ЈН‹ЁГ»Н@¦	л*Ыч	Й Нg»~ж?GёА++! ш…oг#~бгЙ>ГTш}ґИл!
 6 *щчН¦лРл*Ыч#е НKшбЙ"џўG*Ыч~ю	ИюИюИюИxГrџНђіН-¬НxґД…ґяНд±ВАЄН@¦ НЛІН7ҐНюІЪАЄІКАЄН(¦Нљ§НS¶Нх©КЂНwЁГ:ВН є:ћЅ<ВєНR§бс·Вн№ЙНHшНҐЈ:ђЅ·И>ГяЅл~юcРл!њч…oл#~ююТEєл^#VлГ)№G#~И#~Й!°єел~юИюВbє‹єХю	ВkєђєХе##N#F#^#V#~#foг~еo‡…АЄюЃТАЄ2жчЙ{2зчЙНgі*wЅлНЮЁ  ·КЄ№Тў№Гћ№+}ґВќ№*…Ѕ#}‘o|g:‚ЅOЇНцўл*тs#r#wЙ!іч~цЂwВ/~ц@wГ/Н/ґНHшНҐЈ*eЅ>=)Тєхе_Нgі:Ячю0Кєџл"ШчГ¶§Нkі*wЅГ)№*cЅГ)№Н-¬Н}ВН¤¬ГЂ©Нkі*sЅ"џўЙ:ћЅюяВ;№:ачГrџж2ачЙНљіНОҐГ№ІНљіНОҐГВІНљіГіл}/_|/*eЅ¤W}Ј_*cЅл"eЅ}Јo|ўg"cЅ>я2©ЅЙ{·КВ—ё>я2тН®В—ёНр©Н‡«ГАЄН±µл*т 	лжаВ«ё>Ђ2дЅхН™µсwНBµpНјН+«ИН¶·ВТё:дЅwНљ§НA§PН{· Н2¶АНвµГW°>O2 ўНАЄГёўН}ВГR¬*eЅГ)№:¤ЅГrҐГх®НљіНОҐГc°НҐ2іЅНZ¦НT¦НђіН-¬Н®НЪ¬Нш§·К3ёН—©ѕТгёхН@¶КYёНsґжЂКYёНѓµКYёНЧµКYёН…ґ:дЅжАВЯґсФ®Нш§ИНA§НsґжЂКТё:іЅж@КТёН@¶ВТёН$«НѓµµђчГ¦НљіНA§НШҐН=­:џў<ИГєлЇх~ю?ВЇ·НkіНйі ГГ·Н?Ґ~ю?Кѕ·НZ¦НT¦НђісхКЪ·*бче>ьҐo"бчН’§б"бчс!Г§еКч©:ечOНЭ©ГЄл" ЅцГќ·Н}ВГ6«НљіНОЫч
 ~жЂВ·2µЅГАЄНA§НsґжЂКv·Н@¶ВN·Н¶·ВN·~жАКv·Н$«НѓµВW·Н+«ИН¶·Вv·wН¦Мљ§Гv·Н$«НѓµКr·НµКr·Н…ґ:дЅжАКr·жЂВЯґ>Ђ2¶ЅН+«ИНA§@Н2¶МЭГrџ!яяНZ№Ї2Ъч!Ђ "ШчГ¶§Нgі:¤Ѕ2ЪчЙНT¦НђіН-¬:ач·К№¶>ю2т<2ЅЅНЪ¬Нз¶!ЅЅѕИw:тююИН
®>Ђ2µЅ*Ыч6 НЭ©НЄНЭ¬Нз¶ЙНш§ИНOҐ~<Вч¶wб:µЅТ·*В)ЈбЙН@¦	uџХГнµ:бчжюИG*gЅ` ~Ц!Аx‡_‡‡ѓ<Ѓ_ЇЙН@¶А*oЅy¦В¦<Й:„Ѕца/GН?Ґ~ А##~ж?Й Н6¶АНK¦ж@АН?ҐF6 е##N6 ЕНр©ДвµЇ2џўБбp##qЙ:Ўчµ#Й*Ыч~хцwНх©> 2џў*ЫчБpИН@¦л! ~жацЙе*т"тбЙНv¦ЕН@¦л*Ычл°w#Н)ЈБИ6 #ГМµН™µеНµбЙ ГдµН¶·Аљ§ХфчеХ НNшНЈСбчЙ#Fx·ВµT]##	#~И·Кµю Кµл
 л*тЁѕВ4µ#В'µЙВ4µ!зЅГЈе  л*тЇх~·К^µю К^µ33хЂG#ВPµс°бВvµ:ЯчюdКvµ6 ЁВyµИГµЇ2тН@¦л!ЧЅеН)Ј#wС*Ыч~ел"ЫчНр©КдґН¶·ВТґл!дЅFw·КдґЁжаКТґНѓµКТґ:дЅwН¦Мљ§б"Ыч:ЯчюИюИ>ГеёЇ2дЅН¦ВэґНѓµх*Ыч~цwсД‡«б"ЫчеНЂЈНЁ НЁ!Юч~·К$ґ6 б:Ячю0ИН3§Г§Нi¦Ъґб"бчЙ!рч~·И6 *eЅ>=)ТQґхе!©ЅНQіНXґДхібс·В<ґГkі*{Ѕ}¤<И^#V{ІИ! ~·А! Г_ґ*oЅ~ЙНsґжЂИНѓqЅ~жх†wсДи¦Н¦ЙЇ2µЅ2¶ЅГ№іЂ*Ыч л~ 2¶Ѕ~Ўw#~ 2µЅ~ЎwНZ¦!  "т"тЇ2ЅЅ=2Эч*Ыч~2їЅж=2ћЅюяКЯі2¤ЅНkі:ач*ЫчwНх¦МX§НхіГ/ґН§И6 НX§*б–W#xћ#хІWс{ћЙs+p+qЙН7Ґеr#r#rНх©К>іН@¦ НЛІбеНюІФіНЄ> 2џўГібЙл  НЛІ!! q#p#wЙ2ЄЅwW*eЅН¦_ХН3ЈбТ«ў-Й!¤Ѕs:¤Ѕ!©ЅѕВxіюяАНQіИНиЁ*¬:џў<ВњІСбБЕеХ.К©ІН®.К©ІББНA§НЬўБЇГrџСгr##sбНЬў<Б}ГrџяНд±Мх®Й Нд±Мc°ЙлN ! ~жЂЃO> €G~жЂG! ~‡‡‡‡·ЂGх~жoс> ЌЙ_yG~жьб.|В°І!  w:ЯчюcКkІХНи§СК[І! x–ж?В[І! ~№К¤ІН†©В[ІЕН—©Б№ТPІСХВPІСГvџqOН-­Нэ¬ГЎІЕХН=­СБ.:џў<К°ІН®! еVq##~_Хж@°wНЪЅН¶§С:ЁЅWХНMЇЪє±К›±>НяЅГє±Н¶§Н¤>НTшНJ§БЕ:«Ѕ!ѓЅ¦К·± НћЈБx!ҐЅѕЪЗ±w4ВП±НP°НW°ВЮ±НP°НЬўГ‚ҐНХўГ‚ҐЕ*Ычл!! ~жх~#~жO~жр#¶НF¦sГ±O 		s#rЕНт¤:Ячю(В„±y==В„±Бх*«Ѕе!ђЅ^WХ*yЅ^#VлеНxАСВ7±л=2”ЅwНј§СХЇw#тK±WВK±*±Ѕ"«ЅЕНJ§Н¤ЇНTшБНћЈ*«ЅСХ:ѓЅҐ В[±бб"«Н+¦Но§НS¶НXҐ:ЁЅюЂЪњ°Нq®:џў·АНа¤Кє°!ЄЅ•ЅНЈКµ°>я2”Ѕ Г±НЬўН¤¤2џЅ  ·КС°OНМ¤DMНё«}ґВЮ°>Гrџ"«Ѕ"–ЅЇ2”Ѕ:ЄЅ2•Ѕл*Ыч 	:ЈЅ·:џЅК±:ѓЅ<OК°ЃГ°БAO:њЅ·К°x№Ъ°yбБpБ!™ЅVђєТ+°Wy/ў2ЅКoЇх:њЅ·КB°Н єН¶§сgНќ¤|юOДEшЇЙНK¦жwЙНK¦ж@х~ц@wсЙ> 2њЅН9¦:¶Ѕ·>Веё:µЅ·>Веё*Ыч†юЂЪ€Ї>ЂЕF6Еех:ѓЅ_/ Gб:њЅ·К§Ї:ҐЅўјЪЁЇ|ђO»Ъ°ЕН¤¤G:џЅё_КэЇOЕ НМ¤еНМ¤Сz”W{•ІКВЇ|µВхЇ:њЅ·ВхЇ*…Ѕ}“|љЪхЇЕХBKНNЁбБТВЇСz№ЪэЇy“G:ЁЅ!ҐЅѕЪЇюЂВvџНq®:џў·ВvџНХўНа¤КvџНт¤НMЇЪ‚ҐВ?ЇН¶§Н¤>НTшН“ЈГ‚Ґ!  "–Ѕ>НяЅГ‚Ґ:“ЅG:ђЅO х:ЅюЪhЇ=2Ѕс7АЇЙсКrЇy·ИцЙy/W!ЁЅ:™ЅюЪlЇеЕН=­Бб:џў<И>Ўw##~2§ЅВ ®4~ж?КЙ®Н®НѓВВ№®:њЅ<КЙ®Н®КЙ®Гј®НЮ¬НA§НXҐЇ2ЁЅГrџНK¦:§Ѕw++~=жwГvџ4Н—©OѕТм®5:њЅ<Кvџ4Н-­Нэ¬Гј®Но§>я2њЅНXҐАЙ!яя"тЙ*т>ьҐo+"бчЙНvВНы§Д
®*Ыче!bЅ"ЫчНЭ©НЄб"ЫчИ:т·А r#~хеж?w#>r#ВL®=JМ¶·
КL®Нv¦   Нщ«бсwНИБГb¦НЬўН?Ґ~OН†©КЪ®·В†­w·ВЊ­~ѕВт­ГЁ­Н­лН­лѕВт­#ѕВт­#Вx­лмя	еН—©СНш­wЕ 	л	БКЩ­КЪ­ѕЪЩ­·ВЪ­Н­лwН@¦ ~жwНb¦НђЁГљ§НЭ§ГАЄѕАлѕл! ‘К­xТ­>Ђ¶wЙ~·А6 :џЅ·И6ЂЙ~#¶+Аw#w+Йе ~юЃЪ;­жwбЙЇ2џўН¦АНK¦жЂАНи§Кт­НьБOFЕqН-­yёЬэ¬Нl­Н?ҐБNpГэ¬Нр©И Нg»:ЈЅ·К“­~ЄНх©ИН(¦Нч«НИБНЄВ€¬Н«КЂ©НH¬Г€¬НҐ2іЅНxґД…ґНх©И Н¬Н)Ј:іЅж@КО¬еНOҐ~б#wНљ§НЄКЂ©Гґ¬НѓВИНb¦_е++VХН@¦л*Ыч Н)ЈН—©OСбs++r л§~ ЕGж°wБ#Гэ«Х *Ыч	#~Ц$М%¬+лН@¦БЙічцЙ*ЫчН9¬А>	Геё#>?–жИВ;¬·Й*Ыч~ 	wЙН-¬НxґД…ґНэЄНH¬" ЅН0¬* ЅНг©Нъ©ВгёН«ДЉ«НH¬НэЄГE«Нх©КЂ©Н@¦~жВ›«:іЅжЂВќ«6ехН¶·В¦«wНљ§ сМ‹ЁНИБНЄГ‡«PY*…Ѕ{•zњТо«ЕХBKНNЁТж«СБy°Кє«ХЕНNЁТж«БСГє«<НpЁбСЙy°ВТ«!  ЙЂН¬Кљт>ю2тЙ:тююИН
®ЇНяЄ* Ѕ~цwНг©ГЄ*бч"тЙН
®НЭ©ГЄНҐ2іЅ>юНяЄНх©ИК„«Н@¦~жВk«:іЅФ(¦НsґЪ~«*ЫчН9¬К~«ГЉ«НsґТ~«НФµК~«Н…ґГ<«Н†©G:ѕЅ<КЮЄЇ2ЅЅxБ·ВЄ#ГWЄ:ўЅ<В­Є:тююМкЄГЄЇ2ќЅ2џўGЙж?ЙНнЄНЁ>яGГrџx·ВЄ~·ВЄ:ЅЅ·КЄ2ѕЅГ”Є°БЄЕА##~·АНхЄе*т$ВыЄ*бч"тбЙ>я2МЂЈЇ2ѕЅНkБВєЄ НЁНш§КєЄ* ЅлюеК*ЄХНi¦СТєЄН@¦:ечO ~юеМнЄЇ2ўЅ~жпѕКWЄлѕлВWЄ:т·КЄ2ўЅГ”Єy·К›Єю?К”ЄxюК”ЄюК|ЄюМ·Є–жВЗЄГ”ЄЕNН:ќЅГrџЕх:„Ѕ/Gy Oс ‘жБЙНOҐAЕБЇ+ѕВ¬©Вў©y2џЅ:ЈЅ·xВ№©Ееo& :‚ЅW>’OН«ҐE:„ЅёбЪџ©Н?ҐN/жЎ°БЙ*Ыч" Ѕy2ечН¦А>я2ќЅЙГч©НЭ©НЁНх¦R§НX§НЮЁDM*wЅ6 #x±В©*oЅw*‰Ѕл*wЅs#rНЂЈ*iЅ6#6 НЁ*}Ѕ"±ЅяНЁНш§КjВН@¦л*±Ѕ|Ґ<лДЏА>!ѕК8©>еѕК8©> ѕКt©>¦Вn©Н¦ЁНv¦Г8© ~*oЅwГn©T]	сКKшлГKшЕН¦ЁБЕНЮЁл*wЅБе"wЅН¦Ёб"wЅЙН@¦ ЕСИХ:ЈЅ·КГЁЕеN ГЙЁЕN#Fеy°КШЁ*…Ѕ}‘|ФhЁб#БГ°Ё*…ЅН«Ґ#ЙН§6 НлЈВяЁ*qЅѕ  КяЁГ@ВНЙ!яя"бчЙНЁГ@Ё*‡Ѕл*бч#"бчН¦ЪЁ:бчж‡В&Ё2·Ѕ·АЕН’§Б:Юч·АГ€¦Н0Ё:Юч·ИН§Н+§Г’§yж<_W`iН«ҐDM*wЅ	~ВbЁЙХНNЁжюБ±ВpЁwЙхНЮЁDM*wЅe§Х
 ^#V#~2ъЅлСЙНхЈ>Гў§Н9¦Н†¦>!  "–Ѕ*yЅюВі§*рЅНXѕ*ШчГї§Н‚§"тЙ*gЅл*тЂ НKш!џў~<И:бчжwЙНb¦##>яw#wЙНД¤Гы§Ни§Аб>	Гrџ!бч~#ѕА<чG~ёИ#·В§<Й*qЅ#~·Й!;Ѕе!НЅНю¦КщҐ!ФЅНю¦КАЄбЙ!Юч~·И6 Нkі!  "бчЇ2·ЅЙ*qЅNН1ҐqЙ*{ЅГ]§*{ЅГ[§*yЅ}¤<И^#VлеЕЄЅНЈБбВt§6я ^#Vл}ґИГ•ozњgЙю*‘Ѕл*‹Ѕ|жgН¦РЕНёҐ*uЅл*‘ЅБКЖ¦КС¦ѕИН¦ НR§>я2Юч2њчНи¦Н¦ГZ№ѕwИ*qЅ>¶wЙwЙ:¤ЅcЅН¦*‡Ѕ#л*iЅs#rЙ*ђчН¦И’чГ¦:ЊЅжЂА!АЅ:ЯИ)ГяҐeЅ:©ЅO! НюҐµґЙ*cЅ:©ЅOН«Ґ}жЙН@¦Н2¦РГ¦ў	 ~ЙН¦ИГЎў*gЅ:·Ѕ…oР$Й*Ыч ~ЙНK¦6 ЙН?Ґ~жwЙНK¦цЂwЙ*бчл*iЅ{–#zћЙНi¦Шr+sЙ{ЅЙНOҐ:ЁЅw:ЯчюТ’Ґ4л~юЂР:ҐЅwЙН?Ґr##rЙp#ИГ¤ҐИ|·g}oГ¬Ґ*gЅ  Ї†#ВБҐЁGВѕҐЙН1Ґ*qЅѕДгҐ:µЅ·И*ЫчЇwЙ*тл*ючН¦ТчҐ*’чН¦Ибб>
Гrџ2­Ѕ"±Ѕ:ѓЅO:ЁЅЎG2“Ѕ!«Ѕ¶wЙ*Ыч ~‡хzWсw+В!ҐzЙН?Ґ#~Й*Ыч! Й*Ыч Й*Ыч ЙНGҐл! ЙНOҐ~2ЁЅл~·ВmҐН—©OНэ¬~юЃЪtҐ>Ђ2ҐЅН?Ґ:„Ѕ¦2¦gНќ¤DM*љЅлН0шMD"эЅН!ш*тMDГ$ш:ЏЅOГ«Ґ!‚ЅN:ЁЅ·В«¤G>–O:¦ЅКВ¤·Г№¤ЂЙ*Ыч ЙНД¤	:ЈЅ·КЪ¤n`Й	~#foЙН¤¤2џЅO НМ¤"«Ѕ}ґЙ:‚ЅO*«ЅЇНцў"«Ѕ л!«Ѕs#r#pЙ*kЅN#FЕ*mЅ^#V#F*«Ѕ:­ЅO}“|љyеТ9¤*ЂЅНдўбг+гГ"¤*ЂЅНнўб}“|љyЪP¤г#геГ9¤ге*ЂЅНдўбХЕел*ЌЅDM"ыЅНшС*kЅs#rБС*mЅs#r#pБy“oxљНшЇ*kЅw#w*mЅw#w#wЙ>2ґЅН'шГҐЈЇ2ґЅН*ш·ИOН¶ЈyюЪІўГІў<АНлЈИ*eЅН¦ИНІ¦б:Ячю0И!ЄЅ:¤ЅѕВжЈН§:ґЅ·АГІўЇ2ЮчЙ*‹Ѕ>ЂјАЇЅЙ*бчН«Ґ"‘ЅҐ4А#4А#4ЙНЈлГ)ЈН7Ґ®ЅЙНЈГЈѕА#ИГЈИw#Г*ЈJНш|µИ^#V#"iЅ##"kЅ##"mЅ###"oЅ#"qЅ##л"љЅ!sЅН)Ј*sЅл!ЂЅН)Ј*…Ѕ|!ЈЅ6я·К~Ј6 7Йrror File Exists ? in Filename   ГІўГІў>я2©Ѕa.я"џў:ЄЅ2нч:зч<Дыч:ЯчюК5ЅюК5ЅГ;Ѕ:јЅ2тЙЇ2јЅ2тЙ{•_zњWРЙ{…_zЊWРЙИ)ЏГчўН7                                               CP/M Error On  :  Disk I/O Invalid Drive Read/Only File Read/Only Disk Password E                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                чК)№л"ПчЙ!УчzЈ<~КrџsЙл^#V#N#Fлx±ИЕеN:ЯчюoКІџНЂчГµџН(љб#БГћџ                                                                    ™НшГrџy<К џ<Кџ<К%џГzчНяВАЄГrџНя·ИН·ГrџН6шГrџН9шГrџлMDГЊљ:ПчТoџ!Хч6Ђе!hџе: тюКљ™Нnч·ИНtчюК™2 тЇЙНrџб6 ЙН™2џўЙ>ГrџzЈ<*ПК9ќюКЊћН^›:ПчжВ—ћ~юxВ ћюК)№ТаћЕеНАљЪњ:*ў·КАћ:їџюКЕћюКЕћ>ГњбБл*(ў+"(ўwл+ЕеН+›Ї2+ўГњЇ2+ўГя›НЙљбpЕНШљБяНољ!  "єчГН>2+ў2*ўГњЕНjљБбеЕx·К.ћ#NСХzђWЕе:ѕџєЬљбБГће:јџ·Књ!·ч–2јџНWљ!јџ5В=ћН^›Гњхx№Ъ^ћсЕеНzчГњ:їџюКmћ:*ў·Д;›с#wЕеOН›НљбБ:їџюў·Д›Н‚љН^›Ї2ЅџГњюВўќеЕЇН ™БбГя›юВДќб:Ѕџ!·чѕЪЅќ*(ў~·ВЭ›ГЧ›5НWљГЁќюВХќгНШљгНjљбГЧ›юВMћЇ2ѕџлНЁ›лx·КОќл*(ўКшќ+wГнќ"(ўЕХНjљКњНН™ГшњюВќл!%ў"(ўлН^›Гя›юВ-ќ:*ў·Кя›Г$њюВPќ:Кч<К\ќ:ЅџW:·чєКя›2јџx·КMќГћюВsќ:Лч<К9ќ>2їџ:*ў·В9ќx·Кя›~+ГqћюВ’ќЕx2ѕџе:*і›*&ў~·2+ўКoњ#"&ў!+ў6лГMћюВЕњ:ЅџW:·чєКя›2јџx·КћеНє›С*(ў+"(ўwлГћюВќ:ѕџёВЬњ>2*ў2їџГ:њл*(ў:ѕџёКрњ+wГбњ"(ўЕХНє›:·чG:Ѕџёе:+ў·Мњљ2їџбБюКзћю
КзћюВ5њНАљ»Тя›л*(ў~·Кoњ#"(ўлГMћюВљњл*(ў~·К`њлНАљ»лЪUњлНo›лГjњ*(ў~#"(ўГ‘њ!*ў~6 ·Кsњ!+ў6 лГя›:+ў·В‚њx·ВoњНЪЉ›{2·чГ“›еНљб#Гw›:·ч2.ўН›Н+›:.ў2-ўБбЙ!%ў"(ўЇ2*ўЙ!В "&ўЙ!*ў~·А4:·ч2-ўЙНАљФ‚љ:АџG НољНі›НЁ›Н^›Ї2+ў>2Яч:·ч2Ѕџ*ЫчN#еЇG2ѕџ№Вя›ЕИ2АџХ›ЕGHГ)Јб+6 Й:·ч2,ўЙ:·ч!-ўѕР НН™Г›:,ў!·чѕРНН™Г+›Ее*(ў ~·КL›#ГB›xѓ№хФzчсбБШССГя›:*ў·И:їџюИюИюИеЕН›*(ў~·К“›OНАљrљНН™
ГН™!Уч
ѕИЕOН(љБГЊљ*(ў~2*ў*єч}ґК·Н!т#·В¶љ!  "єч"јчАГ·:¶ч_:·ч»Йл*(ўл·И#wГОљx·ИЕHел!В Н)Ј6 "&ўбБЙ:ґчР!В БџВ
›лx·Р5~·ИyюВљ5ЙюА6 ЙyНрТ(љх^НН™сц@OНАљИ:Яч=К7љ:ПчжВН™yю	ВН™:ЯчюВIљНАљИ НН™:·чжВ=љЙНeљ:їџюИ НzчГzч#НН™Н‚љ:·ч!ЅџѕР НН™Г тG:ПчТЋ™>ѕИxюКќ™юКќ™w>ЙЇwЙМ©™ДzчЙ:ПчжВ»™!Фч>®жwЙЇЙ:Яч=КzчxжВzчГzч:јџ·Вц™:ПчжGЕ:Яч=Д/™БЕНЅ™Бx·Вц™Е:Фч·ДЂчБy!·чюИ4ю  т·Вљ™НnчжЙ!Хч6@гйG:ПчжxЙН™Вя: т·ВP™:Мч<КяН™А: тюКP™Н™Нnчб6 жИН™Нtчб6 юВ™! тѕВ^™6 Н™Нtчб6 юВu™:ПчжК)ЇЦИ<Н ™Г^™!ШчЂ Г“*Шч"rЙ*r"ШчГї§Б<И:жчђgЙе:Ячю!ФЈНђС*fщл}DЙ! т~6 ·АГtч!rџеН·НрЪЦхOН(љсЙН™АюВеН^™ГЖюКЖюКЖЙюИю
Ию	ИюИю Й:Function =     File =              !эяГ,Н$В"¬чГhч  !  9"f!ўеН	ЈН‰:жчх2™ЅНt·В™:Ячю!ФюўНс=ВHgoЙ  ЗЗЗЗЗЗЗЗЗЗ  :ЯчO*ЫчлГ;•*еН‚љ:ЄЅЖA2=ў/ўНо—Б:учТо—Но—:Яч0!юdЪЇ—61#ЦdЦ
Ъё—ГЇ—p#Ж:w#6 !6 :Эч·Ке—6 Х*Ыч#л!Н)Ј6.#Н)ЈСН‚љы—Го—
·ИЕOН(љБГо—BDOS  	Н—В—>ђбе 	wГа–НM—Ию Ъх–ъх–В2—ю*К7—w#·Й6?#т7—Й	 .,:;[]=<>| е!?—ѕК]—45#ВR—·бИюaШю{Тi—ж_жЙp#Вl—Йю Кs—ю	Кs—Й Нl— Нl—Нs—ю:беВ¬–НM—Ка–ЦAЪц–юТц–<w#НM—Ка– ю.КК–ю;Кы–Н—В¶–Га–бе	 	 ю;Кы–Н—ВФ–БХНs—НM—бА!  ·ИюИлЙББ!яяЙбе№№#№-№A№J№S№@іY№uџuџJ№АЄuџuџ}№‹№ђ№Н№Я№*єPєи№Иє¦»ј(јdјсјюјЅЅ'Ѕ{џ‰џ•џ•џAўgўXўJў    vў…ў‘ўюА!)№е*Ыч^#VХ#^#VблеЇw# Нl— Нl—!J–		^#VлНЂ—Б:зч·АГ#!"( COPYRIGHT (C) 1982, DIGITAL RESEARCH 151282/В(љџшЂчџ+џ1џ7џИ›=џ}¶ѓ¶–¶ ¶‡·›·м·х·ы·ёёпёхёыё№№У¦     л"Ычлy2ЯчюЪ;•!  "Ѕ:Ъч2¤Ѕ=2јЅ:жч=К;•!••~·К;•№К4#Г.•{2ћЅ!  "џў"Эч9"2!;Ѕеyю3Т]•K!Ж•Гo•юЂТ\–ЦbЪАЄюТАЄ!,–_ ^#V*Ычлй Е        	PUSH BC			;save the count and character
NOT$OUT$READY  00EC'                         NOT$OUT$READY:
COSTER  00EC'   CD 01B0'              	CALL COSTER
  00EF'   B7                    	OR   A
NOT$OUT$READY  00F0'   28 FA                 	JR   Z,NOT$OUT$READY
  00F2'   C1                    	POP  BC			;restore and resave the character and device
  00F3'   C5                    	PUSH BC
?CO  00F4'   CD 0000*              	CALL ?CO		;if device selected, print it
  00F7'   C1                    	POP  BC			;recover count and character
  00F8'   E1                    	POP  HL			;recover the rest of the vector
NO$OUT$DEVICE  00F9'                         NO$OUT$DEVICE:
  00F9'   04                    	INC  B			;next device number
  00FA'   7C                    	LD   A,H		;see if any devices left
  00FB'   B5                    	OR   L
CO$NEXT'ROOT MODULE OF RELOCATABLE BIOS FOR CP/M 3.0'	MACRO-80 3.44	09-Dec-81	PAGE	1-7


  00FC'   20 E9                 	JR   NZ,CO$NEXT		;and go find them ...
  00FE'   C9                    	RET
                                
                                
AUXOUT  00FF'                         AUXOUT:
                                ;======
                                
                                ;Auxiliary output. Send character in reg. C to all selected devices.
                                
@AOVEC  00FF'   2A 0000*              	LD   HL,(@AOVEC)	;fetch aux output bit vector
OUT$SCAN  0102'   18 E1                 	JR   OUT$SCAN
                                
                                
AUXIN  0104'                         AUXIN:
                                ;=====
                                
                                ;Auxiliary input. Return character from first ready auxiliary input device.
                                
@AIVEC  0104'   2A 0000*              	LD   HL,(@AIVEC)
                                
IN$SCAN  0107'   E5                    IN$SCAN:PUSH HL			;save bit vector
  0108'   06 00                 	LD   B,0 
CI$NEXT  010A'   29                    CI$NEXT:ADD  HL,HL		;shift out next bit
  010B'   3E 00                 	LD   A,0		;insure zero a (nonexistent device not ready)
CISTL  010D'   DC 01DE'              	CALL C,CISTL		;see if the device has a character
  0110'   B7                    	OR   A
CI$RDY  0111'   20 08                 	JR   NZ,CI$RDY		;this device has a character
  0113'   04                    	INC  B			;else, next device
  0114'   7C                    	LD   A,H		;see if any more devices
  0115'   B5                    	OR   L
CI$NEXT  0116'   20 F2                 	JR   NZ,CI$NEXT		;go look at them
  0118'   E1                    	POP  HL			;recover bit vector
IN$SCAN  0119'   18 EC                 	JR   IN$SCAN		;loop til we find a character
CI$RDY  011B'   E1                    CI$RDY:	POP  HL			;discard extra stack
?CI  011C'   C3 0000*              	JP   ?CI
                                
                                
                                $EJECT
'ROOT MODULE OF RELOCATABLE BIOS FOR CP/M 3.0'	MACRO-80 3.44	09-Dec-81	PAGE	1-8


                                
                                ;Utility subroutines
                                
IPCHL  011F'   E9                    IPCHL:	JP   (HL)		;vectored CALL point
                                
                                ;print message (^ in reg. HL) up to a null
?PMSG  0120'   C5                    ?PMSG:	PUSH BC			;saves reg. BC & reg. DE
  0121'   D5                    	PUSH DE
PMSG$LOOP  0122'                         PMSG$LOOP:
  0122'   7E                    	LD   A,(HL)
  0123'   B7                    	OR   A
PMSG$EXIT  0124'   28 09                 	JR   Z,PMSG$EXIT
  0126'   4F                    	LD   C,A
  0127'   E5                    	PUSH HL
?CONO  0128'   CD 000C'              	CALL ?CONO
  012B'   E1                    	POP  HL
  012C'   23           Й Й            A  SUB                                                                                                                                                                                                                                       1ЯГx                                                          CP/M Version 3.0COPYRIGHT 1982, DIGITAL RESEARCH151282    654321Invalid file name $Error On Line $Enter Password: $ERROR: No 'SUB' File Found$CP/M 3 SUBMIT Version 3.0
$Enter File to SUBMIT: $SUBDisk Write Error$Random Read $.$Invalid ASCII Character$Parameter Error$ERROR: Directory Full$Requires CP/M 3.0 $1Я1ЯНG"’*’}Ц0џх|ЦЦџБH±Т¤bН   Н PНд2иНIНK
НУ1ЯН"”>я”НdµКг*”++"”~ТгН"”иЕ!\ Н.ћНыv!ўq*ў& лН Йэ Н Й!¤p+q*Јл	Н Й!§s+p+q*Ґ:§w#6 *Ґл
Н *Ґ#"ҐN#FyЙ  Н Й!©p+q*ЁлН Й!«p+q*ЄлН 2Й!­p+q*¬лН Й!Їp+q*®лН Й!±p+q*°лН Й!іp+q*Іл!Н Й!µp+q*ґлН 2Й!·p+q*¶лН Й!ёq*ёл-Н Й!№q:№2–!—6 –1Н Й!»s+q:є2–!—6я*»& "–1Н Й!Ѕp+q*јл<Н Й!Вs+p+q+СБp+qХ:В=2ВюяКd*ѕе*АБ
w*ѕ#"ѕ*А#"АГ=ЙНч
НчЙЂН   Н Й!Жs+q+СБp+qХ:Ж=2ЖюяК©*Г:Еw*Г#"ГГЊЙ!Иp+qНe“НЯН*ЗDMНиЕ!\ Н.\ Нs   Н Й!Йq:ЙюaЪь:Йю{Ть:ЙЦ Й:ЙЙНOНв2К:КЙНeНeўНl Е Н!Л6 >!ЛѕЪњН 2Мю ЪK*Л& l 	:Мw:МюВTЙ:МюВ_Г:МюВ…:ЛюТrГ:Л=2ЛO !l 	6 Г3:МюВ•   Н !Л4В*Й*‘& 	~Ц Цџх~Ц	ЦџБH±ТБ!‘4ГќЙl Е Н:S ю Кг*Q е*S лl Н.юНЦl НЖ\ НP"Н*Н}юяВ=*Н|юВ&ННel НЖ НЦ\ НP"НГ=*Н|ю В5іН   Н Ђ НЖ НЦЙЃ ЕН.*Ђ & 	6 !‘6 Нќ*‘& 	~ю ВНОНкН(Ђ Н 2П*П& ‚ 	6 Нe!‚ "љ!\ "њљНМ
"РяяРН\µВБНp‚ ЕН.Еe Н.:\ ю ВэНд2ТO> №Тэ:Т2\  НьНВ*‘& 	~Ц Жяџх~Ц ЖяџБHЎх~Ц	ЖяџБHЎТ.!‘4Г Нќ*‘& 	~2Т!ђ6ЂЙ>!ђѕТ`\ Нѓю К[>Й!ђ6 :ђ<2ђ=O !Ђ 	~2УюВЅ:г<2гO>9№ТЅ!г60+~<wO>9№ТЅ!в60+~<wO>9№ТЅ!б60+~<wO>9№ТЅ!а60+4:УЙиН“ю КТНЄЙ!  "Ф!Ь6:ЬТ=	!Ц6 !Ю6#6НD2ЭЦЖяџх:ЭЦЖяџБHЎТ%	:Эю
К"	:ЭюяВ#$НЄ:ЮТ;!Ю6 +~ю<К;!Я6 :Эю$ВЁНD2Эю$ВX*ЭMН
ГҐ:ЭЦ02ЭO>	№Тp<НЄГҐ!‘6 Нќ:Эю К”!Э5НK	ТЋГ„НќГxНK	ТҐ*ЧMН
Г”Г"	:Эю^ВъНD2Э:Эю^ВЖ^Н
Гч:Эю@ТЪ:ЭЦ OН
Гч:Эю`То:ЭЦ@OН
Гч:ЭЦ`OН
Г"	:ЭЦ!Цџх:Я/БHЎТ	Н

Н
Г"	*ЭMН
Гт:ЭЦЦџ2ЬН

Н
ГЮ*Ф++"ФяН
Й*‘& 	~2ЧЦ Цџх:ЧЦ ЦџБH±Ъt	!‘4>Й> Й!  "Ф"Щ ЩН\ТУ	!Ш6 >!ШѕЪ·	:ШЩН+Ф	~юяВ°	ГЪ	!Ш4В‘	*ЩФ	DMНЖНБЂ *Щ"ЩГЂ	Ђ НЖЙ*ЩФ	DMНЖНБЂ НЖ!  "	}2иНЈ2:ю К
НЄГµЙ!Ыqя!ФНrТ-
"ННw	*ФФ	:Ыw:ЫюяВC
Нw	*Ф#"ФЙН"б*б#~2ажю2а_ !
 Н8!0 л!оs*а& лН:0 л!пsяНЦ!6 иНі:юяВЖ
иНs НЦиНі:юяВЖ
LН   Н  НЦЙ!  ее`i^#V#~#foН	НЗВн
y·ВowГGю:ВxЦAЪoюТo<wНЗВю.Кoю:Кoю;КoГ6 Нuю.К0НїГ4Нu#6 В6ю;КJНїГNНХН	НЗВ]33Г^Сy·БyБ#q#p#wлА!  Йбб!яяЙНЗКї#ю*ВЉ6?ВuГЊwВuНЗИбГoНЗКї333333Хе. г;;33г,г;;#wКђНЗВ«#6 ВїЙO·И юИOю	Ию ЪИю.Ию:Ию;Ию=Ию,Ию/Ию[Ию]Ию<Ию>ИюaШю{Тж_жЙбГoю Кю	КЙГ	`i~юК<#~2#~2#~2* |ю ЪW\ Н !\ ~·ВRеН б<w
  НoН]2	Нe"ф.^#Vл"л.П~цwН·ВD<zН <{Н е^#VХ#е*  ~юГВ+~юГВ+*ф.ъ~·ВЅ>2ъГй.n~юГКК>2ъ6!.t~юГ:ъКЭюВ+ЇюВз>Ђ2ъ6!бN#F#е*  "ь^q#Vpл"цбN#Fл##" ^q#Vpл"шб4!фС7 НoэН Г  |	Н !ъ6ябГЎ	Н \ Н \ Н Г  ЧГ?>я_ Г 1mГ : ~#y°ВoЙЌЂWARNING: Cannot redirect from BIOS
$ERROR: Auxiliary device redirection not implemented
$ERROR: Insufficient Memory
$       "  л"  ЙГ     SYSIN   SUB                     л_ л…oЊgЙDM!  >х)л—)лЌ‘o|gТQ	с=В?Йi`N#F‘ogЙo& •oњgЙ_ {–_z#ћWлЙ                                                                                                    00001 : $ SYSIN   $$$                         ЂЃ‚                                                                                                                                                      ГFГ  я GET        :у<И*сл*пНфш*н.n6Ги.t6ГЙГLэГL!ё pбе:јЪ~yюКЭюКЭ!к6 юКЭю
КЭю<КЉюВ~л"§лx!лН=F#fhй!нюЂИ:·В~ю‚!ИюЊВ«!©>Ѓ–wюЃВ~:©·ИННЧНЧ!5л*н.ґ~жїw: єА;  Г	:·В~!  9"№1AЕХН#юКu.Иt.ґ~ц@wж :&К/·В3еН–!ё~·6я»	М	б:·Кш~жwГ  ·ВuНcСБЕХy!†ею
КЋюКBюКd{<К‘<Кd!к6 <К–ГНь·ИбН°яН	Н#+~жюwСБ*№щГ~юяКu*№щoЙНd·ИЇ!$4ьХ·яВ®:$!'Н=FxюяЕМ°Б!%~юpАxю
М–xЦ<2&М–>ЙГ	Е'НР*нЄБеХН2.аН2+6.аwН	бСхН2аН2*§лНРЇ2$с·Й*н.¬6ю#6яГ  *н.П~цw#~ж=Й~#В4Й…oР$ЙН–НOШхНѓсЙ! 54ИюИю
Ию	ИюИю Й!кF6яН#юИ·ИxЙНOТѓх>^Нѓсц@_:я·ИГ	лN#е ЕеН–бБюяВ§Ка>юКаю
КаюВЖеЕ*н.Ф>–wБбГ”#wЕеНtбБ~юxВЬюК№Ъ”бpх>НѓсЙ 	8> "  л"  ЙГ    SYSIN   SUB                     Ђ Ђ Ѓhhhhhhhhhhhhhh   WARNING: PROGRAM INPUT IGNORED
$                                                 151282  COPYR '82 DRI gggggggggggggggggggggggggggggg Ђ "D Ђ€! B€H!H@ 	$! €ђ! $„"A!	 D$DHЂH$ђB!" Ђ  	@ A Ѓ„ 
                                           wж :&К/·В3еН–!ё~·6я»	М	б:·Кш~жwГ  ·ВuНcСБЕХy!†ею
КЋюКBюКd{<К‘<Кd!к6 <К–ГНь·ИбН°яН	Н#+~жюwСБ*№щГ~юяКu*№щoЙНd·ИЇ!$4ьХ·яВ®:$!'Н=FxюяЕМ°Б!%~юpАxю
М–xЦ<2&М–>ЙГ	Е'НР*нЄБеХН2.аН2+6.аwН	бСхееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее;******************************************************************************
;*  D R I V E R  *  C P M S Y S 1  *  T h o m a s   H o l t e  *  8 6 0 1 1 3 *
;******************************************************************************
;*									      *
;*	   I / O - D R I V E R S   F O R   T H E   G E N I E  I I I s	      *
;*	   ==========================================================	      *
;*									      *
;*		    M I C R O C O M P U T E R	S Y S T E M		      *
;*		    =======================================		      *
;*									      *
;*									      *
;*  Thomas Holte						 Version 1.1  *
;*									      *
;******************************************************************************

;-----------------------------------------------------------------------------
; [nderung  der  Cursorsteuerung  'ESC	xx  '  Befehle	zur  Worsdstar-
; kompatibilit{t und da ich mit ZCPR  arbeite.
;
; Falls jemand sich mal der Graficm|glichkeiten in einem Anwenderprogramm
; annimmt bitte ich um Nachricht.
; F.Chwolka
;
; Zus{tzlich rungepfuscht hat Volker Dose.
; dies ist ein DRIVER.MAC mit Harddisk-Einbindung einer HD mit OMTI-Controller.
; Folgende [nderungen sind zu beachten :
;
;    1. Harddiskroutinen im Commonbereich sind draussen
;                                                 Dezember 1992
;   
; Uhr auf Software clock eingestellt.
; Video an FBAS-Monitor angepasst (10 SCAN-Lines, zb. SAKATA)  
;
;-----------------------------------------------------------------------------



	.Z80
	.SALL

SASI	EQU  0			;must be true, if Xebec controller installed

	ASEG

;******************************************************************************
;*		  B A N K E D	P A R T   O F	D R I V E R S		      *
;******************************************************************************

	ORG  0000H		;start of 56K bank 0


;ASCII control codes:
NUL	EQU  00H		;null
SOH	EQU  01H		;start of heading
STX	EQU  02H		;start of textЉETX	EQU  03H		;end of text
EOT	EQU  04H		;end of transmission
ENQ	EQU  05H		;enquiry
ACK	EQU  06H		;acknowledge
BEL	EQU  07H		;bell
BS	EQU  08H		;backspace
HT	EQU  09H		;horizontal tabulation
LF	EQU  0AH		;line feed
VT	EQU  0BH		;vertical tabulation
FF	EQU  0CH		;form feed
CR	EQU  0DH		;carriage return
SO	EQU  0EH		;shift out
SI	EQU  0FH		;shift in
DLE	EQU  10H		;data link escape
DC1	EQU  11H		;device control 1
DC2	EQU  12H		;device control 2
DC3	EQU  13H		;device control 3
DC4	EQU  14H		;device control 4
NAK	EQU  15H		;negative acknowledge
SYN	EQU  16H		;synchronous idle
ETB	EQU  17H		;end of transmission block
CAN	EQU  18H		;cancel
EM	EQU  19H		;end of medium
SUB	EQU  1AH		;substitute
ESC	EQU  1BH		;escape
FS	EQU  1CH		;file separator
GS	EQU  1DH		;group separator
RS	EQU  1EH		;record separator
DEL	EQU  7FH		;delete


;common entry point for all driver routines
	PUSH BC			;save contents of reg. B & HL
	PUSH HL
	LD   B,0		;vector # * 2 --> reg. BC
	SLA  C
	LD   HL,DRITBL		;base of vector table --> reg. IX
	ADD  HL,BC		;calc table entry
	LD   C,(HL)		;get entry point of driver routine
	INC  HL
	LD   B,(HL)
	PUSH BC
	POP  IX
	POP  HL			;restore contents of reg. B & HL
	POP  BC
	JP   (IX)		;execute driver routine

	ORG  0036H		;interrupt entry point - 2
	DEFW 0			;checksumm of serial #
	JP   $INT		;jump to interrupt service routine

;table of driver addresses:
DRITBL:	DEFW $VDINIT		;initialize video  controller chip M6845
	DEFW $RSINIT		;initialize RS232C controller chip SIO
	DEFW $KBCHAR		;get a keyboard character if available
	DEFW $KBWAIT		;wait for keyboard character
	DEFW $VDCHAR		;display a character
	DEFW $PRSTAT		;test printer status
	DEFW $PRCHAR		;output a character to the printer
	DEFW $RSRCST		;test RS232C input status
	DEFW $RSRCV		;receive a character from the RS232C interfaceЉ	DEFW $RSTXST		;test RS232C output status
	DEFW $RSTX		;transmit a character to the RS232C interface
	DEFW $READ		;read a sector
	DEFW $WRITE		;write a sector
	DEFW $GETTIM		;get time and date in ASCII format
	DEFW $SETTIM		;set time and date in binary format
	DEFW $XMOVE		;read/write system data
	DEFW $READW		;read a Winchester sector
	DEFW $WRITW		;write a Winchester sector
$GTIME3:DEFW $GTIME3S		;get time and date in CP/M 3 format
$STIME3:DEFW $STIME3S		;set time and date in CP/M 3 format
	DEFW $LDCHAR		;load character pattern
	DEFW $RSTCHR		;restore original character set
	DEFW $SCRNIO		;direct screen I/O
	DEFW $INIT		;general initialization routine
	DEFW $CLOCK		;display time continuously
	DEFW $DISP		;turn on/off graphic display
	DEFW $CLS		;clear graphic screen
	DEFW $PLOT		;plot dot    on graphic screen
	DEFW $POINT		;read dot  from graphic screen
	DEFW $LINE		;draw line   on graphic screen
	DEFW $CIRCLE		;draw circle on graphic screen
	DEFW $ARC		;draw arc    on graphic screen
	DEFW $FILL		;fill shape (not implemented yet)
	DEFW $COPY		;copy area


;EJECT
	ORG  0100H
;******************************************************************************
;*				  S Y S T A B				      *
;******************************************************************************

DELAY1:	DEFW 500		;500/determines debounce time (start of key press)
DELAY2:	DEFW 5000		;determines debounce time (end	 of key press)
DELAY3:	DEFW 25			;35/determines wait time until key autorepeats
DELAY4:	DEFW 3			;determines frequency of auto repeat
KEYTAB:	DEFW NBOARD		;contains ^(keyboard table)

;table contains codes for all caps (may be altered by user):
NBOARD:

;address 3801H (letter keys):
	DEFB '@','`',NUL	;@, SHIFT-@, CTRL-@
	DEFB 'a','A',SOH	;A, SHIFT-A, CTRL-A
	DEFB 'b','B',STX	;B, SHIFT-B, CTRL-B
	DEFB 'c','C',ETX	;C, SHIFT-C, CTRL-C
	DEFB 'd','D',EOT	;D, SHIFT-D, CTRL-D
	DEFB 'e','E',ENQ	;E, SHIFT-E, CTRL-E
	DEFB 'f','F',ACK	;F, SHIFT-F, CTRL-F
	DEFB 'g','G',BEL	;G, SHIFT-G, CTRL-G

;address 3802H (letter keys):
	DEFB 'h','H',BS		;H, SHIFT-H, CTRL-H
	DEFB 'i','I',HT		;I, SHIFT-I, CTRL-I
	DEFB 'j','J',LF		;J, SHIFT-J, CTRL-J
	DEFB 'k','K',VT		;K, SHIFT-K, CTRL-K
	DEFB 'l','L',FF		;L, SHIFT-L, CTRL-L
	DEFB 'm','M',CR		;M, SHIFT-M, CTRL-M
	DEFB 'n','N',SO		;N, SHIFT-N, CTRL-N
	DEFB 'o','O',SI		;O, SHIFT-O, CTRL-OЉ
;address 3804H (letter keys):
	DEFB 'p','P',DLE	;P, SHIFT-P, CTRL-P
	DEFB 'q','Q',DC1	;Q, SHIFT-Q, CTRL-Q
	DEFB 'r','R',DC2	;R, SHIFT-R, CTRL-R
	DEFB 's','S',DC3	;S, SHIFT-S, CTRL-S
	DEFB 't','T',DC4	;T, SHIFT-T, CTRL-T
	DEFB 'u','U',NAK	;U, SHIFT-U, CTRL-U
	DEFB 'v','V',SYN	;V, SHIFT-V, CTRL-V
	DEFB 'w','W',ETB	;W, SHIFT-W, CTRL-W

;address 3808H (letter keys):
	DEFB 'x','X',CAN	;X, SHIFT-X, CTRL-X
	DEFB 'y','Y',EM		;Y, SHIFT-Y, CTRL-Y
	DEFB 'z','Z',SUB	;Z, SHIFT-Z, CTRL-Z
	DEFB '[','{',ESC	;[, SHIFT-[, CTRL-[
	DEFB '\','|',FS		;\, SHIFT-\, CTRL-\
	DEFB ']','}',GS		;], SHIFT-], CTRL-]
	DEFB '^','~',RS		;^, SHIFT-^, CTRL-^
	DEFB '_','^',RS		;_, SHIFT-_, CTRL-_

;address 3810H (number keys):
	DEFB '0','0',0		;0, SHIFT-0, CTRL-0
	DEFB '1','!',0		;1, SHIFT-1, CTRL-1
	DEFB '2','"',0		;2, SHIFT-2, CTRL-2
	DEFB '3','#',0		;3, SHIFT-3, CTRL-3
	DEFB '4','$',0		;4, SHIFT-4, CTRL-4
	DEFB '5','%',0		;5, SHIFT-5, CTRL-5
	DEFB '6','&',0		;6, SHIFT-6, CTRL-6
	DEFB '7','''',0		;7, SHIFT-7, CTRL-7

;address 3820H (number & special keys):
	DEFB '8','(',0		;8, SHIFT-8, CTRL-8
	DEFB '9',')',0		;9, SHIFT-9, CTRL-9
	DEFB ':','*',0		;:, SHIFT-:, CTRL-:
	DEFB ';','+',0		;;, SHIFT-;, CTRL-;
	DEFB ',','<',0		;,, SHIFT-,, CTRL-,
	DEFB '-','=',0		;-, SHIFT--, CTRL--
	DEFB '.','>',0		;., SHIFT-., CTRL-.
	DEFB '/','?',0		;/, SHIFT-/, CTRL-/

;address 3840H (special keys):
	DEFB CR,CR,0		;NEWLINE   , SHIFT-NEWLINE   , CTRL-NEWLINE
	DEFB DEL,0FCH,0		;CLEAR	   , SHIFT-CLEAR     , CTRL-CLEAR
	DEFB ESC,0FDH,0		;BREAK	   , SHIFT-BREAK     , CTRL-BREAK
	DEFB ENQ,VT,ETB		;STX/ UP-ARROW	, SHIFT-UP-ARROW  , CTRL-UP-ARROW
	DEFB CAN,ETX,SUB	;LF/ DOWN-ARROW, SHIFT-DOWN-ARROW, CTRL-DOWN-ARROW
	DEFB DC3,CAN,BS		;SOH/ LEFT-ARROW, SHIFT-LEFT-ARROW, CTRL-LEFT-ARROW
	DEFB EOT,HT,BEL		;ACK/ RGHT-ARROW, SHIFT-RGHT-ARROW, CTRL-RGHT-ARROW
	DEFB ' ',' ',0		;SPACE	   , SHIFT-SPACE     , CTRL-SPACE

;address 38A0H (function keys):
	DEFB 80H,80H,0		;F1, SHIFT-F1, CTRL-F1
	DEFB 81H,81H,0		;F2, SHIFT-F2, CTRL-F2
	DEFB 82H,82H,0		;F3, SHIFT-F3, CTRL-F3
	DEFB 83H,83H,0		;F4, SHIFT-F4, CTRL-F4
	DEFB 84H,84H,0		;F5, SHIFT-F5, CTRL-F5
	DEFB 85H,85H,0		;F6, SHIFT-F6, CTRL-F6
	DEFB 86H,86H,0		;F7, SHIFT-F7, CTRL-F7
	DEFB 87H,87H,0		;F8, SHIFT-F8, CTRL-F8
Љ;address 38C0H (number keys [numeric keypad]):
	DEFB '0','0',0		;1, SHIFT-1, CTRL-1
	DEFB '1','1',0		;2, SHIFT-2, CTRL-2
	DEFB '2','3',0		;3, SHIFT-3, CTRL-3
	DEFB '3','3',0		;4, SHIFT-4, CTPL-4
	DEFB '4','4',0		;5, SHIFT-5, CTRL-5
	DEFB '5','5',0		;6, SHIFT-6, CTRL-6
	DEFB '6','6',0		;7, SHIFT-7, CTRL-7
	DEFB '7','7',0		;8, SHIFT-8, CTRL-8

;address 3880H (function keys & escape key):
	DEFB 0,0,0		;SHIFT
	DEFB 0,0,0		;CTRL
	DEFB ESC,ESC,0		;ESC
	DEFB 8CH,8CH,0		;P5, SHIFT-P5, CTRL-P5
	DEFB 8BH,8BH,0		;P4, SHIFT-P4, CTRL-P4
	DEFB 8AH,8AH,0		;P3, SHIFT-P3, CTRL-P3
	DEFB 89H,89H,0		;P2, SHIFT-P2, CTRL-P2
	DEFB 88H,88H,0		;P1, SHIFT-P1, CTRL-P1

;address 38E0H (number & special keys [numeric keypad]):
	DEFB '8','8',0		;8 , SHIFT-8 , CTRL-8
	DEFB '9','9',0		;9 , SHIFT-9 , CTRL-9
	DEFB 0FEH,0FEH,0	;00, SHIFT-00, CTRL-00
	DEFB 0,0,0		;LOCK
	DEFB ',',',',0		;, , SHIFT-, , CTRL-,
	DEFB '-','-',0		;- , SHIFT-- , CTRL--
	DEFB '.','.',0		;. , SHIFT-. , CTRL-.
	DEFB 0,0FBH,0		;SHIFT-PRINT


;EJECT
;table contains codes for all caps (special WordStar version):
WBOARD:

;address 3801H (letter keys):
	DEFB '@','`',NUL	;@, SHIFT-@, CTRL-@
	DEFB 'a','A',SOH	;A, SHIFT-A, CTRL-A
	DEFB 'b','B',STX	;B, SHIFT-B, CTRL-B
	DEFB 'c','C',ETX	;C, SHIFT-C, CTRL-C
	DEFB 'd','D',EOT	;D, SHIFT-D, CTRL-D
	DEFB 'e','E',ENQ	;E, SHIFT-E, CTRL-E
	DEFB 'f','F',ACK	;F, SHIFT-F, CTRL-F
	DEFB 'g','G',BEL	;G, SHIFT-G, CTRL-G

;address 3802H (letter keys):
	DEFB 'h','H',BS		;H, SHIFT-H, CTRL-H
	DEFB 'i','I',HT		;I, SHIFT-I, CTRL-I
	DEFB 'j','J',LF		;J, SHIFT-J, CTRL-J
	DEFB 'k','K',VT		;K, SHIFT-K, CTRL-K
	DEFB 'l','L',FF		;L, SHIFT-L, CTRL-L
	DEFB 'm','M',CR		;M, SHIFT-M, CTRL-M
	DEFB 'n','N',SO		;N, SHIFT-N, CTRL-N
	DEFB 'o','O',SI		;O, SHIFT-O, CTRL-O

;address 3804H (letter keys):
	DEFB 'p','P',DLE	;P, SHIFT-P, CTRL-P
	DEFB 'q','Q',DC1	;Q, SHIFT-Q, CTRL-Q
	DEFB 'r','R',DC2	;R, SHIFT-R, CTRL-R
	DEFB 's','S',DC3	;S, SHIFT-S, CTRL-S
	DEFB 't','T',DC4	;T, SHIFT-T, CTRL-TЉ	DEFB 'u','U',NAK	;U, SHIFT-U, CTRL-U
	DEFB 'v','V',SYN	;V, SHIFT-V, CTRL-V
	DEFB 'w','W',ETB	;W, SHIFT-W, CTRL-W

;address 3808H (letter keys):
	DEFB 'x','X',CAN	;X, SHIFT-X, CTRL-X
	DEFB 'y','Y',EM		;Y, SHIFT-Y, CTRL-Y
	DEFB 'z','Z',SUB	;Z, SHIFT-Z, CTRL-Z
	DEFB '[','{',ESC	;[, SHIFT-[, CTRL-[
	DEFB '\','|',FS		;\, SHIFT-\, CTRL-\
	DEFB ']','}',GS		;], SHIFT-], CTRL-]
	DEFB '^','~',RS		;^, SHIFT-^, CTRL-^
	DEFB '_','^',RS		;_, SHIFT-_, CTRL-_

;address 3810H (number keys):
	DEFB '0','0',0		;0, SHIFT-0, CTRL-0
	DEFB '1','!',0		;1, SHIFT-1, CTRL-1
	DEFB '2','"',0		;2, SHIFT-2, CTRL-2
	DEFB '3','#',0		;3, SHIFT-3, CTRL-3
	DEFB '4','$',0		;4, SHIFT-4, CTRL-4
	DEFB '5','%',0		;5, SHIFT-5, CTRL-5
	DEFB '6','&',0		;6, SHIFT-6, CTRL-6
	DEFB '7','''',0		;7, SHIFT-7, CTRL-7

;address 3820H (number & special keys):
	DEFB '8','(',0		;8, SHIFT-8, CTRL-8
	DEFB '9',')',0		;9, SHIFT-9, CTRL-9
	DEFB ':','*',0		;:, SHIFT-:, CTRL-:
	DEFB ';','+',0		;;, SHIFT-;, CTRL-;
	DEFB ',','<',0		;,, SHIFT-,, CTRL-,
	DEFB '-','=',0		;-, SHIFT--, CTRL--
	DEFB '.','>',0		;., SHIFT-., CTRL-.
	DEFB '/','?',0		;/, SHIFT-/, CTRL-/

;address 3840H (special keys):
	DEFB CR,CR,0		;NEWLINE   , SHIFT-NEWLINE   , CTRL-NEWLINE
	DEFB 8DH,8EH,DEL	;CLEAR	   , SHIFT-CLEAR     , CTRL-CLEAR
				;CLEAR	     = erase to end of line
				;SHIFT-CLEAR = erase to start of line
				;CTRL -CLEAR = erase previous character
	DEFB NAK,0FDH,0		;BREAK	   , SHIFT-BREAK     , CTRL-BREAK
				;BREAK = abort current operation
	DEFB ENQ,8FH,90H	;UP-ARROW  , SHIFT-UP-ARROW  , CTRL-UP-ARROW
				;      UP-ARROW = cursor up
				;SHIFT-UP-ARROW = start of text
				;CTRL -UP-ARROW = start of screen
	DEFB CAN,91H,92H	;DOWN-ARROW, SHIFT-DOWN-ARROW, CTRL-DOWN-ARROW
				;      DOWN-ARROW = cursor down
				;SHIFT-DOWN-ARROW = end of text
				;CTRL -DOWN-ARROW = end of screen
	DEFB DC3,93H,SOH	;LEFT-ARROW, SHIFT-LEFT-ARROW, CTRL-LEFT-ARROW
				;      LEFT-ARROW = cursor left
				;SHIFT-LEFT-ARROW = start of line
				;CTRL -LEFT-ARROW = word left
	DEFB EOT,94H,ACK	;RGHT-ARROW, SHIFT-RGHT-ARROW, CTRL-RGHT-ARROW
				;      RIGHT-ARROW = cursor right
				;SHIFT-RIGHT-ARROW = end of line
				;CTRL -RIGHT-ARROW = word right
	DEFB ' ',' ',95H	;SPACE	   , SHIFT-SPACE     , CTRL-SPACE
				;CTRL-SPACE = hard space
Љ;address 38A0H (function keys):
	DEFB SYN,SYN,0		;F1, SHIFT-F1, CTRL-F1
				;F1 = toggle insert mode
	DEFB SO,SO,0		;F2, SHIFT-F2, CTRL-F2
				;F2 = insert line
	DEFB BEL,BEL,0		;F3, SHIFT-F3, CTRL-F3
				;F3 = delete character
	DEFB DC4,DC4,0		;F4, SHIFT-F4, CTRL-F4
				;F4 = delete word
	DEFB EM,EM,0		;F5, SHIFT-F5, CTRL-F5
				;F5 = delete line
	DEFB STX,STX,0		;F6, SHIFT-F6, CTRL-F6
				;F6 = reformat paragraph
	DEFB 96H,96H,0		;F7, SHIFT-F7, CTRL-F7
				;F7 = toggle hyphen help
	DEFB 97H,97H,0		;F8, SHIFT-F8, CTRL-F8
				;F8 = toggle right justifying

;address 38C0H (number keys [numeric keypad]):
	DEFB '0','0',0		;1, SHIFT-1, CTRL-1
	DEFB '1','1',0		;2, SHIFT-2, CTRL-2
	DEFB '2','3',0		;3, SHIFT-3, CTRL-3
	DEFB '3','3',0		;4, SHIFT-4, CTRL-4
	DEFB '4','4',0		;5, SHIFT-5, CTRL-5
	DEFB '5','5',0		;6, SHIFT-6, CTRL-6
	DEFB '6','6',0		;7, SHIFT-7, CTRL-7
	DEFB '7','7',0		;8, SHIFT-8, CTRL-8

;address 3880H (function keys & escape key):
	DEFB 0,0,0		;SHIFT
	DEFB 0,0,0		;CTRL
	DEFB ESC,ESC,0		;ESC
	DEFB ETX,ETX,0		;P5, SHIFT-P5, CTRL-P5
				;P5 = page down
	DEFB DC2,DC2,0		;P4, SHIFT-P4, CTRL-P4
				;P4 = page up
	DEFB SUB,SUB,0		;P3, SHIFT-P3, CTRL-P3
				;P3 = line down
	DEFB ETB,ETB,0		;P2, SHIFT-P2, CTRL-P2
				;P2 = line up
	DEFB HT,HT,0		;P1, SHIFT-P1, CTRL-P1
				;P1 = TAB

;address 38E0H (number & special keys [numeric keypad]):
	DEFB '8','8',0		;8 , SHIFT-8 , CTRL-8
	DEFB '9','9',0		;9 , SHIFT-9 , CTRL-9
	DEFB 0FEH,0FEH,0	;00, SHIFT-00, CTRL-00
	DEFB 0,0,0		;LOCK
	DEFB ',',',',0		;, , SHIFT-, , CTRL-,
	DEFB '-','-',0		;- , SHIFT-- , CTRL--
	DEFB '.','.',0		;. , SHIFT-. , CTRL-.
	DEFB 0,0FBH,0		;SHIFT-PRINT


;EJECT
VECTOR:	DEFW FKEYS		;function key vector

OFFSET	DEFL 0			;initialize offset

FKEYS:	REPT 13			;function key pointer
	DEFW F0+OFFSETЉOFFSET	DEFL OFFSET+81
	 ENDM
	DEFW ERAEND,ERABEG,SOTXT,SOCRT,EOTXT,EOCRT
	DEFW SOLIN,EOLIN,HSPACE,HYPHEN,JSTIFY

F0:
;	.XLIST
	REPT 13			;function key buffer
	DEFB 1
	REPT 80
	DEFB 0
	 ENDM
	 ENDM
	.LIST

;special WordStar part:
ERAEND:	DEFB 2			;erase to end of line
	DEFB DC1,'Y',0
ERABEG:	DEFB 2			;erase to start of line
	DEFB DC1,DEL,0
SOTXT:	DEFB 2			;start of text
	DEFB DC1,'R',0
SOCRT:	DEFB 2			;start of screen
	DEFB DC1,'E',0
EOTXT:	DEFB 2			;end of text
	DEFB DC1,'C',0
EOCRT:	DEFB 2			;end of screen
	DEFB DC1,'X',0
SOLIN:	DEFB 2			;start of line
	DEFB DC1,'S',0
EOLIN:	DEFB 2			;end of line
	DEFB DC1,'D',0
HSPACE:	DEFB 2			;hard space
	DEFB DLE,'O',0
HYPHEN:	DEFB 2			;toggle hyphen help
	DEFB SI,'H',0
JSTIFY:	DEFB 2			;toggle right justifying
	DEFB SI,'J',0


;EJECT
;table of control codes:
;  first byte = 0	single ASCII control code
;  first byte = 0FFH	escape sequence

TAB1S:	DEFB 0,BEL		;beep
	DEFB 0,BS		;cursor left
        DEFB 0,LF		;cursor down
	DEFB 0,VT		;cursor up
	DEFB 0,FF		;cursor right
	DEFB 0,CR		;carriage return
	DEFB 0,RS		;home cursor
TAB2S:	DEFB 0FFH,'='		;absolute cursor addressing

	DEFB 0FFH,'F'		;select window
	DEFB 0FFH,'I'		;set top line
	DEFB 0FFH,'J'		;set bottom line
	DEFB 0FFH,'K'		;set left column
	DEFB 0FFH,'L'		;set right column

TAB2E:	DEFB 0FFH,' '		;set erase characterЉ	DEFB 0FFH,FF		;cursor off
	DEFB 0FFH,CR		;cursor on
	DEFB 0FFH,'A'		;ASCII character set
	DEFB 0FFH,'D'		;disable status line
	DEFB 0FFH,'E'		;enable status line
	DEFB 0FFH,'G'		;German character set
	DEFB 0FFH,'N'		;normal keyboard
	DEFB 0FFH,'O'		;WordStar keyboard
	DEFB 0FFH,'R'		;inverse display mode
	DEFB 0FFH,'S'		;normal display mode
	DEFB 0FFH,'X'		;turn on wrap around mode
	DEFB 0FFH,'Y'		;turn off wrap around mode

	DEFB 0FFH,'P'		;insert character
	DEFB 0FFH,'V'		;insert line
	DEFB 0FFH,'Q'		;delete char
	DEFB 0,CAN		;erase to end of line
	DEFB 0FFH,'W'		;delete line
	DEFB 0,EM		;erase to end of screen
TAB1E:	DEFB 0,SUB		;clear screen


;EJECT
	INCLUDE	FONT12		;font set


;drive control tables (5 inch):

;drive 0:
DCT:	DEFB 01110000B		;bit 7	 : reserved
				;bit 6	 : no. of	  0 = single sided
				;	   surfaces	  1 = double sided
				;bit 5	 : density	  0 = single density
				;			  1 = double density
				;bit 4	 : desity of	  0 = single density
				;	   first track	  1 = double density
				;bit 3	 : no. of first   0 = zero
				;	   sec. on track  1 = one
				;bit 2	 : steps per	  0 = one step
				;	   trk to trk	  1 = two steps
				;bits 1,0: track stepping rate
				;	   0 =	3 msec	  1 =  6 msec
				;	   2 = 10 msec	  3 = 15 msec
	DEFB 10000000B		;bits 7,6: sector length
				;	   0 = 128 bytes  1 =  256 bytes
				;	   2 = 512 bytes  3 = 1024 bytes
				;bit 5	 : 0 = new sector numbering on backside
				;	   1 = sector numbering continued on
				;	       backside
				;bit 0	 : drive status (used by disk driver --
				;			 do not alter)
	DEFB 2			;interleaving factor
	DEFB 20			;sector count per track
	DEFB 80			;number of usable tracks
	DEFB 0			;current track

;drive 1:
	DEFB 01110000B
	DEFB 10000000B
	DEFB 2
	DEFB 20Љ	DEFB 80
	DEFB 0

;drive 2:
	DEFB 01110000B,10000000B,2,20,80,0

;drive 3:
	DEFB 01110000B,10000000B,2,20,80,0


;drive control tables (8 inch):
;FRiTZ 1,2MB:
;drive 0:

	DEFB 01110000B		   ;No of first sect on track = 1
	DEFB 10000000B		   ;Sect numbering continued  on back
	DEFB 3
	DEFB 32
	DEFB 80
	DEFB 0

;drive 1:
	DEFB 01110000B,10000000B,3,32,80,0

;drive 2:
	DEFB 01110000B,10000000B,3,32,80,0

;drive 3:
	DEFB 01110000B,10000000B,3,32,80,0



TRYS:	DEFB 10			;# of times to try I/O until routine gives up


;EJECT
;Winchester disk control tables:

;drive 0:
DCTW:	DEFB 01100000B		;bits 7-5: no. of surfaces
				;	   0 = one   head    4 = five  heads
				;	   1 = two   heads   5 = six   heads
				;	   2 = three heads   6 = seven heads
				;	   3 = four  heads   7 = eight heads
				;bit 4	 : no. of first      0 = zero
				;	   sector on track   1 = one
				;bits 3-0: track stepping rate
				;0 = 35  usec	 6 = 3.0 msec	11 = 5.5 msec
				;1 = 0.5 msec	 7 = 3.5 msec	12 = 6.0 msec
				;2 = 1.0 msec	 8 = 4.0 msec	13 = 6.5 msec
				;3 = 1.5 msec	 9 = 4.5 msec	14 = 7.0 msec
				;4 = 2.0 msec	10 = 5.0 msec	15 = 7.5 msec
				;5 = 2.5 msec
	DEFB 10000000B		;bits 7,6: sector length
				;	   0 =	256 bytes  1 = 512 bytes
				;	   2 = 1024 bytes  3 = 128 bytes
				;bit 0	 : drive status (used by disk driver --
				;			 do not alter)
	DEFB 32			;starting track for write precomp / 4
	DEFB 1			;interleaving factor
	DEFB 9			;sector count per trackЉ	DEFW 1440		;number of usable tracks

;drive 1:
	DEFB 00100000B
	DEFB 10000000B
	DEFB 0FFH
	DEFB 1
	DEFB 9
	DEFW 612

;drive 2:
	DEFB 00100000B,01000000B,0,1,16
	DEFW 1224


;EJECT
;powerup/reset parameters:

;powerup/reset marker:
POWUP:	DEFS 1

;table of video parameters:
VIDPAR:	DEFB 110		;horizontal total
	DEFB 80			;horizontal displayed
	DEFB 88			;h sync position
	DEFB 5			;h sync width
	DEFB 28			;vertical total
	DEFB 4			;v total adjust
	DEFB 25			;vertical displayed
	DEFB 25			;v sync position
	DEFB 0			;interlace mode (non interlace)
	DEFB 10			;max scan line address
	DEFB 106		;cursor start
	DEFB 10			;cursor end
	DEFB 0			;start address (H)
	DEFB 0			;start address (L)
	DEFB 0			;cursor (H)
	DEFB 0			;cursor (L)

;character set:
CHRSET:	DEFB 'G'		;'A' = ASCII  character set
				;'G' = German character set

;RS-232-C parameters:
SER0:	DEFB 11000100B
	DEFB 11

SER1:	DEFB 11000100B
	DEFB 8

;clock ?
CLOCK:	DEFB 0			;0 = software clock
				;1 = hardware clock


;EJECT
;*******************
;*  $ V D I N I T  *
;*******************

;entry: HL = address of video parameter tableЉ
;  struct {
;	    char R0, R1, R2 , R3 , R4 , R5 , R6 , R7 ,
;		 R8, R9, R10, R11, R12, R13, R14, R15;
;	  } *HL;

;  R0  = This 8 bit write-only register determines the horizontal frequency of
;	 HS. It is the total of displayed plus non-displayed character time
;	 units minus one.
;  R1  = This 8 bit write-only register determines the number of displayed
;	 characters per horizontal line.
;  R2  = This 8 bit write-only register determines the horizontal sync position
;	 on the horizontal line.
;  R3  = This 4 bit write-only register determines the width of the HS pulse.
;	 It may not be apparent why this width needs to be programmed. However,
;	 consider that all timing widths must be programmed as multiples of the
;	 character clock period which varies. If HS width were fixed as an
;	 integral number of character times, it would vary with character rate
;	 and be out of tolerance for certain monitors. The rate programmable
;	 feature allows compensating HS width.
;  R4
;  R5  = The vertical frequency of VS is determined by both R4 and R5. The
;	 calculated number of character line times is usually an integer plus a
;	 fraction to get exactly a 50 or 60 Hz vertical refresh rate. The
;	 integer number of character line times minus one is programmed in the
;	 7 bit write-only Vertical Total Register (R4); the fraction is
;	 programmed in the 5 bit write-only Vertical Scan Adjust Register (R5)
;	 as a number of scan line times.
;  R6  = This 7 bit write-only register determines the number of displayed
;	 character rows on the CRT screen, and is programmed in character row
;	 times.
;  R7  = This 7 bit write-only register determines the vertical sync position
;	 with respect to the reference. It is programmed in character row
;	 times.
;  R8  = This 2 bit write-only register controls the raster scan mode. When bit
;	 0 and bit 1 are reset, or bit 0 is reset and bit 1 set, the non-
;	 interlace raster scan mode is selected. Two interlace modes are
;	 available. Both are interlaced 2 fields per frame. When bit 0 is set
;	 and bit 1 is reset, the interlace sync raster scan mode is selected.
;	 Also when bit 0 and bit 1 are set, the interlace sync and video raster
;	 scan mode is selected.
;  R9  = This 5 bit write-only register determines the number of scan lines per
;	 character row including spacing. The programmed value is a max address
;	 and is one less than the number of scan lines.
;  R10 = This 7 bit write-only register controls the cursor format. Bit 5 is
;	 the blink timing control. When bit 5 is low, the blink frequency is
;	 1/16 of the vertical field rate, and when bit 5 is high, the blink
;	 frequency is 1/32 of the vertical field rate. Bit 6 is used to enable
;	 a blink. The cursor start scan line is set by the lower 5 bits.
;  R11 = This 5 bit write-only register sets the cursor end scan line.
;  R12
;  R13 = Start Address Register is a 14 bit write-only register which
;	 determines the first address put out as a refresh address after
;	 vertical blanking. It consists of an 8 bit lower register (R13), and a
;	 6 bit higher register (R12).
;  R14
;  R15 = This 14 read/write register stores the cursor location. This register
;	 consists of an 8 bit lower (R15) and 6 bit higher (R14) register.

$CRTREG	EQU  0F6H		;CRT controller address register
$CRTCMD	EQU  0F7H		;CRTC command registerЉ
;initialize the video controller chip M6845:
$VDINIT:LD   A,10H		;source      bank = 1
				;destination bank = 0
VDINIT1:LD   DE,$VIDPAR		;^temp buffer		   --> reg. DE
	LD   B,16		;length of parameter table --> reg. B
	CALL $XMOVE		;get video parameter table
	LD   BC,1000H		;CRTC register count	   --> reg.  B
				;CRTC start register	   --> reg.  C
	LD   HL,$VIDPAR		;^video parameter table    --> reg. HL
OUTCMD:	LD   A,C		;CRTC register no.	   --> accu
	OUT  ($CRTREG),A	;select CRTC register
	LD   A,(HL)		;video parameter --> accu
	OUT  ($CRTCMD),A	;output CRTC command
	INC  HL			;bump ^video parameter
	INC  C			;increment CRTC register no.
	DJNZ OUTCMD		;output 16 parameters
	LD   A,($VIDPAR+10)	;get control byte for cursor start
	LD   (CURBEG),A		;store it for subsequent use
	RET			;return to caller

CURBEG:	DEFS 1			;temporary storage for cursor start byte
$VIDPAR:DEFS 16			;temporary buffer for video parameter table


;EJECT
;*******************
;*  $ R S I N I T  *
;*******************

;entry: B = number  of RS232C interface (0, 1)
;	A = data format
;	E = baud rate

;  A
;  Bit	  0: 0 = no   parity
;	     1 =      parity
;  Bit	  1: 0 = odd  parity
;	     1 = even parity
;  Bits 3-2: 1 = 1   stop bit
;	     2 = 1.5 stop bits
;	     3 = 2   stop bits
;  Bits 7-6: 0 = 5 bits word length
;	     1 = 7 bits word length
;	     2 = 6 bits word length
;	     3 = 8 bits word length

;	    Desired Baud Rate  | reg. E
;	  =====================|=======
;		 50	       |   2
;		 75	       |   3
;		110	       |  15
;		134.5	       |   4
;		150	       |  14
;		200	       |   5
;		300	       |  13
;		600	       |   6
;	       1200	       |  11
;	       1800	       |  10
;	       2400	       |   7
;	       4800	       |   9Љ;	       9600	       |   8
;	      19200	       |   0


RATE	EQU  0F1H		;baud rate register
BTX	EQU  0F2H		;dual baud rate register

;calc initialization routine entry:
$RSINIT:LD   HL,RSTAB		;base of entry table --> reg. HL
	LD   C,B		;calc table entry
	LD   B,0
	SLA  C
	ADD  HL,BC
	LD   C,(HL)		;get entry address
	INC  HL
	LD   H,(HL)
	LD   L,C
	JP   (HL)		;execute initialization routine

;RS232C initialization driver entry routine:
RSTAB:	DEFW RSINIA,RSINIB

;control register of SIO A:
WR0A	EQU  0D2H

RSINIA:	LD   C,A		;save data format
	AND  0C0H		;mask word length bits
	SET  0,A		;receiver enable
	LD   (WR3A),A		;load write register 3
	LD   A,C		;restore data format
	AND  0FH		;mask stop bits and parity
	SET  6,A		;x 16 clock mode
	LD   (WR4A),A		;load write register 4
	LD   A,C		;restore data format
	RRA
	AND  60H		;mask word length bits
	OR   88H		;set DTR, transmitter enable
	LD   (WR5A),A		;load write register 5
	LD   A,B		;relative port number --> accu
	OR   A
	IN   A,(RATE)		;read baud rates
	AND  0F0H		;mask baud rate of channel A
	LD   HL,INITBLA
	JR   RSINIB1

INITBLA:DEFB 1
	DEFB BTX
	DEFB 0
	DEFB 9
	DEFB WR0A
	DEFB 18H		;channel reset
	DEFB 1
	DEFB 0			;disable interrupts
	DEFB 4
WR4A:	DEFS 1
	DEFB 5
WR5A:	DEFS 1
	DEFB 3
WR3A:	DEFS 1
	DEFB 0
Љ
;EJECT
;control register of SIO B:
WR0B	EQU  0D3H

RSINIB:	LD   C,A		;save data format
	AND  0C0H		;mask word length bits
	SET  0,A		;receiver enable
	LD   (WR3B),A		;load write register 3
	LD   A,C		;restore data format
	AND  0FH		;mask stop bits and parity
	SET  6,A		;x 16 clock mode
	LD   (WR4B),A		;load write register 4
	LD   A,C		;restore data format
	RRA
	AND  60H		;mask word length bits
	OR   88H		;set DTR, transmitter enable
	LD   (WR5B),A		;load write register 5
	LD   A,B		;relative port number --> accu
	OR   A
	IN   A,(RATE)		;read baud rates
	AND  0FH		;mask baud rate of channel B
	SLA  E			;shift baud rate code into upper nibble
	SLA  E
	SLA  E
	SLA  E
	LD   HL,INITBLB
RSINIB1:OR   E			;set baud rate
	OUT  (RATE),A		;output baud rate
RSINIB2:LD   A,(HL)
	OR   A			;end of table ?
	RET  Z			;return if yes
	LD   B,A		;byte count  --> reg. B
	INC  HL			;bump table pointer
	LD   C,(HL)		;port number --> reg. C
	INC  HL			;bump table pointer
	OTIR			;output bytes
	JR   RSINIB2		;output next byte stream

INITBLB:DEFB 1
	DEFB BTX
	DEFB 0
	DEFB 9
	DEFB WR0B
	DEFB 18H		;channel reset
	DEFB 1
	DEFB 0			;disable interrupts
	DEFB 4
WR4B:	DEFS 1
	DEFB 5
WR5B:	DEFS 1
	DEFB 3
WR3B:	DEFS 1
	DEFB 0


;EJECT
;*******************
;*  $ K B C H A R  *
;*******************
Љ;exit: A = char (0 = no char available)

$SYS0	EQU  0F9H		;bank select port 0
$SYS1	EQU  0FAH		;bank select port 1

;get a keyboard character if available:
$KBCHAR:LD   A,(RDYKEY)		;active key ?
	OR   A
	RET  NZ			;return if yes
	DI			;disable the interrupts
	LD   A,(KLEN)		;A = buffer length
	OR   A			;jump if
	JR   Z,KBCHAR2		;buffer empty
	DEC  A			;dec the length
	LD   (KLEN),A		;save it
	LD   HL,(CPTR)		;HL = character pointer
	LD   A,(HL)		;A = key value
	LD   (RDYKEY),A		;store it
	INC  HL			;bump pointer
	LD   DE,KBUF+80		;DE = end of bufferr pointer
	EX   DE,HL		;swap the pointers
	SBC  HL,DE		;wrap around the buffer ?
	EX   DE,HL		;swap the pointers
	JR   NZ,KBCHAR1		;jump if no wrap around
	LD   HL,KBUF		;HL = new pointer
KBCHAR1:LD   (CPTR),HL		;save the pointer
KBCHAR2:EI			;reenable interrupts
	RET			;return

KLEN:	DEFB 0			;number of active keys
EPTR:	DEFW KBUF		;pointer to next free location
CPTR:	DEFW KBUF		;pointer to first active key
KBUF:	DEFS 80			;type ahead buffer

;EJECT
;this area makes the preliminary check of keyboard rows:
$SCAN:	IN   A,($SYS1)		;read system byte 1
	PUSH AF			;save it
	AND  11000110B		;enable memory mapped I/O
				;disable graphic page
				;enable keyboard
	OR   01000100B		;disable boot EPROM
				;7.2 MHz clock frequency
	OUT  ($SYS1),A		;write system byte 1
	CALL SCAN		;scan keyboard
	LD   C,A		;code of scanned key --> reg. C
	POP  AF			;restore system byte 1
	OUT  ($SYS1),A		;write it
	RET			;return to interrupt service routine

SCAN:	LD   HL,KEYHLD		;HL = keyboard work area ptr
	LD   IX,KEYBRD		;IX = row address table ptr
	LD   BC,38E0H		;BC = row A10 ptr
	LD   D,10		; E = column index
	LD   A,(BC)		;load row 10
	AND  0F7H		;mask out LOCK key
	LD   E,A		;8 column bits
	XOR  (HL)		;XOR with previous
	LD   (HL),E		;store column bits in buffer
	AND  E			;then test for active row
	JR   NZ,ACTIVE		;go if key active in row 10Љ	DEC  D			;decrement row index
	INC  HL			;eleven byte buffer indexed by row
	LD   C,(IX)		;row address (LSB) --> reg. C
	LD   A,(BC)		;load row 9
	AND  0FCH		;mask out SHIFT + CTRL keys
	LD   E,A		;8 column bits
	XOR  (HL)		;XOR with previous
	LD   (HL),E		;store column bits in buffer
	AND  E			;then test for active row
	JR   NZ,ACTIVE		;go if key active in row 9
	INC  IX			;increment ^row address table
	DEC  D			;decrement row index
CHKKEY:	INC  HL			;ten byte buffer indexed by row
	LD   C,(IX)		;row address (LSB) --> reg. C
	LD   A,(BC)		;load row N
	LD   E,A		;8 column bits
	XOR  (HL)		;XOR with previous
	LD   (HL),E		;store column bits in buffer
	AND  E			;then test for active row
	JR   NZ,ACTIVE		;go if key active in row N
	INC  IX			;increment ^row address table
	DEC  D			;decrement row index
	JP   P,CHKKEY		;try next row

;check for previous key:
	PUSH AF			;save column bits
	LD   HL,(OLDROW)	;^previous row	 --> reg. HL
	LD   A,(OLCLMN)		;old column bits --> accu
	AND  (HL)		;previous key active ?
	JR   NZ,PREV		;jump to wait/repeat procedure if yes
	XOR  A			;clear repeat mode
	LD   (REPEAT),A
	LD   H,A
	LD   L,A
	LD   (COUNT1),HL	;reset first counter
	LD   HL,(DELAY3)	;preset second counter
	LD   (COUNT2),HL
	POP  AF			;restore column bits
	RET			;no key depression - return

;delay routine until key autorepeats:
PREV:	PUSH AF			;save previous column bits
	PUSH HL			;save previous row
	LD   HL,(COUNT1)	;increment first counter
	INC  HL
	LD   (COUNT1),HL
	LD   DE,(COUNT2)	;and compare it with second counter
	LD   A,H
	CP   D
	JR   NZ,REST
	LD   A,L
	CP   E
REST:	POP  HL			;restore previous row
	JR   NZ,RTN		;return if first counter <> second counter
	POP  AF			;restore previous column bits
	CPL			;clear previous row
	AND  (HL)
	LD   (HL),A
	LD   A,1		;set repeat mode
	LD   (REPEAT),A
	LD   HL,0		;clear first counterЉ	LD   (COUNT1),HL
	LD   HL,(DELAY4)	;initialize second counter
	LD   (COUNT2),HL
	POP  AF			;adjust stack pointer
	JR   SCAN		;scan keyboard again
RTN:	POP  AF			;restore column bits
	POP  AF
	RET			;no key active - return

;fist debounce routine:
ACTIVE:	LD   E,A		;save column bits
	PUSH BC			;save active row address
	LD   BC,(DELAY1)	;delay count value
	CALL DELAY		;delay for 7.33 milliseconds (may be varied)
	POP  BC			;restore row address
	LD   A,(BC)		;and reload original flags from active row
	AND  E			;then combine current flag bits with original
				;flag bits
	RET  Z			;rtn to caller if zero because row was not
				;active on 2nd test
	LD   (OLDROW),HL	;save row

;calculate ordinal number of pressed key:
	LD   A,D		;otherwise we have a legimately active row
	RLCA			;row index * 2
	RLCA			;row index * 4
	RLCA			;row index * 8
	LD   D,A		;save in D
	LD   C,1		;start with bit 0
AGAIN:	LD   A,C		;mask
	AND  E			;test for non-zero column
	JR   NZ,FOUND		;go if found
	INC  D			;bump column number
	RLC  C			;align mask
	JR   AGAIN		;try again
FOUND:	LD   A,C		;column bits --> accu
	LD   (OLCLMN),A		;store them
	LD   E,D		; row * 8 + column (0 - 7)  --> reg. DE
	LD   D,0
	LD   H,D		; row * 8 + column (0 - 7)  --> reg. HL
	LD   L,E
	ADD  HL,HL		;(row * 8 + column (0 - 7)) * 2
	ADD  HL,DE		;(row * 8 + column (0 - 7)) * 3

;get ASCII code of pressed key:
	LD   BC,(KEYTAB)	;^table of ASCII codes --> reg. BC
	ADD  HL,BC		;calculate ^ASCII code of pressed key
	LD   A,(3880H)		;load SHIFT bit
	BIT  0,A		;SHIFT ?
	JR   Z,CTRL		;jump if not
	INC  HL			;adjust table pointer
	JR   LOCK
CTRL:	BIT  1,A		;CTRL ?
	JR   Z,LOCK		;jump if not
	INC  HL			;adjust table pointer
	INC  HL
	LD   A,(HL)		;get ASCII code
	JR   DBOUNCE

;check if caps lock:
LOCK:	LD   A,(38E0H)		;load LOCK bitЉ	BIT  3,A		;LOCK ?
	JR   Z,UMLAUT		;jump if not
	LD   A,(HL)		;restore char
	CP   'a'		;is it a letter ?
	JR   C,DBOUNCE		;jump if not
	LD   A,(GERMAN)		;German character set ?
	OR   A
	LD   A,(HL)		;restore char
	JR   Z,UCAPS		;jump if US-ASCII
	CP   DEL
	JR   NC,DBOUNCE		;adjust to lower case
	JR   UCASE
UCAPS:	CP   '{'		;adjust to lower case
	JR   NC,DBOUNCE
UCASE:	AND  5FH		;force upper case
	JR   DBOUNCE

;check if German character set:
UMLAUT:	LD   A,(GERMAN)		;German character set ?
	OR   A
	LD   A,(HL)		;restore char
	JR   Z,DBOUNCE		;jump if US-ASCII
	LD   A,(3880H)		;load SHIFT bit
	BIT  0,A		;SHIFT ?
	LD   A,(HL)		;restore char
	JR   NZ,SHIFT		;jump if SHIFT
	CP   '['		;"Umlaut" ?
	JR   C,DBOUNCE		;jump if not
	CP   '_'
	JR   NC,DBOUNCE
	JR   FILTER
SHIFT:	CP   '{'		;"Umlaut" ?
	JR   C,DBOUNCE		;jump if not
	CP   DEL
	JR   NC,DBOUNCE
FILTER:	XOR  20H		;change to upper/lower case

;second debounce routine:
DBOUNCE:LD   D,A		;save character
	LD   A,(REPEAT)		;auto repeat ?
	OR   A
	JR   NZ,NBOUNCE		;no debounce if repeat mode
	LD   BC,(DELAY2)	;load delay count
	CALL DELAY		;delay
NBOUNCE:LD   A,D		;A = ASCII - like character
	RET			;return

KEYBRD:	DEFB 80H,0C0H,0A0H,40H,20H,10H,08H,04H,02H,01H
GERMAN:	DEFB 0			;switch bit to alter character set
				;(0 = US-ASCII, FF = German)
KEYHLD:	DEFB 0,0,0,0,0,0	;keyboard work area
	DEFB 0,0,0,0,0
COUNT1:	DEFW 0			;delay counters for auto repeat function
COUNT2:	DEFW 0
OLDROW:	DEFW 0			;temporary memory for keyboard driver
OLCLMN:	DEFB 0
RDYKEY:	DEFB 0			;key code memory
REPEAT:	DEFB 0			;repeat mode


;EJECTЉ;*******************
;*  $ K B W A I T  *
;*******************

;exit: A = char

;wait for a keyboard character:

;scan for special function key:
$KBWAIT:LD   A,(COUNT3)		;letter counter --> accu
	OR   A			;test it
	JR   Z,DZERO		;jump if counter empty
	DEC  A			;decrement counter
	LD   (COUNT3),A		;store it
	LD   HL,(FPTR)		;load letter pointer
	LD   A,(HL)		;load next letter
	INC  HL			;bump letter pointer
	LD   (FPTR),HL		;store it
	LD   C,A		;save active key
	LD   A,(HL)		;get next key
	LD   (RDYKEY),A		;store that sucker
	LD   A,C		;restore active key
	JP   TSTKEY+2

;scan for special key "00":
DZERO:	LD   HL,RDYKEY		;^scanned key --> reg. HL
	LD   A,(HL)		; scanned key --> accu
	CP   0FBH		;is it PRINT ?
	JR   Z,PRINT		;jump if yes
	CP   0FCH		;is it SHIFT - CLEAR ?
	JR   Z,ERASE		;jump if yes
	CP   0FDH		;is it SHIFT - BREAK ?
	JR   Z,GERSET		;jump if yes
	CP   0FEH		;is it "00" ?
	JR   C,FKEY		;jump if not
	INC  A			;bump "00"-counter
	LD   (HL),A		;store "00"-counter
	LD   A,'0'		;return one zero
	RET			;return to caller
PRINT:	PUSH HL			;save reg. HL
	IN   A,($SYS1)		;read system byte 1
	AND  11010110B		;enable memory mapped I/O
				;disable graphic page
	OR   01010100B		;disable boot EPROM
				;enable full screen
				;7.2 MHz clock frequency
	OUT  ($SYS1),A		;write system byte 1
	LD   HL,$SCREEN		;address of first screen location --> reg. HL
	LD   IX,(VDTABP)	;^current parameter table	  --> reg. IX
	LD   A,(IX)		;line count of screen		  --> reg. D
	LD   D,A
PRINT1:	LD   A,(IX+1)		;column count of screen 	  --> reg. B
	LD   B,A
PRINT2:	LD   A,(HL)		;screen character		  --> accu
	AND  7FH		;mask it
	INC  HL			;bump screen pointer
	CALL PRCHR0		;output character to printer 0
	DJNZ PRINT2		;repeat "column count" times
	LD   A,CR		;output a carriage return
	CALL PRCHR0
	LD   A,LF		;output a line feedЉ	CALL PRCHR0
	DEC  D			;decrement line counter
	JR   NZ,PRINT1		;print next line
	POP  HL			;restore reg. HL
	JR   GERSE3		;go on
ERASE:	LD   A,SUB
	PUSH HL
	CALL $VDCHAR		;clear screen
	POP  HL
	JR   GERSE3		;go on
GERSET:	PUSH HL
	LD   A,ESC
	CALL $VDCHAR
	LD   A,(GERMAN)		;load switch bit for changing char set
	CPL			;invert it
	LD   (GERMAN),A		;store it
	OR   A
	JR   Z,GERSE1
	LD   A,'G'		;load German character set
	JR   GERSE2
GERSE1:	LD   A,'A'		;load ASCII character set
GERSE2:	CALL $VDCHAR
	POP  HL
GERSE3:	XOR  A			;clear key code
	JR   TSTKEY

;test if function key:
FKEY:	BIT  7,A		;check if code >= 80H
	JR   Z,TSTKEY		;jump if not
	PUSH HL			;save ^key memory
	LD   C,A		;save key code
	LD   E,A
	LD   HL,VECTOR		;^function key vector --> reg. HL
	LD   A,(HL)		;function key vector = 0 ?
	LD   D,A		;save LSB of key vector
	INC  HL
	OR   (HL)
	JR   Z,FKEYEND		;jump if no special function
	LD   H,(HL)		;function key vector --> reg. HL
	LD   L,D
	LD   D,0
	SLA  E			;most significant 7 bits of code * 2
	ADD  HL,DE		;calculate vector address
	LD   A,(HL)		;no special function ?
	LD   E,A
	INC  HL
	LD   D,(HL)
	OR   D
	JR   Z,FKEYEND
	LD   A,(DE)		;vector --> accu
	LD   (COUNT3),A		;load counter
	INC  DE
	LD   (FPTR),DE		;load address of first function key character
	POP  HL			;adjust stack pointer
	JP   $KBWAIT
FKEYEND:LD   A,C		;restore original key code
	POP  HL			;restore ^key memory

;test key memory if legal code:
TSTKEY:	LD   (HL),0		;clear key memory
	OR   A			;legal key code ?Љ	RET  NZ			;return to caller

;scan keyboard:
	CALL $KBCHAR		;scan keyboard
	JP   $KBWAIT		;test if active key

COUNT3:	DEFB 0			;letter counter for function keys
FPTR:	DEFW 0			;letter pointer for function keys


;EJECT
;*******************
;*  $ V D C H A R  *
;*******************

;entry: A = char

$BUZZ	EQU  3860H		;buzzer address
$SCREEN	EQU  3800H		;address of first screen location

;character output routine:
$VDCHAR:LD   C,A		;save character
	IN   A,($SYS1)		;read system byte 1
	AND  11010110B		;enable memory mapped I/O
				;disable graphic page
	OR   01010100B		;disable boot EPROM
				;enable full screen
				;7.2 MHz clock frequency
	OUT  ($SYS1),A		;write system byte 1
	LD   A,C		;restore character

	LD   IX,(VDTABP)	;^^screen constants --> reg. IX
	LD   HL,ESCAPE		;test if escape sequence
	BIT  2,(HL)
	JR   NZ,ESCSQ2		;cursor addressing routine
	BIT  1,(HL)
	JR   NZ,ESCSQ1		;handle second byte of escape sequence
	BIT  0,(HL)
	JR   NZ,ESCSEQ		;handle first byte of escape sequence
	CP   ESC		;char = ESC ?
	JR   NZ,NORMAL		;jump if normal ASCII char
	SET  0,(HL)		;remark escape sequence
	RET

;handling of single byte ASCII's:
NORMAL:	CP   20H		;control char ?
	JR   C,CNTRL
	LD   L,A		;save char
	LD   A,(IX+5)		;right column --> accu
	SUB  (IX+9)		;calc. no. of columns right to the cursor
	RET  M			;return, if cursor beyond right column
	LD   A,L		;restore char
	OR   A			;ASCII code > 80H ?
	JP   P,NORMAL1		;jump if not
	CP   0A0H		;ASCII code > 0A0H ?
	JR   NC,NORMAL1		;jump if yes
	SUB  80H		;convert code if special char
NORMAL1:OR   (IX+11)		;put invert mask over character
	LD   HL,(CURADR)	;absolute screen address --> reg. HL
	LD   (HL),A		;output char
	JP   CURRGT		;output cursorЉ
;handling of control codes:
CNTRL:	OR   A			;control code = 0 ?
	RET  Z
	LD   HL,TAB1E+1		;^end of control code table --> reg. HL
	LD   BC,TAB1E-TAB1S+2	;table length		    --> reg. BC
CAGAIN:	CPDR			;search char
	RET  NZ			;return to caller if not found
	INC  (HL)		;escape sequence ?
	DEC  (HL)
	JR   NZ,CAGAIN		;search next char
	JR   ESCEND

;first entry into escape sequence:
ESCSEQ:	RES  0,(HL)		;reset escape bit
	LD   HL,TAB1E+1		;^end of ESC-sequence-table-1 --> reg. HL
	LD   BC,TAB1E-TAB1S+2	;table length		      --> reg. BC
EAGAIN:	CPDR			;search char
	RET  NZ			;return to caller if not found
	INC  (HL)		;escape sequence ?
	DEC  (HL)
	JR   Z,EAGAIN		;search next char
ESCEND:	LD   HL,CTRLJP		;jump vector --> reg. HL
	DEC  BC			;calc jump address
	ADD  HL,BC
	LD   C,(HL)		;jump address --> reg. HL
	INC  HL
	LD   H,(HL)
	LD   L,C
	JP   (HL)		;execute function

;second entry into escape sequence:
ESCSQ1:	RES  1,(HL)		;reset second escape bit
	SUB  20H		;adjust line/column no.
	LD   D,A		;save it
	LD   A,(ESCCHR)		;load first byte of escape sequence
	LD   HL,TAB2E+1		;^end of ESC-sequence-table-2 --> reg. HL
	LD   BC,TAB2E-TAB2S+2	;table length		      --> reg. BC
	CPDR			;search char
	LD   HL,ESCJP		;^jump vector
	LD   A,D		;restore line/column no.
	JR   ESCEND+3

;third entry into escape sequence:
ESCSQ2:	RES  2,(HL)		;reset third escape bit
	SUB  20H		;adjust column no.
	CP   (IX+7)		;legal column no. ?
	RET  NC			;return if not
	ADD  A,(IX+3)		;add left column
	LD   (IX+9),A		;store new column no.
	LD   A,(LINE)		;fetch new line no.
	ADD  A,(IX+2)		;add top line
	LD   (IX+8),A		;store it
	CALL OUTCUR		;output cursor
	JP   CURON+4		;turn on cursor

;handle first byte of two or three byte escape sequence:
ESC1ST:	LD   (ESCCHR),A		;store first byte of escape sequence
	LD   HL,ESCAPE
	SET  1,(HL)		;remark it
	RETЉ
;handle second byte of three byte escape sequence:
ESC2ND:	CP   (IX+6)		;legal line no. ?
	RET  NC			;return if not
	LD   (LINE),A		;save new line
	LD   HL,ESCAPE
	SET  2,(HL)		;remark cursor addressing sequence
	RET

;beep:
BEEP:	IN   A,($SYS1)		;read system byte 1
	PUSH AF			;save it
	AND  11000110B		;enable memory mapped I/O
				;disable graphic page
				;enable buzzer
	OUT  ($SYS1),A		;write system byte 1

	LD   BC,0		;repeat counter --> reg. B
				;  wait counter --> reg. C
	DI			;force clean tone
BEEP1:	LD   A,($BUZZ)		;turn on buzzer
	PUSH BC			;save base value of wait counter
BUZZON:	NOP			;little delay for lower frequency
	NOP
	NOP
	DEC  C			;decrement wait counter
	JR   NZ,BUZZON		;wait `til end of buzz
	POP  BC			;restore wait counter
	DJNZ BEEP1		;turn on buzzer eleven times
	POP  AF			;restore system byte 1
	OUT  ($SYS1),A		;write it
	RET

;cursor left:
CURLFT:	LD   A,(IX+3)		;left column --> accu
	CP   (IX+9)		; > current column ?
	JP   M,CURLFT1		;jump if not
	LD   A,(WRAP)		;wrap around mode ?
	OR   A
	RET  Z			;return if not
	LD   A,(IX+5)		;right column --> current column
	LD   (IX+9),A
	JR   CURUP
CURLFT1:DEC  (IX+9)		;decrement column no.
	JP   INSLI3



;cursor down:
CURDWN:	LD   A,(IX+8)		;current line --> accu
	CP   (IX+4)		; >= bottom line ?
	JP   P,CURDW1		;scroll up if yes
	INC  (IX+8)		;increment line no.
	JP   OUTCUR
CURDW1:	LD   A,(IX+2)		;top line --> current line
	LD   (IX+8),A
	JP   SCRLU		;scroll window up one line

;cursor up:
CURUP:	LD   A,(IX+2)		;top line --> accu
	CP   (IX+8)		; >= current line ?Љ	RET  P			;return if yes
	DEC  (IX+8)		;decrement line
	JP   OUTCUR

;cursor right:
CURRGT:	LD   A,(IX+5)		;right column --> accu
	CP   (IX+9)		;right column >= current column ?
	RET  M			;return if cursor beyond right column
	PUSH AF			;save status reg.
	INC  (IX+9)		;increment column no.
	POP  AF			;restore status reg.
	JP   NZ,OUTCUR		;output cursor
	LD   A,(WRAP)		;wrap around mode ?
	OR   A
	JP   Z,CUROFF+4		;turn cursor off
	LD   A,(IX+3)		;left column  --> current column
	LD   (IX+9),A
	CALL OUTCUR		;output cursor
	JR   CURDWN		;perform line feed

;carriage return:
NEWLIN:	LD   A,(IX+3)		;left column  --> current column
	LD   (IX+9),A
	JP   INSLI3		;output cursor

;home cursor:
HOME:	LD   A,(IX+2)		;top line    --> current line
	LD   (IX+8),A
	LD   A,(IX+3)		;left column --> current column
	LD   (IX+9),A
	JP   OUTCUR		;output cursor

;select window:
WINDOW:	LD   C,A		;save window #
	LD   A,(STONOFF)	;status line enabled ?
	RET  NZ			;return if yes
	LD   A,C		;restore window #
	OR   A			;window # < 0 ?
	RET  M			;return if yes
	CP   8			;window # > 7 ?
	RET  NC			;return if yes
	ADD  A,A		;multiply window number by 13
	ADD  A,C
	ADD  A,A
	ADD  A,A
	ADD  A,C
	LD   B,0		;window number * 13 --> reg. BC
	LD   C,A
	LD   HL,VDTAB		;^screen constants  --> reg. HL
	ADD  HL,BC		;calc current table entry
	LD   (VDTABP),HL	;store it
	PUSH HL			;^screen constants  --> reg. IX
	POP  IX
	LD   A,(IX+12)		;cursor off ?
	OR   A
	JR   Z,WINDOW2		;jump if not
WINDOW1:CALL CUROFF+4		;turn off cursor
	JP   OUTCUR		;output cursor & return to caller
WINDOW2:LD   A,(IX+5)		;right column --> accu
	CP   (IX+9)		;right column >= current column ?
	JR   C,WINDOW1		;turn off cursor beyond right columnЉ	CALL OUTCUR		;position cursor
	JR   CURON+4		;turn on cursor & return to caller

;set top line:
SETTOP:	CP   (IX)		;legal	line/column no. ?
	RET  NC			;return if not
	LD   B,A		;save line/column
	SUB  (IX+4)		;top	line   - bottom line
				;left	column - right	column
	NEG			;bottom line   - top	line
				;right	column - left	column
	JP   M,SETTO1		;jump if illegal top line/left column
	INC  A			;adjust line/column count
	LD   (IX+6),A		;store new line/column count
SETTO1:	LD   A,B		;restore line column
	RET  M
	LD   (IX+2),A		;store new top line/left column
	CP   (IX+8)		;current line	> top  line ?
				;current column > left column ?
	RET  C			;return to caller if yes
SETTO2:	LD   (IX+8),A		;store new current line/column
	LD   IX,(VDTABP)	;adjust ^screen constants
	JP   OUTCUR		;output cursor

;set bottom line:
SETBOT:	CP   (IX)		;legal	line/column no. ?
	RET  NC			;return if not
	LD   B,A		;save line/column
	SUB  (IX+2)		;bottom line   - top  line
				;right	column - left column
	JP   M,SETTO1		;jump if illegal bottom line/left column
	INC  A			;adjust line/column count
	LD   (IX+6),A		;store new line/column count
	LD   A,B		;restore line column
	LD   (IX+4),A		;store new bottom line/left column
	CP   (IX+8)		;current line	> bottom line ?
				;current column > right  column ?
	RET  P			;return to caller if not
	JR   SETTO2

;set left column:
SETLFT:	INC  IX			;adjust ^screen constants
	JR   SETTOP		;set left column

;set right column:
SETRGT:	INC  IX			;adjust ^screen constants
	JR   SETBOT		;set right column

;set erase character:
SETERA:	ADD  A,20H		;restore ASCII code of erase character
	CP   80H		;ASCII between 80H and 9FH ?
	JR   C,SETERA1
	CP   0A0H
	JR   NC,SETERA1
	RES  7,A		;make code between 00H and 1Fh
SETERA1:LD   (IX+10),A		;store new erase character
	RET			;return to caller

;turn off cursor:
CUROFF:	LD   (IX+12),0FFH	;store remark byte
	LD   A,10		;CRTC register no. --> accuЉ	OUT  ($CRTREG),A	;select CRTC register
	LD   A,20H
	OUT  ($CRTCMD),A	;turn off cursor
	RET

;turn on cursor:
CURON:	LD   (IX+12),0		;clear remark byte
	LD   A,(IX+5)		;right column --> accu
	SUB  (IX+9)		;calc no. of columns right to the cursor
	RET  M			;return, if cursor beyond right column
	LD   A,(IX+12)		;load remark byte
	OR   A			;test remark byte
	RET  NZ			;no action if cursor is invisible
	LD   A,10		;CRTC register no. --> accu
	OUT  ($CRTREG),A	;select CRTC register
	LD   A,(CURBEG)		;cursor image	   --> accu
	OUT  ($CRTCMD),A	;turn on cursor
	RET

;set ASCII character set:
SETASC:	XOR  A			;clear accu
SETAS1:	LD   (GERMAN),A		;set ASCII char set
	JP   SELCHR		;select ASCII character set and ret to caller

;disable status line:
STATOFF:LD   A,(STONOFF)	;status line enabled ?
	OR   A
	RET  Z			;return if not
	XOR  A			;clear marker
	LD   HL,VDTEMP		;restore screen parameter table
	JR   STATO1

;enable status line:
STATON:	LD   A,(STONOFF)	;status line already enabled ?
	OR   A
	RET  NZ			;return if yes
	CPL			;set marker
	LD   HL,(VDTABP)	;save screen parameter table
	LD   DE,VDTEMP
	LD   BC,13
	LDIR
	LD   HL,VDSTAT		;setup status line parameters
STATO1:	LD   DE,(VDTABP)
	LD   BC,13
	LDIR
	LD   (STONOFF),A	;store marker
	JP   OUTCUR		;output cursor

;set German character set:
SETGER:	LD   A,0FFH		;set accu to ones
	JR   SETAS1		;set German char set

;switch on normal keyboard:
SETNKB:	LD   HL,NBOARD		;^normal key table  --> reg. HL
SETNK1:	LD   (KEYTAB),HL	;store it
	RET			;return to caller

;switch on WordStar keyboard:
SETWKB:	LD   HL,WBOARD		;^WordStar key table --> reg. HL
	JR   SETNK1
Љ;turn on inverse display mode:
INVON:	LD   (IX+11),80H	;store invert mask
	RET

;turn off inverse display mode:
INVOFF:	LD   (IX+11),0		;clear invert mask
	RET

;turn on wrap around mode:
WRAPON:	LD   A,0FFH
	LD   (WRAP),A		;remember wrap around mode
	RET

;turn off wrap around mode:
WRAPOFF:XOR  A
	LD   (WRAP),A
	RET

;insert character:
INSCHR:	LD   HL,(CURADR)	;absolute screen address --> reg. HL
	LD   A,(IX+5)		;right column		 --> accu
	SUB  (IX+9)		;calc. no. of columns right to the cursor
	RET  M			;return, if cursor beyond right column
	JR   Z,INSCH1		;no columns to shift
	LD   B,0		;no of columns to shift --> reg. BC
	LD   C,A
	ADD  HL,BC		;now HL contains address of last column
	LD   D,H
	LD   E,L		;now DE contains address of last column
	DEC  HL			;now HL contains address of last column - 1
	LDDR			;shift rest of line right one char
	INC  HL			;now HL contains current cursor address
INSCH1:	LD   A,(IX+10)		;get erase char
	LD   (HL),A		;insert one space at current cursor location
	RET

;insert line:
INSLIN:	LD   A,(IX+3)		;left column --> current column
	LD   (IX+9),A
	LD   A,(IX+4)		;bottom line --> accu
	SUB  (IX+8)		;calc. no. of lines to scroll
	LD   B,(IX+4)		;bottom line --> current line
	LD   (IX+8),B
INSLI1:	JR   Z,INSLI2		;return if line count = 0
	CALL CALC		;calculate start position
	PUSH HL			;save it
	LD   D,0		;maximum column count --> reg. DE
	LD   E,(IX+1)
	SBC  HL,DE		;now HL contains ^(last line - 1)
	POP  DE			;restore ^last line
	LD   B,0		;column count --> reg. BC
	LD   C,(IX+7)
	LDIR			;scroll down one line
	DEC  (IX+8)		;decrement current line
	DEC  A			;decrement counter
	JR   INSLI1		;scroll down all lines
INSLI2:	CALL ERAEOLN		;erase current line
INSLI3:	CALL OUTCUR		;output cursor
	JP   CURON+4		;turn on cursor

;delete character:ЉDELCHR:	LD   HL,(CURADR)	;absolute screen address  --> reg. HL
	LD   A,(IX+5)		;right column --> accu
	SUB  (IX+9)		;calc. no. of columns right to the cursor
	RET  M			;return, if cursor beyond right column
	JR   Z,INSCH1		;no columns to shift
	LD   B,0		;no. of columns to shift --> reg. BC
	LD   C,A
	LD   D,H
	LD   E,L		;now DE contains absolute screen address
	INC  HL			;now HL contains absolute screen address + 1
	LDIR			;shift rest of line left one char
	DEC  HL			;now HL contains address of last column
	JR   INSCH1		;insert one space at last column

;erase to end of line:
ERAEOLN:CALL CALC		;calculate absolute screen address
	LD   A,(IX+5)		;right column --> accu
	SUB  (IX+9)		;now accu contains number of columns to erase
	RET  M			;return if cursor beyond right column
	LD   C,(IX+10)		;get erase char
ERAEO1:	LD   (HL),C		;clear column
	INC  HL			;bump column ptr
	DEC  A			;decrement column counter
	JP   P,ERAEO1		;erase all columns right to the cursor
	RET

;delete line:
DELLIN:	LD   A,(IX+3)		;left  column --> current column
	LD   (IX+9),A
	LD   A,(IX+8)		;current line no. --> accu
	PUSH AF			;save it
	CALL SCRLU		;scroll rest of window up one line
	POP  AF
	LD   (IX+8),A		;restore current line
	JR   INSLI3		;output cursor

;erase to end of screen:
ERAEOS:	CALL ERAEOLN		;erase to end of first line
	LD   B,(IX+8)		;save current line
	LD   C,(IX+9)		;save current column
	PUSH BC
	LD   A,(IX+3)		;left column --> current column
	LD   (IX+9),A
	LD   A,(IX+4)		;bottom line --> accu
	SUB  B			;now accu contains number of lines to erase
	LD   B,A		;counter --> reg. B
	JR   Z,ERAES2		;no further lines to erase
ERAES1:	INC  (IX+8)		;increment current line
	PUSH BC			;save counter
	CALL ERAEOLN		;erase current line
	POP  BC			;restore counter
	DJNZ ERAES1		;erase to end of whole window
ERAES2:	POP  BC
	LD   (IX+8),B		;restore original line	 no.
	LD   (IX+9),C		;restore original column no.
	RET

;clear screen:
ERAALL:	CALL HOME		;home cursor
	JR   ERAEOS		;clear to end of screen
Љ;output cursor:
OUTCUR:	CALL CALC		;calculate absolute screen address
	LD   (CURADR),HL	;store it
	LD   DE,$SCREEN		;base address of video RAM --> reg. DE
	OR   A			;clear carry flag
	SBC  HL,DE		;subtract base address from current cursor
				;address
	LD   C,$CRTREG		;CRTC address register --> reg. C
	LD   A,14		;CRTC register number  --> accu
	OUT  (C),A		;select CRTC register
	INC  C			;CRTC command register --> reg. C
	OUT  (C),H		;output cursor address (MSB)
	INC  A			;increment CRTC register no.
	DEC  C			;decrement port number
	OUT  (C),A		;select CRTC register
	INC  C			;CRTC command register --> reg. C
	OUT  (C),L		;output cursor address (LSB)
	RET

;scroll up routine:
SCRLU:	LD   A,(IX+9)		;current column --> accu
	PUSH AF			;save it
	LD   A,(IX+3)		;left column --> current column
	LD   (IX+9),A
	LD   A,(IX+4)		;bottom line  --> accu
	SUB  (IX+8)		;calc. no. of lines to scroll
SCRLU1:	JR   Z,SCRLU2		;clear last line if count = 0
	CALL CALC		;calculate start position
	PUSH HL			;save it
	LD   D,0		;maximum column count --> reg. DE
	LD   E,(IX+1)
	ADD  HL,DE		;now HL contains address of line to scroll
	POP  DE			;restore ^line before
	LD   B,0		;column count --> reg. BC
	LD   C,(IX+7)
	LDIR			;scroll up one line
	INC  (IX+8)		;increment current line
	DEC  A			;decrement counter
	JR   SCRLU1		;scroll up all lines
SCRLU2:	CALL ERAEOLN		;clear last line
	POP  AF			;restore column no.
	LD   (IX+9),A		;store it
	RET

;calculate absolute cursor address:
CALC:	LD   HL,$SCREEN		;address of first screen loc --> reg. HL
	LD   D,0		;maximum column count	     --> reg. DE
	LD   E,(IX+1)
	LD   B,(IX+8)		;current line		     --> reg. B
	DEC  B
	INC  B
	JR   Z,CALC2		;jump if line no. = 0
CALC1:	ADD  HL,DE
	DJNZ CALC1		;handle all lines
CALC2:	LD   E,(IX+9)		;current column --> reg. DE
	ADD  HL,DE		;now HL contains absolute screen address
	RET

;jump vectors:
CTRLJP:	DEFW BEEP,CURLFT,CURDWN,CURUP,CURRGT,NEWLIN,HOME,ESC1ST,ESC1ST
	DEFW ESC1ST Љ        DEFW ESC1ST,ESC1ST,ESC1ST,ESC1ST,CUROFF,CURON,SETASC,STATOFF,STATON
	DEFW SETGER,SETNKB,SETWKB,INVON,INVOFF,WRAPON,WRAPOFF,INSCHR,INSLIN
	DEFW DELCHR,ERAEOLN,DELLIN,ERAEOS,ERAALL
ESCJP:	DEFW ESC2ND,WINDOW,SETTOP,SETBOT,SETLFT,SETRGT,SETERA

;table of screen constants:
VDTABP:	DEFW VDTAB
VDTAB:	REPT 8
	DEFB 24			;maximum line	count
	DEFB 80			;maximum column count
	DEFB 0			;top	 line
	DEFB 0			;left	 column
	DEFB 23			;bottom  line
	DEFB 79			;right	 column
	DEFB 24			;line	 count
	DEFB 80			;column  count
	DEFB 0			;current line
	DEFB 0			;current column
	DEFB ' '		;erase	 character
	DEFB 0			;0 = normal mode,  80H = inverse mode
	DEFB 0			;0 = cursor on	, 0FFH = cursor off
	 ENDM

;status line constants:
VDSTAT:	DEFB 25			;maximum line	count
	DEFB 80			;maximum column count
	DEFB 24			;top	 line
	DEFB 0			;left	 column
	DEFB 24			;bottom  line
	DEFB 79			;right	 column
	DEFB 1			;line	 count
	DEFB 80			;column  count
	DEFB 24			;current line
	DEFB 0			;current column
	DEFB ' '		;erase	 character
	DEFB 0			;0 = normal mode,  80H = inverse mode
	DEFB 0			;0 = cursor on	, 0FFH = cursor off

ESCAPE:	DEFB 0			;contains escape remarks
ESCCHR:	DEFB 0			;memory for escape char
LINE:	DEFB 0			;memory for line number
CURADR:	DEFW 3800H		;memory for absolute cursor address
WRAP:	DEFB 00H		;0 = normal mode, 0FFH = wrap around mode
STONOFF:DEFB 0			;0 = status line off, 0FFH = status line on
VDTEMP:	DEFS 13			;temporary storage area for screen constants


;EJECT
;*******************
;*  $ P R S T A T  *
;*******************

;entry: B = number of Centronics interface (0, 1)

;exit : A = printer status
;	0 = printer ready
;    <> 0 = printer not ready

;calc entry of printer status routine:
$PRSTAT:LD   HL,PSTAB		;base of entry table --> reg. HL
	LD   C,B		;calc table entryЉ	LD   B,0
	SLA  C
	ADD  HL,BC
	LD   C,(HL)		;get entry address
	INC  HL
	LD   H,(HL)
	LD   L,C
	JP   (HL)		;execute printer status routine

;printer status routine entry table:
PSTAB:	DEFW PRSTA0,PRSTA1

;test status of printer 0:
$PTR0	EQU  0FDH		;printer port 0

PRSTA0:	IN   A,($PTR0)		;read printer status
	AND  0F0H		;mask it
	XOR  30H
	RET			;return to caller

;test status of printer 1:
$PTR1	EQU  0D5H		;printer port 1

PRSTA1:	IN   A,($PTR1)		;read printer status
	AND  0F0H		;mask it
	XOR  30H
	RET			;return to caller


;EJECT
;*******************
;*  $ P R C H A R  *
;*******************

;entry: A = char
;	B = number of Centronics interface (0, 1)

;calc entry of printer output routine:
$PRCHAR:LD   HL,POTAB		;base of entry table --> reg. HL
	LD   C,B		;calc table entry
	LD   B,0
	SLA  C
	ADD  HL,BC
	LD   C,(HL)		;get entry address
	INC  HL
	LD   H,(HL)
	LD   L,C
	JP   (HL)		;execute printer output routine

;printer output routine entry table:
POTAB:	DEFW PRCHR0,PRCHR1

;output a character to printer 0:
PRCHR0:	LD   C,A		;save char
	CALL PRSTA0		;test status of printer 0
	JR   NZ,PRCHR0+1	;wait for printer ready
	LD   A,C		;restore char
	OUT  ($PTR0),A		;print it
	RET			;return to caller

;output a character to printer 1:Љ$PTR1D	EQU  0D4H		;data port of PIO

PRCHR1:	LD   C,A		;save char
	CALL PRSTA1		;test status of printer 0
	JR   NZ,PRCHR1+1	;wait for printer ready
	LD   A,C		;restore char
	OUT  ($PTR1D),A		;output it
	XOR  A
	OUT  ($PTR1),A		;set STROBE
	INC  A
	OUT  ($PTR1),A		;clear STROBE

	RET			;return to caller


;EJECT
;*******************
;*  $ R S R C S T  *
;*******************

;entry: B = number of RS232C interface (0, 1)

;exit : A = input status
;	0 = no char available
;    <> 0 = char available

;calc entry of RS232C input status routine:
$RSRCST:LD   HL,RSSTAB		;base of entry table --> reg. HL
	LD   C,B		;calc table entry
	LD   B,0
	SLA  C
	ADD  HL,BC
	LD   C,(HL)		;get entry address
	INC  HL
	LD   H,(HL)
	LD   L,C
	JP   (HL)		;execute initialization routine

;RS232C input status routine entry table:
RSSTAB:	DEFW RSRCSA,RSRCSB

;get input status of SIO A:
RSRCSA:	IN   A,(WR0A)		;read status
	AND  1			;character available ?
	RET  NZ			;return to caller if yes
	LD   B,A		;load counter
	LD   A,5		;speak to write register 5
	OUT  (WR0A),A
	LD   A,(WR5A)		;get write register 5
	SET  1,A		;set RTS
	OUT  (WR0A),A		;request to send
RSRCSA1:IN   A,(WR0A)		;read status
	BIT  0,A		;character available ?
	JR   NZ,RSRCSA2		;jump if character ready
	DJNZ RSRCSA1		;scan 256 times
	LD   C,0		;no character available
	JR   RSRCSA3
RSRCSA2:LD   C,1		;character available
RSRCSA3:LD   A,5		;speak to write register 5
	OUT  (WR0A),A
	LD   A,(WR5A)		;get write register 5Љ	OUT  (WR0A),A		;data terminal ready
	LD   A,C		;get input status
	RET

;get input status of SIO B:
RSRCSB:	IN   A,(WR0B)		;read status
	AND  1			;character available ?
	RET  NZ			;return to caller if yes
	LD   B,A		;load counter
	LD   A,5		;speak to write register 5
	OUT  (WR0B),A
	LD   A,(WR5B)		;get write register 5
	SET  1,A		;set RTS
	OUT  (WR0B),A		;request to send
RSRCSB1:IN   A,(WR0B)		;read status
	BIT  0,A		;character available ?
	JR   NZ,RSRCSB2		;jump if character ready
	DJNZ RSRCSB1		;scan 256 times
	LD   C,0		;no character available
	JR   RSRCSB3
RSRCSB2:LD   C,1		;character available
RSRCSB3:LD   A,5		;speak to write register 5
	OUT  (WR0B),A
	LD   A,(WR5B)		;get write register 5
	OUT  (WR0B),A		;data terminal ready
	LD   A,C		;get input status
	RET


;EJECT
;*****************
;*  $ R S R C V  *
;*****************

;entry: B = number of RS232C interface (0, 1)

;exit : A = char

;calc entry of RS232C input routine:
$RSRCV:	LD   HL,RSRTAB		;base of entry table --> reg. HL
	LD   C,B		;calc table entry
	LD   B,0
	SLA  C
	ADD  HL,BC
	LD   C,(HL)		;get entry address
	INC  HL
	LD   H,(HL)
	LD   L,C
	JP   (HL)		;execute initialization routine

;RS232C input routine entry table:
RSRTAB:	DEFW RSRCVA,RSRCVB

;read character from SIO A:
DRA	EQU  0D0H		;data register of SIO A

RSRCVA:	IN   A,(WR0A)		;read status
	BIT  0,A		;character available ?
	JR   NZ,RSRCVA2		;jump if yes
	LD   A,5		;speak to write register 5
	OUT  (WR0A),AЉ	LD   A,(WR5A)		;get write register 5
	SET  1,A		;set RTS
	OUT  (WR0A),A		;request to send
RSRCVA1:IN   A,(WR0A)		;read status
	BIT  0,A		;character available ?
	JR   Z,RSRCVA1		;loop `til character ready
	LD   A,5		;speak to write register 5
	OUT  (WR0A),A
	LD   A,(WR5A)		;get write register 5
	OUT  (WR0A),A		;data terminal ready
RSRCVA2:IN   A,(DRA)		;read character
	RET

;read character from SIO B:
DRB	EQU  0D1H		;data register of SIO A

RSRCVB:	IN   A,(WR0B)		;read status
	BIT  0,A		;character available ?
	JR   NZ,RSRCVB2		;jump if yes
	LD   A,5		;speak to write register 5
	OUT  (WR0B),A
	LD   A,(WR5B)		;get write register 5
	SET  1,A		;set RTS
	OUT  (WR0B),A		;request to send
RSRCVB1:IN   A,(WR0B)		;read status
	BIT  0,A		;character available ?
	JR   Z,RSRCVB1		;loop `til character ready
	LD   A,5		;speak to write register 5
	OUT  (WR0B),A
	LD   A,(WR5B)		;get write register 5
	OUT  (WR0B),A		;data terminal ready
RSRCVB2:IN   A,(DRB)		;read character
	RET


;EJECT
;*******************
;*  $ R S T X S T  *
;*******************

;entry: B = number of RS232C interface (0, 1)

;exit : A = terminal status
;	0 = data terminal ready
;    <> 0 = data terminal not ready

;get output status of SIO:
$RSTXST:LD   A,WR0A		;control register of SIO A --> accu
	ADD  A,B		;add relative port number
	LD   C,A		;absolute port address --> reg. C
	LD   A,10H
	OUT  (C),A		;reset ext/status interrupts
	IN   A,(C)		;read status
	AND  2CH		;buffer empty, data set ready, clear to send ?
	SUB  2CH
	RET


;EJECT
;***************
;*  $ R S T X  *Љ;***************

;entry: A = char
;	B = number of RS232C interface (0, 1)

;write character to SIO:
$RSTX:	LD   E,A		;save character
	CALL $RSTXST		;test output status
	JR   NZ,$RSTX+1		;wait for CTS
	DEC  C
	DEC  C			;now reg. C points to data port
	OUT  (C),E		;output character
	RET


;EJECT
;disk driver:

;FDC registers:
$FDSEL	EQU  0E0H		;FDC select  register
$FDCMD	EQU  0ECH		;FDC command register
$FDSTAT	EQU  0ECH		;FDC status  register
$FDTRK	EQU  0EDH		;FDC track   register
$FDSIZ	EQU  0EEH		;FDC size    register
$FDSEC	EQU  0EEH		;FDC sector  register
$FDDATA	EQU  0EFH		;FDC data    register

;FDC commands:
$SEEK	EQU  10H		;seek
$RDSEC	EQU  88H		;read sector
$WRSEC	EQU  0A8H		;write sector
$SET8	EQU  0C0H		;set disk size to 5 inch
$FCINT	EQU  0D0H		;force interrupt
$DDDEN	EQU  0FFH		;set double density


;***************
;*  $ R E A D  *
;***************

;entry: A  = drive  number	     (lower nibble)
;	     bank   number of buffer (upper nibble)
;	B  = sector number
;	E  = track  number
;	HL = buffer pointer

;exit : A = error code
;	0 = NO ERROR
;	1 = ILLEGAL DRIVE #
;	2 = TRACK # TOO HIGH
;	3 = SECTOR # TOO HIGH
;	4 = DEVICE NOT AVAILABLE
;	6 = TRIED TO READ LOCKED/DELETED RECORD
;	7 = DATA RECORD NOT FOUND DURING READ
;	8 = PARITY ERROR DURING READ
;	9 = LOST DATA DURING READ

;read a sector:
$READ:	LD   C,A		;save drive #/bank #
	LD   A,0FFH		;set READ-flag
	JR   TASKЉ

;EJECT
;*****************
;*  $ W R I T E  *
;*****************

;entry: A  = drive  number	     (lower nibble)
;	     bank   number of buffer (upper nibble)
;	B  = sector number
;	E  = track  number
;	HL = buffer pointer

;exit : A = error code
;	0 = NO ERROR
;	1 = ILLEGAL DRIVE #
;	2 = TRACK # TOO HIGH
;	3 = SECTOR # TOO HIGH
;	4 = DEVICE NOT AVAILABLE
;	5 = WRITE PROTECTED DISKETTE
;	6 = WRITE FAULT ON DISK DRIVE
;	7 = DATA RECORD NOT FOUND DURING WRITE
;	8 = PARITY ERROR DURING WRITE
;	9 = LOST DATA DURING WRITE

;write a sector:
$WRITE:	LD   C,A		;save drive #/bank #
	XOR  A			;clear READ-flag

;dominant controller:
TASK:	LD   (RDFLAG),A		;set/reset READ-flag
	LD   A,C		;restore drive/bank #
	RRA			;get bank number of transfer buffer
	RRA
	RRA
	RRA
	AND  0FH
	LD   (BANK),A		;store bank #
	LD   A,C		;restore drive/bank #
	AND  0FH		;mask drive #
	CP   8			;legal drive # ?
	JR   C,TRKNO		;jump if yes
	LD   A,1		;error code 1 --> accu
	RET
TRKNO:	LD   (DRIVE),A		;store drive #
	LD   (BUFFER),HL	;store buffer pointer
	CALL GETDCT		;get control table ptr
	LD   A,E		;track # --> accu
	CP   (IX+4)		;legal track # ?
	JR   C,SECNO		;jump if yes
	LD   A,2		;error code 2 --> accu
	RET
SECNO:	LD   (TRACK),A		;store track #
	LD   A,B		;sector # --> accu
	CP   (IX+3)		;legal sector # ?
	JR   C,TRYNO		;jump if yes
	LD   A,3		;error code 3 --> accu
	RET
TRYNO:	LD   (SECTOR),A		;store sector #
	LD   A,(TRYS)		;get # of err tries
	INC  A			;adjust itЉ	LD   (TRIES),A		;store in counter

;set double density & disk size to 8 inch:
	LD   A,$DDDEN		;set double density command
	BIT  5,(IX)		;density ?
	JR   NZ,SETDEN		;jump if double density
	DEC  A			;set single density
SETDEN:	OUT  ($FDCMD),A		;set density
	LD   C,$SET8		;set 8 inch command
	LD   A,(DRIVE)		;drive # --> accu
	CP   4			;disk size ?
	JR   NC,SETSIZ		;jump if 8 inch
	RES  6,C		;set 5 inch command
SETSIZ:	LD   A,C
	OUT  ($FDSIZ),A		;set disk size

;actual I/O handler:
INIT:	LD   HL,0		;clear wait counter
	LD   (WAIT),HL
	LD   A,$FCINT		;force interrupt
	OUT  ($FDCMD),A		;reset FDC
	IN   A,($FDSTAT)	;get FDC status
	LD   (OLDSTAT),A	;save drive status
	CALL SELECT		;select drive
	BIT  0,(IX+1)		;is drive initialized ?
	JR   NZ,TRKSEC		;yes skip init process

;restore drive head:
	SET  0,(IX+1)		;set init bit in DCT
	LD   A,255		;max possible track # --> accu
	LD   (IX+5),A		;make current track # to 255
	XOR  A			;desired track # = 0
	JR   TRKSE8

;set track and sector:
TRKSEC:	LD   A,(TRACK)		;track # --> accu
	BIT  5,(IX)		;disk density ?
	JR   Z,TRKSE1		;jump if single density
	BIT  4,(IX)		;density of first track ?
	JR   NZ,TRKSE1		;jump if double density
	INC  A			;increment track #
TRKSE1:	BIT  2,(IX)		;step count from track to track
	JR   Z,TRKSE2		;jump if step count = 1
	ADD  A,A		;track # * 2
TRKSE2:	CP   (IX+5)		;same as current track
	JR   NZ,TRKSE6		;jump to SEEK cmd if not
	LD   C,A		;save track #
	LD   A,$FCINT		;force interrupt
	OUT  ($FDCMD),A
	LD   A,C		;restore track #
	BIT  2,(IX)		;step count from track to track
	JR   Z,TRKSE3		;jump if step count = 1
	SRL  A			;track # / 2
TRKSE3:	OUT  ($FDTRK),A		;adjust current track #
	LD   A,(SECTOR)		;sector # --> accu
	BIT  6,(IX)		;single or double sided ?
	JR   Z,TRKSE4		;jump if single sided
	BIT  5,(IX+1)		;sector numbering continued on backside ?
	JR   NZ,TRKSE4		;jump if yes
	LD   B,(IX+3)		; sectors/track --> reg. B
	SRL  B			;(sectors/track) / 2Љ	CP   B			;front or back side ?
	JR   C,TRKSE4		;jump if front side
	SUB  B			;adjust sector #
TRKSE4:	BIT  3,(IX)		;test number of first sector
	JR   Z,TRKSE5		;jump if zero
	INC  A			;else adjust sector #
TRKSE5:	OUT  ($FDSEC),A		;store sector # in FDC reg
	JR   WAITEN		;no SEEK
TRKSE6:	LD   C,A		;save track #
	SUB  (IX+5)		;subtract current track #
	JR   NC,TRKSE7
	NEG			;make result positive
TRKSE7:	LD   (WAIT),A		;store calculated step count
	LD   A,C		;restore track #
TRKSE8:	OUT  ($FDDATA),A	;store track # in FDC reg
	LD   A,$FCINT
	OUT  ($FDCMD),A		;reset FDC
	LD   A,(IX+5)		;current track from DCT
	OUT  ($FDTRK),A		;FDC track register
	LD   A,(IX)
	AND  3			;step rate --> accu
	PUSH AF			;save it
	LD   HL,(WAIT)		;get step count
	JR   Z,TRKS10		;jump if step rate = 3 msec
	LD   D,H		;step count --> reg. DE
	LD   E,L
	LD   B,A		;step rate --> reg. B
TRKSE9:	ADD  HL,DE		;counter = step count * step rate
	DJNZ TRKSE9
TRKS10:	LD   B,H		;counter --> reg. BC
	LD   C,L
	ADD  HL,HL		;counter * 2
	ADD  HL,BC		;counter * 3
	LD   A,(DRIVE)		;drive # --> accu
	CP   4			;disk size ?
	JR   NC,TRKS11		;jump if 8 inch
	ADD  HL,HL		;counter * 6
TRKS11:	LD   BC,15		;adjust value for delay loop --> reg. BC
	ADD  HL,BC		;adjust wait counter
	LD   (WAIT),HL		;store wait counter (msecs of passed time)
	POP  AF			;restore step rate
	OR   $SEEK		;or step rate with "seek" command
	OUT  ($FDCMD),A		;issue seek command
TRKS12:	CALL SELECT		;select drive
	IN   A,($FDSTAT)	;get disk status
	BIT  7,A		;drive not ready ?
	JP   NZ,READ2		;jump to error exit
	BIT  0,A		;seek done ?
	JR   NZ,TRKS12		;no, loop
	LD   BC,4000		;load delay counter
	CALL DELAY		;15 msec head settle delay
	IN   A,($FDTRK)		;get current track
	LD   (IX+5),A		;store in drive's DCT
	JP   TRKSEC		;check track # again

;motor on / head load time:
WAITEN:	LD   A,(DRIVE)		;get drive #
	LD   HL,OLDDRV		;^previous drive # --> reg. HL
	CP   (HL)		;new drive # same as old drive # ?
	LD   (HL),A		;store new drive #
	LD   A,(OLDSTAT)	;get old FDC statusЉ	RLCA			;drive rotating already
	JR   C,WAITE2		;jump to motor on delay loop, if not
	JR   Z,WAITE6		;jump if same drive #
WAITE1:	LD   HL,50		;50 msec head load time
	JR   WAITE3
WAITE2:	BIT  7,(IX)		;8 inch drive
	JR   NZ,WAITE1		;jump if 8 inch drive
	LD   HL,800		;500 msec delay after motor on
WAITE3:	LD   BC,(WAIT)		;msecs of passed time --> reg. BC
	OR   A			;clear carry bit
	SBC  HL,BC		;calculate remaining wait time
	JR   C,WAITE6		;no further time to wait
	JR   Z,WAITE6
WAITE5:	LD   BC,253		;1 msec delay
	CALL DELAY
	DEC  HL
	LD   A,H
	OR   L
	JR   NZ,WAITE5		;loop HL times
WAITE6:	IN   A,($FDSTAT)	;get FDC status
	RLCA			;drive rotating already ?
	JP   C,READ2		;jump if not

;init READ/WRITE:
TASK1:	CALL SELECT		;select drive
	LD   HL,(BUFFER)	;get buffer pointer
	LD   A,(RDFLAG)
	OR   A			;READ or WRITE ?
	PUSH AF			;save status
	LD   A,(BANK)		;bank # of transfer buffer --> accu
	JP   IO			;handle disk I/O in common memory

;test controller status:
STATUS:	IN   A,($FDSTAT)	;get FDC status
	BIT  6,A		;write protect ?
	JR   Z,STATU1		;jump if not
	LD   A,5		;error code 5 --> accu
	RET
STATU1:	BIT  5,A		;hardware fault (WRITE) ?
				;sector   prot	(READ ) ?
	JR   Z,STATU2		;jump if no
	LD   A,6		;error code 6 --> accu
	RET
STATU2:	AND  1CH		;any errors ?
	RET  Z
	RES  0,(IX+1)		;clear init bit in DCT
	LD   HL,TRIES		;get tries counter
	DEC  (HL)		;dec value
	JP   NZ,INIT		;try again, reseek
	BIT  4,A		;data record not found ?
	JR   Z,STATU3
	LD   A,7		;error code 7 --> accu
	RET
STATU3:	BIT  3,A		;parity error ?
	JR   Z,STATU4
	LD   A,8		;error code 8 --> accu
	RET
STATU4:	LD   A,9		;error code 9 --> accu
	RET

;put drive control table pointer in "IX":ЉGETDCT:	PUSH DE			;save reg. DE
	LD   H,0		;drive # --> reg. HL
	LD   L,A
	ADD  A,A		; drive # * 2
	ADD  A,L		; drive # * 3
	ADD  A,A		; drive # * 6
	LD   L,A		;(drive # * 6) --> reg. HL
	LD   DE,DCT		;get drive table start
	ADD  HL,DE		;add offset and get ^DCT
	PUSH HL			;^DCT --> reg. IX
	POP  IX
	POP  DE			;restore reg. DE
	RET			;return to caller

;select drive:
SELECT:	LD   A,(DRIVE)		;get drive #
	AND  3			;force # between 0 and 3
	OR   A			;drive # zero ?
	LD   B,A		;drive # --> reg. B
	LD   A,1		;select code for drive zero
	JR   Z,SELEC1		;jump if drive # zero
	RLCA			;rotate left accu
	DJNZ $-1		;decrement drive #
SELEC1:	BIT  6,(IX)		;single or double sided ?
	JR   Z,SELEC2		;jump if single sided
	LD   C,A		;save select code
	LD   A,(SECTOR)		;sector #	--> accu
	LD   B,(IX+3)		; sectors/track --> reg. B
	SRL  B			;(sectors/track) / 2
	CP   B			;front or back side ?
	LD   A,C		;restore select code
	JR   C,SELEC2		;jump if front side
	SET  4,A		;set side select bit
SELEC2:	OUT  ($FDSEL),A		;select drive and side
	RET			;return to caller

DRIVE:	DEFS 1			;drive
TRACK:	DEFS 2			;track
SECTOR:	DEFS 1			;sector
BUFFER:	DEFS 2			;I/O buffer
OLDDRV:	DEFB 0FFH		;contains # of previous selected disk
OLDSTAT:DEFS 1			;contains drive status
TRIES:	DEFS 1			;counter for counting # of times to try I/O
				;after error occurs
RDFLAG:	DEFS 1			;flag (0 = WRITE, 0FFH = READ)
WAIT:	DEFS 2			;counter for passed time


;EJECT
;*******************
;*  $ G E T T I M  *
;*******************

;entry: HL = address of a 21 bytes long buffer, containing on exit
;	     time & date in the form WWW MM/DD/YY HH:MM:SS

;		  WWW = weekday
;		   MM = month
;		   DD = day
;		   YY = year
;		   HH = hoursЉ;		   MM = minutes
;		   SS = seconds

;get time & date in ASCII format:
$GETTIM:DI			;critical phase
	PUSH HL			;save ^user buffer
	CALL GETTIM		;read time & date from clock chip
	LD   IX,TIMBUF		;^temp buffer --> reg. IX

	LD   A,(IX+6)		;weekday      --> accu
	AND  7			;make binary
	LD   H,0		;weekday      --> reg. HL
	LD   L,A
	LD   DE,DAYTAB		;base of weekday table --> reg. DE
	ADD  A,A		;calc table entry
	ADD  A,L
	LD   L,A
	ADD  HL,DE
	LD   DE,ATIMBUF		;^ASCII buffer	       --> reg. DE
	LD   BC,3		;length of table entry --> reg. BC
	LDIR			;move weekday into ASCII buffer
	INC  DE			;bump buffer ptr over space

	LD   A,(IX+2)		;month (tenths) --> accu
	LD   (DE),A		;store it
	INC  DE
	LD   A,(IX+3)		;month (ones)	--> accu
	LD   (DE),A		;store it
	INC  DE
	INC  DE			;bump buffer pointer over slash

	LD   A,(IX+4)		;day (tenths) --> accu
	AND  '3'		;mask leapyear bit
	LD   (DE),A		;store it
	INC  DE
	LD   A,(IX+5)		;day (ones)   --> accu
	LD   (DE),A		;store it
	INC  DE
	INC  DE			;bump buffer pointer over slash

	LD   A,(IX)		;year (tenths) --> accu
	LD   (DE),A		;store it
	INC  DE
	LD   A,(IX+1)		;year (ones)   --> accu
	LD   (DE),A		;store it
	INC  DE
	INC  DE			;bump buffer pointer over space

	LD   A,(IX+7)		;hours (tenths) --> accu
	AND  '3'		;mask format bit
	LD   (DE),A		;store them
	INC  DE
	LD   A,(IX+8)		;hours (ones)	--> accu
	LD   (DE),A		;store them
	INC  DE
	INC  DE			;bump buffer pointer over colon

	LD   A,(IX+9)		;minutes (tenths) --> accu
	LD   (DE),A		;store them
	INC  DE
	LD   A,(IX+10)		;minutes (ones)   --> accuЉ	LD   (DE),A		;store them
	INC  DE
	INC  DE			;bump buffer pointer over colon

	LD   A,(IX+11)		;seconds (tenths) --> accu
	LD   (DE),A		;store them
	INC  DE
	LD   A,(IX+12)		;seconds (ones)   --> accu
	LD   (DE),A		;store them

	POP  DE			;restore ^user buffer
	LD   HL,ATIMBUF		;^(time & date buffer)	      --> reg. HL
	LD   B,21		;length of time & date string --> reg. BC
	LD   A,01H		;source bank	  = 0
				;destination bank = 1
	JP   $XMOVE		;transfer time & date string and return

;read time & date from clock chip:
GETTIM:	IN   A,($SYS1)		;read system byte 1
	PUSH AF			;save it
	AND  10111111B		;1.78 MHz clock frequency
	OUT  ($SYS1),A		;write system byte 1
	LD   HL,TIMBUF		;^temp buffer --> reg. HL
	LD   DE,10C4H		;register address displacement --> reg. D
				;register address & read mode  --> reg. E
	LD   B,13		;byte counter		       --> reg. B
GETTI1:	LD   A,E		;read date & time
	OUT  (5BH),A
	SUB  D
	LD   E,A
	IN   A,(5AH)
	AND  0FH		;mask undesired bits
	OR   '0'		;make ASCII digit
	LD   (HL),A
	INC  HL			;bump ^(time & date)
	DJNZ GETTI1
	POP  AF			;restore system byte 1
	OUT  ($SYS1),A		;write system byte 1
	RET			;return to caller

DAYTAB:	DEFM 'SatSunMonTueWedThuFri'
TIMBUF:	DEFS 13
ATIMBUF:DEFM 'WWW MM/DD/YY HH:MM:SS'


;EJECT
;*******************
;*  $ S E T T I M  *
;*******************

;entry:  A = weekday (0 - 6, 0 = Sat)
;	 B = month   (MM)
;	 D = hours   (HH)
;	 E = minutes (MM)
;	 H = day     (DD)
;	 L = year    (YY)


;set time and date in binary format:
$SETTIM:DI			;critical phase
	LD   IX,TIMBUF		;^temp buffer --> reg. IXЉ	LD   (IX+6),A		;weekday      --> buffer
	LD   A,L		;year (ones)  --> accu
	AND  0FH		;mask it
	LD   (IX+1),A		;year (ones)  --> buffer
	LD   A,L		;shift reg. L four bits right
	RRA
	RRA
	RRA
	RRA
	AND  0FH
	LD   (IX),A		;year  (tenths) --> buffer
	LD   A,B		;month (ones)	--> accu
	AND  0FH		;mask it
	LD   (IX+3),A		;month (ones)	--> buffer
	LD   A,B		;shift reg. B four bits right
	RRA
	RRA
	RRA
	RRA
	AND  0FH
	LD   (IX+2),A		;month (tenths) --> buffer
	LD   A,H		;day   (ones)	--> accu
	AND  0FH		;mask it
	LD   (IX+5),A		;day   (ones)	--> buffer
	LD   A,H		;shift reg. H four bits right
	RRA
	RRA
	RRA
	RRA
	AND  0FH
	LD   (IX+4),A		;day   (tenths) --> buffer
	LD   A,D		;hours (ones)	--> accu
	AND  0FH		;mask it
	LD   (IX+8),D		;hours (ones)	--> buffer
	LD   A,D		;shift reg. D four bits right
	RRA
	RRA
	RRA
	RRA
	AND  0FH
	LD   (IX+7),A		;hours	 (tenths) --> buffer
	LD   A,E		;minutes (ones)   --> accu
	AND  0FH		;mask it
	LD   (IX+10),A		;minutes (ones)   --> buffer
	LD   A,E		;shift reg. E four bits right
	RRA
	RRA
	RRA
	RRA
	AND  0FH
	LD   (IX+9),A		;minutes (tenths) --> buffer
	LD   (IX+11),0		;seconds (tenths) --> buffer
	LD   (IX+12),0		;seconds (ones)   --> buffer
	LD   HL,TIMBUF		;^buffer	  --> reg. HL
	LD   DE,10D2H		;register address displacement --> reg. D
				;register address	       --> reg. E
	LD   B,13		;byte counter		       --> reg. B
	IN   A,($SYS1)		;read system byte 1
	AND  10010111B		;disable graphic page
				;1.78 MHz clock frequency
	OR   00000101B		;disable memory mapped I/OЉ				;disable boot EPROM
	OUT  ($SYS1),A		;write system byte 1
SETTI1:	LD   A,E		;set date & time
	SUB  D
	LD   E,A
	OUT  (05BH),A
	LD   A,(HL)
	OUT  (5AH),A
	INC  HL			;bump ^(time & date)
	DJNZ SETTI1
	IN   A,($SYS1)		;read system byte 1
	OR   01000000B		;7.2 MHz clock frequency
	OUT  ($SYS1),A		;write system byte 1
	JP   GETTIM		;adjust clock chip and return to caller


;EJECT
;Winchester disk driver:

	COND SASI		;Xebec part

MAXDRIVE EQU 2			;drive count

;DC registers:
WPORT0	EQU  00H		;SASI write port 0 - write data
WPORT1	EQU  01H		;SASI write port 1 - software reset
WPORT2	EQU  02H		;SASI write port 2 - cntlr select
RPORT0	EQU  00H		;SASI read  port 0 - read data
RPORT1	EQU  01H		;SASI read  port 1 - read status

;DC commands:
$TSTDRV	EQU  00H		;test drive ready
$REST	EQU  01H		;recalibrate
$STATUS	EQU  03H		;request sense status
$$READ	EQU  08H		;read
$$WRITE	EQU  0AH		;write
$INIDRV	EQU  0CH		;initialize drive characteristics

;DC status bits:
REQMASK	EQU  01H		;request mask for bit test
BUSYMASK EQU 02H		;busy	 mask for bit test
CDMASK	EQU  08H		;command/data bit position test
IOMASK	EQU  10H		;input/output bit mask
ERROR	EQU  02H		;test for an error

	 ELSE			;WD1002 part

MAXDRIVE EQU 3			;drive count

;WDC registers:
$DATA	EQU  50H		;data register
$WPC	EQU  51H		;write precomp register
$ERROR	EQU  51H		;error register
$SECNO	EQU  53H		;sector number register
$CYLLO	EQU  54H		;cylinder low register
$CYLHI	EQU  55H		;cylinder high register
$SDH	EQU  56H		;size/drive/head register
$COMND	EQU  57H		;command register
$STATUS	EQU  57H		;status register

;WDC commands:Љ$REST	EQU  10H		;restore
$$READ	EQU  20H		;read sector
$$WRITE	EQU  30H		;write sector
$DSEL	EQU  98H		;deselect drive

	ENDC


;EJECT
;*****************
;*  $ R E A D W  *
;*****************

;entry: A  = drive  number	     (lower nibble)
;	     bank   number of buffer (upper nibble)
;	B  = sector number
;	DE = track  number
;	HL = buffer pointer

;exit : A  = error status returned from controller
;	 0 = NO ERROR
;	-1 = ILLEGAL DRIVE #
;	-2 = TRACK # TOO HIGH
;	-3 = SECTOR # TOO HIGH
;	else error code returned by controller

;read a sector:
$READW:	LD   C,A		;save drive/bank number
	LD   A,0FFH
	JR   TASKW		;read sector


;EJECT
;*****************
;*  $ W R I T W  *
;*****************

;entry: A  = drive  number	     (lower nibble)
;	     bank   number of buffer (upper nibble)
;	B  = sector number
;	DE = track  number
;	HL = buffer pointer

;exit : A  = error code
;	 0 = NO ERROR
;	-1 = ILLEGAL DRIVE #
;	-2 = TRACK # TOO HIGH
;	-3 = SECTOR # TOO HIGH
;	else error code returned by controller

;write a sector:
$WRITW:	LD   C,A		;save drive/bank number
	XOR  A


;dominant controller:
TASKW:	LD   (RDFLAG),A		;set/cear READ-flag
	LD   A,C		;restore drive/bank #
	RRA			;get bank number of transfer buffer
	RRA
	RRAЉ	RRA
	AND  0FH
	LD   (BANK),A		;store bank #
	LD   A,C		;restore drive/bank #
	AND  0FH		;mask drive #
	CP   MAXDRIVE		;legal drive # ?
	JR   C,TRKNOW		;jump if yes
	LD   A,-1		;error code 1 --> accu
	RET
TRKNOW:	LD   (DRIVE),A		;store drive #
	LD   (BUFFER),HL	;store buffer pointer
	CALL GETWCT		;get control table ptr
	LD   A,D		;track # (MSB) --> accu
	CP   (IX+6)		;legal track # ?
	JR   C,SECNOW		;jump if yes
	JR   Z,CPLOW		;compare LSB's
TRKERR:	LD   A,-2		;error code 2 --> accu
	RET
CPLOW:	LD   A,E		;track (LSB) --> accu
	CP   (IX+5)		;legal track # ?
	JR   NC,TRKERR		;jump if not
SECNOW:	LD   (TRACK),DE		;store track #
	LD   A,B		;sector # --> accu
	CP   (IX+4)		;legal sector # ?
	JR   C,INITW		;jump if yes
	LD   A,-3		;error code 3 --> accu
	RET

;actual I/O handler:
INITW:	LD   (SECTOR),A		;store sector #


;EJECT
	COND SASI		;Xebec part

	LD   A,(OLDW)		;number of previously accessed drive --> reg. C
	LD   C,A
	OR   A			;no drive previously accessed ?
	JP   P,INITW1		;select controller
	OUT  (WPORT1),A		;reset controller
INITW1:	LD   A,(DRIVE)		;drive # --> accu
	LD   (OLDW),A		;save it
	CP   C			;same as old drive ?
	JR   Z,INITW2		;no drive selection needed if yes

;select Winchester drive:
	LD   IY,WPARS		;^Winchster parameters --> reg. IY
	LD   H,(IX+6)		;track count --> reg. HL
	LD   L,(IX+5)
	LD   D,0		;clear MSB of divisor
	LD   E,(IX)		;get no. of surfaces
	LD   B,5
	SRL  E
	DJNZ $-2
	INC  E
	LD   (IY+2),E		;load head count
	CALL DIV		;calc cylinder count
	LD   (IY),H		;load cylinder count
	LD   (IY+1),L
	LD   (IY+3),H		;load starting cylinder
	LD   (IY+4),L		;for reduced write currentЉ	LD   H,0		;calc startimg cylinder for write precomp
	LD   L,(IX+2)
	ADD  HL,HL
	ADD  HL,HL
	LD   (IY+5),H		;load starting cylinder for write precomp
	LD   (IY+6),L
	LD   A,$INIDRV		;initialize drive data
	CALL TASKOUT

	LD   HL,WPARS		;^Winchester parameters --> reg. HL
	LD   BC,8 SHL 8+WPORT0	;number of bytes	--> reg. B
				;SASI port 0		--> reg. C
	CALL REQWAIT		;wait for data request
SELDRV:	IN   A,(RPORT1)		;read status again
	AND  IOMASK+CDMASK+REQMASK
	CP   IOMASK+CDMASK+REQMASK
	JR   Z,SELDRV1		;jump if data transfer finished
	CP   REQMASK
	JR   NZ,SELDRV		;wait for request
	OTIR			;load disk parameters
	JR   SELDRV

SELDRV1:CALL GETSTAT		;get error status
	JR   NZ,ERREXIT		;any errors ?

INITW2:	BIT  0,(IX+1)		;is drive initialized ?
	JR   NZ,RWINI		;jump if yes

;restore drive heads:
RESTOW:	LD   A,$TSTDRV		;test drive ready
	CALL TASKOUT
	CALL GETSTAT		;get error status
	JR   NZ,RESTOW		;retry if drive not ready
	LD   A,$REST		;recalibrate drive
	CALL TASKOUT
	CALL GETSTAT		;get error status
	JR   NZ,ERREXIT		;any errors ?
	SET  0,(IX+1)		;set init bit in WCT


;EJECT
	 ELSE			;WD1002 part

	EX   DE,HL		;track #  --> reg. HL
	LD   D,0		;clear MSB of divisor
	LD   E,(IX)		;get no. of surfaces
	LD   B,5
	SRL  E
	DJNZ $-2
	INC  E
	CALL DIV		;cylinder # = track # / head count (HL)
				;surface #  = track # % head count (DE)
	LD   A,(DRIVE)		;drive # --> accu
	ADD  A,A		;shift drive # 3 bits left
	ADD  A,A
	ADD  A,A
	ADD  A,E		;add surface #
	LD   E,A		;and save it
	LD   A,(IX+1)		;get sector length bits
	RRA
	AND  60H		;mask sector length bitsЉ	ADD  A,E		;add surface # and drive #
	OR   80H		;set ECC error correction bit
	LD   E,A		;save drive select bits
	BIT  0,(IX+1)		;is drive initialized ?
	JR   NZ,TRKSEW		;yes, skip init process

;restore drive heads:
RESTOW:	IN   A,($STATUS)	;read WDC status
	AND  0C0H		;mask it
	CP   40H		;busy ?
	JR   NZ,RESTOW		;wait `til WDC is ready to accept a command
	OUT  ($SDH),A		;select drive
	LD   A,(IX)		;get step rate bits
	AND  0FH		;mask them
	OR   $REST		;or with "restore" command
	OUT  ($COMND),A		;restore drive heads
RESTO1:	IN   A,($STATUS)	;read WDC status
	BIT  7,A		;restore done ?
	JR   NZ,RESTO1		;no, loop
	SET  0,(IX+1)		;set init bit in WCT

;set track and sector:
TRKSEW:	LD   A,(IX+2)		;set starting track for write precomp
	OUT  ($WPC),A
	LD   A,(SECTOR)		;sector # --> accu
	BIT  4,(IX)		;test number of first sector
	JR   Z,TRKSW1		;jump if zero
	INC  A			;else adjust sector #
TRKSW1:	OUT  ($SECNO),A		;set sector #
	LD   A,L		;set cylinder # (LSB)
	OUT  ($CYLLO),A
	LD   A,H		;set cylinder # (MSB)
	OUT  ($CYLHI),A
	LD   A,E		;restore drive select bits
	OUT  ($SDH),A		;select drive

;init READ/WRITE:
	LD   E,(IX+1)		;get sector length bits
	LD   B,6
	SRL  E
	DJNZ $-2
	LD   C,$DATA		;init byte counter and data port number

	ENDC

RWINI:	LD   HL,(BUFFER)	;get buffer pointer
	LD   A,(RDFLAG)		;READ or WRITE ?
	OR   A
	PUSH AF			;save status
	JR   Z,RWINI1		;jump if write
	LD   A,$$READ		;issue read command
	JR   RWINI2
RWINI1:	LD   A,$$WRITE		;issue write command

	COND SASI		;Xebec part

RWINI2:	CALL TASKOUT

	 ELSE

RWINI2:	OUT  ($COMND),A		;WD1002 partЉ
	ENDC

	LD   A,(BANK)		;bank # of transfer buffer --> accu
	JP   IOW		;handle Winchester I/O in common memory

;test controller status:

	COND SASI		;Xebec part

WDCSTAT:CALL GETSTAT		;get status
	RET  Z			;return if no errors
ERREXIT:LD   A,$STATUS		;request sense status
	CALL TASKOUT

	CALL REQWAIT		;wait for data request
	IN   A,(RPORT0)		;read error code
	LD   D,A		;save it temporarily
	IN   A,(RPORT0)		;skip rest
	IN   A,(RPORT0)
	IN   A,(RPORT0)
	CALL GETSTAT		;get status
	JR   NZ,ERREXIT

	LD   A,D		;restore error code
	AND  7FH
	RET

	 ELSE			;WD1002 part

WDCSTAT:IN   A,($STATUS)	;get WDC status
	AND  1			;any errors ?
	LD   C,A		;save error status
	JR   Z,DSEL		;return if no errors
	IN   A,($ERROR)		;read WDC error register
	LD   C,A		;save error code

DSEL:	LD   A,$DSEL		;deselect drive
	OUT  ($SDH),A
	LD   A,C		;error code --> accu
	RET			;return to caller

	ENDC

;put drive control table pointer in "IX":
GETWCT:	PUSH DE			;save reg. DE
	LD   H,0		;drive # --> reg. HL
	LD   L,A
	ADD  A,A		;drive # * 2
	ADD  A,L		;drive # * 3
	ADD  A,A		;drive # * 6
	ADD  A,L		;drive # * 7
	LD   L,A		;drive # * 7 --> reg. H
	LD   DE,DCTW		;get drive table start
	ADD  HL,DE		;add offset and get ^DCT
	PUSH HL			;^DCT --> reg. IX
	POP  IX
	POP  DE			;restore reg. DE
	RET			;return

BANK:	DEFS 1			;bank number of transfer bufferЉ

;EJECT
	COND SASI		;Xebec part

;output a command to SASI controller:
TASKOUT:PUSH HL			;save regs. HL & IY
	PUSH IY			;save reg. IY
	LD   IY,DCCMD		;^command block --> reg. IY
	LD   (IY),A		;store command
	LD   A,(DRIVE)		;load drive #
	RRCA
	RRCA
	RRCA
	LD   (IY+1),A
	LD   DE,(TRACK)		;track #		 --> reg. DE
	LD   HL,0		;clear result
	LD   B,(IX+4)		;sectors/track		 --> reg. B
TASKO1:	ADD  HL,DE		;track # * sectors/track --> reg. HL
	DJNZ TASKO1
	LD   D,0		;sector #		 --> reg. DE
	LD   A,(SECTOR)
	LD   E,A
	ADD  HL,DE		;block # = track # * sectors/track + sector #
	LD   (IY+2),H		;load block #
	LD   (IY+3),L
	LD   A,(IX)		;get step rate ?
	AND  0FH
	LD   A,0
	JR   NZ,TASKO2		;jump if not
	LD   A,5		;set buffered step mode
TASKO2:	LD   (IY+5),A		;load control byte

TASKO3:	IN   A,(RPORT1)		;read status port
	AND  BUSYMASK		;mask busy bit
	JR   NZ,TASKO3		;jump, if busy
	LD   A,1		;cntlr default select code
	OUT  (WPORT0),A		;send it to transparent latch
TASKO4:	OUT  (WPORT2),A		;generate a select strobe
	IN   A,(RPORT1)		;get cntlr response
	AND  BUSYMASK		;isolate the busy mask
	JR   Z,TASKO4		;wait for cntlr busy

	LD   HL,DCCMD		;^command block --> reg. HL
	LD   BC,6 SHL 8+WPORT0	;byte count	--> reg. B
				;port number	--> reg. C
	CALL REQWAIT		;wait for controller request
	OTIR			;load command

	POP  IY			;restore regs. HL & IY
	POP  HL
	RET

;get status:
GETSTAT:CALL REQWAIT		;wait for request
	IN   A,(RPORT0)		;read in the status byte
	LD   C,A		;save status temporarily
	CALL REQWAIT		;wait for second byte
	IN   A,(RPORT0)		;get the null byte
	LD   A,C		;restore status to A
	AND  ERROR		;isolate the error bitЉ	RET

;Winchester drive parameters:
WPARS:	DEFS 2			;cylinder count
	DEFS 1			;head	  count
	DEFS 2			;starting cylinder for reduced write current
	DEFS 2			;starting cylinder for write precompensation
	DEFB 11			;length of ECC impulse

;command control block:
DCCMD:	DEFS 1			;opcode
	DEFS 1			;luno
	DEFS 2			;block number
	DEFB 1			;block count
	DEFS 1			;control field

SENSE:	DEFS 4			;sense status bytes
OLDW:	DEFB 0FFH		;previously accessed drive

	ENDC


;EJECT
;*******************
;*  $ G T I M E 3  *
;*******************

;entry: HL = pointer to a 5 byte buffer containing on exit
;	     date and time in the form DDDDHHMMSS

;	      DDDD = number of days since January 1st, 1978 (binary    )
;		HH = hours				    (BCD format)
;		MM = minutes				    (BCD format)
;		SS = seconds				    (BCD format)

;get time & date in CP/M 3 format (software clock):
$GTIME3S:
	EX   DE,HL		;^user buffer --> reg. DE
	DI			;critical phase
	JP   GTIME5		;transfer time & date into caller's buffer

;get time & date in CP/M 3 format (hardware clock):
$GTIME3H:
	DI			;critical code (not reentrant)
	PUSH HL			;save ^user buffer
	CALL GETTIM		;read time & date from clock chip
	LD   IX,TIMBUF		;^temp buffer	--> reg. IX
	LD   IY,BINARY$DATE	;^result buffer --> reg. IY

	LD   A,(IX+7)		;hours (tenths) --> reg. C
	AND  3			;make binary
	RLCA			;hours (tenths) --> upper nibble
	RLCA
	RLCA
	RLCA
	LD   C,A		;upper nibble	--> reg. C
	LD   A,(IX+8)		;hours (ones)	--> accu
	AND  0FH		;make binary
	ADD  A,C		;add upper nibble
	LD   (IY+2),A		;store BCD hours
Љ	LD   A,(IX+9)		;minutes (tenths) --> reg. C
	AND  7			;make binary
	RLCA			;minutes (tenths) --> upper nibble
	RLCA
	RLCA
	RLCA
	LD   C,A		;upper nibble	  --> reg. C
	LD   A,(IX+10)		;minutes (ones)   --> accu
	AND  0FH		;make binary
	ADD  A,C		;add upper nibble
	LD   (IY+3),A		;store BCD minutes

	LD   A,(IX+11)		;seconds (tenths) --> reg. C
	AND  7			;make binary
	RLCA			;seconds (tenths) --> upper nibble
	RLCA
	RLCA
	RLCA
	LD   C,A		;upper nibble	  --> reg. C
	LD   A,(IX+12)		;seconds (ones)   --> accu
	AND  0FH		;make binary
	ADD  A,C		;add upper nibble
	LD   (IY+4),A		;store BCD seconds

	LD   A,(IX+1)		;year (ones)   --> accu
	AND  0FH		;make binary
	LD   C,A		;year (ones)   --> reg. C
	LD   A,(IX)		;year (tenths) --> accu
	AND  0FH		;make binary
	CALL BCDBIN		;convert BCD year to binary
	LD   (YEAR),A		;store it

	LD   A,(IX+3)		;month (ones)	--> accu
	AND  0FH		;make binary
	LD   C,A		;month (ones)	--> reg. C
	LD   A,(IX+2)		;month (tenths) --> accu
	AND  1			;make binary
	CALL BCDBIN		;convert BCD month to binary
	LD   (MONTH),A		;store it

	LD   A,(IX+5)		;day (ones)   --> accu
	AND  0FH		;make binary
	LD   C,A		;day (ones)   --> reg. C
	LD   A,(IX+4)		;day (tenths) --> accu
	AND  3			;make binary
	CALL BCDBIN		;convert BCD day to binary
	LD   (DAY),A		;store it

	LD   A,(YEAR)		;binary year --> accu
	SUB  78			;subtract base year
	JR   NC,GTIME1		;result negative ?
	ADD  A,100		;correct year
GTIME1:	SRL  A			;year / 4 --> accu
	RR   C			;year % 4 --> reg. C
	SRL  A
	RR   C
	LD   B,6
GTIME2:	SRL  C
	DJNZ GTIME2
	LD   HL,0		;clear daycount
	OR   A			;year / 4 == 0 ?Љ	JR   Z,GTIME4		;no multiplication
	LD   B,A		;year / 4 --> reg. B
	LD   DE,1461		;number of days in 4 years --> reg. DE
GTIME3:	ADD  HL,DE		;daycount = year / 4 * 1461
	DJNZ GTIME3
GTIME4:	EX   DE,HL		;daycount --> reg. DE

;calc table index:
	LD   A,C		;year %  4    --> accu
	ADD  A,A		;accu *  2
	ADD  A,A		;accu *  4
	LD   C,A		;accu *  4    --> reg. C
	ADD  A,A		;accu *  8
	ADD  A,C		;accu * 12
	LD   C,A		;accu * 12    --> reg. C
	LD   A,(MONTH)		;binary month --> accu
	DEC  A			;normalize
	ADD  A,C		;index = year % 4 * 12 + month - 1
	ADD  A,A		;make byte index
	LD   C,A		;table index	   --> reg. BC
	LD   HL,MONTAB		;base of day table --> reg. HL
	ADD  HL,BC		;add index
	LD   A,(HL)		;table[index]	   --> reg. HL
	INC  HL
	LD   H,(HL)
	LD   L,A

	ADD  HL,DE		;daycount += table[index]
	LD   A,(DAY)		;binary day --> accu
	LD   C,A		;day	    --> reg. BC
	ADD  HL,BC		;now reg. HL contains number of days
				;since January 1st, 1978

	LD   (IY),L		;store daycount
	LD   (IY+1),H

	POP  DE			;restore ^user buffer
GTIME5:	LD   HL,BINARY$DATE	;^temporary buffer --> reg. HL
	LD   B,5		;buffer length	   --> reg. B
	LD   A,(INT)		;called from interrupt service routine ?
	OR   A
	LD   A,1		;source bank	  = 0
				;destination bank = 1
	JP   Z,$XMOVE		;move time & date into user buffer and return,
				;if not called from interrupt service routine

	LD   BC,5		;buffer length --> reg. BC
	LDIR			;no interbank move, if called from interrupt
	RET			;service routine

;convert BCD to binary:
BCDBIN:	ADD  A,A		;lower nibble *  2
	LD   B,A		;lower nibble *  2 --> reg. B
	ADD  A,A		;lower nibble *  4
	ADD  A,A		;lower nibble *  8
	ADD  A,B		;lower nibble * 10
	ADD  A,C		;add lower nibble
	RET

YEAR:	DEFS 1
MONTH:	DEFS 1ЉDAY:	DEFS 1


;EJECT
;*******************
;*  $ S T I M E 3  *
;*******************

;entry:  D = hours   (HH)
;	 E = minutes (MM)
;	HL = number of days since January 1st, 1978 (binary)

;set time & date in CP/M 3 format (software clock):
$STIME3S:
	DI			;critical phase
	LD   (BINARY$DATE),HL	;load binary date
	LD   HL,TIME$IN$BCD	;^BCD time --> reg. HL
	LD   (HL),D		;load BCD hours
	INC  HL
	LD   (HL),E		;load BCD minutes
	INC  HL
	LD   (HL),0		;reset BCD seconds
	RET			;return to caller

;set time & date in CP/M 3 format (hardware clock):
$STIME3H:
	PUSH DE			;save hours & minutes
	PUSH HL			;save daycount
	DEC  HL			;normalize

	XOR  A			;clear quotient
	LD   DE,1461		;number of days in 4 years --> reg. DE
STIME1:	SBC  HL,DE		;daycount / 1461	   --> accu
	JR   C,STIME2
	INC  A
	JR   STIME1
STIME2:	ADD  HL,DE		;adjust remainder
	EX   DE,HL		;remainder --> reg. DE
	ADD  A,A		;accu * 2
	ADD  A,A		;accu * 4
	LD   (YEAR),A		;year = daycount / 1461 * 4

;search table entry:
	LD   A,47		;last index	   --> accu
STIME3:	LD   H,0		;index #	   --> reg. HL
	LD   L,A
	ADD  HL,HL		;make byte index
	LD   BC,MONTAB		;dase of day table --> reg. BC
	ADD  HL,BC		;calc table entry
	LD   B,(HL)		;table[index]	   --> reg. HL
	INC  HL
	LD   H,(HL)
	LD   L,B
	SBC  HL,DE		;daycount >= table index ?
	JR   C,STIME4		;if yes search finished
	JR   Z,STIME4
	DEC  A			;index = index - 1
	JP   P,STIME3

STIME4:	LD   B,0		;clear quotient
STIME5:	SUB  12			;index / 12 --> accuЉ	JR   C,STIME6
	INC  B			;increment quotient
	JR   STIME5
STIME6:	ADD  A,13		;adjust remainder and calc month
	LD   (MONTH),A		;store it
	LD   A,(YEAR)		;year --> accu
	ADD  A,B		;year += index / 12
	SUB  22			;normalize
	JR   NC,STIME7		;year negative ?
	ADD  A,100		;correct it
STIME7:	LD   (YEAR),A		;store it
	LD   A,L		;table[index] - daycount --> accu
	NEG			;daycount - table[index] --> accu
	INC  A			;day = daycount - table[index] + 1
	LD   (DAY),A		;store it

	POP  HL			;restore day count
	LD   A,H		;daycount (MSB)       --> accu
	LD   C,L		;daycount (LSB)       --> reg. C
	LD   DE,7		;no. of days per week --> reg. DE
	LD   HL,0		;clear accumulator
	LD   B,16		;init counter
STIME8:	RL   C			;rotate result left
	RLA
	ADC  HL,HL		;shift left
	SBC  HL,DE		;subtract divisor
	JR   NC,$+3		;subtraction ok
	ADD  HL,DE		;restore accumulator
	CCF			;complement carry flag
	DJNZ STIME8		;counter = 0 ?
	LD   A,L		;weekday no. --> accu
	PUSH AF			;save weekday

	LD   A,(MONTH)		;binary month --> accu
	CALL BINBCD		;convert to BCD format
	LD   D,A		;save month

	LD   A,(DAY)		;binary day --> accu
	CALL BINBCD		;convert to BCD format
	LD   H,A		;BCD day     --> reg. H
	LD   A,(YEAR)		;binary year --> accu
	RRA			;year / 4
	JR   C,STIME9
	RRA
	JR   C,STIME9
	SET  6,H		;set leapyear flag

STIME9:	LD   A,(YEAR)		;binary year --> accu
	CALL BINBCD		;convert to BCD format
	LD   L,A		;BCD year    --> reg. L

	LD   B,D		;BCD month   --> reg. B
	POP  AF			;weekday     --> accu
	POP  DE			;BCD hours   --> reg. D
				;BCD minutes --> reg. E
	SET  7,D		;set "24 hour" format
	JP   $SETTIM		;set time & date and return to caller

;convert binary to BCD:
BINBCD:	LD   C,0		;clear result
BINBC1:	SUB  10			;accu / 10Љ	JR   C,BINBC2
	INC  C			;increment quotient
	JR   BINBC1
BINBC2:	ADD  A,10		;adjust remainder
	LD   B,4
BINBC3:	SLA  C			;quotient --> upper nibble
	DJNZ BINBC3
	ADD  A,C		;add remainder
	RET

;day table:
;	     Jan  Feb  Mar  Apr  May  Jun  Jul	Aug  Sep  Oct  Nov  Dec
MONTAB:	DEFW 0000,0031,0059,0090,0120,0151,0181,0212,0243,0273,0304,0334  ;1978
	DEFW 0365,0396,0424,0455,0485,0516,0546,0577,0608,0638,0669,0699  ;1979
	DEFW 0730,0761,0790,0821,0851,0882,0912,0943,0974,1004,1035,1065  ;1980
	DEFW 1096,1127,1155,1186,1216,1247,1277,1308,1339,1369,1400,1430  ;1981


;EJECT
;*******************
;*  $ L D C H A R  *
;*******************

;entry:  A = ASCII code of character to be loaded (00 - 7F)
;	HL = address of dot matrix (16 bytes)

;load user character:
$LDCHAR:AND  7FH		;make seven bit ASCII code
	PUSH AF			;save ASCII code
	LD   DE,PATTERN		;^dot matrix	 --> reg. DE
	LD   B,16		;number of bytes --> reg. B
	LD   A,10H		;source bank	  = 1
				;destination bank = 0
	CALL $XMOVE		;load matrix
	POP  BC			;ASCII code --> reg. B
	IN   A,($SYS1)		;read system byte 1
	AND  11010110B		;enable memory mapped I/O
				;disable graphic page
	OR   01000100B		;disable boot EPROM
				;7.2 MHz clock frequency
	OUT  ($SYS1),A		;write system byte 1
	IN   A,($SYS0)		;read system byte 0
	AND  00111111B		;enable bank 0
	OR   00000011B		;enable character RAM
	DI			;disable interrupts
	OUT  ($SYS0),A		;write system byte 0
	LD   A,(3C00H)		;save character at 3C00
	LD   (SAVECH),A
	LD   A,B		;ASCII code --> accu
	LD   (3C00H),A		;load ASCII code
	LD   DE,PATTERN		;^dot matrix		     --> reg. DE
	LD   HL,8400H		;^first character	     --> reg. HL
	LD   B,16		;maximum count of scan lines --> reg. B
LDCHAR1:LD   A,(DE)		;get first scan line
	LD   (HL),A		;load character RAM
	INC  DE			;bump scan line pointer
	LD   A,8		;bump ^scan line in character RAM
	ADD  A,H
	LD   H,A
	DJNZ LDCHAR1		;load next scan line
	LD   A,(3C00H)		;get ASCII codeЉ	OR   80H		;set MSB
	LD   (3C00H),A		;reload code
	LD   DE,PATTERN		;^dot matrix		     --> reg. DE
	LD   HL,8400H		;^first character	     --> reg. HL
	LD   B,16		;maximum count of scan lines --> reg. B
LDCHAR2:LD   A,(DE)		;get first scan line
	CPL			;invert bit pattern
	LD   (HL),A		;load character RAM
	INC  DE			;bump scan line pointer
	LD   A,8		;bump ^scan line in character RAM
	ADD  A,H
	LD   H,A
	DJNZ LDCHAR2		;load next scan line
	LD   A,(SAVECH)		;restore character at 3C00
	LD   (3C00H),A
	IN   A,($SYS0)		;read system byte 0
	AND  00111101B		;disable character RAM
	OUT  ($SYS0),A		;write system byte 0
	RET			;return to caller
PATTERN:DEFS 16			;temporary storage area for dot matrix
SAVECH:	DEFS 1


;EJECT
;*******************
;*  $ R S T C H R  *
;*******************

;restore original character set:
$RSTCHR:IN   A,($SYS1)		;read system byte 1
	AND  11010110B		;enable memory mapped I/O
				;disable graphic page
	OR   01000100B		;disable boot EPROM
				;7.2 MHz clock frequency
	OUT  ($SYS1),A		;write system byte 1
	IN   A,($SYS0)		;read system byte 0
	AND  00111111B		;enable bank 0
	OR   00000011B		;enable character RAM
	DI			;disable interrupts
	OUT  ($SYS0),A		;write system byte 0
	LD   A,(3C00H)		;save character at 3C00
	LD   (SAVECH),A
	XOR  A			;reset code counter
	LD   DE,FONTSET		;^dot matrices --> reg. DE
RSTCHR1:LD   (3C00H),A		;load ASCII code
	LD   HL,8400H		;^first character	     --> reg. HL
	LD   B,16		;maximum count of scan lines --> reg. B
RSTCHR2:LD   A,(DE)		;get first scan line
	LD   (HL),A		;load character RAM
	INC  DE			;bump scan line pointer
	LD   A,8		;bump ^scan line in character RAM
	ADD  A,H
	LD   H,A
	DJNZ RSTCHR2		;load next scan line
	LD   A,(3C00H)		;get ASCII code
	INC  A			;increment ASCII code
	JP   P,RSTCHR1		;load next character

;load inverted characters
	LD   DE,FONTSET		;^dot matrices --> reg. DE
RSTCHR3:LD   (3C00H),A		;load ASCII codeЉ	LD   HL,8400H		;^first character	     --> reg. HL
	LD   B,16		;maximum count of scan lines --> reg. B
RSTCHR4:LD   A,(DE)		;get first scan line
	CPL			;invert bit pattern
	LD   (HL),A		;load character RAM
	INC  DE			;bump scan line pointer
	LD   A,8		;bump ^scan line in character RAM
	ADD  A,H
	LD   H,A
	DJNZ RSTCHR4		;load next scan line
	LD   A,(3C00H)		;get ASCII code
	INC  A			;increment ASCII code
	JR   NZ,RSTCHR3		;load next character
	LD   A,(SAVECH)		;restore character at 3C00
	LD   (3C00H),A

;select ASCII or national character set:
SELCHR:	IN   A,($SYS0)		;read system byte 0
	AND  00111111B		;enable bank 0
	OR   00000011B		;enable character RAM
	DI			;disable interrupts
	OUT  ($SYS0),A		;write system byte 0
	LD   A,(3C00H)		;save character at 3C00
	LD   (SAVECH),A
	LD   IX,NATIONAL	;^national codes --> reg. IX
	LD   A,(GERMAN)		;national char set ?
	OR   A
	JR   Z,SELCHR1		;jump if no
	LD   DE,FONTSET+136*16	;^dot matrices	--> reg. DE
	JR   SELCHR2
SELCHR1:LD   DE,FONTSET+128*16	;^dot matrices	--> reg. DE
SELCHR2:LD   A,(IX)		;character code --> accu
	OR   A			;end of table ?
	JR   Z,SELCHR4		;jump if yes
	INC  IX			;bump table ptr
	LD   (3C00H),A		;load ASCII code
	LD   HL,8400H		;^first character	     --> reg. HL
	LD   B,16		;maximum count of scan lines --> reg. B
SELCHR3:LD   A,(DE)		;get first scan line
	LD   (HL),A		;load character RAM
	INC  DE			;bump scan line pointer
	LD   A,8		;bump ^scan line in character RAM
	ADD  A,H
	LD   H,A
	DJNZ SELCHR3		;load next scan line
	JR   SELCHR2		;load next character

;load inverted characters:
SELCHR4:LD   IX,NATIONAL	;^national codes --> reg. IX
	LD   A,(GERMAN)		;national char set ?
	OR   A
	JR   Z,SELCHR5		;jump if no
	LD   DE,FONTSET+136*16	;^dot matrices	--> reg. DE
	JR   SELCHR6
SELCHR5:LD   DE,FONTSET+128*16	;^dot matrices	--> reg. DE
SELCHR6:LD   A,(IX)		;character code --> accu
	OR   A			;end of table ?
	JR   Z,SELCHR8		;jump if yes
	OR   80H		;make code of inverted char
	INC  IX			;bump table ptr
	LD   (3C00H),A		;load ASCII codeЉ	LD   HL,8400H		;^first character	     --> reg. HL
	LD   B,16		;maximum count of scan lines --> reg. B
SELCHR7:LD   A,(DE)		;get first scan line
	CPL			;invert bit pattern
	LD   (HL),A		;load character RAM
	INC  DE			;bump scan line pointer
	LD   A,8		;bump ^scan line in character RAM
	ADD  A,H
	LD   H,A
	DJNZ SELCHR7		;load next scan line
	JR   SELCHR6		;load next character

SELCHR8:LD   A,(SAVECH)		;restore character at 3C00
	LD   (3C00H),A
	IN   A,($SYS0)		;read system byte 0
	AND  00111101B		;disable character RAM
	OUT  ($SYS0),A		;write system byte 0
	EI			;reenable interrupts
	RET			;return to caller


;codes of national character set:
NATIONAL:
	DEFM '@[\]{|}~'
	DEFB 0


;EJECT
;*******************
;*  $ S C R N I O  *
;*******************

;entry:  A = control code
;	     0	read  window
;	     1	write window
;	HL = address of user buffer
;	 D = 0	contiguous  buffer
;	     1	full screen buffer
;	 E = attribute
;	     0	normal	 display
;	     1	inverted display

;direct screen I/O:
$SCRNIO:LD   IX,(VDTABP)	;^screen constants --> reg. IX
	LD   (IOMODE),A		;save I/O mode
	PUSH HL			;save ^user buffer
	PUSH DE			;save buffer mode
	LD   A,(IX+8)		;save current line
	LD   (SLINE),A
	LD   A,(IX+9)		;save current column
	LD   (SCOLUMN),A
	LD   A,(IX+11)		;save current display mode
	LD   (SMODE),A
	LD   A,(IX+12)		;save cursor state
	LD   (SCUROFF),A
	LD   A,(WRAP)		;save "wrap around" mode
	LD   (SWRAP),A
	DEC  E			;test display mode
	JR   Z,SCRNIO1		;jump if inverse display mode
	CALL INVOFF		;turn on normal display mode
	JR   SCRNIO2ЉSCRNIO1:CALL INVON		;turn on inverse display mode
SCRNIO2:CALL CUROFF		;turn off cursor
	CALL WRAPOFF		;turn off "wrap around" mode
	CALL HOME		;home cursor

	POP  DE			;get buffer mode
	DEC  D			;calc buffer increment
	JR   Z,SCRNIO3		;jump if full screen buffer
	LD   A,(IX+7)		;buffer increment = column count
	JR   SCRNIO4
SCRNIO3:LD   A,(IX+1)		;buffer increment = maximum column count
	POP  DE			;get base address of screen buffer
	ADD  HL,DE		;add cursor address (returned from "HOME")
	PUSH HL			;save actual buffer address
SCRNIO4:LD   (BINC),A		;store buffer increment

;screen I/O:
	LD   A,(IOMODE)
	OR   A			;read or write screen ?
	JR   NZ,SCRNIO9		;jump if write screen


;EJECT
;read screen:
SCRNIO5:LD   IY,LINBUF		;^temp buffer --> reg. IY
	LD   B,(IX+7)		;column count --> reg. B
	IN   A,($SYS1)		;read system byte 1
	AND  11010110B		;enable memory mapped I/O
				;disable graphic page
	OR   01010100B		;disable boot EPROM
				;enable full screen
				;7.2 MHz clock frequency
	OUT  ($SYS1),A		;write system byte 1

SCRNIO6:PUSH BC			;save remaining column count
	LD   HL,(CURADR)	;absolute screen address --> reg. HL
	LD   A,(HL)		;character under cursor  --> accu
	AND  7FH		;mask it
	CP   (IX+10)		;erase character ?
	JR   NZ,SCRNIO7		;jump if not
	LD   A,' '		;convert it to space
SCRNIO7:CP   ' '		;graphic character ?
	JR   NC,SCRNIO8		;jump if not
	ADD  A,80H		;convert code of graphic character
SCRNIO8:LD   (IY),A		;store character
	INC  IY			;inc buffer pointer
	CALL CURRGT		;move cursor right
	POP  BC			;restore column count
	DJNZ SCRNIO6		;read next character

	IN   A,($SYS1)		;read system byte 1
	OR   01010101B		;disable memory mapped I/O
	OUT  ($SYS1),A		;write system byte 1
	LD   HL,LINBUF		;source      address --> reg. HL
	POP  DE			;destination address --> reg. DE
	PUSH DE
	LD   B,(IX+7)		;byte count	     --> reg. B
	LD   A,1		;source      bank = 0
				;destination bank = 1
	CALL $XMOVE		;transfer screen line into user buffer
Љ	LD   A,(IX+8)		;current line --> accu
	CP   (IX+4)		; == bottom line ?
	JR   Z,SCRNI12		;jump if yes

	CALL NEWLIN		;carriage return
	CALL CURDWN		;line feed

	LD   HL,(BINC)		;buffer increment --> reg. HL
	LD   H,0
	POP  DE			;buffer pointer   --> reg. DE
	ADD  HL,DE		;increment buffer pointer
	PUSH HL			;save it
	JR   SCRNIO5		;read next line


;EJECT
;write screen:
SCRNIO9:POP  HL			;source      address --> reg. HL
SCRNI10:PUSH HL			;save it
	LD   DE,LINBUF		;destination address --> reg. HL
	LD   B,(IX+7)		;byte count	     --> reg. B
	LD   A,10H		;source      bank = 1
				;destination bank = 0
	CALL $XMOVE		;transfer screen line into user buffer

	LD   IY,LINBUF		;^temp buffer --> reg. IY
	LD   B,(IX+7)		;column count --> reg. B
	IN   A,($SYS1)		;read system byte 1
	AND  11010110B		;enable memory mapped I/O
				;disable graphic page
	OR   01010100B		;disable boot EPROM
				;enable full screen
				;7.2 MHz clock frequency
	OUT  ($SYS1),A		;write system byte 1

SCRNI11:PUSH BC			;save remaining column count
	LD   A,(IY)		;character --> accu
	CALL NORMAL		;display character
	INC  IY			;inc buffer pointer
	POP  BC			;restore column count
	DJNZ SCRNI11		;display next character

	IN   A,($SYS1)		;read system byte 1
	OR   01010101B		;disable memory mapped I/O
	OUT  ($SYS1),A		;write system byte 1

	LD   A,(IX+8)		;current line --> accu
	CP   (IX+4)		; == bottom line ?
	JR   Z,SCRNI12		;jump if yes

	CALL NEWLIN		;carriage return
	CALL CURDWN		;line feed

	LD   HL,(BINC)		;buffer increment --> reg. HL
	LD   H,0
	POP  DE			;buffer pointer   --> reg. DE
	ADD  HL,DE		;increment buffer pointer
	JR   SCRNI10		;write next line


;EJECTЉ;restore old screen state:
SCRNI12:POP  HL			;adjust stack pointer
	LD   A,(SLINE)		;restore current line
	LD   (IX+8),A
	LD   A,(SCOLUMN)	;restore current column
	LD   (IX+9),A
	LD   A,(SMODE)		;restore current display mode
	LD   (IX+11),A
	LD   A,(SCUROFF)	;restore cursor state
	LD   (IX+12),A
	LD   A,(SWRAP)		;restore "wrap around" mode
	LD   (WRAP),A
	CALL OUTCUR		;position cursor
	JP   CURON+4		;turn on (?) cursor and return to caller

;temporary storage area:
SLINE:	DEFS 1			;current cursor line
SCOLUMN:DEFS 1			;current cursor column
SMODE:	DEFS 1			;current display mode
SCUROFF:DEFS 1			;current cursor state
SWRAP:	DEFS 1			;current "wrap around" mode
IOMODE:	DEFS 1			;read or write screen ?
BINC:	DEFS 1			;buffer pointer increment
LINBUF:	DEFS 80			;line buffer


;EJECT
;***************
;*  $ I N I T  *
;***************

;general initialization routine:
$INIT:	DI			;disable interrupts
	IM   1			;select interrupt mode 1 (RST 38H)
	IN   A,($SYS0)		;read system byte 0
	AND  00110011B		;enable bank 0
				;RTC interrupt only
	OUT  ($SYS0),A		;write system byte 0

	CALL $RSTCHR		;load character set

	XOR  A			;source bank	  = 0
				;destination bank = 0
	LD   HL,VIDPAR		;^video parameters --> reg. HL
	CALL VDINIT1		;initialize video controller chip MC6845

	LD   A,ESC		;select national character set
	CALL $VDCHAR
	LD   A,(CHRSET)
	CALL $VDCHAR

	LD   B,0		;# of RS232C interface --> reg. B
	LD   HL,(SER0)		;data format	       --> accu
	LD   A,L
	LD   E,H		;baud rate	       --> reg. E
	CALL $RSINIT		;initialize Z80 SIO A

	LD   B,1		;# of RS232C interface --> reg. B
	LD   HL,(SER1)		;data format	       --> accu
	LD   A,L
	LD   E,H		;baud rate	       --> reg. EЉ	CALL $RSINIT		;initialize Z80 SIO B

	LD   HL,PIO$INIT$TBL	;initialize Z80 PIO
STREAM$OUT:
	LD   A,(HL)
	OR   A
	JR   Z,$FCINIT
	LD   B,A
	INC  HL
	LD   C,(HL)
	INC  HL
	OTIR
	JR   STREAM$OUT		;now Z80 PIO acts as Centronics interface
PIO$INIT$TBL:
	DEFB 2,0D6H,0FH,07H
	DEFB 3,0D7H,0CFH,0F0H,07H
	DEFB 1,0D5H,01H
	DEFB 0

$FCINIT:LD   A,$FCINT		;initialize floppy disk controller chip WD2791
	OUT  ($FDCMD),A


;EJECT
;powerup/reset test:
	LD   A,10H		;source      bank    = 1
				;destination bank    = 0
	LD   HL,0038H		;source      address = interrupt entry point
	LD   DE,JUMP		;destination address = test variable
	LD   B,1		;byte count	     = 1
	CALL $XMOVE		;get byte from interrupt entry point in bank 1

	LD   A,(JUMP)		;JP ?
	CP   0C3H
	JR   NZ,$POWUP		;jump if power up
	XOR  A			;clear power up marker
	JR   $RESET
$POWUP:	LD   HL,1		;reset binary date
	LD   (BINARY$DATE),HL
	LD   HL,TIME$IN$BCD	;^BCD time --> reg. HL
	XOR  A
	LD   (HL),A		;reset BCD hours
	INC  HL
	LD   (HL),A		;reset BCD minutes
	INC  HL
	LD   (HL),A		;reset BCD seconds
	CPL			;set power up marker
$RESET:	LD   (POWUP),A

;set interrupt jump vectors:
	LD   A,3		;initialize bank number
$SETINT:LD   HL,0038H		;interrupt entry point --> reg. HL & DE
	LD   D,H
	LD   E,L
	LD   B,3		;byte count	       --> reg. B
	PUSH AF			;save bank number
	CALL $XMOVE		;transfer jump vector
	POP  AF			;restore bank number
	DEC  A			;decrement bank number
	JR   NZ,$SETINT		;load next interrupt entry point
Љ;hardware clock ?
	LD   A,(CLOCK)
	OR   A
	JR   Z,$CLSGR		;jump if not
	LD   HL,$GTIME3H	;alter entry vectors to
	LD   ($GTIME3),HL	;clock maintenance routine
	LD   HL,$STIME3H
	LD   ($STIME3),HL

;clear graphic pages:
$CLSGR:	XOR  A			;colour = black
	LD   B,A		;clear graphic page 0
	CALL $CLS
	XOR  A			;colour = black
	LD   B,1		;clear graphic page 1
	CALL $CLS

;calc number of graphic scan lines:
	LD   BC,(VIDPAR+8)	;number of scan lines per text line --> reg. B
	INC  B
	LD   DE,(VIDPAR+6)	;number of text lines		    --> reg. DE
	LD   D,0
	LD   H,D
	LD   L,D
LOOP:	ADD  HL,DE		;calc total number of scan lines - 1
	DJNZ LOOP
	DEC  HL
	LD   (YMAX),HL		;store them

;build table of y-addresses:
	LD   BC,(VIDPAR+5)	;number of text lines --> reg. B
	LD   DE,YTAB		;^address table       --> reg. DE
	LD   HL,8000H		;^graphic screen      --> reg. HL
OLOOP:	PUSH BC			;save line counter
	LD   (YBASE),HL		;store base address
	LD   BC,(VIDPAR+8)	;number of scan lines per text line --> reg. B
	INC  B
ILOOP:	LD   A,L		;calc y address
	LD   (DE),A
	INC  DE
	LD   A,H
	LD   (DE),A
	INC  DE
	LD   A,8
	ADD  A,H
	LD   H,A
	DJNZ ILOOP		;process next scan line
	LD   HL,(YBASE)		;bump base address
	LD   BC,80
	ADD  HL,BC
	POP  BC			;restore line counter
	DJNZ OLOOP		;process next text line

;build table of normalized y-addresses:
	LD   IX,YNTAB		;^address table --> reg. IX
	LD   DE,0		;initialize scan line counter

NOLOOP:	PUSH DE			;save it

	LD   BC,(VIDPAR+8)	;number of scan lines per text line --> reg. B
	INC  BЉ	LD   HL,0
NILOOP:	ADD  HL,DE		;y-coordinate * # of scan lines
	DJNZ NILOOP

	LD   DE,18		;load divisor
	CALL DIV
	LD   A,E		;remainder --> accu
	CP   9			;remainder >= 9 ?
	JR   C,$+3		;jump if not
	INC  HL			;round normalized y-coordinate

	ADD  HL,HL		;make word index
	LD   DE,YTAB		;^unnormalized address table --> reg. DE
	ADD  HL,DE		;calc entry address
	LD   A,(HL)		;copy table entry
	LD   (IX),A
	INC  IX
	INC  HL
	LD   A,(HL)
	LD   (IX),A
	INC  IX

	POP  DE			;restore scan line counter
	INC  DE			;increment it
	LD   HL,450		;total count of scan lines --> reg. HL
	CALL CMP		;reached ?
	JR   NZ,NOLOOP		;process next scan line if not
	RET

YBASE:	DEFS 2			;base address of graphic screen - 80
JUMP:	DEFS 1			;byte at 0038H in bank 1


;EJECT
;*****************
;*  $ C L O C K  *
;*****************

;entry: A =  0	clock display off
;	  <> 0	clock display on
;	B = line   number (0 - 24)
;	E = column number (0 - 79)

;set clock display on/off:
$CLOCK:	LD   IX,(VDTABP)	;^screen constants		  --> reg. IX
	LD   HL,$SCREEN		;address of first screen location --> reg. HL
	LD   C,E		;display column 		  --> reg. C
	LD   D,0		;maximum column count		  --> reg. DE
	LD   E,(IX+1)
	DEC  B			;calc absolute screen address
	INC  B
	JR   Z,CLOCK2
CLOCK1:	ADD  HL,DE
	DJNZ CLOCK1
CLOCK2:	LD   E,C
	ADD  HL,DE
	LD   (CLOCK$LOC),HL	;save display address
	LD   (CLOCKON),A	;set/reset display marker
	RET			;return to caller
CLOCKON:DEFB 0
CLOCK$LOC:Љ	DEFS 2


;EJECT
;***************
;*  $ D I S P  *
;***************

;entry: A =  0	turn off graphic display
;	  <> 0	turn on  graphic display
;	B =  graphic page number (0, 1)

$DISP:	LD  C,A			;save accu
	IN  A,($SYS0)		;read system byte 0
	AND 00100001B		;enable bank 0
				;select graphic page 0
				;RTC interrupt only
				;disable character RAM
	INC B			;test page number
	DEC B
	JR  Z,DISP1		;jump if page 0
	SET 4,A			;select page 1
DISP1:	OUT ($SYS0),A		;write system byte 0

	IN  A,($SYS1)		;read system byte 1
	AND 11010101B		;7.2 MHz clock rate
				;disable graphic page
				;disable boot ROM
				;disable graphic display
				;disable memory mapped I/O
	INC C			;test display mode
	DEC C
	JR  Z,DISP2		;jump if no display
	SET 1,A			;enable graphic display
DISP2:	OUT ($SYS1),A		;write system byte 1
	RET			;return to caller


;EJECT
;*************
;*  $ C L S  *
;*************

;entry: A = 0  black
;	    1  white
;	B = graphic page number (0, 1)

;clear graphic page:
$CLS:	LD  C,A			;save colour
	IN  A,($SYS0)		;read system byte 0
	AND 00010001B		;enable bank 0
				;select graphic page 0
				;RTC interrupt only
				;disable character RAM
	INC B			;test page number
	DEC B
	JR  Z,CLS1		;jump if page 0
	SET 5,A			;select page 1
CLS1:	OUT ($SYS0),A		;write system byte 0

Љ	IN  A,($SYS1)		;read system byte 1
	OR  01011101B		;7.2 MHz clock rate
				;enable graphic page
				;disable boot ROM
				;disable memory mapped I/O
	DI			;disable interrupts
	OUT ($SYS1),A		;write system byte 1

	LD  A,C			;restore colour
	LD  HL,8000H		;^graphic memory	--> reg. HL
	LD  DE,8001H		;^graphic memory + 1	--> reg. DE
	LD  BC,7FFFH		;size of graphic memory --> reg. BC
	OR  A			;colour ?
	JR  Z,CLS2		;jump if black
	LD  A,0FFH		;select white
CLS2:	LD  (HL),A
	LDIR			;clear graphic page

	IN  A,($SYS1)		;read system byte 1
	AND 11010111B		;disable graphic page
	OUT ($SYS1),A		;write system byte 1
	RET			;return to caller


;EJECT
;***************
;*  $ P L O T  *
;***************

;entry:  A = 0	non-normalized (high nibble)
;	     1	    normalized
;	     0	black	       (low  nibble)
;	     1	white
;	 B = graphic page number (0, 1)
;	HL = y-coordinate (0 - YYY)
;	DE = x-coordinate (0 - 639)

$PLOT:	PUSH BC			;save graphic page #
	PUSH AF			;save colour
	PUSH DE			;save x-coordinate
	AND  0F0H		;normalize y-coordinate ?
	JR   Z,PLOT1		;jump if not

;normalize y-coordinate:
	EX   DE,HL		;y-coordinate		  --> reg. DE
	OR   A			;clear carry flag
	LD   HL,449		;maximum scan line number --> reg. HL
	SBC  HL,DE		;calc physical y-coordinate
	POP  DE			;restore x-coordinate
	JR   C,PLOT2		;jump if overflow

	PUSH DE			;save x-coordinate

	ADD  HL,HL		;make word index
	LD   DE,YNTAB		;^y-addresses --> reg. DE
	ADD  HL,DE		;get entry address
	LD   E,(HL)		;y-address    --> reg. DE
	INC  HL
	LD   D,(HL)
	JR   PLOT4
Љ
;EJECT
PLOT1:	EX   DE,HL		;y-coordinate		  --> reg. DE
	OR   A			;clear carry flag
	LD   HL,(YMAX)		;maximum scan line number --> reg. HL
	SBC  HL,DE		;calc physical y-coordinate
	POP  DE			;restore x-coordinate
	JR   NC,PLOT3		;jump if no overflow
PLOT2:	POP  HL			;adjust stack
	POP  HL
	RET

PLOT3:	PUSH DE			;save x-coordinate

	ADD  HL,HL		;make word index
	LD   DE,YTAB		;^y-addresses --> reg. DE
	ADD  HL,DE		;get entry address
	LD   E,(HL)		;y-address    --> reg. DE
	INC  HL
	LD   D,(HL)

PLOT4:	POP  HL			;get x-coordinate
;divide x-coordinate by 8:
	XOR  A			;clear remainder
	SRL  H			;/ 2
	RR   L
	RRA
	SRL  H			;/ 4
	RR   L
	RRA
	SRL  H			;/ 8
	RR   L
	RRA

	LD   C,A		;save accu
	LD   A,H		;test MSB of result
	OR   A
	JR   NZ,PLOT2		;return if overflow
	LD   A,L		;test LSB of result
	CP   80
	JR   NC,PLOT2		;return if overflow
	LD   A,C		;restore accu

	ADD  HL,DE		;final result = y-address + x / 8
	SET  7,H		;select upper 32K page

	RRA			;build SET/RES instruction
	RRA
	OR   0C6H		;SET instruction
	POP  BC			;get colour
	BIT  0,B		;black or white ?
	JR   NZ,$+4		;jump if white
	AND  0BEH		;RES instruction
	LD   (SETRES),A		;load instruction

	IN   A,($SYS0)		;read system byte 0
	AND  00010001B		;enable bank 0
				;select graphic page 0
				;RTC interrupt only
				;disable character RAM
	POP BC			;get  page numberЉ	INC B			;test page number
	DEC B
	JR  Z,PLOT5		;jump if page 0
	SET 5,A			;select page 1
PLOT5:	OUT ($SYS0),A		;write system byte 0

	IN  A,($SYS1)		;read system byte 1
	OR  01011101B		;7.2 MHz clock rate
				;enable graphic page
				;disable boot ROM
				;disable memory mapped I/O
	DI			;disable interrupts
	OUT ($SYS1),A		;write system byte 1

	DEFB 0CBH		;SET/RES dot
SETRES:	DEFS 1

	IN  A,($SYS1)		;read system byte 1
	AND 11010111B		;disable graphic page
	OUT ($SYS1),A		;write system byte 1
	EI			;reenable interrupts
	RET			;return to caller

YMAX:	DEFS 2			;total number of scan lines
YTAB:	DEFS 800		;addresses of all y-coordinates
YNTAB:	DEFS 900		;address of all normalized y-coordinates


;EJECT
;*****************
;*  $ P O I N T  *
;*****************

;entry:  B = graphic page number (0, 1)
;	HL = y-coordinate (0 - YYY)
;	DE = x-coordinate (0 - 639)
;
;exit :  A = 0	black
;	     1	white

$POINT:	PUSH BC			;save graphic page #
	PUSH DE			;save x-coordinate

POINT1:	EX   DE,HL		;y-coordinate		    --> reg. DE
	OR   A			;clear carry flag
	LD   HL,(YMAX)		;total number of scan lines --> reg. HL
	SBC  HL,DE		;calc physical y-coordinate
	POP  DE			;restore x-coordinate
	JR   NC,POINT3		;jump if no overflow
POINT2:	XOR  A			;clear accu
	POP  HL			;adjust stack
	RET

POINT3:	PUSH DE			;save x-coordinate

	ADD  HL,HL		;make word index
	LD   DE,YTAB		;^y-addresses --> reg. DE
	ADD  HL,DE		;get entry address
	LD   E,(HL)		;y-address    --> reg. DE
	INC  HL
	LD   D,(HL)Љ
	POP  HL			;get x-coordinate
;divide x-coordinate by 8:
	XOR  A			;clear remainder
	SRL  H			;/ 2
	RR   L
	RRA
	SRL  H			;/ 4
	RR   L
	RRA
	SRL  H			;/ 8
	RR   L
	RRA

	LD   C,A		;save accu
	LD   A,H		;test MSB of result
	OR   A
	JR   NZ,POINT2		;return if overflow
	LD   A,L		;test LSB of result
	CP   80
	JR   NC,POINT2		;return if overflow
	LD   A,C		;restore accu

	ADD  HL,DE		;final result = y-address + x / 8
	SET  7,H		;select upper 32K page

	RRA			;build BIT instruction
	RRA
	OR   46H
	LD   (BITTST),A		;load instruction

	IN   A,($SYS0)		;read system byte 0
	AND  00010001B		;enable bank 0
				;select graphic page 0
				;RTC interrupt only
				;disable character RAM
	POP BC			;get  page number
	INC B			;test page number
	DEC B
	JR  Z,POINT4		;jump if page 0
	SET 5,A			;select page 1
POINT4:	OUT ($SYS0),A		;write system byte 0

	IN  A,($SYS1)		;read system byte 1
	OR  01011101B		;7.2 MHz clock rate
				;enable graphic page
				;disable boot ROM
				;disable memory mapped I/O
	DI			;disable interrupts
	OUT ($SYS1),A		;write system byte 1

	DEFB 0CBH		;BIT test
BITTST:	DEFS 1

	IN  A,($SYS1)		;read system byte 1
	RES 3,A			;disable graphic page
	OUT ($SYS1),A		;write system byte 1
	EI			;reenable interrupts

	LD   A,0		;clear accu
	RET  Z			;accu = 0 if dot = blackЉ	INC  A			;accu = 1 if dot = white
	RET			;return to caller


;EJECT
;***************
;*  $ L I N E  *
;***************

;entry:  A = 0	non-normalized (high nibble)
;	     1	    normalized
;	     0	black	       (low  nibble)
;	     1	white
;	 B = graphic page number (0, 1)
;	HL = ^coordinates (x1, y1, x2, y2)

;draw line:
$LINE:	PUSH BC			;save page number
	PUSH AF			;save mode & colour
	LD   A,10H		;source bank	  = 1
				;destination bank = 0
	LD   DE,X1		;^coordinates --> reg. DE
	LD   B,8		;byte count   --> reg. BC
	CALL $XMOVE		;get coordinates
	POP  AF			;get mode
	LD   C,A		;save colour
	AND  0F0H		;normalize y-coordinates ?
	LD   A,C		;restore colour
	PUSH AF			;save colour
	JR   Z,LINE4		;jump if not

;normalize y-coordinates:
	POP  AF			;get colour
	AND  0FH		;mask mode
	PUSH AF
	LD   B,2		;y1, y2
	LD   IX,Y1		;^first y-coordinate		    --> reg. IX
LINE1:	PUSH BC			;save counter
	LD   BC,(VIDPAR+8)	;number of scan lines per text line --> reg. B
	INC  B
	LD   D,(IX+1)		;y-coordinate			    --> reg. DE
	LD   E,(IX)
	LD   HL,0
LINE2:	ADD  HL,DE		;y-coordinate * # of scan lines
	DJNZ LINE2

	LD   DE,18		;load divisor
	CALL DIV
	LD   A,E		;remainder --> accu
	CP   9			;remainder >= 9 ?
	JR   C,LINE3		;jump if not
	INC  HL			;round normalized y-coordinate
LINE3:	LD   (IX+1),H		;store normalized y-coordinate
	LD   (IX),L
	INC  IX			;get ^second y-coordinate
	INC  IX
	INC  IX
	INC  IX
	POP  BC			;restore counter
	DJNZ LINE1		;normalize second y-coordinate
Љ;calc px and dx:
LINE4:	LD   HL,0		;clear pp
	LD   (PP),HL
	LD   HL,(X2)		;second x-coordinate --> reg. HL
	LD   DE,(X1)		;first	x-coordinate --> reg. DE
	CALL CMP		;x2 >= x1 ?
	JP   M,LINE5		;jump if x2 < x1
	LD   BC,1		;dx = 1
	JR   LINE6
LINE5:	LD   BC,-1		;dx = -1
	EX   DE,HL
LINE6:	LD   (DX),BC		;store dx
	OR   A
	SBC  HL,DE		;px = x2 - x1 + 1 (x1 - x2 + 1)
	INC  HL
	LD   (PX),HL

;calc py and dy:
	LD   HL,(Y2)		;second y-coordinate --> reg. HL
	LD   DE,(Y1)		;first	y-coordinate --> reg. DE
	CALL CMP		;y2 >= y1 ?
	JP   M,LINE7		;jump if y2 < y1
	LD   BC,1		;dy = 1
	JR   LINE8
LINE7:	LD   BC,-1		;dy = -1
	EX   DE,HL
LINE8:	LD   (DY),BC		;store dx
	OR   A
	SBC  HL,DE		;py = y2 - y1 + 1 (y1 - y2 + 1)
	INC  HL
	LD   (PY),HL

;plot first dot:
	CALL LPLOT		;plot first point of line

;py <= px:
	LD   HL,(PX)		;px --> reg. HL
	LD   DE,(PY)		;py --> reg. DE
	CALL CMP		;py <= px ?
	JP   M,YLIN		;jump if py > px
XLIN:	LD   HL,(X1)
	LD   DE,(X2)
	CALL CMP		;x1 == x2 ?
	JP   Z,ENDLIN		;break if yes
	LD   HL,(PP)		;pp += py
	LD   DE,(PY)
	ADD  HL,DE
	LD   (PP),HL
	LD   DE,(PX)
	CALL CMP		;pp >= px
	JP   M,XLIN1		;jump pp < px
	OR   A
	SBC  HL,DE		;pp -= px
	LD   (PP),HL
	LD   HL,(Y1)		;y1 += dy
	LD   DE,(DY)
	ADD  HL,DE
	LD   (Y1),HL
XLIN1:	LD   HL,(X1)		;x1 += dx
	LD   DE,(DX)
	ADD  HL,DEЉ	LD   (X1),HL
	CALL LPLOT		;plot next point of line
	JR   XLIN

;py > px:
YLIN:	LD   HL,(Y1)
	LD   DE,(Y2)
	CALL CMP		;y1 == y2 ?
	JR   Z,ENDLIN		;break if yes
	LD   HL,(PP)		;pp += px
	LD   DE,(PX)
	ADD  HL,DE
	LD   (PP),HL
	LD   DE,(PY)
	CALL CMP		;pp >= py
	JP   M,YLIN1		;jump pp < py
	OR   A
	SBC  HL,DE		;pp -= py
	LD   (PP),HL
	LD   HL,(X1)		;x1 += dx
	LD   DE,(DX)
	ADD  HL,DE
	LD   (X1),HL
YLIN1:	LD   HL,(Y1)		;y1 += dy
	LD   DE,(DY)
	ADD  HL,DE
	LD   (Y1),HL
	CALL LPLOT		;plot next point of line
	JR   YLIN

;end of draw line routine:
ENDLIN:	POP  HL			;adjust stack
	POP  HL
	RET

;plot (x1, y1):
LPLOT:	POP  HL			;skip return address
	POP  AF			;get colour
	POP  BC			;get graphic page
	PUSH BC			;save that suckers again
	PUSH AF
	PUSH HL			;save return address
	LD   HL,(Y1)		;y-coordinate --> reg. HL
	LD   DE,(X1)		;x-coordinate --> reg. DE
	JP   $PLOT

;variables for draw line, circle, and arc:
XM:	DEFS 2
YM:	DEFS 2
XX:
X1:	DEFS 2
YY:
Y1:	DEFS 2
X2:	DEFS 2
Y2:	DEFS 2
M1:
PX:	DEFS 2
M2:
PY:	DEFS 2
DD:
PP:	DEFS 2ЉN1:
XB:
XB1:	DEFS 2
N2:
XB2:	DEFS 2
II:
N3:	DEFS 2
P1:	DEFS 2
P2:	DEFS 2
DX:	DEFS 2
DY:	DEFS 2


;EJECT
;*******************
;*  $ C I R C L E  *
;*******************

;entry:  A = 0	black
;	     1	white
;	 B = graphic page number (0, 1)
;	HL = ^coordinates, radius (xm, ym, r)

;draw circle:
$CIRCLE:PUSH BC			;save page number
	SET  4,A		;force normalizing
	PUSH AF			;save colour & mode
	LD   A,10H		;source bank	  = 1
				;destination bank = 0
	LD   DE,XM		;^coordinates --> reg. DE
	LD   B,6		;byte count   --> reg. BC
	CALL $XMOVE		;get coordinates

	LD   HL,0		;dd = yy = 0
	LD   (DD),HL
	LD   (YY),HL
	LD   HL,(XX)		;m1 = 1 - (xx + xx)
	ADD  HL,HL
	EX   DE,HL
	LD   HL,1
	LD   (M2),HL		;m2 = 1
	OR   A
	SBC  HL,DE
	LD   (M1),HL

;EJECT
;plot first dots:
	LD   HL,(XM)		;xm + xx --> reg. DE
	LD   DE,(XX)
	ADD  HL,DE
	EX   DE,HL
	LD   HL,(YM)		;ym	 --> reg. HL
	CALL CPLOT

	LD   HL,(XM)		;xm - xx --> reg. DE
	LD   DE,(XX)
	OR   A
	SBC  HL,DE
	EX   DE,HL
	LD   HL,(YM)		;ym	 --> reg. HL
	CALL CPLOTЉ
	LD   HL,(YM)		;ym + xx --> reg. HL
	LD   DE,(XX)
	ADD  HL,DE
	LD   DE,(XM)		;xm	 --> reg. DE
	CALL CPLOT

	LD   HL,(YM)		;ym - xx --> reg. HL
	LD   DE,(XX)
	OR   A
	SBC  HL,DE
	LD   DE,(XM)		;xm	 --> reg. DE
	CALL CPLOT

;EJECT
;circle loop:

;calc next coordinates:
CIRCLE1:LD   HL,(M1)		;p1 = m1 + d
	LD   DE,(DD)
	ADD  HL,DE
	LD   (P1),HL
	LD   HL,(M2)		;p2 = m2 + d
	ADD  HL,DE
	LD   (P2),HL

	LD   HL,(YY)		;yy++
	INC  HL
	LD   (YY),HL
	LD   HL,(M2)		;m2 += 2
	INC  HL
	INC  HL
	LD   (M2),HL

	LD   HL,(P2)
	CALL ABS
	EX   DE,HL
	LD   HL,(P1)
	LD   DE,(M2)
	ADD  HL,DE
	CALL ABS
	CALL CMP		;jump if
	JR   C,CIRCLE2		;abs(p1 + m2) < abs(p2)

	LD   HL,(P2)		;dd = p2
	LD   (DD),HL
	JR   CIRCLE3

CIRCLE2:LD   HL,(XX)		;xx--
	DEC  HL
	LD   (XX),HL
	LD   HL,(P1)		;dd = p1 + m2
	LD   DE,(M2)
	ADD  HL,DE
	LD   (DD),HL
	LD   HL,(M1)		;m1 += 2
	INC  HL
	INC  HL
	LD   (M1),HL

;EJECTЉ;plot dots:
CIRCLE3:LD   HL,(XM)		;xm + xx --> reg. DE
	LD   DE,(XX)
	ADD  HL,DE
	EX   DE,HL
	LD   HL,(YM)		;ym + yy --> reg. HL
	LD   BC,(YY)
	ADD  HL,BC
	CALL CPLOT

	LD   HL,(XM)		;xm - xx --> reg. DE
	LD   DE,(XX)
	OR   A
	SBC  HL,DE
	EX   DE,HL
	LD   HL,(YM)		;ym + yy --> reg. HL
	LD   BC,(YY)
	ADD  HL,BC
	CALL CPLOT

	LD   HL,(XM)		;xm + xx --> reg. DE
	LD   DE,(XX)
	ADD  HL,DE
	EX   DE,HL
	LD   HL,(YM)		;ym - yy --> reg. HL
	LD   BC,(YY)
	OR   A
	SBC  HL,BC
	CALL CPLOT

	LD   HL,(XM)		;xm - xx --> reg. DE
	LD   DE,(XX)
	OR   A
	SBC  HL,DE
	EX   DE,HL
	LD   HL,(YM)		;ym - yy --> reg. HL
	LD   BC,(YY)
	OR   A
	SBC  HL,BC
	CALL CPLOT

	LD   HL,(XM)		;xm + yy --> reg. DE
	LD   DE,(YY)
	ADD  HL,DE
	EX   DE,HL
	LD   HL,(YM)		;ym + xx --> reg. HL
	LD   BC,(XX)
	ADD  HL,BC
	CALL CPLOT

	LD   HL,(XM)		;xm - yy --> reg. DE
	LD   DE,(YY)
	OR   A
	SBC  HL,DE
	EX   DE,HL
	LD   HL,(YM)		;ym + xx --> reg. HL
	LD   BC,(XX)
	ADD  HL,BC
	CALL CPLOT

	LD   HL,(XM)		;xm + yy --> reg. DEЉ	LD   DE,(YY)
	ADD  HL,DE
	EX   DE,HL
	LD   HL,(YM)		;ym - xx --> reg. HL
	LD   BC,(XX)
	OR   A
	SBC  HL,BC
	CALL CPLOT

	LD   HL,(XM)		;xm - yy --> reg. DE
	LD   DE,(YY)
	OR   A
	SBC  HL,DE
	EX   DE,HL
	LD   HL,(YM)		;ym - xx --> reg. HL
	LD   BC,(XX)
	OR   A
	SBC  HL,BC
	CALL CPLOT

	LD   HL,(XX)
	LD   DE,(YY)
	CALL CMP		;jump if
	JP   P,CIRCLE1		;xx >= yy

	POP  HL			;adjust stack
	POP  HL
	RET

;plot (xx, yy):
CPLOT:	POP  IX			;skip return address
	POP  AF			;get colour & mode
	POP  BC			;get graphic page
	PUSH BC			;save that suckers again
	PUSH AF
	PUSH IX			;save return address
	JP   $PLOT


;EJECT
;*************
;*  $ A R C  *
;*************

;entry:  A = 0	black
;	     1	white
;	 B = graphic page number (0, 1)
;	HL = ^coordinates (xm, ym, x1, y1, x2, y2)

;draw arc:
$ARC:	PUSH BC			;save page number
	SET  4,A		;force normalizing
	PUSH AF			;save colour & mode
	LD   A,10H		;source bank	  = 1
				;destination bank = 0
	LD   DE,XM		;^coordinates --> reg. DE
	LD   B,12		;byte count   --> reg. BC
	CALL $XMOVE		;get coordinates

	LD   HL,0		;dd = 0
	LD   (DD),HLЉ	LD   HL,(X1)		;xx = x1 - xm
	LD   DE,(XM)
	OR   A
	SBC  HL,DE
	LD   (XX),HL
	LD   HL,(X2)		;x2 -= xm
	OR   A
	SBC  HL,DE
	LD   (X2),HL
	LD   HL,(Y1)		;yy = y1 - ym
	LD   DE,(YM)
	OR   A
	SBC  HL,DE
	LD   (YY),HL
	LD   HL,(Y2)		;y2 -= xm
	OR   A
	SBC  HL,DE
	LD   (Y2),HL

;plot first dot:
	LD   HL,(XM)		;xm + xx --> reg. DE
	LD   DE,(XX)
	ADD  HL,DE
	EX   DE,HL
	LD   HL,(YM)		;ym + yy --> reg. HL
	LD   BC,(YY)
	ADD  HL,BC
	CALL CPLOT


;EJECT
;arc loop:

;calc next coordinates:
ARC1:	LD   HL,(YY)
	BIT  7,H		;jump if
	JR   NZ,ARC2		;yy < 0
	LD   HL,-1		;dx = -1
	LD   (DX),HL
	LD   HL,(XX)		;m1 = 1 - (xx + xx)
	ADD  HL,HL
	EX   DE,HL
	LD   HL,1
	OR   A
	SBC  HL,DE
	JR   ARC3
ARC2:	LD   HL,(XX)		;m1 = 1 + xx + xx
	ADD  HL,HL
	EX   DE,HL
	LD   HL,1		;dx = 1
	LD   (DX),HL
	ADD  HL,DE
ARC3:	LD   (M1),HL

	LD   HL,(XX)
	BIT  7,H		;jump if
	JR   NZ,ARC4		;xx < 0
	LD   HL,(YY)		;m2 = 1 + yy + yy
	ADD  HL,HL
	EX   DE,HL
	LD   HL,1		;dy = 1Љ	LD   (DY),HL
	ADD  HL,DE
	JR   ARC5
ARC4:	LD   HL,-1		;dy = -1
	LD   (DY),HL
	LD   HL,(YY)		;m2 = 1 - (yy + yy)
	ADD  HL,HL
	EX   DE,HL
	LD   HL,1
	OR   A
	SBC  HL,DE
ARC5:	LD   (M2),HL

	LD   DE,(DD)		;p2 = m2 + dd
	ADD  HL,DE
	LD   (P2),HL
	CALL ABS		;n3 = abs(p2)
	LD   (N3),HL
	LD   HL,(M1)		;p1 = m1 + d
	ADD  HL,DE
	LD   (P1),HL
	CALL ABS		;n1 = abs(p1)
	LD   (N1),HL
	LD   HL,(P1)		;n2 = abs(p1 + m2)
	LD   DE,(M2)
	ADD  HL,DE
	CALL ABS
	LD   (N2),HL

	LD   DE,(N1)
	CALL CMP		;jump if
	JR   C,ARC8		;n1 >= n2
	JR   Z,ARC8
	LD   HL,(N3)
	CALL CMP		;jump if
	JR   C,ARC6		;n1 >= n3
	JR   Z,ARC6

	LD   HL,(XX)		;xx += dx
	LD   DE,(DX)
	ADD  HL,DE
	LD   (XX),HL
	LD   HL,(P1)		;dd = p1
	LD   (DD),HL
	JR   ARC9

ARC6:	LD   HL,(P2)		;dd = p2
	LD   (DD),HL
ARC7:	LD   HL,(YY)		;yy += dy
	LD   DE,(DY)
	ADD  HL,DE
	LD   (YY),HL
	JR   ARC9

ARC8:	LD   DE,(N3)
	CALL CMP		;jump if
	JP   P,ARC6		;n2 >= n3

	LD   HL,(XX)		;xx += dx
	LD   DE,(DX)
	ADD  HL,DEЉ	LD   (XX),HL
	LD   HL,(P1)		;dd = p1 + m2
	LD   DE,(M2)
	ADD  HL,DE
	LD   (DD),HL
	JR   ARC7


;EJECT
;plot dot:
ARC9:	LD   HL,(XM)		;xm + xx --> reg. DE
	LD   DE,(XX)
	ADD  HL,DE
	EX   DE,HL
	LD   HL,(YM)		;ym + yy --> reg. HL
	LD   BC,(YY)
	ADD  HL,BC
	CALL CPLOT

	LD   HL,(XX)
	LD   DE,(X2)
	CALL CMP		;jump if
	JP   NZ,ARC1		;xx != x2
	LD   HL,(YY)
	LD   DE,(Y2)
	CALL CMP		;jump if
	JP   NZ,ARC1		;yy != y2

	POP  HL			;adjust stack
	POP  HL
	RET


;EJECT
;***************
;*  $ F I L L  *
;***************

;entry:  A = 0	non-normalized		(high nibble)
;	     1	    normalized
;	     graphic page number (0, 1) (low  nibble)
;	BC = ^fill pattern
;	HL = y-coordinate within shape
;	DE = x-coordinate within shape

;fill shape with user supplied pattern:
$FILL	EQU  $			;not implemented yet


;EJECT
;***************
;*  $ C O P Y  *
;***************

;entry:  A = source	 page (high nibble)
;	     destination page (low  nibble)
;	     0 = graphic page 0
;	     1 = graphic page 1
;	     F = user buffer
;		 (user/user [FF] = invalid combination)
;	HL = ^parameter block (x1, y1, x2, y2, dx, dyЉ;			    or x2, y2, dx, dy
;			    or x1, y1, dx, dy)
;	DE = ^user buffer

;copy graphic area:
$COPY:	LD   (UBUF),DE		;save ^user buffer
	LD   C,A		;save source page
	AND  0FH		;mask it
	CP   0FH		;destination == user buffer ?
	JP   Z,COPY17		;jump if yes
	PUSH AF
	LD   A,C		;restore source page
	RRA
	RRA
	RRA
	RRA
	AND  0FH
	CP   0FH		;source == user buffer ?
	JP   Z,COPY10		;jump if yes
	PUSH AF

	LD   A,10H		;source bank	  = 1
				;destination bank = 0
	LD   DE,X1		;^parameter block --> reg. DE
	LD   B,12		;byte count	  --> reg. BC
	CALL $XMOVE		;get coordinates

;EJECT
;copy on screen:

;setup variables:
	LD   HL,(X1)		;xb1 = x1
	LD   (XB1),HL
	LD   HL,(X2)		;xb2 = x2
	LD   (XB2),HL

;determine copy direction of x-coordinate:
	LD   DE,(X1)
	CALL CMP
	JR   C,COPY1		;jump if
	JR   Z,COPY1		;x1 >= x2
	LD   DE,(PX)		;xb2 += dx - 1
	DEC  DE
	ADD  HL,DE
	LD   (XB2),HL
	LD   HL,(XB1)		;xb1 += dx - 1
	ADD  HL,DE
	LD   (XB1),HL
	LD   HL,(X1)		;x1--
	DEC  HL
	LD   (X1),HL
	LD   HL,-1		;dx = -1
	JR   COPY2
COPY1:	LD   HL,(X1)		;x1 += dx
	LD   DE,(PX)
	ADD  HL,DE
	LD   (X1),HL
	LD   HL,1		;dx = 1
COPY2:	LD   (PX),HL

;determine copy direction of y-coordinate:Љ	LD   HL,(Y1)
	LD   DE,(Y2)
	CALL CMP		;jump if
	JP   P,COPY3		;y1 >= y2
	DEC  HL			;yy = --y1 + dy
	LD   (Y1),HL
	LD   DE,(PY)
	ADD  HL,DE
	LD   (YM),HL
	LD   HL,(Y2)		;y2 += dy - 1
	DEC  DE
	ADD  HL,DE
	LD   (Y2),HL
	LD   HL,-1		;dy = -1
	JR   COPY4
COPY3:	LD   (YM),HL		;yy = y1
	LD   DE,(PY)		;y1 += dy
	ADD  HL,DE
	LD   (Y1),HL
	LD   HL,1		;dy = 1
COPY4:	LD   (PY),HL

;EJECT
;copy area:
COPY5:	LD   HL,(YM)
	LD   DE,(Y1)
	CALL CMP		;jump if
	JR   Z,COPY8		;yy == y1

	LD   HL,(XB1)		;xx = xb1
	LD   (XM),HL
	LD   HL,(XB2)		;x2 = xb2
	LD   (X2),HL

COPY6:	LD   HL,(XM)
	LD   DE,(X1)
	CALL CMP		;jump if
	JR   Z,COPY7		;xx == x1

	POP  BC			;source page # --> reg. B
	PUSH BC
	LD   HL,(YM)		;y-coordinate  --> reg. HL
	LD   DE,(XM)		;x-coordinate  --> reg. DE
	CALL $POINT		;read source dot

	POP  HL			;destination page # --> reg. B
	POP  BC
	PUSH BC
	PUSH HL
	LD   HL,(Y2)		;y-coordinate	    --> reg. HL
	LD   DE,(X2)		;x-coordinate	    --> reg. DE
	CALL $PLOT		;set destination dot

	LD   HL,(XM)		;xx += dx
	LD   DE,(PX)
	ADD  HL,DE
	LD   (XM),HL
	LD   HL,(X2)		;x2 += dx
	ADD  HL,DE
	LD   (X2),HL
	JR   COPY6Љ
COPY7:	LD   HL,(YM)		;yy += dy
	LD   DE,(PY)
	ADD  HL,DE
	LD   (YM),HL
	LD   HL,(Y2)		;y2 += dy
	ADD  HL,DE
	LD   (Y2),HL
	JR   COPY5

COPY8:	POP  HL			;adjust stack
COPY9:	POP  HL
	RET

;EJECT
;copy from user buffer to screen:
COPY10:	LD   A,10H		;source bank	  = 1
				;destination bank = 0
	LD   DE,X2		;^parameter block --> reg. DE
	LD   B,8		;byte count	  --> reg. BC
	CALL $XMOVE		;get coordinates

;setup variables:
	LD   HL,(Y2)		;yy = y2
	LD   (YY),HL
	LD   HL,(X2)		;xb = x2
	LD   (XB),HL
	LD   HL,(PX)		;pp = dx / 8 + (dx % 8 != 0)
	LD   A,L
	SRL  H
	RR   L
	SRL  H
	RR   L
	SRL  H
	RR   L
	AND  7
	JR   Z,COPY11
	INC  HL
COPY11:	LD   (PP),HL
	LD   HL,(X2)		;x2 += dx
	LD   DE,(PX)
	ADD  HL,DE
	LD   (X2),HL
	LD   HL,(Y2)		;y2 += dy
	LD   DE,(PY)
	ADD  HL,DE
	LD   (Y2),HL

;EJECT
;copy area:
COPY12:	LD   HL,(YY)
	LD   DE,(Y2)
	CALL CMP		;jump if
	JR   Z,COPY9		;yy == y2

	LD   HL,(UBUF)		;^user buffer --> reg. HL
	LD   DE,LINBUF		;^temp buffer --> reg. DE
	LD   A,(PP)		;byte count   --> reg. B
	LD   B,A
	LD   A,10H		;source bank	  = 1
				;destination bank = 0Љ	CALL $XMOVE		;get user bytes

	LD   HL,(XB)		;xx = xb
	LD   (XX),HL
	LD   HL,0		;ii = 0
	LD   (II),HL

COPY13:	LD   HL,(XX)
	LD   DE,(X2)
	CALL CMP		;jump if
	JR   Z,COPY16		;xx == x2

	LD   HL,LINBUF		;^temp buffer --> reg. HL
	LD   DE,(II)		;divide buffer index by 8
	XOR  A
	SRL  D
	RR   E
	RRA
	SRL  D
	RR   E
	RRA
	SRL  D
	RR   E
	RRA
	ADD  HL,DE		;now reg. HL contains byte address
	RRA			;build BIT instruction
	RRA
	OR   46H
	LD   (COPY14),A
	DEFB 0CBH		;BIT instruction
COPY14:	DEFS 1

	LD   A,0		;initialize colour (black)
	JR   Z,COPY15		;dont't change colour if tested bit = 0
	INC  A			;change colour (white)
COPY15:	POP  BC			;graphic page number # --> reg. B
	PUSH BC
	LD   HL,(YY)		;y-coordinate	       --> reg. HL
	LD   DE,(XX)		;x-coordinate	       --> reg. DE
	CALL $PLOT		;set dot

	LD   HL,(XX)		;xx++
	INC  HL
	LD   (XX),HL
	LD   HL,(II)		;ii++
	INC  HL
	LD   (II),HL
	JR   COPY13

COPY16:	LD   HL,(YY)		;yy++
	INC  HL
	LD   (YY),HL
	LD   HL,(UBUF)		;bump pointer to user buffer
	LD   DE,(PP)
	ADD  HL,DE
	LD   (UBUF),HL
	JP   COPY12

;EJECT
;copy from screen to user buffer:
COPY17:	LD   A,C		;restore source pageЉ	RRA
	RRA
	RRA
	RRA
	AND  0FH
	PUSH AF

	LD   A,10H		;source bank	  = 1
				;destination bank = 0
	LD   DE,X2		;^parameter block --> reg. DE
	LD   B,8		;byte count	  --> reg. BC
	CALL $XMOVE		;get coordinates

;setup variables:
	LD   HL,(Y2)		;yy = y2
	LD   (YY),HL
	LD   HL,(X2)		;xb = x2
	LD   (XB),HL
	LD   HL,(PX)		;pp = dx / 8 + (dx % 8 != 0)
	LD   A,L
	SRL  H
	RR   L
	SRL  H
	RR   L
	SRL  H
	RR   L
	AND  7
	JR   Z,COPY18
	INC  HL
COPY18:	LD   (PP),HL
	LD   HL,(X2)		;x2 += dx
	LD   DE,(PX)
	ADD  HL,DE
	LD   (X2),HL
	LD   HL,(Y2)		;y2 += dy
	LD   DE,(PY)
	ADD  HL,DE
	LD   (Y2),HL

;EJECT
;copy area:
COPY19:	LD   HL,(YY)
	LD   DE,(Y2)
	CALL CMP		;jump if
	JP   Z,COPY9		;yy == y2

	LD   HL,(XB)		;xx = xb
	LD   (XX),HL
	LD   HL,0		;ii = 0
	LD   (II),HL

COPY20:	LD   HL,(XX)
	LD   DE,(X2)
	CALL CMP		;jump if
	JR   Z,COPY22		;xx == x2

	POP  BC			;graphic page number # --> reg. B
	PUSH BC
	LD   HL,(YY)		;y-coordinate	       --> reg. HL
	LD   DE,(XX)		;x-coordinate	       --> reg. DE
	CALL $POINT		;read dotЉ	LD   C,A		;colour 	       --> reg. C

	LD   HL,LINBUF		;^temp buffer --> reg. HL
	LD   DE,(II)		;divide buffer index by 8
	XOR  A
	SRL  D
	RR   E
	RRA
	SRL  D
	RR   E
	RRA
	SRL  D
	RR   E
	RRA
	ADD  HL,DE		;now reg. HL contains byte address
	RRA			;build SET/RES instruction
	RRA
	OR   0C6H		;SET instruction
	BIT  0,C		;colour black or white ?
	JR   NZ,$+4		;jump if white
	AND  0BEH		;RES instruction
	LD   (COPY21),A		;load instruction
	DEFB 0CBH		;SET/RES instruction
COPY21:	DEFS 1

	LD   HL,(XX)		;xx++
	INC  HL
	LD   (XX),HL
	LD   HL,(II)		;ii++
	INC  HL
	LD   (II),HL
	JR   COPY20

COPY22:	LD   HL,LINBUF		;^temp buffer --> reg. HL
	LD   DE,(UBUF)		;^user buffer --> reg. DE
	LD   A,(PP)		;byte count   --> reg. B
	LD   B,A
	LD   A,1		;source bank	  = 0
				;destination bank = 1
	CALL $XMOVE		;put user bytes

	LD   HL,(YY)		;yy++
	INC  HL
	LD   (YY),HL
	LD   HL,(UBUF)		;bump pointer to user buffer
	LD   DE,(PP)
	ADD  HL,DE
	LD   (UBUF),HL
	JP   COPY19

UBUF:	DEFS 2			;^user buffer


;EJECT
;division HL / DE, quotient --> HL, remainder --> DE:
DIV:	LD   A,H		;dividend (MSB) --> accu
	LD   C,L		;dividend (LSB) --> reg. C
	LD   HL,0		;clear accumulator
	LD   B,16		;init counter
DIV1:	RL   C			;rotate result left
	RLAЉ	ADC  HL,HL		;shift left
	SBC  HL,DE		;subtract divisor
	JR   NC,$+3		;subtraction ok
	ADD  HL,DE		;restore accumulator
	CCF			;complement carry flag
	DJNZ DIV1		;counter = 0 ?
	RL   C			;get last result bit
	RLA
	EX   DE,HL		;remainder --> reg. DE
	LD   H,A		;quotient  --> reg. HL
	LD   L,C
	RET

;compare HL with DE:
CMP:	PUSH HL			;save reg. HL
	OR   A			;clear carry flag
	SBC  HL,DE		;compare operands
	POP  HL			;restore reg. HL
	RET

;HL = abs(HL):
ABS:	BIT  7,H		;number positive ?
	RET  Z			;return if yes
	PUSH DE			;save reg. DE
	EX   DE,HL		;number --> reg. DE
	LD   HL,0
	OR   A			;clear carry flag
	SBC  HL,DE		;negate number
	POP  DE			;restore reg. DE
	RET


;EJECT
;******************************************************************************
;*	       I N T E R R U P T   S E R V I C E   R O U T I N E	      *
;******************************************************************************

INT1:	PUSH BC			;save user register set
	PUSH DE
	PUSH HL
	PUSH IX
	PUSH IY

;scan keyboard:
	CALL $SCAN		;scan the keyboard
	LD   A,C		;get code of pressed key
	OR   A			;key pressed ?
	JR   Z,RTC3		;jump if not
	LD   A,(KLEN)		;A = buffer length
	LD   B,A		;save it
	CP   80			;jump if
	JR   Z,RTC2		;it's full
	LD   A,(REPEAT)		;auto repeat ?
	OR   A
	JR   Z,RTC0		;jump if not
	LD   A,B		;restore buffer length
	OR   A			;buffer empty ?
	JR   NZ,RTC3		;return no repeated key if buffer not empty
RTC0:	LD   A,C		;get code of pressed key
	LD   HL,(EPTR)		;HL = next location pointer
	LD   (HL),A		;save the keyЉ	INC  HL			;bump the pointer
	LD   DE,KBUF+80		;DE = end of buffer pointer
	EX   DE,HL		;swap the pointers
	SBC  HL,DE		;wrap around the buffer ?
	EX   DE,HL		;swap the pointers
	JR   NZ,RTC1		;jump if no wrap around
	LD   HL,KBUF		;HL = new pointer
RTC1:	LD   (EPTR),HL		;save the pointer
	LD   HL,KLEN		;HL = buffer length pointer
	INC  (HL)		;bump it
	JR   RTC3
RTC2:	CALL BEEP		;alarm

;clock maintenance routine:
RTC3:	LD   HL,RTC$TICK$COUNT	;downdate tick count
	DEC  (HL)
	JR   NZ,INT6		;is not at 0 yet
	LD   (HL),45		;one second has elapsed so
				;reset to original value

	LD   A,(CLOCK)		;hardware clock ?
	OR   A
	JR   NZ,INT2		;jump if yes

	LD   B,3		;maximum number of values to update
	LD   DE,TIME$IN$BCD$END	;DE -> seconds of BCD time
	LD   HL,UPDATE$TIME	;HL -> control table
RTC$UPDATE$DIGIT:
	LD   A,(DE)
	INC  A			;bump a time period, seconds
	DAA			;then minutes, then ours
	LD   (DE),A
	SUB  (HL)		;compare period to max. unit value
	JR   NZ,INT2		;jump if unit not max. value
	LD   (DE),A		;else reset period to zero
	DEC  DE			;and bump increment and
	INC  HL			;test addresses to next unit
	DJNZ RTC$UPDATE$DIGIT	;loop till periods incremented or no overflow
				;from one period to the next
	LD   HL,(BINARY$DATE)	;HL -> number of days since Jan 1st, 1978
	INC  HL			;bump day count
	LD   (BINARY$DATE),HL

;EJECT
INT2:	LD   A,(CLOCKON)
	OR   A			;display clock ?
	JR   Z,INT6		;jump if not
	LD   A,(CLOCK)		;hardware clock ?
	OR   A
	JR   Z,INT3		;jump if not
	LD   HL,BINARY$DATE	;^time & date buffer --> reg. HL
	LD   (INT),A		;mark interrupt service routine
	CALL $GTIME3H		;read hardware clock
	XOR  A
	LD   (INT),A
INT3:	LD   HL,TIME$IN$BCD	;^BCD	time --> reg. HL
	LD   DE,$ATIME		;^ASCII time --> reg. DE
	LD   B,3		;convert hours, minutes, and seconds
INT4:	CALL BCDASC
	DJNZ INT4
	IN   A,($SYS1)		;read system byte 1Љ	PUSH AF			;save it
	AND  11111110B		;enable memory mapped I/O
	OR   00010000B		;enable video RAM
	OUT  ($SYS1),A
	LD   HL,$ATIME		;^ASCII time	   --> reg. HL
	LD   DE,(CLOCK$LOC)	;^display location --> reg. DE
	LD   B,8		;byte count	   --> reg. B
INT5:	LD   A,(DE)		;get screen character
	AND  80H		;mask invert bit
	OR   (HL)		;over clock character
	LD   (DE),A		;display clock character
	INC  DE			;get next clock character
	INC  HL			;get next screen location
	DJNZ INT5		;display whole clock
	POP  AF			;restore system byte 1
	OUT  ($SYS1),A

INT6:	POP  IY
	POP  IX
	POP  HL			;restore user register set
	POP  DE
	POP  BC
	JP   $INT1		;jump to end of interrupt service routine

;convert BCD to ASCII:
BCDASC:	LD   A,(HL)		;get high nibble
	RRA
	RRA
	RRA
	RRA
	AND  0FH
	ADD  A,'0'		;convert it to ASCII
	LD   (DE),A		;store high digit
	LD   A,(HL)		;get low nibble
	AND  0FH		;get low nibble
	ADD  A,'0'		;convert to ASCII
	INC  DE
	INC  HL
	LD   (DE),A		;store low digit
	INC  DE			;bump over colon
	INC  DE
	RET

RTC$TICK$COUNT:
	DEFB 45
UPDATE$TIME:
	DEFB 60H		;BCD 60 seconds
	DEFB 60H		;BCD 60 minutes
	DEFB 24H		;BCD 24 hours
$ATIME:	DEFM 'HH:MM:SS'		;time in ASCII format
INT:	DEFB 0			;marker for interrupt service routine


;EJECT
;******************************************************************************
;*		  C O M M O N	P A R T   O F	D R I V E R S		      *
;******************************************************************************

	ORG  3500H
	.PHASE 0FE00H		;common memory
Љ;time & date location will not be destroyed during reset:
BINARY$DATE:
	DEFW 1
TIME$IN$BCD:
	DEFB 0
	DEFB 0
TIME$IN$BCD$END:
	DEFB 0

;*****************
;*  $ X M O V E  *
;*****************

;entry:  A	upper nibble = source	   bank
;		lower nibble = destination bank
;	 B  =	byte count
;	DE  =	destination address
;	HL  =	source	    address

;interbank transfer:

$XMOVE: LD   C,A		;save source/dest bank #'s
	IN   A,($SYS0)		;read system byte 0
	PUSH AF			;save current bank #
	LD   A,C		;restore source/dest bank #'s
	PUSH DE			;save destination address
	LD   C,B		;byte count --> reg. BC
	LD   B,0
	PUSH BC			;save byte count
	PUSH AF			;save destination bank number
	SRL  A			;get source bank number
	SRL  A
	SRL  A
	SRL  A
	CALL SWITCH		;select source bank
	LD   DE,SBUF		;^scratch buffer --> reg. DE
	LDIR			;transfer data from source buf to scratch buf
	POP  AF			;get destination bank number
	AND  0FH
	CALL SWITCH		;select destination bank
	POP  BC			;restore byte count
	LD   HL,SBUF		;^scratch buffer --> reg. HL
	POP  DE			;restore destination address
	LDIR			;transfer data from scratch buf to dest buf
	POP  AF			;restore current bank #
	OUT  ($SYS0),A		;select it
	RET

;select memory bank:

SWITCH:	RRCA
	RRCA
	AND  0C0H
	OR   1
	LD   D,A		;save bank number
	IN   A,($SYS0)		;read system byte 0
	AND  00111101B		;RTC interrupt only
				;disable character RAM
	OR   D			;set bank number
	OUT  ($SYS0),A		;write system byte 0
	RET

SBUF:	DEFS 128		;scratch buffer


;EJECT
;entry to interrupt service routine:
	DEFS 64			;local stack
$INT:	LD   (SAVESP),SP	;save user stack
	LD   SP,$INT		;get local stack
	PUSH AF			;save user accu/status
	IN   A,($FDSEL)		;reset interrupt flipflop
	IN   A,($SYS0)		;get current bank #
	PUSH AF			;save it
	AND  00111111B		;enable bank 0
	OUT  ($SYS0),A		;select it
	JP   INT1		;perform interrupt service routine

$INT1:	POP  AF			;get user bank
	OUT  ($SYS0),A		;select it
	POP  AF			;restore user accu/status
	LD   SP,(SAVESP)	;restore user stack
	EI			;enable interrupts
	RET			;return to user task
SAVESP:	DEFS 2			;SP save areaЉ

;EJECT
;floppy disk I/O:
IO:	CALL SWITCH		;select bank of transfer buffer
	POP  AF			;restore status
	JR   Z,WRITE1		;jump if write

;read sector:
	LD   A,$RDSEC		;issue "read" command
	DI			;disable interrupts
	OUT  ($FDCMD),A
	LD   BC,12		;56 usec delay
	CALL DELAY
	LD   C,$FDDATA		;data register
READ1:	IN   A,($FDSTAT)	;get FDC status
	BIT  1,A		;data request ?
	JR   NZ,READ3		;yes, get byte
	BIT  0,A		;full sector transferred ?
	JR   Z,IOEND		;yes, go end process
	IN   A,($FDSTAT)	;get FDC status
	BIT  1,A		;data request ?
	JR   NZ,READ3		;yes, get byte
	BIT  7,A		;drive not ready ?
	JR   Z,READ1		;no loop
READ2:	LD   A,4		;error code 4 --> accu
	RET
READ3:	INI			;read char
	JR   READ1

;write sector:
WRITE1:	LD   A,$WRSEC		;issue "write" command
	DI			;disable interrupts
	OUT  ($FDCMD),A
	LD   BC,12		;56 usec delay
	CALL DELAY
	LD   C,$FDDATA		;data register
WRITE2:	IN   A,($FDSTAT)	;get FDC status
	BIT  1,A		;data request ?
	JR   NZ,WRITE3		;yes, put byte
	BIT  0,A		;full sector written ?
	JR   Z,IOEND		;yes, go end process
	IN   A,($FDSTAT)	;get FDC status
	BIT  1,A		;data request ?
	JR   NZ,WRITE3		;yes, put byte
	BIT  7,A		;drive not ready ?
	JR   Z,WRITE2		;no loop
	JR   READ2		;jump to error exit
WRITE3:	OUTI			;write char
	JR   WRITE2		;put next byte

IOEND:	IN   A,($SYS0)		;read system byte 0
	AND  00111101B		;enable bank 0
	OR   00000001B
	OUT  ($SYS0),A		;write system byte 0
	JP   STATUS		;check status

;delay for ((BC-1)*26+17)*2.255 T-states:
DELAY:	DEC  BC			;decrement cycle count
	LD   A,B		;test if count zero
	OR   C			;combine LSB/MSB of countЉ	JR   NZ,DELAY		;loop until delay count exhausted
	RET			;rtn to caller


;EJECT



;Winchester I/O:
; Diese Routine wird lahmgelegt, ausserdem werden einige OPCodes
; gel|scht, um Platz f}r die neue SWITCH Routine zu bekommen.
; Die Harddisk wird bei mir sowieso anders angesprochen.
 



IOW:	RET         		;select bank of transfer buffer

;read sector:

;write sector:


	END
atus
	BIT  1,A		;data request ?
	JR   NZ,WRITE3		;yes, put byte
	BIT  7,A		;drive not ready ?
	JR   Z,WRITE2		;no loop
	JR   READ2		;jump to error exit
WRITE3:	OUTI			;write char
	JR   WRITE2		;put next byte

IOEND:	IN   A,($SYS0)		;read system byееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее	title	'hard-disk handler'

;************************************************
;*	H D  2 . M A C	Version : 3.2		*
;*	Created	:	19-oct-87		*
;*	by	:	Peter Petersen		*
;*	Rev	:	22-oct-87..17-aug-89	*
;*	weiter dran geschnitzt:			*
;*	...08.07.90	H. Bernhardt		*
;*      November 92     V.Dose                  *
;*            pderr ge{ndert f}r Genie IIIs     *
;*            angepasst an Harddisk 10 MByte    *
;*	30.7.93		V.DOSE			*
;*	      angepasst an 20 MByte Platte      *
;*	      TANDON TM 262			*		
;*	21.12.93	E.SCHROEER		*
;*	      angepasst an 20 MByte Platte	*
;*	      SEAGATE ST 225 Typ MFM/RLL	*		
;*                                              *
;************************************************

; CP/M-80 Version 3     ---  Modular BIOS  ---

; Harddisk I/O routines for standardized BIOS interface
; DPH und DPB in DTBL.ASM

true	equ	-1
false	equ	 0
bel     equ    07h
sub     equ    1AH
esc     equ    1BH

   
	public	hdwrit,hdread,hdlogi,hdinit,hd1ini

; Variables containing parameters passed by BDOS

	external	@adrv,@rdrv,@dbnk,@dma,@trk,@sect
	external	@cbnk,@erdme,?pderr
	external        ?bank	        	;log. Bank (in A) einschalten

; Utility routines in standard BIOS

	external	?pmsg		; print message @<HL> up to 0,
	            			; saves <BC> & <DE>
        external        ?conin,?cono    ; console input and output
        external        ?const          ; get console status

; definition of hd-controller port-addresses and control-data

hdport	equ	040h		; hd-controller base address

hdstat	equ	hdport+1	; hard disk status port
hdres	equ	hdport+1	; hard disk reset function
hdsel	equ	hdport+2	; hard disk select function
hdconf	equ	hdport+2	; hard disk configuration port
hdmask	equ	hdport+3	; hard disk DMA- and Interrupt-mask

        .z80
	cseg			; residente Ruinen zum
  				; Verholen von/zu Banks
hdrd:	ld	hl,(@dma)	; set buffer address
	ld	a,(@dbnk)
	call	?bank
	ld	bc,hdport	; get hd port address
	inir			; 512 Beitz reinziehen
	inir
	jr	termcmd1	; if yes quit loop

hdwr:	ld	hl,(@dma)	; set buffer address
	ld	a,(@dbnk)
	call	?bank
	ld	c,hdport	; get hd port address
	outi			; get first data byte
hdwrlp:	in	a,(hdstat)	; get hdc status
	cp	0cfh		; test if transfer is terminated
	jr	z,termcmd1	; if yes quit loop
	cp	0c9h		; data requested  ?
	jr	nz,hdwrlp	; loop if not
wr_dat:	outi			; write data
	jr	hdwrlp		; and loop

termcmd1:			; aus dem Common heraus noch
	xor	a		; schnell Bank 0 einschalten
	call	?bank
	jp	termcmd		; und den Job abschliessen

	dseg

; harddisk READ and WRITE entry points.
; these entries are called with the following arguments :
;	 relative drive number	in @rdrv	 (8 bits)
;	 absolute drive number	in @adrv	 (8 bits)
;	 disk transfer address	in @dma		(16 bits)
;	 disk transfer bank	in @dbnk	 (8 bits)
;	 disk track address	in @trk		(16 bits)
;	 disk sector address	in @sect	(16 bits)
;	 pointer to XDPH	in <DE>
; they transfer the appropriate data, perform retries
; if necessary, then return an error code in <A>

hdread:	ld	hl,readmsg	; point at ' Read '
	call	hdrw_common	; prepare command descriptor
	di			; disable interrupts
	ld	bc,0508h	; get length and command
	call	hdscmd		; send command
rd1:	in	a,(hdstat)	; get hdc status
	cp	0cfh		; test if status is to send
	jp	z,termcmd	; skip if yes
	cp	0cbh		; test transfer direction
	jr	nz,rd1		; loop until o. k.
	jp	hdrd		; sektor holen

hdwrit:	ld	hl,writemsg	; point to ' Write '
	call	hdrw_common
	di			; disable interrupts
	ld	bc,050ah	; get length and command
	call	hdscmd		; send command
wr1:	in	a,(hdstat)	; get hdc status
	cp	0cfh		; test if status is to send
	jr	z,termcmd	; skip if yes
	cp	0c9h		; test transfer direction
	jr	nz,wr1		; loop until o. k.
	jp	hdwr		; sektkorken wegdruecken

termcmd:
	ei			; test termination of command
	ld	b,0		; set retry count to 256
tr1:	in	a,(hdstat)	; get hdc status
	cp	0cfh		; ready to read status  ?
	jr	z,tr2		; skip if o. k.
	djnz	tr1		; else retry b times

	ld	hl,hdmsg2	; print error mesage
	jr	tr3

tr2:	in	a,(hdport)	; get command status
	and	2		; to test completion
	ret	z

	ld	hl,hdmsg1	; else print terminate error
tr3:	out	(hdres),a	; reset hdc
	call	dskerr		; print bios error message
	ld	a,1
	ret

hdinit:	out	(hdres),a	; reset hard-disk controller
get_st:	in	a,(hdstat)	; get status
	cp	0c0h		; test if hdc is idle
	jr	nz,get_st	; else loop until hdc is idle

setmsk:	xor	a		; clear accu and send mask to disable
	out	(hdmask),a	; interrupt and dma from hard-disk

w0:	in	a,(hdstat)	; get status
	cp	0c0h		; and wait until hdc is idle
	jr	nz,w0

;	init hd controller with hd-drive-characteristics

trpara:	ld	hl,ifield	; point to init-parameter field
	ld	bc,050ch	; get command to set hd characteristics
	call	hdscmd		; send command
	ld	hl,hd_charact	; point to table of hd characteristics
	ld	c,hdport	; get hd port
	ld	b,8		; get length of table
tr_p1:	in	a,(hdstat)	; get hdc status
	cp	0c9h		; request for data --> hdc  ?
	jr	nz,tr_p1	; loop until hdc requests for data
	jr	nx1		; else send data from data table

nxtbyt:	call	wcr		; wait for controller ready
nx1:	ld	a,(hl)		; get byte from table
	out	(c),a		; send byte to hd controller
	inc	hl		; increment pointer
	djnz	nxtbyt		; loop until done

;	test if command successfully completed

rdy1:	in	a,(hdstat)	; get hdc status
	cp	0cfh		; test if status is to be send
	jr	nz,rdy1		; loop until o. k.
	in	a,(hdport)	; get command status state
	bit	2,a		; test if correctly terminated
	jr	z,pri_ok	; skip if o. k.
	out	(hdres),a	; reset controller
	ld	hl,hdmsg1	; else print hd-init-error
	jp	print		; and return

pri_ok:	ld	hl,iniok	; print init o. k.
	jp	print


;	prepare command descriptor block setting cylinder,
;	sector and head addresses
;
;  Byte  |  D7  | D6  | D5  | D4  | D3  | D2  | D1  | D0  |
;----------------------------------------------------------
;   0    |  Command-Class   |       Operation-Code        |
;   1    | cyl10   0    LUN |         Head Number         |   head
;   2    | cyl9  cyl8 |         Sector Number             |   sect
;   3    |      Cylinder Number, Low Byte (cyl7-0)        |   cylind
;   4    |     Interleave or Block Count (always 1)       |   bcount
;   5    |          Control Byte  (always 2)              |   termin
;


hdrw_common:
	ld	(hdc_rw),hl	; save name of operation
	ld	bc,(@trk)	; get track #
	ld	a,c		; get lsb of track #
	ld	(cylind),a	; set lsb of track #
	ld	c,0
	rr	b		; move high byte of track #
	rr	c		; into bits 7 and 6 of C
	rr	b
	rr	c
	ld	b,0		; head count
	ld	a,(@sect)	; sector # (only low byte significant)
fdhead:	cp	17		; find head #
	jr	c,hds0		; if head 0
	sub	17		; else convert to sector # and head #
	inc	b		; next head, if more than 26 secs
	jr	fdhead
hds0:	or	c
	ld	(sect),a	; set sector and track msb
	ld	a,b		; head #
	ld	(head),a
	ret
	
; suppress error message if BDOS is returning errors to application...

dskerr:
	ld	a,(@erdme) 
	cp	0ffh 
	jr	nz,pr_err
	pop	af		; correct stack
harderror:
	ld	a,1		; get hard-error code
	ei			; enable interrupts
	ret			; and return to bdos

; Had permanent error, print message like :
; BIOS Err on d: T-nn, S-mm, <operation> <type>, Retry ?

pr_err:	call	?pderr		; print message header
        ld      hl,(hdc_rw)     ; READ oder WRITE
        call    ?pmsg  
        call    frageab         ; Eingabe holen
        ld      hl,msgend       ; Statuszeile aus
print:  call    ?pmsg  
hdlogi:	ret			; dummy vector, hard-disk login

; get console input, echo it and shift to uppercase

frageab:  call ?const
          or   a
          jr   z,istda
          call ?conin
          jr   frageab
istda:    call ?conin
          push af
          ld   c,a
          call ?cono
          pop  af
          cp   'A'
          ret  c
          and  0dfh
          ret
     


; hard disk subroutines

; wait controller ready
wcr:	in	a,(hdstat)	; get hd controller status
	bit	0,a		; test for data request
	jr	z,wcr		; quit if request
	ret

;hd send command	hl -->	parameterlist
;			b  -->	count
;			c  -->	command
hdscmd:	in	a,(hdstat)	; get hdc status
	cp	0c0h		; to test if hdc is idle
	jr	z,hdc_id	; skip if o. k.
	out	(hdres),a	; else reset hdc
	jr	hdscmd		; and try again
hdc_id:	out	(hdsel),a	; select hd controller
	ld	hl,cfield	; set pointer to command field
	call	wcr		; wait for controller ready
	ld	a,c		; get command
	out	(hdport),a	; to send it
nxtpar:	call	wcr		; wait for controller ready
	ld	a,(hl)		; fetch next parameter
	out	(hdport),a	; to send it
	inc	hl		; increment parameter pointer
	djnz	nxtpar		; and loop until done
hd1ini:	ret

;  hard disk data area
cfield:				; hdc command field
head:	db	0		; selected head, lun and c10
sect:	db	0		; sector #, c8 and c9
cylind:	db	0		; cylinder #  < modulo 256 >
bcount:	db	1		; block count
termin:	db	2		; step rate --> 25 us

hd_charact:			; drive characteristics
				; 614 cylinders, 4 heads 
	db	2		; last cylinder  (msb)
	db	102		; last cylinder  (lsb)
	db	4		; 4 heads
	db	2,102		; start cyl reduced wr current
	db	2,102		; start cyl wr precomp
	db	0		; always zero

ifield:	db	0,0,0,0,0	; hard disk init-parameter field

;	error message components
hdc_rw:		dw	readmsg
readmsg:	db	', Read ',0
writemsg:	db	', Write ',0
hdmsg1:		db	7
		db	'Hard Disk Error'
		db	0
hdmsg2:		db	7
		db	'Command Terminate Error'
		db	0
iniok:		db	'Seagate ST 225 - 21.4 MB'
		db	13,10,0		
msgend:         db      sub,esc,'D',0
       



	end
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееГЁ COPYRIGHT (C) 1980 DIGITAL RESEARCH ю@ДзЙ:
5жц@Н%Г                                                                                                           °1ґ5Ї252'5Нh+НU"!  ""*"5Нj"Ї2u3> 2v3*5"ш3Н-Н©-:5·ДZ!  ""$"5"5"5"5"5""5Ї22>2 5Ня:Д4юКюВb:И4ю$ВНуВM:(5 ю-КCю+КCю*ВMЕНяБ:(5!,5юMК[!35юPВMpНяГ%юВMНЭ(КЎНЈ#Нv#ВѓН $:5·ДбГ}Н%ю В}!  "&:5·К¦Н>%л*#5}“|љЪУН	НV НAВX*|µДщ:5·ВцН(Н#Н $*#5"ГA*#5"&Нц#Нv#КнН%ю ВRГНV НAВR*&л*НжВR"ГA*5е"%5!З4NA#~ЕеН«%бБВбp"5Й*5N"%5!З4q#ЕеНў%бБwВ3Й:Д4юАНЭ(АюАxю	ЙНбГ*#5еНэ:,5·Мoб"#5НV%2*5е·КГ”ю;ИюИю
ИюИю!Й:·КНV :Д4юВЪ:И4Н{Кщю%ВПН‰"">я2!:Д4юВц:И4хЇ2З4Н*НoсГлю,ВЪНkГЉНoНя:Д4юВц:И4Н{Кщю,КЉНщ:·КНkГщ*%5#е!(5~НЃКНяГЇw2и3Н@:2(4Нy"б"Ж3б"ш3Ї2и3>2v3Г:u3·КL!P46+Н(0>2Г4Й:u3·Ку:v3юРюИНА"ГUЇ2З4Н‹$Н‡%Н©$!5Й*}ґДз*#5"Ня:Д4юВ:И4ю:ВГюВ=X !ґ^#fkйо:Vj±єы&AіРюW	y
~
­µЅ8;Cі¶ЉЌНэНя:Д4юВ:З4=КG!И4КЕF#еНIбБГ	НяГ,Н*5НEНIНмНrю,КсГНэНoН‰лХНn2С"5Н~2НмГНэНЪНмНrю,КYГНэНoНС:K4ю ВН‰:K4ю ВЏ":
52> 2K4:·ДуНя:Д4юВM:И4ю
ВMГНэНg
Г%ЕНэНU!P46+:v3юТХБНї$ГЅ*ш3е*†3"ш3Нї$б"ш3сюВЅ:v3юВ*†3^#V{ІКЅr+sГЬ*†3^#VюКЅ·К-:v3юВ:r+s!З46#wГ4>Ї2З4Н‹$Г­!94~х6 !(5~х6 л"Ж3~Ц,В_#е!З4wН‹$бГЏеНV С*ж3НжВo6 Н‹$*Ж3~·В6Гћ*ж3еНя:И4ю,Дщб"Ж3~юВљ6 Ї2:4л*†3s#rс2(5с294*†3#"%5Н‡%Н©$ГЬН@*ш3"5НА":(42:и32(5·ДўГ>2Г4*¦3"Ж3Ї2(5ГхН‰Нrс!Q4wЙНуКM>=НоНn2е*5Н~2НэН%жь!
5¶Н%бН~2ГНэН‰:K4ю Вv	}>Тv	НS
ГНуВMНзГ:5·Кp*#5л*НжКgНбГuН>%"Гu> Н%Ї2 :5·МO%Ня:Д4юВ©:5·М[%! 4Ня:Д4юВ©:И4ю,КЂ>НКК:5·: МO%Г%ю	ИюИюИюЙ2)5:Д4юВе:И4юКою!КоюИНщНяГН*%5"-5>2'5Ня*%5"&Ня:Д4юВ:И4юИюВьНЭ(Вьх:)5юВN:5·ВN:З4=КNКNЕ*&"%5Н2)Н«%:(5·Д«%БсюВьxНѕВc!'54ИГьюВь!'55Вь:)5юВћ!  ":*5·КЌ!  Н5%Г™*Н5%*#5":5·А*%5~юДщ*%56ЇН«%Ї<ЙН‰:K4ю В"5Н~2НэНoНмГНуКMН%·КвжьН(>@Н%>#НоНу*5Н5%!  "Г.!/5",НэНя:Д4юВM:'5·ВM*,~#¶ВT	:5·ВT	!З4Nе*5л*,s#rл+"%5Сy·КP	ХЕН«%БСГ>	ЇН«%Г%НэНg
ю>Кv	НуГ%ю	ИюИюИюЙ2Ї22:Д4юВ¦	:И4юВ–	НяГ¬	ю!К¬	юВ¦	НуГНяГЂ	Ня:Д4юМя:Д4юВЂ	НЭ(Кй	Ня:Д4юВЫ	:И4ю:ВЂ	Ня:Д4юВЂ	НЭ(ВЂ	юВЂ	xюВю	!4МнГЂ	юВ
:·ВЂ	:юМу>НS
Г%юВ2
!~5·ВЂ	:·ДуГ%Нj	ВB
!4МнГЂ	юВЂ	!~5·ВЂ	ГєG!~юТн4_ !pЙ!~·Ку5^ !~Й>ГЂ
>2)5НэНя:Д4юВ*5"
+"%5:З4юЪҐ
>ЖН«%ЇН«%Н[%Ня:Д4юВ:И4ю,ВНV :З4·ВФ
НяГу
Н+Ку
!З4N#~ЕеН«%бБВЮ
>Н«%НяЇН«%*5"#5:)5Г-Нщ:)5НКГ%Н‰е}*5"
+"%5Н«%сН«%*5"#5>НККН@Ня:2(4:(5ю
ВHЇ2и3Нy"*5"ш3*%5л!
{–#zћлЪt~+"%5*5+"5wГT#"5*5"†3:)5юК‘N ]T	лs#r+е*#5л*
{•_zњWб"¦3:)52v3ГмНС> ГВНС>ГВНС>2 5Нn2"5НмГ%: 5юА*#5е*5"#5*5Н5%б"#5Й:5·ИKНBНn2: 5OлН0Й!*",Г	НэНяН+К+Н*5:K4ю ВН0ГН@:5·ДЁ/ГГє>2)Г:u3·К­Ня:Д4юВ­*5е+"%5Н[%Ї2!<2З4*$#"$""Н*:Й4ю0Дн!??"И4Н‹$б"5+"%5Н‡%Н©$НяН+К:Д4юВ­:И4ю,КJНщГГ"Нэ*}ґВ:*5·ВНя:5·В%:Д4юВН+:25·ДЁ/Ня:Д4юВд:И4юКьюВдН@НS+ГНщГ>2)НэНя:Д4юВ„НЈ#Нv#В::5·ДбН $:)Н%ГkН%Gж КIНбГk:)°Н%:)юКcН%жМзГkН%жДзНяН+К:Д4юВ„:И4ю,КНщГГ"НСНя:Д4юВ	:И4ю/В	Ня:Д4юВ	:5·ВХН $*#5^#V*S"s#r*5л*#5s#r+"5ГбН|#Нv#Мб*#5"5Ня:Д4юВ	:И4ю/В	!  "5:5·Д>ГВНщГ%AНBН,#*#5 	НЦЙНяНяГ:Д4юА:И4юИю!Ию;ЙЦю*ТM_ !Q^#fkйox„Љћ§¶ЖПЮзохНIНяГНЕНиНЪГНЕГН»ю8К—жДЗyж0°ГНIНЪГН»°GНиН°°ГН»°НHНиНФГНIНФГН»ж(ДЗyж°ГНIНЪГН°°ГН»°ГН»жДЗyж0°ГН»°ГНIНФГНHНэНмГ'иd 
  ! ^#V#е*"0}“o|љgЪFГ9"":!·К`x=К`yю0КlЇ2!!З4^4 !И4qбВ/Й:Д4юДЫ:И4ю,Ию;ИюДЫЙЕНяН*5БЙН‰:
5жВЄ|·}И$ВЄ·шНСЇoЙН•юФСжЙН°ж8OЙН»жДЗyж0°ГHН•ГHН‰:
5жВnГ«хЕ:Д4юВъ:И4ю,Кя>CНХ0БсЙНэ:Д4юВM:И4юВНяГю;ВCНэНя:Д4юВ#:И4ю
КюКю!КГ#ю!КюКНщГ#{•ozњgЙBНB**}ґВj!] е ~ц ю К}#yюВmбyНЦ>2(>2v3Н–Нв*5|µКВеEНBбе"#5Н>%л Н0Н,#бе 	НЦб^#VлГ•НвJНB *5лН0MНB*5лН0Й!  ".*5}ґК
"#5е^#Vл"5*.лбs#r+".Ги*."5Й:u3·КНуЇ2'5!5~4·ВP!яя"*|µКД"#5еН>%ге*Н5%б"б"Г.НяНo!P46!L4Нк*>2(>2v3Н–>2(>2v3Н–NНB:O*лН0:+5·КНэ0НД*5л*!5НSе*5л*!5НS\ бНgлНr!P4Й·КЧw#ГѕH USE FACTOR !M4Нк**"5ГA1zјА{ЅЙ*5Н~2Й*"#5Нv#ЙНуИ!  ":5·В(Н%хжуДзсц! 5¶Н%Нn2Н5%ЙН%·МбН%жюМзН>%еНn2СНжДбЙGЕ:5·xДЙБЕ:L4ю Мo:юБxЬ_*5#"5Й:5·КЅ*5|µК‰еIНB СН0Н>%еН%OСНхН%жьO: 5±Н%*5Н5%ГЅ:5·КЅ:
5O*5лНх*5еEНSБГSх НЋ2сOГ=юЪЭ>OЕеНЋ2бСNеХН=Сб#ВзЙyжВХ{НЙсГЙюВ#Х*5л*5НжК "#5"5НСХЕНЋ2БГ1ХНЋ2БЕН=БHГЋ2ГЋ2Ж0ю:ШЖЙНG!^ 4!K4wЙхжНOсжГOНn2л!е6zХН_С{Н_б4ЙЦAю_ШЖAю?ИЙ*!5"#5*#5л*5{•zњР*/5Нж+"%5КЪ**Нж+"%5КЪН%ю ВиНV%·КЪ=хН‡%сГННў%·ВЪ*%5#Гѕ!v3¦КІ:( O!я		^#Vлй4@НBГ%GГFНBН>%еН%СOН0*#5##~<##НЦГІ*#5"|3#"%5Н‡%:15·В^:З4юЪ^!И4~ю?В^#ѕКІ:И4Н†!~3 "z3^#Vл"#5}ґКќ##~<OЗ4G##ѕЪќВ—КќВ…*#5Гk*#5л*|3"#5s#r+л*z3s#r*#5##~Ж_ "#5Гњ>2v3Ї2w322(!~38Їw#ВЩН–!~3"z3>2y3*z3^#V#"z3л"#5*#5}ґК©##~<2x3G*#5###"%5:w3·К7>	Нє!w3~жшЖwжК7>†w>	Нє:w3ЂЖюPЪd!5^ !K4~ю	КB!~6 2Г4Н(0Ї2w3Н%ж!  М>%е|Н_б}Н_> Нє!w3~Жw:x3·Књ=хНў%Нє!w34сГ€*#5^#Vл"#5Гы!y35Вн:2Г4Н(0Й!^ 4!K4wЙхЕ>RНХ0БсЙхе>VНХ0бсЙх>DГх>PГх>LГх>OГх>BГх>SГх>NНХ0сЙ                                                                                                                 л!u~юЪ‡НK6 N4 !E		s#r!U	:mжw*5л!]		s#rЙх!t~ю
Ъ№6 НK^ 4с!1w!;pЙ!u~·ВЩНK!  ЇЙ5N !E		~#foе!U	~2nХ!]		^#Vл"pСбЙНЙю ДKЙНя2oлНяЙo& ) ^#fkйёБИОЪоьN]iv‚‰ђЁЇ»ЗУЪKНz·ВV{юШНK>ЙЇ•o> њgЙНл"љ!њ6  ЕЇ{_zW5бИ> О )D…*љ•OxњGЕТ“	г!њ?Гu   DM!  ЇxGyOЪ±°ИГІл)лГўННќГЯНdлГЯНdГЯНJ·КЯ)=ГСНJ·КЯхЇ|g}oс=ГЭНя2oлНЙГЯНЙ2oхл*p"rНЙБOxжДKxжКGyжДKxжGyжёК0НKЙюВGеХ*pл*r}“|љДKСблН\ГшНяН\ГЯzјА{ЅЙННWВўГњН}“|љЪњГўННWКњГlНлГlНлГyННWВњГў!яяГЯ!  ГЯНя#ГQНz¤g{ҐoГЯНzґg{µoГЯНz¬g{­oГЯНяlГЭНя& :oO:n‘2mе*p"5бЇ2n2oГx:Д4юА:И4юИю;Ию!ЙНьИю,ЙЇ2t2u2
52o=20!  "5"5Ї2mНВ{!t~·КQ5_ !1~НГ9:uюДK:K4ю А*E"5:U2
5*]"5юА*v"#5Й:K4ю В$:Д4юВ§:З4·МKюФK !И4^#=КЈVлГюВІ*Е4ГНЭ(В—юТЊюВыНV НьКт:Д4юВг:З4·ВгНяНКтНV НьВг!  Гх!яяН*Г/юO:0В·МK>я20yГ_·ВjЕ:t·К:_ !;~ёЪ:!ts!1~НБГБyюВ_!t~·КX=w_ !1~юК[НKЇГdНЄ>я20Г$yюК$юВz<OГюКюКюДKГюМKh& Г:Д4юВВ:И4ю$К°НK!  Г*5"5Нn2: 52mГНЈ#Нv#ВЦ>UНХ0!  ГН%2mжКк*#5"vГ:mжP>UМХ0Н%жюВН4Н>%:mжК!  >2mН*Ї202m!  "5НяГ/:0·МKГx*#5DM*5"5}‘|Ш^#VлГ<е>EНХ0бЙ          :u3·К›*Ж3~·ВЊ:v3юКЃ!\4> АНA!Н(0НА":и3·АГ]#"Ж3ю,Вћ"ж3ГћНс-2\ЙхюКГю
КГ:Г4юxТГ_ <2Г4!K4сwЙсЙ:94НњА:94НЙЇ2:4284Н]294:Д4юИ:94юЂЪНK)2:4;4~#ВчГ!НњИНЕК,!:4~юТ*4!;4_ :94wН]294ГЇЙЇ<Й*#5"WН‰#Н4#А*W"#5ЙЇ2[![4ВYН5!!:46 "Ж3!:4~·Кq5!84^4 !;4~Гў:u3·:94В†G·ВіН]Гў·К»ю^ВЁНУ^В·:94ю&В·!:44#wГію&КЪGюКнЇ294xГўНУКG:94ю&КС:Д4юКGН/КGГщНУ&К·Н/&К·ГщНУКGН/КG!94~ю&В>6 2и3Нy"!v36*5"ш3Нф$"Ж3Ї2:4*W"#5НУГGНJ2:42942(52Г4>
2SН(0>2Г4ЙЇ2З42TЙ!З4~ю@Ъ`6 Н5!^ 4#:(5O:Д4юyДD(wЙ~ю$АЇwЙ:(5Ц0ю
жЙН|А:(5НD(ЦAюжЙ:(5ю?К±ю@К±НD(ЦAюжЙ·ЙН™АН|Йю Рю	ИюИю
ИюИГ;!НCН»2(5:'5·Кт:)5юВм:5·Вт:(5Н«%:(5ЙюИюИю!ЙНJЇ2Д4:(5ю	Кћю;В{>2Д4:'5·К‹:)5юВ.:5·В‹ННю;ВЋ*-5л*%5++{ЅВIzјК]~ю
ВT++Г]ю!Т]+Г?"%5:'5хЇ2'5НННцВhН«%с2'5Г¤:(5ю*В—:Sю
В—НННцК¤Г‹ц ю В¤ННГЇ2Д4Н™Кі>ГпН|Кѕ>Гп:(5ю'ВПЇ2(5>Гпю
Вн:u3·Ка>+2P4Н(0!K46 >2Г4>2Д4:(52S·ДRНН:Д4юВZ:'5·А:И4ю=В!EQГMю<В8!LE:(5ю=КI!NEю>КI!LTГMю>А!GT:(5ю=ВM!GEЇ2(5"И4!З44>2Д4Й!(5:Д4юВrНuКтНіВтЙюВ НuКтН‡Вт:(5НD(юOК“юQВ>ГџюHВ©>2TЇ2(5ГЗ:SНD(юBВ№>ГАюD>
ВД!З452T!  "Е4!З4N#~#юAТЮЦ0ГаЦ7еЕO!TѕФ/! ~*Е4л!  ·К Тэл)лГф	"Е4БбВТЙ:(5юК5!ю'ВтННю'АГт:(5·Ию Ию	Й:(5ю,Ию;Ию%И:(5юИюИю!Й:(5ю;Ию Ию	Ию,ЙНJЇ2Д42ZН$ Вl ННГ` Н/ В‰ >2Д4Г#!:(52SНН:Д4юИН; ВЎ :Д4юМ/!:Z·Д/!Г)!:Д4юВЖ :(5ю'В#!НRНН:(5ю'Кz Ї2Д4Г‰ :(5ю'ВЦ >2Д4Г#!ю^Вс НН:(5ю	К#!ю Т#!Н;!Г)!ю<В!!Z~4·Кz Г#!ю>В!!Z~·К#!5Кz Г#!:Z·В#!НG К)!НRГz >2Д4Йх>VГG!х>OГG!х>IГG!х>BГG!ЕеНХ0бБсЙ                                                                                                                                                                                                                                                                     !P!ЂЇw#w#В["!  "#5Й!U3Їw#w#Вp"Й!u3~юТ#4^ !v3~w!¦3Н·"!†3Н·"!Ж3Н·"!и3~w!ш3Н·"!4~w!(4~wЙN#Fp+qЙ!u3~·К#е^ !v3Ня"!¦3Н#!†3Н#!Ж3Н#!и3Ня"!ш3Н#!4Ня"!(4Ня"б5Йе~бwЙеN#Fбq#pЙ>BГХ0!З4"Й%*Й%FЇ#†В #ж2P"Й*#5##~<ЙНv#Ил  :v3юКa#!u3N !v3	y·К^#~юКa#+ГN#<лЙ!ш3		{–z#ћЪv#!  "#5ЇЙ*#5}ґЙ!5"Q"Ї2P"Г¬#!:4"Й%Н#:P"ж2P"!U3"Q"ГІ#Н#!P!"Q"!З4"Й%*Й%~юЪЅ#6!P"^ *Q"^#fk"#5Нv#ИН,#*Й%ѕВц#G#л*#5####НD(ѕВц##Вз#Й*#5^#VлГМ#!З4^ *5"#5 л*5{•zњлТч$"5!P!"Q"Н/$Ї#w#wЙ*#5л!P"N *Q"		"S"N#Fr+sлq#pЗ4юЪV$>G=#w#6 #wВ]$Й*5л!З4n& 	{•ozњg"#5л!5{–#zћЪч$л"5Й Нf$*5л!З4N#y·К¦$~Г™$ЇЙ Нf$!U3"Q"Н/$:P"Н%Й*5л!ш3{–#zћРл"#5Н%_ !U3л*#5~#~Н&%~·#Ви$"5Гї$Г&%! %Нк*ГA1SYMBOL TABLE OVERFLOW*#5###wЙ*#5###~ЙН,#*#5_ ####ЙеН&%Сs#rЙН&%^#VлЙН&%##"%5ЙхНF%сwЙНF%~ЙН#жх!З4~юЪl%6~=Н«%сН«%!З4N#~ЕеН«%бБВy%ЙНў%хНў%2P"с<OЗ4Нў%В%Й*%5#"%5~ЙO*%5#л*5{•zњТч$л"%5yНD(w#"5Й   ж%ц%&№&	','D'J'j'€'ц'(,(()*+,-/ABCDEHLMDBDIDSDWEIEQGEGTIFINLELTNEORSPACIADCADDADIANAANDANICMACMCCMPCPIDAADADDCRDCXENDEQUHLTINRINXIRPJMPLDALOWLXIMODMOVMVINOPNOTNULORAORGORIOUTPOPPSWRALRARRETRLCRRCRSTSBBSBISETSHLSHRSTASTCSUBSUIXORXRAXRIASEGCALLCSEGDSEGELSEENDMHIGHIRPCLDAXLHLDNAMEPAGEPCHLPUSHREPTSHLDSPHLSTAXXCHGXTHLENDIFEXITMEXTRNLOCALMACROSTKLNTITLECOMMONINPAGEMACLIBPUBLIC7
 PF
FP уыAAA*Ы
A	AA(#О&€&Ђ#Ж& 2#ж/?&ё#ю'	'(v'( Г%:P!@" < &°
#ц*УБЙ)З&#ЮPP%27&ђ#Ц(&Ё#о Н$
%*йЕ%"щ$лг	NZZ NCC POPEP M юaШю{РжЯЙя ЇxЃ»К‘(_еХЕеBH !  Вf(СИ4НD(ѕ#Вѓ(Вp(БСб{ЙБСбЪЌ(KГR(CГR(Ї<Й:И4 ВюJИДюCИАюRЙ:З4юТЪ(юКї(юВЪ(!К46  4(!Й4ѕВТ(#ѕИВЕ(ЙЇ<Й:З4O=_ ХюТ.)!D'F!М%V#fjQНM(В)2Л%С!Ъ%^#Vo& )ЇO~#FЙСН”(АЕНЁ(xБА·°GyїЙСЇ<Й!З4N!E'ЇКD)†#Г;)!Л%†цЂЙж!i)_ ^#~жG~жW!ц%xЙ      
          0!0$0'0*0-000306090<0?0B0E0H0K0N0Q0T0W0Z0]0`0c0f0i0l0o0r0u0x0{0~0Ѓ0„0‡0Љ0Ќ0ђ0“0–0™0њ0џ0ў0Ґ0Ё0«0®0±0ґ0·0є0Ѕ0А0Г@З@Л@П@У@Ч@Ы@Я@г@з@л@п@у@ч@ы@я@AAAAQQQ"Q'Q,Q1Q6a<aBaHa                           ASM                                 PRN                                  REL                         Г Ђ Гґ*!;*ѕИw_Н Й:<*Гї*:=*Гї*:>*Гї*:?*Гї*:@*Гї*~Нx/~#юВк*>
Нx/Й\ 	ю?Кв-ю$Кв-w#В +Й!\ 6 З4ю	Ъ#+>GO#wВ%+>ђO#К<+6 Г2+6L#6I#6B#Їw2| Нд*\ Гз+>я2*5!Ђ "B*!(5~2A*ЇwЙН№*!њ1Нк*>826*Ї27*!  "/5* "5!ґ5"h* "Ќ* "І* #"5"!5Г\,ю ИЕе_Н бБЙ#~НЁ+В¶+Йел:;*ЖAНЁ+>:НЁ+Н¶+>.НЁ+Н¶+>-НЁ+бГк*ХН юяСА!°1НА+Г  ХН юяСА!32Нк*Г  Г ХН юяСА!З1НА+Г  :=*юИюИюЙю	ВD,> НD,:D*жВ6,Йх_Н с!D*ю
ВW,6 Йю Ш4ЙЇ2D*2*522521528*:\ ю Кв-Н 2;*2@*O:\ ·К‹,=ГЊ,y!<*w#w#w#w#>2+52,5:m ю$В>-!Ѓ ~#ю$ВЄ,~·К>-#ю К±,<*юAК-юPК-юSК-юRК-юLК-ю*Кт,ю+Кт, ю-В,-+5~юSК-юMК-25юLК-15юQК-8*ю1В,-x#Г±,~ЦAюТ,-#Г±,#6!с1Нк*!Ѓ Нк*Г  !E*Ны*e ю !N*Д +НЛ-!j*еНы*бН%,Кr-ее6 НТ*СН,СН,:=*юК‚-:>*юВ…-НК2:?*юКЁ-!Џ*ееНы*НЮ*СЇ2:*29*Н,СН,Й!3*60#60#60#>я235!  "‹*:5·ИНЁ/ГЛ-! "f*Ї2Q*2e*НМ*E*Нз+Й!Ъ1Нк*Г  zјА{ЅЙЕХе:*5·КG.*B*Ђ Нл-В.!  "B*Нд*\ Н ·В..*B*#"B*+Ђ ~юВ¤.:u3·2*5КG.Нд*\ !F2НА+Г  *f* Нл-В•.НМ*!  "f**h*ЕелНґ*E*Н бЂ Б·ВЂ.Вa.Г’.юТЄ.К’.Ђ6#В‹.Н№**h*л*f*е#"f*б~бСБжЙ!2Нк*Г  ЕG:=*юКЬ.юВЙ.xНx/ГЬ.ХеюxВЧ.Н1,ГЪ.НЮ.бСБЙ*‹*л*Ќ*wл#"‹*л! Нл-АНТ*!  "‹**Ќ*j*е!Џ*Нл-бК/~юК5/ЕХелНґ*бЂ СХеН бСБ·В9/В/Н№*Й!2Нк*Г1ЕХеНL/бСБЙ*°*л*І*wл#"°*л! Нл-АЕНЮ*!  "°**І*Џ*БГ/ЕХе_Н бСБЙ!5*~<wю:Ъ™/60+ВЉ/!3*~Ні.#Вћ/Й:6*·И:35·И>Ні.Ї27**/5}ґИ!њ1~юКС/Ні.#ГД/>	Ні.>#Ні.Н…/>	Ні.*/5~·Кт/Ні.#Гж/>Ні.>
Ні.>
Гі.}26*!7*–РГЁ/OНі.:K4ю И:5юИ:=*юИyНx/Й:8*!5¶ВI0:25!*5¦В—0~·КД0:K4ю КД0!K4~ю В—0:35·КД0:P4ю+В—0:,5·КД0юК—0:Q4ю#КД0:L4ю КД0:,5=К—0 !K4~ю К‡0!Г4s!7*е~!6*–ФЁ/б4:Г4!K4·Кє0G~Н0#x=Г«0>Н0>
Н0Ї2Г4!K4>x6 #=ВН0ЙG!K4~ю АpЙН%,И*‹*}ґКу0>Ні.Гг0НТ*j*Нъ+Й:+5юКЁ/НЯ0!s*6S#6Y#6M#Їw!Љ*w:>*2=*!  "‹*Н%,КЁ/Ї26*НТ*j*ХЇН,СН,ЙНЯ0:?*юК1::*·КZ1ЇН¬2ГL1ћНЋ2*°*}ґК1}жКw1>НB/Гa1}|GНd/   :?*юК“1НЮ*Џ*Нъ+![2Нк*Г  CP/M RMAC ASSEM 1.1NO SOURCE FILE PRESENTNO DIRECTORY SPACESOURCE FILE NAME ERRORINVALID PARAMETER:SOURCE FILE READ ERROROUTPUT FILE WRITE ERRORCANNOT CLOSE FILESUNBALANCED MACRO LIBEND OF ASSEMBLY   : 5O !5		~#foЙ: 5O л!5		s#rЙ:?*юИХyКџ2Вљ2жЕН¬2БСВЋ2ЙG:9*°29*!:*4>ѕА6 :9*НL/Ї29*ЙНэ2%А#3ХН3СН3·И/3Н3Н3Н3·Д3#3Н3·Вв2E3Н3ЙГ ‡Г ЉГ 	Г Ќ Г Г Г     MXList  WAITING FOR PRINTER
$PRINTER READY
$                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ER:SOURCE FILE READ ERROROUTPUT FILE WRITE ERRORCANNOT CLOSE FILESUNBALANCED MACRO LIBEND OF ASSEMBLY   : 5O !5		~#foЙ: 5O л!5		s#rЙ:?*юИХyКџ2Вљ2жЕН¬2БСВЋ2ЙG:9*°29*!:*4>ѕА6 :9*НL/Ї29*ЙНэ2%А#3ХН3СН3·И/3Н3Н3Н3·Д3#3Н3·Вв2E3Н3ЙГееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее;******************************************************************************
;*  D I S K I O  *  C P M S Y S 4 f  *	T h o m a s   H o l t e * 8 5 0 9 2 5 *
;******************************************************************************
;*									      *
;*			    D I S K   H A N D L E R			      *
;*			    =======================			      *
;*									      *
;*									      *
;*  Thomas Holte						 Version 1.0  *
;*									      *
;******************************************************************************

;------------------------------------------------------------------------------
; Anmerkungen:
;
; Aus verschiedenen Versionen zusammengelegt und Ansteuerung f}r Hard-Disk
; entfernt um Pseudo-Laufwerke zur Formatkonvertirung einzubinden. In den
; Originaldateien  DISKIO.MAC, TABLES.MAC und DRIVER.MAC sind dir Werte f}r
; das High-Density Format 'FRITZ' als Standartwerte einzutragen. Zur
; Portabilitaet waere eine identische Formatdefinition von Vorteil. Beim HD
; Format habe ich die Formatgr|~e durch Versuche festgelegt. Die Systemspur
; beinhaltet auf/f}r meine CPU 280 eine Formatangabe, so da~ das Format auf
; meinem anderen Rechner automatisch erkannt wird. Da nicht von High Density
; gebootet wird k|nnte man die Systemspur auch entfallen lassen. (siehe vorher).
;
; Fritz Chwolka, Saarstr.34, 5173 Aldenhoven (02464)8920
;
; Hier m|chte ich mich noch f}r das Entgegenkommen des Herrn Holte bedanken,
; welcher mir seine Originaldisketten zur Systemerstellung vertrauensvoll
; zusandte, wobei ich anschlie~end das Systembios bei Herrn Holte erstandt.
; Das BIOS darf unter beibehalten der COPYRIGHT - Meldung des Herrn HOLTE
; weitergegeben werden.
; Die Copyrechte der Firma Digital Research betreff dem CPM+ , hier speziell
; der ???????.SPR Dateien ist von obigen Aussagen unbeeintr{chtigt. Sie
; sollten auf jeden Fall eine Systemdiskette von Digital Research erworben
; haben, um so als Lizensnehmer die SPR-Systemdateien der Firma Digital
; Research zu nutzen.
; Bei Problemen oder Fragen bin ich unter obiger Adresse immer erreichbar und
; freue mich f}r jede Zuschrift.
;
; 1989 F.Chwolka
;
; Zus{tzlich rumgepfuscht hat Volker Dose. Zum einen um eine Harddisk
; mit OMTI-Controller lesen zu k|nnen. 
; Die Harddiskroutine f}r 10MByte Platte mit 2 K|pfen und 612 Cylindern
; wird jetzt eingebunden. Die Routinen sind die BIOS Sources von
; Helmut Bernhardt aus HD2.MAC. Der DPB wurde mit XCPM3.LIB aus 
; HDDTBL.ASM errechnet.
; Ausserdem soll die RAM-Floppy 770Kbyte Speicher bekommen, da bei mir
; der Helmutsche 1MB-Umbau eingebaut ist. Daf}r war es notwendig die
; XMOVE-Funktion in DRIVER.MAC zu {ndern.
;
; Au~erdem noch verschieden Kleinigkeiten in DRIVER.MAC
;
; Jetzt ist ein 8 Zoll Laufwerk als logisches Laufwerk E: eingetragen.
; Format IBM 3740 Standard 77 Tr. SS SD
; Zur Zeit ist LW E: wieder raus.
;
; Die Benutzung des IX-Registers in den Routinen zum Lesen und Schreiben
; vom/auf das logische Laufwerk P: vertr{gt sich nicht mit dem ZPM3, welchem
; ich den Vorzug gebe. IX ist also durch IY vertauscht worden.
; Das neueste ist jetzt die Aufteilung der HardDisk in zwei logische
; Laufwerke C: und D:.					19.6.93
;
; Es ist jetzt eine Tandon Festplatte mit 20 MB Kapazit{t eingebaut, also
; Einteilung in C: mit 7 MB und D: mit 14 MB.
;							15.9.93
; Auf Seagate ST 225 mit 2 Partitionen a 10.4 MB eingestellt.
; Ramdisk auf 55K
;							21.12.93
;-----------------------------------------------------------------------------


SBANK	equ	3	;Erste Bank, die von der RAMDisk benutzt wird

	.Z80

	TITLE 'CP/M 3 DISKETTE HANDLER'

	DSEG

;Disk drive dispatching tables for linked BIOS
;GLOBAL DS0,MF0,MF1,FD0,IBMPC,KDS,RAM,RAIR,ALPHAP3,DRIVEP

	GLOBAL	MF0,MF1,DS0,DS1,RAM,DRIVEP

;Variables containing parameters passed by BDOS
	EXTERNAL @DTBL,@ADRV,@RDRV,@DMA,@TRK,@SECT,@DBNK,@CBNK

;System control block variables
	EXTERNAL @ERDME		; BDOS error mode

	EXTERNAL ?PMSG		; Print message ^HL up to 0, saves reg. BC & DE
	EXTERNAL ?PDERR		; Print BIOS disk error header
	EXTERNAL ?CONIN,?CONO	; Con in and out
	EXTERNAL ?CONST		; Get console status

	EXTERNAL ?BANK,?USERF
;Harddiskroutinen aus HD2.MAC

        external hdwrit,hdread,hdlogi,hdinit,hd1ini

 
;ASCII control codes:
SUB	EQU	1AH		; Substitute
ESC	EQU	1BH		; Escape



;**Extended Disk Parameter Headers (XDPHs)


;Double Density
	DEFW	FD$WRITE
	DEFW	FD$READ
	DEFW	FD$LOGIN
	DEFW	FD$INIT
	DEFB	0		; Relative drive zero
	DEFB	0		; Drive type
				; 0 = floppy disk
				; 1 = floppy disk (special format)
				; 2 = Winchester
				; 3 = Winchester (cartridge)
				; 4 = RAM disk
MF0:	DEFW	0		; No translation table
	DEFW	0,0,0,0		; BDOS scratch area
	DEFB	0,0		; Media flag
	DEFW	DPB01		; Disk parameter block
	DEFW	0FFFEH,0FFFEH	; CSV, ALV, DIRBCB, DTABCB, HASH
	DEFW	0FFFEH,0FFFEH	; Alloc'd by GENCPM
	DEFW	0FFFEH
	DEFB	0		; Hash bank

	DEFW	FD$WRITE
	DEFW	FD$READ
	DEFW	FD$LOGIN
	DEFW	FD$INIT
	DEFB	1,0		; Relative drive one
MF1:	DEFW	0		; No translation table
	DEFW	0,0,0,0		; BDOS scratch area
	DEFB	0,0		; Media flag
	DEFW	DPB01		; Disk parameter block
	DEFW	0FFFEH,0FFFEH	; CSV, ALV, DIRBCB, DTABCB, HASH
	DEFW	0FFFEH,0FFFEH	; Alloc'd by GENCPM
	DEFW	0FFFEH
	DEFB	0		; Hash bank

;8 Zoll Floppy Laufwerk
;
;	DEFW	FD$WRITE
;	DEFW	FD$READ
;	DEFW	FD$LOGIN
;	DEFW	FD$INIT
;	DEFB	4,0		; Relative drive four (first 8 inch)
;FD0:	DEFW	XLT3		; translation table
;	DEFW	0,0,0,0		; BDOS scratch area
;	DEFB	0,0		; Media flag
;	DEFW	DPB3		; Disk parameter block
;	DEFW	0FFFEH,0FFFEH	; CSV, ALV, DIRBCB, DTABCB, HASH
;	DEFW	0FFFEH,0FFFFH	; Alloc'd by GENCPM
;	DEFW	0FFFEH
;	DEFB	0		; Hash bank



;EJECT
;RAM disk:
;--------:
	DEFW	M$WRITE
	DEFW	M$READ
	DEFW	FD$LOGIN
	DEFW	M$INIT0
	DEFB	0,4
RAM:	DEFW	0		; No translation table
	DEFW	0,0,0,0		; BDOS scratch area
	DEFB	0,0		; Media flag
	DEFW	DPBC		; Disk parameter block
	DEFW	0		; No CSV
	DEFW	0FFFEH,0FFFEH	; ALV, DIRBCB alloc'd by GENCPM
	DEFW	0FFFFH		; No data buffer
	DEFW	0FFFEH		; HASH alloc'd by GENCPM
	DEFB	0		; Hash bank

;
;XDPH f}r Harddisk Partition 1 C:
	DEFW	hdwrit
	DEFW	hdread
	DEFW	FD$LOGIN
	DEFW	hdinit
	DEFB	0		;relative Drive zero
	DEFB	2		;drive type
				; 0 : floppy disk
				; 1 : floppy disk (special format)
				; 2 : Winchester
				; 3 : Winchester (cartridge)
				; 4 : Ramdisk
DS0:	DEFW	0		;no translation table
	DEFW	0,0,0,0		;BDOS scratch area
	DEFB	0,0		;media flag
	DEFW	DPBHD1		;disk parameter block
	DEFW	0		;no CSV
	DEFW	0FFFEH,0FFFEH	;ALV, DIRBCB, DTABCB, HASH
	DEFW	0FFFEH,0FFFEH	;allocated by GENCPM
	DEFB	0		;hash bank
							
;
;XDPH f}r Harddisk Partition 2 D:
	DEFW	hdwrit
	DEFW	hdread
	DEFW	FD$LOGIN
	DEFW	hdinit
	DEFB	1		;relative Drive zero
	DEFB	2		;drive type
				; 0 : floppy disk
				; 1 : floppy disk (special format)
				; 2 : Winchester
				; 3 : Winchester (cartridge)
				; 4 : Ramdisk
DS1:	DEFW	0		;no translation table
	DEFW	0,0,0,0		;BDOS scratch area
	DEFB	0,0		;media flag
	DEFW	DPBHD2		;disk parameter block
	DEFW	0		;no CSV
	DEFW	0FFFEH,0FFFEH	;ALV, DIRBCB, DTABCB, HASH
	DEFW	0FFFEH,0FFFEH	;allocated by GENCPM
	DEFB	0		;hash bank
							



;----------------------------------------------------------------
; Formatdefinitionen:
; F}r Sonderformate wird Drive B als relatives laufwerk genutzt.
;----------------------------------------------------------------

;EJECT
;virtual disk drive P:
;--------------------:
	DEFW	P$WRITE
	DEFW	P$READ
	DEFW	FD$LOGIN
	DEFW	FD$INIT
	DEFB	1,1		; Relative drive one
DRIVEP:	DEFW	XLTF       	; Translation table
	DEFW	0,0,0,0		; BDOS scratch area
	DEFB	0,0		; Media flag
	DEFW	DPBF		; Disk parameter block
	DEFW	CSVF,ALVF	; Checksumm vector, allocation vector
	DEFW	DIBCBH,DTBCBH	; BCB list header
	DEFW	0FFFEH		; No HASH
	DEFB	0		; Hash bank
PDCT:	DEFB	01110000B
	DEFB	11000000B
	DEFB	2,10,80

;sector translation tables:
;Drive E:
;8" Drive 
;XLT3:	defb	0,6,12,18,24,4,10,16,22,2,8,14,20
;	defb	1,7,13,19,25,5,11,17,23,3,9,15,21


; Drive P:
XLTF:	DEFB	0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16
	DEFB	17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33
	DEFB	34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51


;checksum vectors
CSVF:   DEFS    64

  
;allocation vectors:
ALVF:	DEFS	100

;BCB list header:
DIBCBH:	DEFW	DIRBCB
DTBCBH:	DEFW	DTABCB

;directory control block:
DIRBCB:	DEFB	0FFH
	DEFS	9
	DEFW	DIRBUF
	DEFB	0
	DEFW	0

;data control block:
DTABCB:	DEFB	0FFH
	DEFS	9
	DEFW	DTABUF
	DEFB	0
	DEFW	0

;directory buffer:
DIRBUF:	DEFS	1024

;data buffer:
DTABUF:	DEFS	1024


;EJECT
	CSEG			; DPB must be resident


;Disk Parameter Blocks (DPB)

;Double Density Holte:
;--------------------:
DPB01:	DEFW	80		; 128 byte records per track
	DEFB	4,15		; Block shift and mask
	DEFB	0		; Extent mask
	DEFW	389		; Maximum block number
	DEFW	191		; Maximum directory entry number
	DEFB	0E0H,0		; Alloc vector for directory
	DEFW	48		; Checksum size
	DEFW	2		; Offset for system tracks
	DEFB	2,3		; Physical sector size shift and mask

;8 Zoll IBM 3740 SS SD:
;---------------------:
;DPB3:	DEFW	26		; 128 byte records per track
;	DEFB	3,7		; Block shift and mask
;	DEFB	0		; Extent mask
;	DEFW	242		; Maximum block number
;	DEFW	63		; Maximum directory entry number
;	DEFB	0C0H,0		; Alloc vector for directory
;	DEFW	16		; Checksum size
;	DEFW	2		; Offset for system tracks
;	DEFB	0,0		; Physical sector size shift and mask


;RAMDISK:
;-------:
DPBC:	DEFW	447		; 128 byte records per track
	DEFB	3,7		; Block shift and mask
	DEFB	0		; Extent mask
	DEFW	55		; Maximum block number(385 bei 770k, 330 wenn
				; Bank 2 (bzw. bei 256k Memory 110/55 k)
				; als Data-Buffer benutzt wird )
	DEFW	31		; Maximum directory entry number
	DEFB	080H,0		; Alloc vector for directory
	DEFW	8000H		; Checksum size
	DEFW	0		; Offset for system tracks
	DEFB	0,0		; Physical sector size shift and mask

;VIRTUELLES DRIVE -P-:
;--------------------:
DPBF:	DEFW	80		; 128 byte records per track
	DEFB	5,31		; Block shift and mask
	DEFB	3		; Extent mask
	DEFW	191		; Maximum block number
	DEFW	255		; Maximum directory entry number
	DEFB	192,0		; Alloc vector for directory
	DEFW	64		; Checksumm size
	DEFW	3		; Offset for system tracks
	DEFB	3,7		; Physical sector size shift and mask

;:---------------------------------:
;:HARDISK 10MByte, Partition 1 C:  :
;:---------------------------------:
;:Seagate 21,4 MB Hartddisk        :
;:---------------------------------:

DPBHD1:	DEFB  	010H,001H   ;SPT= 136      128 Byte records/track
	DEFB	005H        ;BSH=   5      block shift factor  
        DEFB    01FH        ;BLM=  31      block mask   
	DEFB	001H        ;EXM=   1      extend mask  
        DEFB    01FH,00AH   ;DSM=2591	   maximum block number 
	DEFB	0FFH,003H   ;DRM=1024      maximum directory number
	DEFB	0FFH        ;AL0= 255      allocation vector 0
        DEFB    000H        ;AL1= 000      allocation vector 1
	DEFB	000H,080H   ;CKS=   0      checksum size is zero
                            ;              ,permanently mounted
	DEFB	002H,000H   ;OFF=   2      reserved tracks 
 	DEFB	002H        ;PSH=   2      physical sector shift
	DEFB	003H        ;PHM=   3      physical record mask 

;das hei~t auf Deutsch:
;			512 Bytes/Sector
;			 68 Sectoren/Zylinder (2 K|pfe*17 Sec/Cyl)
;			615 Cylinder/Laufwerk
;			4KB Blockgr|~e
;		       2048 Directory Eintr{ge
;			  2 Reservierte Systemspur
;		      8000h Flag f}r nonremovable medium 			

;:------------------------------------:
;:HARDISK 10MByte Partition 2 D:      :
;:------------------------------------:
DPBHD2:	DEFB  	010H,001H   ;SPT= 136      128 Byte records/track
	DEFB	005H        ;BSH=   5      block shift factor  
        DEFB    01FH        ;BLM=  31      block mask   
	DEFB	001H        ;EXM=   1      extend mask  
        DEFB    039H,00AH   ;DSM=2617      maximum block number 
	DEFB	0FFH,003H   ;DRM=1024      maximum directory number
	DEFB	0FFH        ;AL0= 255      allocation vector 0
        DEFB    000H        ;AL1= 000      allocation vector 1
	DEFB	000H,080H   ;CKS=   0      checksum size is zero
                            ;              ,permanently mounted
	DEFB	033H,001H   ;OFF= 307      reserved tracks 
 	DEFB	002H        ;PSH=   2      physical sector shift
	DEFB	003H        ;PHM=   3      physical record mask 

;das hei~t auf Deutsch:
;			512 Bytes/Sector
;			 68 Sectoren/Zylinder (2 K|pfe*17 Sec/Cyl)
;			615 Cylinder/Laufwerk
;			4KB Blockgr|~e
;		       2048 Directory Eintr{ge
;			307 Reservierte Systemspuren
;		      8000h Flag f}r nonremovable medium 			


	

          DSEG

;EJECT
;RAM disk init routine:
;---------------------:
POWUP	EQU	111DH		; Power up/reset marker

M$INIT0:LD	A,(POWUP)	; Power up ?
	OR	A
	RET	Z

;clear RAM disk:
;modfied for 256k ram
;
	LD	C,32		; Entry count		 --> reg. C
	LD	DE,128		; ^first directory entry --> reg. DE
CLRNXT:	PUSH	BC		; Save remaining entry count
	PUSH	DE		; Save ^directory entry
	LD	HL,CLRBYT	; ^E5		   --> reg. HL
	LD	BC,1 SHL 8+15	; Byte count	   --> reg. B
				; Function #	   --> reg. C
	LD	A,SBANK		; Source      bank # = 0
				; Destination bank # = 2
	CALL	?USERF		; Clear current entry
	POP	HL		; ^current directory entry --> reg. HL
	LD	DE,32		; Offset to next entry	   --> reg. DE
	ADD	HL,DE		; Add offset
	EX	DE,HL		; ^next directory entry    --> reg. DE
	POP	BC		; Restore entry count
	DEC	C		; Decrement it
	JR	NZ,CLRNXT	; Clear next entry
	RET
CLRBYT:	DEFB	0E5H
          


;EJECT

          DSEG


;EJECT
;disk read routine:
FD$READ:LD	A,(@SECT)	; Sector number 	--> reg. B
	LD	B,A
	LD	A,(@TRK)	; Track number		--> reg. E
	LD	E,A
FD$REA1:LD	A,(@RDRV)	; Relative drive number --> reg. C
	LD	C,A
	LD	A,(@DBNK)	; DMA bank --> accu (upper nibble)
	SLA	A
	SLA	A
	SLA	A
	SLA	A
	OR	C		; Set drive number
	LD	HL,(@DMA)	; User buffer address	--> reg. HL
	LD	C,11		; Function number	--> reg. C
	CALL	?USERF		; Read physical disk sector
	LD	(DISK$STATUS),A	; Save status for error messages
	OR	A		; Any errors ?
	JP	NZ,RDERR
	RET

;suppress error message if BDOS is returning errors to application ...
RDERR:	LD	A,(@ERDME)
	INC	A
	JR	Z,R$HARD$ERROR

;had permanent error, print message like:
;	BIOS Error on d: T-nn, S-nn, <type>, Retry ?
	CALL	?PDERR		; Print message header
	LD	HL,(DISK$STATUS) ; Get status byte from last error
	LD	H,0
	DEC	L
	ADD	HL,HL		; Make byte offset
	LD	BC,R$ERROR$TABLE ; Point at table of message addresses
	ADD	HL,BC
	LD	A,(HL)		; Get specific message address
	INC	HL
	LD	H,(HL)
	LD	L,A
	CALL	?PMSG		; Print message
	LD	HL,ERROR$MSG	; Print "<BEL>, Retry (Y/N) ? "
	CALL	?PMSG
	CALL	U$CONIN$ECHO	; Get operator response
	LD	C,A		; Save response
	LD	HL,MSG$END	; Disable status line
	CALL	?PMSG
	LD	A,C		; Restore response
	CP	'Y'		; Yes, then retry 10 more times
	JP	Z,FD$READ
R$HARD$ERROR:			; Otherwise,
	LD	A,1		; Return hard error to BDOS
	RET


;EJECT
;disk write routine:
FD$WRITE:
	LD	A,(@SECT)	; Sector number 	--> reg. B
	LD	B,A
	LD	A,(@TRK)	; Track number		--> reg. E
	LD	E,A
FD$WRI1:LD	A,(@RDRV)	; Relative drive number --> reg. C
	LD	C,A
	LD	A,(@DBNK)	; DMA bank --> accu (upper nibble)
	SLA	A
	SLA	A
	SLA	A
	SLA	A
	OR	C		; Set drive number
	LD	HL,(@DMA)	; User buffer address	--> reg. HL
	LD	C,12		; Function number	--> reg. C
	CALL	?USERF		; Write physical disk sector
	LD	(DISK$STATUS),A	; Save status for error messages
	OR	A		; Any errors ?
	JP	NZ,WRERR
	RET

;suppress error message if BDOS is returning errors to application ...
WRERR:	LD	A,(@ERDME)
	INC	A
	JR	Z,W$HARD$ERROR

;had permanent error, print message like:
;	BIOS Error on d: T-nn, S-nn, <type>, Retry ?
	CALL	?PDERR		; Print message header
	LD	HL,(DISK$STATUS) ; Get status byte from last error
	LD	H,0
	DEC	L
	ADD	HL,HL		; Make byte offset
	LD	BC,W$ERROR$TABLE ; Point at table of message addresses
	ADD	HL,BC
	LD	A,(HL)		; Get specific message address
	INC	HL
	LD	H,(HL)
	LD	L,A
	CALL	?PMSG		; Print message
	LD	HL,ERROR$MSG	; Print "<BEL>, Retry (Y/N) ? "
	CALL	?PMSG
	CALL	U$CONIN$ECHO	; Get operator response
	LD	C,A		; Save response
	LD	HL,MSG$END	; Disable status line
	CALL	?PMSG
	LD	A,C		; Restore response
	CP	'Y'		; Yes, then retry 10 more times
	JP	Z,FD$WRITE
W$HARD$ERROR:			; Otherwise,
	LD	A,(DISK$STATUS)	; Return hard error to BDOS
	CP	5		; Diskette write protected ?
	LD	A,1		; Common error code
	RET	NZ
	INC	A

FD$LOGIN:
FD$INIT:
	RET

U$CONIN$ECHO:			; Get console input, echo it, and shift to
				; Upper case
	CALL	?CONST		; See if any character already struck
	OR	A
	JR	Z,U$C1
	CALL	?CONIN		; Yes, eat and try again
	JR	U$CONIN$ECHO
U$C1:	CALL	?CONIN
	PUSH	AF
	LD	C,A
	CALL	?CONO
	POP	AF
	CP	'A'
	RET	C
	AND	0DFH		; Make upper case
	RET

DISK$STATUS:
	DEFS	1		; Last error status code for messages
;EJECT




;EJECT
;RAM disk I/O routines
M$READ:	LD	A,0FFH		; Switch on read flag
	JR	TASKM
M$WRITE:XOR	A		; Clear read flag
TASKM:	LD	(RDFLAG),A
	LD	A,(@TRK)	; Track # --> accu
	ADD	A,SBANK		; Calc source bank #
	ADD	A,A
	ADD	A,A
	ADD	A,A
	ADD	A,A
	LD	HL,@DBNK	; Get destination bank #
	ADD	A,(HL)
	PUSH	AF		; Save bank numbers
	LD	DE,(@DMA)	; DMA address --> reg. DE
	LD	HL,(@SECT)	; Sector #    --> reg. HL
	INC	HL		; Adjust it
	LD	B,7		; Sector # * 128
	ADD	HL,HL
	DJNZ	$-1
	LD	BC,128 SHL 8+15	; Sector length --> reg. B
				; Function #	--> reg. C
	LD	A,(RDFLAG)	; Read or write ?
	OR	A
	JR	NZ,TASKM1	; Jump if read
	POP	AF		; Restore bank numbers
	RLCA			; Swap bank numbers
	RLCA
	RLCA
	RLCA
	PUSH	AF		; Push bank numbers again
	EX	DE,HL
TASKM1:	POP	AF		; Restore bank numbers
	CALL	?USERF		; Transfer "sector"
	XOR	A
	RET
RDFLAG:	DEFS	1




;EJECT
;------------------:
;virtual disk drive:
;
; Drive Controll Table mu~ f}r Konfig eine feste Adresse haben.

DCT	EQU	10D7H		; Drive control table (SYSTAB)

P$READ:	LD	IY,FD$READ	; Read	routine vector	   --> reg. IY
	JR	P$TASK
P$WRITE:LD	IY,FD$WRITE	; Write routine vector	   --> reg. IY
P$TASK:	LD	A,(DRIVEP-2)	; Relative drive number    --> accu
	ADD	A,A		; *2
	LD	C,A		; Save it
	ADD	A,A		; *4
	ADD	A,C		; *6
	LD	B,0		; Relative drive # * 6	   --> reg. BC
	LD	C,A
	LD	HL,DCT		; ^drive control table	   --> reg. HL
	ADD	HL,BC		; Calc real pointer
	PUSH	HL		; Save DCT pointer
	LD	DE,TDCT		; ^temporary storage area  --> reg. DE
	LD	BC,5		; Number of bytes	   --> reg. BC
	LDIR			; Save disk parameters of drive B:
	LD	HL,PDCT		; ^parameters for drive P: --> reg. HL
	POP	DE		; DCT pointer		   --> reg. DE
	PUSH	DE		; Save DCT pointer again
	LD	BC,5		; Number of bytes	   --> reg. BC
	LDIR			; Load disk parameters of drive P:
	LD	HL,P$RET	; Return address	   --> reg. HL
	PUSH	HL		; Push it
	JP	(IY)		; Jump to driver
P$RET:	LD	HL,TDCT		; Restore original disk parameters
	POP	DE
	LD	BC,5
	LDIR
	LD	HL,PDCT+1	; Get drive status
	SET	0,(HL)		; Set init bit
	RET
TDCT:	DEFS	5		; Temporary storage area


;EJECT
;tables of pointers to error message strings
R$ERROR$TABLE:
	DEFW	R1MSG
	DEFW	R2MSG
	DEFW	R3MSG
	DEFW	R4MSG
	DEFW	R5MSG
	DEFW	R6MSG
	DEFW	R7MSG
	DEFW	R8MSG
	DEFW	R9MSG

W$ERROR$TABLE:
	DEFW	W1MSG
	DEFW	W2MSG
	DEFW	W3MSG
	DEFW	W4MSG
	DEFW	W5MSG
	DEFW	W6MSG
	DEFW	W7MSG
	DEFW	W8MSG
	DEFW	W9MSG

R1MSG:	DEFM	' Illegal drive #,'
	DEFB	0
R2MSG:	DEFM	' Track # too high,'
	DEFB	0
R3MSG:	DEFM	' Sector # too high,'
	DEFB	0
R4MSG:	DEFM	' Device not available,'
	DEFB	0
R5MSG:	DEFB	0
R6MSG:	DEFM	' Locked/deleted record,'
	DEFB	0
R7MSG:	DEFM	' Data record not found,'
	DEFB	0
R8MSG:	DEFM	' Parity error during read,'
	DEFB	0
R9MSG:	DEFM	' Lost data during read,'
	DEFB	0

W1MSG:	DEFM	' Illegal drive #,'
	DEFB	0
W2MSG:	DEFM	' Track # too high,'
	DEFB	0
W3MSG:	DEFM	' Sector # too high,'
	DEFB	0
W4MSG:	DEFM	' Device not available,'
	DEFB	0
W5MSG:	DEFM	' Write protected diskette,'
	DEFB	0
W6MSG:	DEFM	' Write fault on disk drive,'
	DEFB	0
W7MSG:	DEFM	' Data record not found,'
	DEFB	0
W8MSG:	DEFM	' Parity error during write,'
	DEFB	0
W9MSG:	DEFM	' Lost data during write,'
	DEFB	0

ERROR$MSG:
	DEFM	' Retry (Y/N) ? '
	DEFB	0

MSG$END:DEFB	SUB,ESC,'D',0

	END

	W7MSG
	DEFW	W8MSG
	DEFW	W9MSG

R1MSG:	DEFM	' Illegal drive #,'
	DEFB	0
R2MSG:	DEFM	' Track # too high,'
	DEFB	0
R3MSG:	DEFM	' Sector # too high,'
	DEFB	0
R4MSG:	DEFM	' Device not available,'
	DEFB	0
R5MSG:	DEFB	0
R6MSG:	DEFM	' Locked/deleted record,'
	DEFB	0
R7MSG:	DEFM	' Data record not found,'
	DEFB	0
R8MSG:	DEFM	' Parity error during read,'
	DEFB	0
R9MSG:	DEFееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее;Um den richtigen DPB in DISKIO1.MAC einzubauen,mu~ er zun{chst
;mit XCPM3.LIB errechnet werden. Dies besorgt RMAC.
;
;  RMAC hddtbl $pz sz
;
;	Dann m}ssen nach dem Linken die Bytes herausgesucht
;	werden und von Hand in DISKIO1.MAC eingetragen
;	werden.
;	Die Bytefolge aus dem .COM File sieht folgenderma~en aus:
;
;	10 01 05 1f 01 1f 0a ff 07 ff ff 00 80 02 00 02 03 ; Partition 0
;	10 01 05 1f 01 39 0a ff 07 ff ff 00 80 33 01 02 03 ; Partition 1
;
;	Dies ist die Version f}r Egbert Schr|er.
;	Platte mit 	4 K|pfen
;			615 Zylindern
;			17 Sektoren/Track
;			
;	Aufgeteilt wird die Platte in 2 logische Laufwerke
;	Da dein Booteprom nicht von der Harddisk booten kann,
;	fallen die Bootspuren des ersten logischen Laufwerkes weg.
;
;	Die Aufteilung sieht physikalisch folgenderma~en aus:
;
; Spur-Nr.	0		307		615
; Partit. 0	=================------------------
; Partit. 1	-----------------==================
;
; = Datenspuren der Partition.
;
;	siehe auch den Artikel von Helmut Bernhardt.
;	 	 
;
;
 
     title 'DPH f}r Harddisk 21.40 MByte'


	maclib	xcpm3


hdsk0	dph	0,hddph0
hdsk1	dph	1,hddph1


hddph0	hdpb	512,68,307,4096,2048,2,8000h	;partition 0
hddph1	hdpb	512,68,615,4096,2048,307,8000h	;partition 1

;		 !  !   !   !    !    !	   !		
;		 !  !   !   !    !    !	   ------ Flag f}r Non-Removal-Medium	
;		 !  !   !   !    !    ----------- reserv. Systemspuren	
;    		 !  !   !   !    ---------------- 2048 Directory Eintr{ge  
;		 !  !   !   --------------------- 4 KB Blockgr|~e
;		 !  !   ------------------------- Anzahl Zylinder des Laufwerkes
;		 !  ----------------------------- Sektoren/Zylinder (4 K|pfe               
;		 !				  * 17 Sektoren)
;		 -------------------------------- Bytes / Sektor
;
;
	end
	tit. 1	-----------------==================
;
; = Datenspuren der Partition.
;
;	siehe auch den Artikel von Helmut Bernhardt.;	Macro Definitions for CP/M3 BIOS Data Structures.

	; dtbl	<dph0,dph1,...>		- drive table

	; dph	translate$table,	- disk parameter header
	;	disk$parameter$block,
	;	checksum$size,			(optional)
	;	alloc$size			(optional)

	; skew	sectors,		- skew table
	;	skew$factor,
	;	first$sector$number

	; dpb	physical$sector$size,	- disk parameter block
	;	physical$sectors$per$track,
	;	number$tracks,
	;	block$size,
	;	number$dir$entries,
	;	track$offset,
	;	checksum$vec$size		(optional)


;	Drive Table.  Contains 16 one word entries.

dtbl macro ?list
    local ?n
?n  set 0
    irp ?drv,<?list>
?n  set ?n+1
	dw	?drv
    endm

    if ?n > 16
.' Too many drives.  Max 16 allowed'
	exitm
    endif

    if ?n < 16
	rept (16-?n)
	dw	0
	endm
    endif
 endm

dph macro ?trans,?dpb,?csize,?asize
    local ?csv,?alv
	dw ?trans		; translate table address
	db 0,0,0,0,0,0,0,0,0	; BDOS Scratch area
	db 0			; media flag
	dw ?dpb			; disk parameter block
    if not nul ?csize
	dw ?csv			; checksum vector
    else
	dw 0FFFEh		; checksum vector allocated by
    endif			; GENCPM
    if not nul ?asize
	dw ?alv			; allocation vector
    else
	dw 0FFFEh		; alloc vector allocated by GENCPM
    endif
	dw 0fffeh,0fffeh,0fffeh	; dirbcb, dtabcb, hash alloc'd
				; by GENCPM
	db 0			; hash bank

    if not nul ?csize
?csv	ds	?csize		; checksum vector
    endif
    if not nul ?asize
?alv	ds	?asize		; allocation vector
    endif

    endm

dpb macro ?psize,?pspt,?trks,?bls,?ndirs,?off,?ncks
    local ?spt,?bsh,?blm,?exm,?dsm,?drm,?al0,?al1,?cks,?psh,?psm
    local ?n
;; physical sector mask and physical sector shift
    ?psh	set 0
    ?n		set ?psize/128
    ?psm	set ?n-1
	rept 8
	?n	set ?n/2
 	    if ?n = 0 
	    exitm
	    endif
	?psh	set ?psh + 1
	endm
    ?spt	set ?pspt*(?psize/128)

    ?bsh	set 3
    ?n		set ?bls/1024
	rept 8
	?n	set ?n/2
	    if ?n = 0
	    exitm
	    endif
	?bsh	set ?bsh + 1
	endm
    ?blm	set ?bls/128-1
    ?size	set (?trks-?off)*?spt
    ?dsm	set ?size/(?bls/128)-1

    ?exm	set ?bls/1024
	if ?dsm > 255
	    if ?bls = 1024
.'Error, can''t have this size disk with 1k block size'
	    exitm
	    endif
	?exm	set ?exm/2
	endif
    ?exm	set ?exm-1
    ?all	set 0
    ?n		set (?ndirs*32+?bls-1)/?bls
	rept ?n
	?all	set (?all shr 1) or 8000h
	endm
    ?al0	set high ?all
    ?al1	set low ?all
    ?drm	set ?ndirs-1
    if not nul ?ncks
    	?cks	set ?ncks
    else
	?cks	set ?ndirs/4
    endif
	dw	?spt		; 128 byte records per track
	db	?bsh,?blm	; block shift and mask
	db	?exm		; extent mask
	dw	?dsm		; maximum block number
	dw	?drm		; maximum directory entry number
	db	?al0,?al1	; alloc vector for directory
	dw	?cks		; checksum size
	dw	?off		; offset for system tracks
	db	?psh,?psm	; physical sector size shift
				; and mask
    endm

; updated version of dpb macro to be used with hard disk's
; with drive capacities much greater than 300 kb

hdpb macro ?psize,?pspt,?trks,?bls,?ndirs,?off,?ncks
     local ?spt,?bsh,?blm,?exm,?dsm,?drm,?al0,?al1,?cks,?psh,?psm
     local ?n
;; physical sector mask and physical sector shift
    ?psh	set 0
    ?n		set ?psize/128
    ?psm	set ?n-1
	rept 8
	?n	set ?n/2
 	    if ?n = 0 
	    exitm
	    endif
	?psh	set ?psh + 1
	endm
    ?spt	set ?pspt*(?psize/128)

    ?bsh	set 3
    ?n		set ?bls/1024
	rept 8
	?n	set ?n/2
	    if ?n = 0
	    exitm
	    endif
	?bsh	set ?bsh + 1
	endm
    ?blm	set ?bls/128-1

    if ?psize  >  ?bls
       ?n	set ?psize/?bls
       ?dsm	set (((?trks - ?off) * ?pspt) * ?n) - 1
    endif

    if ?psize  <= ?bls
       ?n	set ?bls / ?psize
       ?dsm	set (((?trks - ?off) * ?pspt) / ?n) - 1
    endif

    ?exm	set ?bls/1024
	if ?dsm > 255
	    if ?bls = 1024
.'Error, can''t have this size disk with 1k block size'
	    exitm
	    endif
	?exm	set ?exm/2
	endif
    ?exm	set ?exm-1
    ?all	set 0

    ?n		set (?ndirs + (?bls/32)-1)/(?bls/32)
    if  ?n = 0
    endif
    if  ?n > 16
    endif

	rept ?n
	?all	set (?all shr 1) or 8000h
	endm
    ?al0	set high ?all
    ?al1	set low ?all
    ?drm	set ?ndirs-1
    if not nul ?ncks
    	?cks	set ?ncks
    else
	?cks	set ?ndirs/4
    endif

    if not nul ?nocheck
	?cks	set ?cks or 8000h
    endif

	dw	?spt		; 128 byte records per track
	db	?bsh,?blm	; block shift and mask
	db	?exm		; extent mask
	dw	?dsm		; maximum block number
	dw	?drm		; maximum directory entry number
	db	?al0,?al1	; alloc vector for directory
	dw	?cks		; checksum size
	dw	?off		; offset for system tracks
	db	?psh,?psm	; physical sector size shift
				; and mask
    endm

;
gcd macro ?m,?n
	    ;;	greatest common divisor of m,n
		    ;;	produces value gcdn as result
		    ;;	(used in sector translate table generation)
    ?gcdm	set ?m	;;variable for m
    ?gcdn	set ?n	;;variable for n
    ?gcdr	set 0	;;variable for r
	rept 65535
	?gcdx	set ?gcdm/?gcdn
	?gcdr	set ?gcdm - ?gcdx*?gcdn
	    if ?gcdr = 0
	    exitm
	    endif
	?gcdm	set ?gcdn
	?gcdn	set ?gcdr
	endm
    endm

skew macro ?secs,?skf,?fsc
;;	generate the translate table
    ?nxtsec	set 0	;;next sector to fill
    ?nxtbas	set 0	;;moves by one on overflow
    gcd %?secs,?skf
    ;;	?gcdn = gcd(?secs,skew)
    ?neltst	set ?secs/?gcdn
    ;;	neltst is number of elements to generate
    ;;	before we overlap previous elements
    ?nelts	set ?neltst	;;counter
	rept ?secs	;;once for each sector
	db	?nxtsec+?fsc
	?nxtsec	set ?nxtsec+?skf
	    if ?nxtsec >= ?secs
	    ?nxtsec	set ?nxtsec-?secs
	    endif
	?nelts	set ?nelts-1
	    if ?nelts = 0
	    ?nxtbas	set ?nxtbas+1
	    ?nxtsec	set ?nxtbas
	    ?nelts	set ?neltst
	    endif
	endm
    endm

skew1 macro ?secs,?skf,?fsc
;;	generate the translate table
;;	with bit 8 high (usefull for twosided disks)
    ?nxtsec	set 0	;;next sector to fill
    ?nxtbas	set 0	;;moves by one on overflow
    gcd %?secs,?skf
    ;;	?gcdn = gcd(?secs,skew)
    ?neltst	set ?secs/?gcdn
    ;;	neltst is number of elements to generate
    ;;	before we overlap previous elements
    ?nelts	set ?neltst	;;counter
	rept ?secs	;;once for each sector
	db	?nxtsec+?fsc or 80h
	?nxtsec	set ?nxtsec+?skf
	    if ?nxtsec >= ?secs
	    ?nxtsec	set ?nxtsec-?secs
	    endif
	?nelts	set ?nelts-1
	    if ?nelts = 0
	    ?nxtbas	set ?nxtbas+1
	    ?nxtsec	set ?nxtbas
	    ?nelts	set ?neltst
	    endif
	endm
    endm

t ?secs	;;once for each sector
	db	?nxtsec+?fsc
	?nxtsec	set ?nxtsec+?skf
	    if ?nxtsec >= ?secs
	    ?nxtsec	set ?nxtsec-ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееPRTMSG   = Y
PAGWID   = 4F
PAGLEN   = 17
BACKSPC  = N
RUBOUT   = Y
BOOTDRV  = C
MEMTOP   = FD
BNKSWT   = Y
COMBAS   = E0
LERROR   = Y
NUMSEGS  = 02
MEMSEG00 = 42,5B,00
MEMSEG01 = 01,C0,02
MEMSEG02 = 00,C0,03
MEMSEG03 = 00,C0,04
MEMSEG04 = 00,C0,05
MEMSEG05 = 00,C0,06
MEMSEG06 = 00,C0,07
MEMSEG07 = 00,C0,08
MEMSEG08 = 00,C0,09
MEMSEG09 = 00,C0,0A
MEMSEG0A = 00,C0,0B
MEMSEG0B = 00,C0,0C
MEMSEG0C = 00,C0,0D
MEMSEG0D = 00,C0,0E
MEMSEG0E = 00,C0,0F
MEMSEG0F = 00,C0,10
HASHDRVA = Y
HASHDRVB = Y
HASHDRVC = Y
HASHDRVD = Y
HASHDRVE = Y
HASHDRVF = Y
HASHDRVG = Y
HASHDRVH = Y
HASHDRVI = Y
HASHDRVJ = Y
HASHDRVK = Y
HASHDRVL = Y
HASHDRVM = N
HASHDRVN = Y
HASHDRVO = Y
HASHDRVP = Y
ALTBNKSA = Y
ALTBNKSB = Y
ALTBNKSC = Y
ALTBNKSD = Y
ALTBNKSE = N
ALTBNKSF = N
ALTBNKSG = N
ALTBNKSH = N
ALTBNKSI = N
ALTBNKSJ = N
ALTBNKSK = N
ALTBNKSL = N
ALTBNKSM = N
ALTBNKSN = N
ALTBNKSO = N
ALTBNKSP = N
NDIRRECA = 04
NDIRRECB = 04
NDIRRECC = 10
NDIRRECD = 10
NDIRRECE = 01
NDIRRECF = 01
NDIRRECG = 01
NDIRRECH = 01
NDIRRECI = 01
NDIRRECJ = 01
NDIRRECK = 01
NDIRRECL = 01
NDIRRECM = 01
NDIRRECN = 01
NDIRRECO = 01
NDIRRECP = 01
NDTARECA = 02
NDTARECB = 02
NDTARECC = 1F
NDTARECD = 1F
NDTARECE = 01
NDTARECF = 01
NDTARECG = 01
NDTARECH = 01
NDTARECI = 01
NDTARECJ = 01
NDTARECK = 01
NDTARECL = 01
NDTARECM = 01
NDTARECN = 01
NDTARECO = 01
NDTARECP = 01
ODIRDRVA = A
ODIRDRVB = A
ODIRDRVC = A
ODIRDRVD = A
ODIRDRVE = A
ODIRDRVF = A
ODIRDRVG = A
ODIRDRVH = A
ODIRDRVI = A
ODIRDRVJ = A
ODIRDRVK = A
ODIRDRVL = A
ODIRDRVM = A
ODIRDRVN = A
ODIRDRVO = A
ODIRDRVP = A
ODTADRVA = A
ODTADRVB = A
ODTADRVC = A
ODTADRVD = A
ODTADRVE = A
ODTADRVF = A
ODTADRVG = A
ODTADRVH = A
ODTADRVI = A
ODTADRVJ = A
ODTADRVK = A
ODTADRVL = A
ODTADRVM = A
ODTADRVN = A
ODTADRVO = A
ODTADRVP = A
OVLYDIRA = Y
OVLYDIRB = Y
OVLYDIRC = Y
OVLYDIRD = Y
OVLYDIRE = Y
OVLYDIRF = Y
OVLYDIRG = Y
OVLYDIRH = Y
OVLYDIRI = Y
OVLYDIRJ = Y
OVLYDIRK = Y
OVLYDIRL = Y
OVLYDIRM = Y
OVLYDIRN = Y
OVLYDIRO = Y
OVLYDIRP = Y
OVLYDTAA = Y
OVLYDTAB = Y
OVLYDTAC = Y
OVLYDTAD = Y
OVLYDTAE = Y
OVLYDTAF = Y
OVLYDTAG = Y
OVLYDTAH = Y
OVLYDTAI = Y
OVLYDTAJ = Y
OVLYDTAK = Y
OVLYDTAL = Y
OVLYDTAM = Y
OVLYDTAN = Y
OVLYDTAO = Y
OVLYDTAP = Y
CRDATAF  = N
DBLALV   = Y
NDTARECP = 01
ODIRDRVA = A
ODIRDRVB = A
ODIRDRVC = A
ODIRDRVD = A
ODIRDRVE = A
ODIRDRVF = A
ODIRDRVG = A
ODIRDRVH = A
OееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееM80
<=HDBOOTER
<=DRIVER
<=LDRBIOHD
<

L80 HDBOOTER/N,HDBOOTER/E
<N
L80 DRIVER/N,DRIVER/E
<N

LINK CPMLDR[L4400,NR]=CPMLDR,LDRBIOHD

ERA HDBOOTER.REL
ERA DRIVER.REL
ERA LDRBIOHD.REL
ERA $$TEMP$$

T80
<LOAD HDBOOTER 1000
<LOAD DRIVER 1200
<LOAD CPMLDR 4900
<A 49A8
<JR 49A8
<
<A 4C23
<JR 4C23
<
<SAVE $$TEMP$$. 100 557F
<BYE
copysys $$temp$$
<C
<N


ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее;******************************************************************************
;*  D R V T B L  *  C P M S Y S 4 e  *  T h o m a s   H o l t e * 8 5 0 9 2 5 *
;******************************************************************************
;*									      *
;*  			     D R I V E   T A B L E			      *
;*                           =====================                            *
;*									      *
;*									      *
;*  Thomas Holte						 Version 1.0  *
;*									      *
;******************************************************************************

	.Z80

	GLOBAL @DTBL
        EXTERNAL MF0,MF1,DS0,DS1,RAM,DRIVEP


@DTBL:	DEFW MF0,MF1,DS0,DS1,0,0,0,0
	DEFW 0,0,0,0,RAM,0,0,DRIVEP

	END
жюDISK ERROREnhanced BIOS written by Thomas Holte  (c) 1985                                                                                                                                                                                                  ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее1Гж                                                          CP/M Version 3.0COPYRIGHT 1982, DIGITAL RESEARCH151282    654321PASSWORD0CONFIRMя 	я []=,  я
*** Aborted by ^C ***$
Disk I/O $
Drive $Read Only$Currently Opened$Password Error$Password: $  $Not erased, $
ERROR: Missing Delimiter or$
       Unrecognized Option $Near: $Requires CP/M 3.0 $Enter filename: $
$ERROR: Invalid file name $Confirm delete all user files (Y/N)?$No File $ (Y/N)? $
*** Aborted by ^C ***$11Нў}Ц0џхНў|ЦЦџБH±ТSНb   Н Н4Ѓ НюЪ‘!16fНb(Ђ Нr2:<<2}wНb!Ѓ 6 е*}& Б	6 !u6:}!uѕЪ‘*u& Ѓ 	~юaЪЉ*u& Ѓ 	~ю}ТЉ*u& Ѓ 	~Ц w!u4ВU!Ѓ "+!\ "-+Н5"{яя{Н”µВБzНb   Н > {НњµКк*{~ю Ва*{#"{ГН*{#"HНR:\ ю В  Н O y<2\ Нд2yНн.3l 
-В:1/ТЂ!u6 :u<2uO !\ 	~ю?В?Г(>!uѕТЂ:2/ТЂ”НbН@2x:xЦyЦџх:xЦYЦџБH±/Т}   Н НЬ	.l \ 
-В€Ђ Н«l Н»2z:zюяВµ№Нb   Н :zюяК6:zж`O !Ђ 	"/EНц";GНц"=IНц"? Нц"AНц"CНц"E:1Т¶*/:yѕВі:\ ЖA=OНI:НI НI!v6>!vѕЪW:vю	В?.НI*v& л*/NНI:v<2vВ)ВНbН@2xНI
НI:xюВѓЛНb   Н :xЦyЦџх:xЦYЦџБH±Ті.е*/#DM] б
-ВЁНГС.е*/#DM] б
-ВГНЖ	НЂ Н«*;лEН*=лGН*?лIН*Aл Н*CлН*EлН!=l НЄµК-.е*=лl б
-В%НЛ2zГµ   Н ыv  Н Й!q*& лН Йэ Н Й!p+q*л	Н Й!s+p+q*:w#6 *л
Н *#"N#FyЙ  Н Й  Н Й!p+q*лН Й! p+q*лН Й  Н Й!"p+q*!лН Йя  Н Йя -Н Й!'q:'2#!$6 #1Н Й!*r+s+q:(2#!$6юе*)лб#s#r#1Н Й mН Й!Nq!O6*O& •	
ѕВX> Й*O& •	:NѕВl:OЙ!O4ГFЙ!Ur+s+p+q+СБp+qХНЄ	!\6 Нр*T~ю КЪ*T~2\*YMН=2L!`6:Lю ВСН	:`ЪДГФ*YMН=2LГЇГдНрГђ:V2KНN	Й:V2K2_*T~2]!`6 *T~2\Нр*T~ю ВГj*TN е! 	л*Rе*R	Б
–=2^!_ѕбВ^!`6!W6:_!WѕЪ[Н	:`ЪTГщ!W4В=ГaГщ*T6 НN	Й*T:]w:KHН‚л+s#rНЄ	:Lю К”*H#"HГ™!L6Й:\2aO *R	~2X*X& л*P:”ѕКк!a4*T:aw*X& л*P:YѕВЩЙ*a& л*R~2XГ«*T6 Й*H~2YНљ:X2Z!V6*H#~2YЙ!Z4N *P	:MѕВ(	!`6 Г>	*Z& л*P:YѕК>	!`6 !V4N *H	~2YЙ*V& л*H~2Y*YMН=2L:LЦџх>!L–џБH±Т—	!V4N *H	~2Y*YMН=2LГf	:V2KHН‚#л+s#rЙ*HNН=2L!ќѕВЕ	*H#"HГЄ	ЙН™ТЫ	ћНb   Н ЙНI
НIЙ!es+q+СБp+qХ:e=2eюяК
*b:dw*b#"bГф	Й!fq НI:fюВ)
¶Нb:fюВ7
ВНb:fЦЦџх:fЦЦџБH±ТU
ЛНb:fюВc
ХНb:fюВq
жНb:fюТЃ
   Н Й!hp+q:2Тљ
 *g	>Ђ¶w3Н«*g:\ w*gDMНФ"i *g	>¦w*i}юяВн
*i|2kЦЦџх:kЦЦџБH±Тй
*kMН
:kЙ>яЙНY2lюaЪ	:lю{Т	:lЦ Й:lЙхНb3Е Нз	!m6 >!mѕЪ—Нр
2nю ЪD*m& 3	:nw:nюВOГ—:nюВZГ:nюВЂ:mюТmГ:m=2mO !3	6 Г,:nюВђ   Н !m4В#Н™2nЙ!oq:1Ъу:\ ЖA=OНI:НI НI!v6>!vѕЪн:vю	ВШ.НI*v& л*/NНI!v4ВВ НbНb*oMН
НЬ	Й\ Н‚
2wюяКQ:wюТ$*wMН
ГB:wюВB*wMНћННЬ	\ Н‚
2w:wюяКQ*wMНћЙ!L6!J6 :LЦ Жяџх:LЦЖяџБHЎх:LЦЖяџБHЎТэЂЕJ‘Нt:Jю ВаНb.НbLНb:KHНњ+"p!r6:K!rѕЪШ*pNНI*p#"p!r4В№   Н :JюВн!26:JюВъ!16Г\Й!tp+q*s~Ц Цџх~Ц	ЦџБH±Т%*s#"sГ*s~ю В1> Й>ЙЙ!  ее`i^#V#~#foНrН0ВVy·ВШwГ‡Gю:В„xЦAЪШюТШ<wН0В‡ю.КШю:КШю;КШГ‡6 НЮю.К™Н(ГќНЮ#6 Вџю;КіН(Г·НХНrН0ВЖ33ГЗСy·БyБ#q#p#wлА!  Йбб!яяЙН0К(#ю*Ву6?ВЮГхwВЮН0ИбГШН0К(333333Хе. г;;33г,г;;#wКщН0В#6 В(ЙO·И юИOю	Ию ЪnИю.Ию:Ию;Ию=Ию,Ию/Ию[Ию]Ию<Ию>ИюaШю{Тkж_жЙбГШю К~ю	К~ЙГrл_ л…oЊgЙi`N#F‘ogЙo& •oњgЙ_ {–_z#ћWлЙ                                                                                                                                                          0                                                 :nюВђ   Н !m4В#Н™2nЙ!oq:1Ъу:\ ЖA=OНI:НI НI!v6>!vѕЪн:vю	ВШ.НI*v& л*/NНI!v4ВВ НbНb*oMН
НЬ	Й\ Н‚
2wюяКQ:wюТ$*wMН
ГB:wюВB*wMНћННЬ	\ Н‚
2w:wюяКQ*wMНћЙ!L6!J6 :LЦ Жяџх:LЦЖяџБHЎх:LЦЖяџБHЎТэЂЕJ‘Нt:Jю ВаНb.НbLНb:KHНњ+"p!r6:K!rѕЪШ*pNНI*p#"p!r4В№   Н :JюВн!26:JюВъ!16Г\Й!t;******************************************************************************
;*  F O N T 1 2  *  C P M S Y S 1 a  *  T h o m a s   H o l t e * 8 5 1 1 2 6 *
;******************************************************************************
;*									      *
;*  		   F O N T S E T   F O R   M O N I T O R S 		      *
;*		   =======================================		      *
;*									      *
;*  	  W I T H   1 2   S C A N L I N E S   P E R   T E X T L I N E	      *
;*	  ===========================================================         *
;*									      *
;*									      *
;*  Thomas Holte			                         Version 1.0  *
;*									      *
;******************************************************************************

	.RADIX 16

;storage area for font set:
FONTSET:

;graphic characters:
	DEFB 18,18,18,18,18,18,18,18	;	vertical bar
	DEFB 18,18,18,18,18,18,18,18
	DEFB 00,00,00,00,00,0FF,0FF,00	;	horizontal bar
	DEFB 00,00,00,00,00,00,00,00
	DEFB 18,18,18,18,18,0FF,0FF,18	;	cross
	DEFB 18,18,18,18,18,18,18,18
	DEFB 18,18,18,18,18,1F,1F,18	;	left half of a cross
	DEFB 18,18,18,18,18,18,18,18 
	DEFB 18,18,18,18,18,0F8,0F8,18	;	right half of a cross
	DEFB 18,18,18,18,18,18,18,18
	DEFB 18,18,18,18,18,0FF,0FF,00	;	upper half of a cross
	DEFB 00,00,00,00,00,00,00,00
	DEFB 00,00,00,00,00,0FF,0FF,18	;	lower half of a cross
	DEFB 18,18,18,18,18,18,18,18
	DEFB 18,18,18,18,18,1F,1F,00	;	upper left corner
	DEFB 00,00,00,00,00,00,00,00
	DEFB 18,18,18,18,18,0F8,0F8,00	;	upper right corner
	DEFB 00,00,00,00,00,00,00,00
	DEFB 00,00,00,00,00,1F,1F,18	;	lower left corner
	DEFB 18,18,18,18,18,18,18,18
	DEFB 00,00,00,00,00,0F8,0F8,18	;	lower right corner
	DEFB 18,18,18,18,18,18,18,18
	DEFB 18,18,18,18,1C,0F,07,00	;	upper left arc
	DEFB 00,00,00,00,00,00,00,00
	DEFB 18,18,18,18,38,0F0,0E0,00	;	upper right arc
	DEFB 00,00,00,00,00,00,00,00
	DEFB 00,00,00,00,00,07,0F,1C	;	lower left arc
	DEFB 18,18,18,18,18,18,18,18
	DEFB 00,00,00,00,00,0E0,0F0,38	;	lower right arc
	DEFB 18,18,18,18,18,18,18,18
	DEFB 00,00,08,1C,2A,08,08,08	;	up arrow
	DEFB 08,00,00,00,00,00,00,00
	DEFB 00,00,08,08,08,08,2A,1C	;	down arrow
	DEFB 08,00,00,00,00,00,00,00
	DEFB 00,00,00,08,04,7E,04,08	;	left arrow
	DEFB 00,00,00,00,00,00,00,00
	DEFB 00,00,00,10,20,7E,20,10	;	right arrow
	DEFB 00,00,00,00,00,00,00,00
	DEFB 00,00,08,1C,3E,7F,7F,3E	;	spades
	DEFB 08,08,00,00,00,00,00,00
	DEFB 00,00,00,36,7F,7F,3E,1C	;	hearts
	DEFB 08,00,00,00,00,00,00,00
	DEFB 00,00,08,1C,3E,7F,3E,1C	;	diamonds
	DEFB 08,00,00,00,00,00,00,00
	DEFB 00,00,1C,1C,08,6B,7F,6B	;	clubs
	DEFB 08,1C,00,00,00,00,00,00
	DEFB 55,0AA,55,0AA,55,0AA,55,0AA;	shaded area
	DEFB 55,0AA,55,0AA,55,0AA,55,0AA
	DEFB 00,00,3C,42,0B9,85,85,0B9	;	copyright
	DEFB 42,3C,00,00,00,00,00,00
	DEFB 00,00,0FA,06,0C6,46,26,0DE	;	1st part of a hand
	DEFB 06,0FA,00,00,00,00,00,00
	DEFB 00,00,0FF,20,0C0,3F,40,3F	;	2nd part of a hand
	DEFB 20,1F,00,00,00,00,00,00
	DEFB 00,00,3F,40,3F,00,00,00	;	3rd part of a hand
	DEFB 00,00,00,00,00,00,00,00
	DEFB 00,00,00,00,7C,2A,28,28	;	Pi
	DEFB 28,00,00,00,00,00,00,00
	DEFB 00,00,1C,22,41,41,63,22	;	Omega
	DEFB 63,00,00,00,00,00,00,00
	DEFB 00,00,3C,42,0A5,81,0A5,99	;	"Smiley"
	DEFB 42,3C,00,00,00,00,00,00
	DEFB 00,00,3C,42,0A5,81,99,0A5	;	"Laetschi"
	DEFB 42,3C,00,00,00,00,00,00


*EJECT
;ASCII characters:
	DEFB 00,00,00,00,00,00,00,00	;	space
	DEFB 00,00,00,00,00,00,00,00
	DEFB 00,00,08,08,08,08,08,00	;	!
	DEFB 08,00,00,00,00,00,00,00
	DEFB 00,00,14,14,00,00,00,00	;	"
	DEFB 00,00,00,00,00,00,00,00
	DEFB 00,00,14,14,3E,14,3E,14	;	#
	DEFB 14,00,00,00,00,00,00,00
	DEFB 00,00,08,3C,0A,1C,28,1E	;	$
	DEFB 08,00,00,00,00,00,00,00
	DEFB 00,00,26,26,10,08,04,32	;	%
	DEFB 32,00,00,00,00,00,00,00
	DEFB 00,00,04,0A,0A,04,2A,12	;	&
	DEFB 2C,00,00,00,00,00,00,00
	DEFB 00,00,0C,0C,08,04,00,00	;	'
	DEFB 00,00,00,00,00,00,00,00
	DEFB 00,00,10,08,04,04,04,08	;	(
	DEFB 10,00,00,00,00,00,00,00
	DEFB 00,00,04,08,10,10,10,08	;	)
	DEFB 04,00,00,00,00,00,00,00
	DEFB 00,00,00,14,08,3E,08,14	;	*
	DEFB 00,00,00,00,00,00,00,00
	DEFB 00,00,00,08,08,3E,08,08	;	+
	DEFB 00,00,00,00,00,00,00,00
	DEFB 00,00,00,00,00,00,00,0C	;	,
	DEFB 0C,08,04,00,00,00,00,00
	DEFB 00,00,00,00,00,3E,00,00	;	-
	DEFB 00,00,00,00,00,00,00,00
	DEFB 00,00,00,00,00,00,00,0C	;	.
	DEFB 0C,00,00,00,00,00,00,00
	DEFB 00,00,20,20,10,08,04,02	;	/
	DEFB 02,00,00,00,00,00,00,00
	DEFB 00,00,1C,22,22,2A,22,22	;	0
	DEFB 1C,00,00,00,00,00,00,00
	DEFB 00,00,08,0C,08,08,08,08	;	1
	DEFB 1C,00,00,00,00,00,00,00
	DEFB 00,00,1C,22,20,10,08,04	;	2
	DEFB 3E,00,00,00,00,00,00,00
	DEFB 00,00,3E,20,10,18,20,22	;	3
	DEFB 1C,00,00,00,00,00,00,00
	DEFB 00,00,10,08,14,12,3E,10	;	4
	DEFB 10,00,00,00,00,00,00,00
	DEFB 00,00,3E,02,1E,20,20,22	;	5
	DEFB 1C,00,00,00,00,00,00,00
	DEFB 00,00,1C,02,02,1E,22,22	;	6
	DEFB 1C,00,00,00,00,00,00,00
	DEFB 00,00,3E,20,20,10,08,04	;	7
	DEFB 02,00,00,00,00,00,00,00
	DEFB 00,00,1C,22,22,1C,22,22	;	8
	DEFB 1C,00,00,00,00,00,00,00
	DEFB 00,00,1C,22,22,3C,20,20	;	9
	DEFB 1C,00,00,00,00,00,00,00
	DEFB 00,00,00,00,0C,0C,00,0C	;	:
	DEFB 0C,00,00,00,00,00,00,00
	DEFB 00,00,00,00,0C,0C,00,0C	;	;
	DEFB 0C,08,04,00,00,00,00,00
	DEFB 00,00,10,08,04,02,04,08	;	<
	DEFB 10,00,00,00,00,00,00,00
	DEFB 00,00,00,00,3E,00,3E,00	;	=
	DEFB 00,00,00,00,00,00,00,00
	DEFB 00,00,02,04,08,10,08,04	;	>
	DEFB 02,00,00,00,00,00,00,00
	DEFB 00,00,1C,22,20,10,08,00	;	?
	DEFB 08,00,00,00,00,00,00,00
	DEFB 00,00,1C,22,3A,2A,3A,02	;	@
	DEFB 1C,00,00,00,00,00,00,00
	DEFB 00,00,08,14,22,22,3E,22	;	A
	DEFB 22,00,00,00,00,00,00,00
	DEFB 00,00,1E,24,24,1C,24,24	;	B
	DEFB 1E,00,00,00,00,00,00,00
	DEFB 00,00,1C,22,02,02,02,22	;	C
	DEFB 1C,00,00,00,00,00,00,00
	DEFB 00,00,1E,24,24,24,24,24	;	D
	DEFB 1E,00,00,00,00,00,00,00
	DEFB 00,00,3E,02,02,1E,02,02	;	E
 	DEFB 3E,00,00,00,00,00,00,00
	DEFB 00,00,3E,02,02,1E,02,02	;	F
	DEFB 02,00,00,00,00,00,00,00
	DEFB 00,00,1C,22,02,3A,22,22	;	G
	DEFB 1C,00,00,00,00,00,00,00
	DEFB 00,00,22,22,22,3E,22,22	;	H
	DEFB 22,00,00,00,00,00,00,00
	DEFB 00,00,1C,08,08,08,08,08	;	I
	DEFB 1C,00,00,00,00,00,00,00
	DEFB 00,00,20,20,20,20,20,22	;	J
	DEFB 1C,00,00,00,00,00,00,00
	DEFB 00,00,22,12,0A,06,0A,12	;	K
	DEFB 22,00,00,00,00,00,00,00
	DEFB 00,00,02,02,02,02,02,02	;	L
	DEFB 3E,00,00,00,00,00,00,00
	DEFB 00,00,22,36,2A,2A,22,22	;	M
	DEFB 22,00,00,00,00,00,00,00
	DEFB 00,00,22,22,26,2A,32,22	;	N
	DEFB 22,00,00,00,00,00,00,00
	DEFB 00,00,1C,22,22,22,22,22	;	O
	DEFB 1C,00,00,00,00,00,00,00
	DEFB 00,00,1E,22,22,1E,02,02	;	P
	DEFB 02,00,00,00,00,00,00,00
	DEFB 00,00,1C,22,22,22,2A,12	;	Q
	DEFB 2C,00,00,00,00,00,00,00
	DEFB 00,00,1E,22,22,1E,0A,12	;	R
	DEFB 22,00,00,00,00,00,00,00
	DEFB 00,00,1C,22,02,1C,20,22	;	S
	DEFB 1C,00,00,00,00,00,00,00
	DEFB 00,00,3E,08,08,08,08,08	;	T
	DEFB 08,00,00,00,00,00,00,00
	DEFB 00,00,22,22,22,22,22,22	;	U
	DEFB 1C,00,00,00,00,00,00,00
	DEFB 00,00,22,22,22,14,14,08	;	V
	DEFB 08,00,00,00,00,00,00,00
	DEFB 00,00,22,22,22,2A,2A,2A	;	W
	DEFB 14,00,00,00,00,00,00,00
	DEFB 00,00,22,22,14,08,14,22	;	X
	DEFB 22,00,00,00,00,00,00,00
	DEFB 00,00,22,22,14,08,08,08	;	Y
	DEFB 08,00,00,00,00,00,00,00
	DEFB 00,00,3E,20,10,08,04,02	;	Z
	DEFB 3E,00,00,00,00,00,00,00
	DEFB 00,00,1C,04,04,04,04,04	;	[
	DEFB 1C,00,00,00,00,00,00,00	
	DEFB 00,00,02,02,04,08,10,20	;	\
	DEFB 20,00,00,00,00,00,00,00
	DEFB 00,00,1C,10,10,10,10,10	;	]
	DEFB 1C,00,00,00,00,00,00,00
	DEFB 00,00,08,14,22,00,00,00	;	^
	DEFB 00,00,00,00,00,00,00,00
	DEFB 00,00,00,00,00,00,00,00	;	_
	DEFB 00,00,3E,00,00,00,00,00
	DEFB 00,00,18,18,08,10,00,00	;	`
	DEFB 00,00,00,00,00,00,00,00
	DEFB 00,00,00,00,1C,12,12,12	;	a
	DEFB 3C,00,00,00,00,00,00,00
	DEFB 00,00,02,02,1E,22,22,22	;	b
	DEFB 1E,00,00,00,00,00,00,00
	DEFB 00,00,00,00,3C,02,02,02	;	c
	DEFB 3C,00,00,00,00,00,00,00
	DEFB 00,00,20,20,3C,22,22,22	;	d
	DEFB 3C,00,00,00,00,00,00,00
	DEFB 00,00,00,00,1C,22,1E,02	;	e
	DEFB 1C,00,00,00,00,00,00,00
	DEFB 00,00,18,24,04,0E,04,04	;	f
	DEFB 04,00,00,00,00,00,00,00
	DEFB 00,00,00,00,3C,22,22,22	;	g
	DEFB 3C,20,1E,00,00,00,00,00
	DEFB 00,00,02,02,1E,22,22,22	;	h
	DEFB 22,00,00,00,00,00,00,00
	DEFB 00,00,08,00,0C,08,08,08	;	i
	DEFB 1C,00,00,00,00,00,00,00
	DEFB 00,00,10,00,10,10,10,10	;	j
	DEFB 12,0C,00,00,00,00,00,00
	DEFB 00,00,02,02,12,0A,06,0A	;	k
	DEFB 12,00,00,00,00,00,00,00
	DEFB 00,00,04,04,04,04,04,04	;	l
	DEFB 18,00,00,00,00,00,00,00
	DEFB 00,00,00,00,1E,2A,2A,2A	;	m
	DEFB 2A,00,00,00,00,00,00,00
	DEFB 00,00,00,00,1E,22,22,22	;	n
	DEFB 22,00,00,00,00,00,00,00
	DEFB 00,00,00,00,1C,22,22,22	;	o
	DEFB 1C,00,00,00,00,00,00,00
	DEFB 00,00,00,00,1E,22,22,22	;	p
	DEFB 1E,02,02,00,00,00,00,00
	DEFB 00,00,00,00,3C,22,22,22	;	q
	DEFB 3C,20,20,00,00,00,00,00
	DEFB 00,00,00,00,1A,26,02,02	;	r
	DEFB 02,00,00,00,00,00,00,00
	DEFB 00,00,00,00,3C,02,1C,20	;	s
	DEFB 1E,00,00,00,00,00,00,00
	DEFB 00,00,04,04,0E,04,04,24	;	t
	DEFB 18,00,00,00,00,00,00,00
	DEFB 00,00,00,00,22,22,22,22	;	u
	DEFB 1C,00,00,00,00,00,00,00
	DEFB 00,00,00,00,22,22,22,14	;	v
	DEFB 08,00,00,00,00,00,00,00
	DEFB 00,00,00,00,22,22,2A,2A	;	w
	DEFB 14,00,00,00,00,00,00,00
	DEFB 00,00,00,00,22,14,08,14	;	x
	DEFB 22,00,00,00,00,00,00,00
	DEFB 00,00,00,00,22,22,22,22	;	y
	DEFB 3C,20,1E,00,00,00,00,00
	DEFB 00,00,00,00,3E,10,08,04	;	z
	DEFB 3E,00,00,00,00,00,00,00
	DEFB 00,00,18,04,04,02,04,04	;	{
	DEFB 18,00,00,00,00,00,00,00
	DEFB 00,00,08,08,08,00,08,08	;	|
	DEFB 08,00,00,00,00,00,00,00
	DEFB 00,00,0C,10,10,20,10,10	;	}
	DEFB 0C,00,00,00,00,00,00,00
	DEFB 00,00,4C,32,00,00,00,00	;	~
	DEFB 00,00,00,00,00,00,00,00
	DEFB 00,00,00,3E,3E,3E,3E,3E	;	block
	DEFB 00,00,00,00,00,00,00,00


*EJECT
;language dependent ASCII characters:
	DEFB 00,00,1C,22,3A,2A,3A,02	;	@
	DEFB 1C,00,00,00,00,00,00,00
	DEFB 00,00,1C,04,04,04,04,04	;	[
	DEFB 1C,00,00,00,00,00,00,00	
	DEFB 00,00,02,02,04,08,10,20	;	\
	DEFB 20,00,00,00,00,00,00,00
	DEFB 00,00,1C,10,10,10,10,10	;	]
	DEFB 1C,00,00,00,00,00,00,00
	DEFB 00,00,18,04,04,02,04,04	;	{
	DEFB 18,00,00,00,00,00,00,00
	DEFB 00,00,08,08,08,00,08,08	;	|
	DEFB 08,00,00,00,00,00,00,00
	DEFB 00,00,0C,10,10,20,10,10	;	}
	DEFB 0C,00,00,00,00,00,00,00
	DEFB 00,00,4C,32,00,00,00,00	;	~
	DEFB 00,00,00,00,00,00,00,00

;German characters:
	DEFB 00,1C,22,04,0A,12,24,28	;	paragraph
	DEFB 10,22,1C,00,00,00,00,00
	DEFB 22,00,08,14,22,22,3E,22	;	"Ae"
	DEFB 22,00,00,00,00,00,00,00
	DEFB 22,00,1C,22,22,22,22,22	;	"Oe"
	DEFB 1C,00,00,00,00,00,00,00
	DEFB 22,00,22,22,22,22,22,22	;	"Ue"
	DEFB 1C,00,00,00,00,00,00,00
	DEFB 00,00,14,00,1C,12,12,12	;	"ae"
	DEFB 3C,00,00,00,00,00,00,00
	DEFB 00,00,14,00,1C,22,22,22	;	"oe"
	DEFB 1C,00,00,00,00,00,00,00
	DEFB 00,00,14,00,22,22,22,22	;	"ue"
	DEFB 1C,00,00,00,00,00,00,00
	DEFB 00,00,1C,22,22,1E,22,22	;	"sharp" "s"
	DEFB 1E,02,02,00,00,00,00,00


*EJECT
	.RADIX 10
DEFB 00,00,1C,10,10,10,10,10	;	]
	DEFB 1C,00,00,00,00,00,00,00
	DEFB 00,00,18,04,04,02,04,04	;	{
	DEFB 18,00,00,00,00,00,00,00
	DEFB 00,00,08,08,08,00,08,08	;	|
	DEFB 08,00,00,00,00,00,00,00
	DEFB 00,00,0C,10,10,20,10,10	;	}
	DEFB 0C,00,00,00,00,00,ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееГЁ#яяяяяяяяяяяяяяяяяяяяяяяяяя                          MM/DD/YY  HH:MM:SS  formatted by FORMAT, written by Thomas Holte (c) 1985                                                                                                                   л!ПФ9щл  ХЕЕЕ ХНҐ'ББсеЕ  ! 9s#rГ&! 9^#V+s#r! Н%КШБСХЕ! 9~#fo)^#VzіК‡БСХЕ! 9~#fo)^#V!цясе! 9^#V!)+9еБСХЕ!	 е ХХ ХН	*л!
 9щГ—! 9^#V!)+9я s! 9^#V!)+9^ !  |µВІГ№{ЦІВјГГ{ЦІВХ! 9^#V!ЃлA 	}Г  ! 9s#rГс! 9^#V+s#r! Н%Кж! 9^#V!Ѓ^ zіКг Х! 9^#V!Ѓе“ХН§)БББ! 9^#V!Ѓ^ zіКS! 9^#V!Ѓ^ zіКS К–мХ“ХНg)ББ! 9^#V+s#r! Н%К“! 9^#V!Ѓ^ zіВђГ“ГcГг! 9^#V! 9s#rГґ! 9^#V+s#r! Н%Кг! 9^#V!Ѓ^ zіКарХ“ХНg)ББГгГЁГе ХН)Б!;+9^#V+s#rНИ$ВD!=+9^#V+s#rл^#V& oеНT1Бїя	л!(+9s! Н%лzіВD!(+9^ !Ѓ^ НИ$КG Кd“ХцХуХН)БББ ХНв#БыХ!*+9^ !A еЙХъХН)л! 9щН-)еНT1Б:  _Н
%КЎл!9+9щлЙБСХЕ!(+9n& )^#V!цясе!'+9еБСХЕ! е ХХ ХН	*л!
 9щ!(+9^ !)+9^ !  |µВXмХ!)+9^ ! Н{$Ч	е Х Х ХН	*л!
 9щ!ю :н _НЬ$}2н!'+9^ ! Н{$Ч	емХ Х Х ХН	*л!
 9щГ±{ЦІВэмХБСХЕ!# е Х Х ХН	*л!
 9щ!ю :н _НЬ$}2нСХ!# емХ Х Х ХН	*л!
 9щ! :м _Нъ$ НЬ$л!&+9s! :м _Нъ$ НЬ$л!%+9s!%+9^ zіК! :м _Нъ$ НЬ$НУ$Г!  л!! 9s! :м _Нъ$ НЬ$л! 9s!&+9^ *п& Н•$}2т! :н _Нъ$ НЬ$КX:т _Г[  !"+9s!! 9^ *р& л! 9s#r! :н _Нъ$ НЬ$л!$+9s! 9s#r!Ђ "к! 9^#V+s#rzіК»*к Н{$"кГљ:о _!#+9s!%+9^ zіК2
 !$ 9s#r!$+9^ {ЦІВ !$ 9^#V!b л!$ 9s#rГ{ЦІВ!$ 9^#V! л!$ 9s#r!$ 9^#V!< н[кл!" 9s#r!$ 9^#V! л!( 9s#r!" 9^#V*т& Н{$л!& 9s#r  ! 9s#rГЃ! 9^#V!" 9~#foл! 9s#r!& 9~#foН%Кц	  ! 9s#r! 9^#V!$ 9~#foН%КС! 9^#V+s#r! 9~#foл!* 9N sГ™!$ 9^#V! л! 9~#foН%К! 9^#V+s#r! 9~#foл!* 9  sГС!$ 9^#V! л! 9~#foН%КK! 9^#V+s#r! 9~#foл!* 9х sГ! 9^#V! 9~#foл!* 9ю s! 9^#V! л! 9s#r! 9s#r! 9~#foл!* 9л!$+9n& }! 9^#V+s#r! 9~#foл!* 9ч s!$ 9^#V!+ л! 9~#foН%Кч! 9^#V+s#r! 9~#foл!* 9N sГє!$ 9^#V!7 л! 9~#foН%К4	! 9^#V+s#r! 9~#foл!* 9  sГч!$ 9^#V!: л! 9~#foН%Кq	! 9^#V+s#r! 9~#foл!* 9х sГ4	! 9^#V+s#r! 9~#foл!* 9ы s!$ 9^#V!; н[кл! 9~#foН%КУ	! 9^#V+s#r! 9~#foл!* 9е sГ‘	! 9^#V+s#r! 9~#foл!* 9ч sГi!& 9^#V! 9s#rГ
! 9^#V+s#r!ш*Н%К/
! 9^#V!* 9N sГ
Гч !$ 9s#r!$+9^ zіВ\
!$ 9^#V!хял!$ 9s#r!$ 9^#V! н[кл!" 9s#r!$ 9^#V! л!( 9s#r!" 9^#V*т& Н{$л!& 9s#r  ! 9s#rГГ
! 9^#V!" 9~#foл! 9s#r!& 9~#foН%Кѕ  ! 9s#r! 9^#V!$ 9~#foН%К! 9^#V+s#r! 9~#foл!* 9я sГЫ
!$ 9^#V! л! 9~#foН%КP! 9^#V+s#r! 9~#foл!* 9  sГ! 9^#V! 9~#foл!* 9ю s! 9^#V! л! 9s#r! 9s#r! 9~#foл!* 9л!$+9n& }! 9^#V+s#r! 9~#foл!* 9ч s!$ 9^#V! л! 9~#foН%Кь! 9^#V+s#r! 9~#foл!* 9я sГї!$ 9^#V! л! 9~#foН%К9! 9^#V+s#r! 9~#foл!* 9  sГь! 9^#V+s#r! 9~#foл!* 9ы s!$ 9^#V! н[кл! 9~#foН%К›! 9^#V+s#r! 9~#foл!* 9е sГY! 9^#V+s#r! 9~#foл!* 9ч sГ«
!& 9^#V! 9s#rГЫ! 9^#V+s#r!ш*Н%Кч! 9^#V!* 9я sГП  ! 9s! 9s#rГ! 9^#V+s#r*т& Н%Кў! 9^ ! 9s#r!^ {ЦяІКT! 9^ s! 9^#V+s#rГџ! 9^#V!л! 9~#fo! 9^ !#+9n& л! 9s*т& Н%Кџ! 9^ *т& л§нRл! 9sГ	!&+9^ zіК   ! 9s#rГЗ! 9^#V+s#r*т& Н%К ! 9^#V*т& л! 9~#foХ^ *т& С}Г»ХХН)ББ!! 9^ ! 9s#rГ*! 9^#V+s#r! 9~#foН%Кс!( 9^#V! 9s#rГa! 9^#V!" 9~#foл! 9s#r!& 9~#foН%К€! 9^#V!* 9л! 9~#foГI! 9^#VХХН)ББ  ! 9sГ­! 9^ s! 9^ !&+9n& Н%Ко!( 9^#V! 9s#r  ! 9s#rГ! 9^#V!" 9~#foл! 9s#r! 9^#V+s#r! 9^#V*т& Н%Кj! 9^#V!* 9л! 9n& }! 9^#V!* 9л! 9~#foХ^ ! 9n& е!&+9^ ! 9n& Н{$СС}ГЭ!* 9е! 9^#VХ! 9^ Х!-+9^ ХН л! 9щ! 9szіКл! 9^ ХН8Бл! 9s* & Н*%КВ ХНв#БГа! 9^ * & Н*%Ка! 9^#V+s#rХН)БГоГ¤Г$ХХН)ББ!! 9^ ! 9s#rГ! 9^#V+s#r! 9~#foН%Къ! 9^#VХХН)ББ! 9^#VХ!)+9^ ХНО!ББл! 9szіКч! 9^ ХН8Бл! 9s* & Н*%К‚ ХНв#БГк! 9^ * & Н*%Кк!( 9^#V! 9s#rГЅ! 9^#V!" 9~#foл! 9s#r!& 9~#foН%Кд! 9^#V!* 9л! 9~#foГҐ  ! 9sГш! 9^ s! 9^ !&+9n& Н%КЮ!( 9^#V! 9s#r  ! 9s#rГM! 9^#V!" 9~#foл! 9s#r! 9^#V+s#r! 9^#V*т& Н%Кµ! 9^#V!* 9л! 9n& }! 9^#V!* 9л! 9~#foХ^ ! 9n& е!&+9^ ! 9n& Н{$СС}Г(!* 9е! 9^#VХ! 9^ Х!-+9^ ХН л! 9щГп! 9^#V+s#r$ХХН)ББГГд{ЦІВдгХ!)+9^ ! Н{$	е Х Х ХН	*л!
 9щБСХЕ!(+9n& )^#V!цясе! 9еБСХЕ! е Х Х ХН	*л!
 9щ! :г _Нъ$л!&+9s! :г _Нъ$ НЬ$л! 9s*з& }2тил^#V! 9s#r!Ђ "к! :д _Нъ$` НЬ$}2дл{Ц@ІВЬ*к Н{$"кГг{Ц ІВт*к Н{$"кГы!  |µВ*к Н{$"к:ж _!#+9s!'+9^ ХНvБ!* 9л! 9s#r*кл! 9s#r*кл! 9s#r! 9s#r*кХ Н{$Сл!
 9s#r  ! 9s#rГv! 9^#V+s#r! :т _Н{$л! 9~#foН%КГ! 9^#VХ! 9^#V+s#rб  s! 9^#V! 9~#foя sГj  ! 9s#rГб! 9^#V! 9s#r*кН%К! 9^#V! 9~#fom sГР ! 9s#rГ! 9^#V! 9s#r*кН%К?! 9^#V! 9~#fo¶ sГ ! 9s#rГ]! 9^#V! 9s#r*кН%К}! 9^#V! 9~#foЫ sГLя Х*ке! 9^#VХНQ)БББ  Х*ке! 9^#VХНQ)БББJ Х! 9^#VХ7ХНа(БББ Х! 9^#VХНи'еНа(БББ Х! 9^#V!
 еН4*еНа(БББ  ! 9s! 9s#rГ! 9^#V+s#r*т& Н%Кј! 9n&  Н{$#л! 9s#r! 9^#V! 9~#fo^ {ЦяІК`! 9^ s! 9^#V+s#rГ№! 9^#V! 9~#foе! 9^#V! 9n& С}! 9^ !#+9n& л! 9s*т& Н%К№! 9^ *т& л§нRл! 9sГ=ХН)Б  ! 9s#rГЭ! 9^#V+s#r!&+9^ ! 9~#foН•$л! 9~#foН%КЮ  ! 9sГ! 9^ s! 9^ !&+9n& Н%КЫ!&+9^ ! 9~#foН{$л! 9n& л! 9s#rХХН)ББ! 9^#VХ! 9^#VХ! 9^ Х!-+9^ ХН№л! 9щ  ! 9sГ’! 9^ s! 9^ *т& Н%КШ! 9^#VХ! 9^#VХ! 9^ Х!-+9^ ! е ХН	*л!
 9щГ‰Г
ГСWХН)Б  ! 9s#rГя! 9^#V+s#r! 9~#foН%КA! 9^#VХ#ХН)ББ  ! 9sГ2! 9^ s! 9^ *т& Н%К>! 9^#VХ! 9^#VХ! 9^ Х!-+9^ ! е ХН	*л!
 9щzіК;! 9^#VzіКё! 9^#V!я Н%лzіКё *кН•$+л! 9~#foН%лzіКё К8! 9^#V! 9~#foХ Н{$Сл! 9~#foлs#r! 9^#V! 9~#foХ Н{$С##л! 9n& }sХ! 9^#V+s#rХ+ХН)БББ! 9^#VХѓХ1ХН)БББГ;НёГ)Гу! 9^#V*к++л! 9~#fo 	Х^#V!! 9~#fo§нR:т _Н{$л! 9~#foл§нRНи&Н~'*кЂ Н•$Нљ'Ни&Нј%Нl'! 9~#fo###Н†'^ Н‘'Нт&Нъ% Нт&Н©%Слs#r  Х! 9^#VХ  Х!-+9^ ! е ХН	*л!
 9щzіВ   Х! 9^#VХ Х!-+9^ ! е ХН	*л!
 9щzіК# К)Нёе Х*ке! 9^#VХНQ)БББњХН)Б:т _! 9s#rГc! 9^#V+s#r! 9^#V! ^#V! Н–$е*кЂ Н•$СН–$:т _л! 9~#foН%Кд! 9^#V*т& Н–$л! 9s#r! 9^#V*т& Н–$лл! 9s  ! 9s#rГв! 9^#V+s#r! 9^#V! 9~#foХ Н{$С^#V! 9~#foН6%КГg! 9^#V! 9~#foХ Н{$С^#V! 9~#foН*%Кd! 9^#V! 9~#foХ Н{$С##^ ! 9n& Н%КdГgГЦ! 9^#V! 9~#fo:т _Н•$л! 9s#r! 9^#V! 9~#fo:т _Н•$лл! 9s! 9^#VХ! 9^#VХ! 9^ Х!-+9^ ! е ХН	*л!
 9щzіКбНёГWл!9+9щлЙ -  ,  %s%s)
 %s%c%s 
%s %02d %s %02d 
%s %03d %03d 
%d%s %s%03d ;! 9^ {ЦІВZХН)Б ХНв#БГa{ЦІВt5ХН)Б ХНв#БГ{{ЦІВЋGХН)Б ХНв#БГ•{ЦІВ \ХН)БГ{ЦІВІuХН)БГ{ЦІВМ’ХН)Б ХНв#БГУ{ЦІВЮҐХН)БГ{ЦІВрГХН)БГ{Ц	ІВСХН)Б ХНв#БИХН)БrХН)БН-)еНT1Бл!  9s!  9^ * & Н
%К^!  9^ * & Н
%К^!  9^ * & Н
%К^! ВtХН)Б!  9n& 3Й 
   ХХХ! 9^ ХНAл! 9щ:г _!  НЬ$еW ХНю(ББW ХНЧ(БЂ НЬ$В§ЙЕ  Х!
 9^#VХ!
 9^ Х!
 9^ ХНAл! 9щ:т _ХR ХНю(ББP ХW ХНю(ББ  сХГСХ*кН%К.!
 9^#V+s#r& oеP ХНю(ББГW ХНЧ(БЂ НЬ$В.БЙ:е _ХQ ХНю(ББ! 9^ ХS ХНю(ББ! 9^#V! Нъ$еU ХНю(ББ! 9^#VХT ХНю(ББ:д _!Ђ е! 9^ ! Нф$Сл! 9n& еV ХНю(ББЙгХН)Б ХНв#БЙM|chten Sie wirklich den Datentr{ger in Laufwerk   formatieren ?  
Formatieren von Spur    Verifizieren von Spur    
Formatieren von Spur     Verifizieren von Spur      defekte Bl|cke Verifizieren von Spur  

Initialisieren des Inhaltsverzeichnisses
 
(A)bbrechen, (F)ortfahren, or (W)iederholen
 Ung}ltiger Laufwerksname (Benutzen Sie  

Ung}ltiges Laufwerk
 

Ung}ltige Spur
 

Ung}ltiger Sektor
 

Laufwerk nicht bereit
 

Diskette schreibgesch}tzt
 

Laufwerksfehler
 

Datenrecord nicht gefunden
 

CRC-Fehler
 

Daten verloren
 

FESTPLATTENLAUFWERK DEFEKT
 G AFWJЭбБyБСбеХЕЕЭеЭ!мю8! Й2ѕ!y·((! ЙЭЛ v(ц2ї!{Эѕ8! Й2А!>2Е!"Б!>яЭЛ n =УмА:ѕ!ю0Л±yУо!  "Ж!>РУмЫм2Д!НЈ!ЭЛF ЭЛЖ>яЭwЇ::А!ЭЛ n(ЭЛ f <ЭЛ V(‡Эѕ O>РУмyЭЛ V(Л?Ун[OЭ–0нD2Ж!yУп>РУмЭ~УнЭ~ жх*Ж!(T]GэDM)	:ѕ!ю0) 	"Ж!сцУмНЈ!ЫмЛ rЛG у НИ!ЫнЭwГЉ :ѕ!!Г!ѕw:Д!8($!2 	ЭЛ ~ х!фнKЖ!·нB8(э НИ!+|µ хЫм8'НЈ!*Б!>фуУм НИ!пЫмЛO ЛG(ЫмЛO 	Л(м! ыЙнЈгыЫмЛw(! ЙЛo(! ЙжgoИЭЛ†!Е!5Вf !	 Й:ѕ!ж·G>(эO:ї!·y(ЛзУаЙEDGDяН x± ыЙбБyСХЕеЭ!мю8>'2љ#{Эѕ8>2›#!ЭF~2њ#еЕН"Бб· #п& oЙ>2џ#>яЭЛ n =УмА:љ#ю0Л±yУо!  " #>РУмЫм2ћ#Нt#ЭЛF ЭЛЖ>яЭwЇ[:›#ЭЛ n(ЭЛ f <ЭЛ V(‡Эѕ 3O>РУмyЭЛ V(Л?Ун:њ#ЭЛ v(ЭЛn 	ЭFЛ8ё8ђЭЛ ^(<Уо\OЭ–0нD2 #yУп>РУмЭ~УнЭ~ жх* #(T]GэDM)	:љ#ю0) 	" #сцУмНt#ЫмЛВK#ЛG т Нў#ЫнЭwГN":љ#!ќ#ѕw:ћ#8($!2 	ЭЛ ~ х!фнK #·нB8(э Нў#+|µ хЫмЪK#Нt#>€Уму Нў#ЫмЛG(Л(ц>ыЙыЫмЛo(>ЙжИЭЛ†!џ#5В*"Лg(>ЙЛ_И>Й:љ#ж·G>(эЭЛ v(O:њ#ЭFЛ8ёy8ЛзУаЙКqя<КqMx± ыЙн{ Н }ю00!$еНa%б!L$еНa%бЗя-Н НЎ*!"$еНa%б$jН Збб-(	яХ!5$ яХ!L$еНa%бСlН Х        
CP/M 3 erforderlich
 
Programm beendet
 
Programm abgebrochen
 
Programm mit Fehlern beendet
 z/W{/_Й+|/g}/oЙL}!  Л90л)лхЙлЇххлл|ЄхЛ|Дs$лЛ|хДs$|M!  ЛнjнR0?уЛWYсДs$лсъs$Йzі  (ЇЙЙ|µ!  (YЇЙ|ўg}ЈoґЙ|Іg}іoґЙ|Єg}«oґЙлш)ылшЛ,ЛшлшЛ<х·нRИ! Йл·нR! ш-Йл·нR!  ъ(%,ЙЇЙ·нR(ЇgoЙ,Йл·нR! Ш-Йл·нR!  8а,ЙбСХе{ю
 	Н 
Г СбеХ~·И_еХНJ%Сб#т    DM!  ·нBенKu%!  нB"u%бЙе!  ·нRлнKs%!  нB"s%бЙНw%НЋ%л*u%нKs%нJ"u%лЙнKs%"s%Э!s%> !  еэбЭЛ>ЭЛЭЛЭЛ 0энJЛ#ЛЛЛ= Я"u%эебЙНl'Ї2„&Э!s%:v%Э®хЭЛ~ДЋ%ЭЛ~хДw%нKs%"s%> !  еэбЭЛ ЭЛЭЛЭЛеэебнjеэббнjеэебнRеэббнB0энJ?= ОЭЛ ЭЛЭЛЭЛ:„&· 	*s%ссьw%Й"u%сбэебДw%Й=Нl'>Гы%Нl'Э!u%шЭЛ.ЭЛ ЛЛр}ґ*u%µґЙ{Ін[s%іІЙНУ&! ш-ЙНУ&!  (ЇЙ,ЙНУ&! А-ЙлЇнR*s%н[u%(нRА<ЙнRЙ|џ2u%2v%Йzџ2s%2t%ЙЇ2u%2v%ЙЇ2s%2t%ЙБ
o
g
2u%
2v%ЕЙБ
_
W
2s%
2t%ЕЙN#F#~#fo"u%`iЙ^#V#~#2s%~2t%Й}|:u%:v%Йs#r#:s%w#:t%wЙлнKu%Э*s%нCs%Э"u%ЙDM*u%гЕйBKл*s%гЕелЙБбг"u%бЕЙлБбг"s%бЕлЙэбБy2Ь'ЭбЭ"Ю'СнSа'б"в'еХЭеЕэехЬ'2Н _се!д' н±бИ& kЙ  C318  	j(iН *j(+ЇµнR8<щл‡‡2l(>/& o)w(	F#fhнR8(=т( Ц8щЖ2m(:l(ЂЦ0Жd2l(}нD<НY("n(:m(НY("q(:l(НY("t(!n(Й. Ц
8,щЖ:g}Ж0oЙC328TT.MM.JJ    ; Z x — µ Ф у 0NmЊЁЗе"A`~ќ»Ъщ5SrђЇОм)HgѓўАЯэ;Yx–бБЕе& нhЙсбСБЕХехx±ИнRИ8н°Й	+л	+лнёЙбБСХЕнYйл!°я9щл!R 9е! 9еН]+ББ!  9еНa%Бл!P 9щлЙ:H)· Н ю !яяЙ& oЇ2H)Й бБyЕ2H)йсбБСХЕехx±ИsT]x±Ин°ЙЕ! 9^#VсХСХ& oґВq)СХСХХ! 9^#V+s#r _бszіВЂ)! 9~#foБЙЕ! 9^#VсХСХ& oґВ±)СХ! 9^#V+s#rzіВЬ)СХ!  }Гя)СХХ! 9^#V+s#r _бszіВь)Гя)ГА)! 9~#foБЙсБЭбэбэEбСХеэеЭеЕхЭ}ЕЭ* W Э	Бэ!0*эеЭй& oЙi*iН НX*"s*:k*НX*"m*:l*НX*"p*!m*ЙgжЖ0o|жЖ0gЙА!HH:MM:SS                                           НІ*y*Х*v*еНуББЙЕЕЂ БсХЕЃ сХБСХЕ _бе  s!x*"y*СХ& oґК+СХ& oеН1Б|µКх*СХГХ**v* Н%К+*v*#"v*+)y*СХs#rСХХН"+БсеГХ*ББЙБСХЕ& oґКX+БСХЕ& oеН1Б|µКP+БСХЕ!  }БСХЕлЙБСХЕГ"+БбеЕЙл!iя9щл!› 9^#V+s#rл^#V!‘ 9s#r!‘ 9^#V+s#r _!“ 9szіКЗ/!“ 9^ {Ц%ІКА+!™ 9^#V+s#r!“ 9n& }ГД/!‘ 9^#V!• 9s#r! 9л! 9s#r БсХЕ  !Ќ 9s!Ћ 9s!‘ 9^#V _!- Н*%л!Џ 9szіК,!‘ 9^#V+s#r!‘ 9^#V _!0 Н*%К0,0 Г3,  !ђ 9s!‘ 9еНv0Бсе!‘ 9^#V+s#r _!“ 9s{Ц.ІВЊ,!‘ 9еНv0ББсеЕ!Ќ 9^ s!‘ 9^#V+s#r _!“ 9s!“ 9^ {ЦlІВќ,Г¤,{ЦhІВС,!‘ 9^#V+s#r _!“ 9sХЫ/ХНО0ББ|µВС,л!— 9щлЙ!“ 9^ ХНT1Бл!“ 9s!S Н
%Къ,СХНИ$л|µКъ,! К- сХ!“ 9^ {ЦDІВC-!› 9^#Vл^#V!  Н%К@- !Ћ 9s!› 9^#Vkb~#foНs$лs#rГJ-{ЦUІВU-
 !” 9sГv-{ЦXІВg- !” 9sГv-{ЦOІВЁ- !” 9s!” 9^ Х!ќ 9^#V+s#rл^#VХ! 9еНа/БББСХл§нRсеГѓ.{ЦCІВШ-! 9^#V+s#rХ!ќ 9^#V+s#rл^#VбsСХГѓ.{ЦSІВ‘/!Ќ 9^ НИ$Вь-БСХЕ!… Н%лzіКя- К	.„ БсХЕ!› 9^#V+s#rл^#V!‹ 9s#r!‹ 9^#V _ІВ5.Гѓ.БСХЕzіВA.Гѓ.! 9^#V!‹ 9Н5%Кl.! 9^#V+s#r!‹ 9~#fon& }!‹ 9^#V+s#rСХБСХЕГ#.!Џ 9^ zіВц.!Ћ 9^ zіК±.!ђ 9^ !0 Н*%лzіК±. КС.!™ 9^#V+s#r!- }  !Ћ 9sСХСХ!  Н%Кц.!™ 9^#V+s#r!ђ 9n& }ГС.!Ћ 9^ zіК/!™ 9^#V+s#r!- }СХ! 9^#V!  }! 9л! 9s#r!™ 9^#V+s#rХ! 9^#V+s#r _бszіВ//!™ 9^#V+s#r!Џ 9^ zіКЋ/СХ!  Н%КЋ/!™ 9^#V+s#r!  }Гm/ГД/{Ц%ІВ¤/!• 9^#V+s#r!™ 9^#V+s#r!% }!• 9^#V!‘ 9s#rГ~+!™ 9^#V!  }л!— 9щлЙxodu ! 9^#V! 9~#foН5%К-0БСХЕл^#V+s#rХ! 9^#V!
 Н5%К00 Г07 ! 9~#foС}! Й! 9^#VХ! 9~#foНЋ$е! 9^#VХНа/БББе! 9^#VХ! 9~#foНЋ$ле! 9^#VХНа/БББСЙЕЕ  сХ! 9^#Vл^#VБсХЕБСХЕ& oеН1Б|µКє0бе
 Н{$БСХЕ _Ря	сеГЊ0! 9^#VБбеЕлs#rбеББЙЕ! 9^#VсХСХ& oґК 1СХ _! 9n& Н*%Кэ0СХлБЙГШ0!  БЙБбеЕ}!  ю0Шю:Р,Й! 9^ {Ц	ІВ&1Г-1{Ц
ІВ01Г71{ЦІВ:1ГA1{ЦІВD1ГK1{Ц ІВO1! Й!  ЙЙБбеЕ& }юaШю{0о oЙ _! 9n& Н*%Кэ0СХлБЙГШ0 9^#V+s#rл^#VХ! 9еНа/БББСХл§нRсеГѓ.{ЦCІВШ-! 9^#V+s#rХ!ќ 9^#V+s#rл^#VбsСХГѓ.{ЦSІВ‘/!Ќ 9^ НИ$Вь-БСХЕ!… Н%лzіКя- К	.„ БсХЕ!› 9^#V+s#rл^#V!‹ 9s#r!‹ 9^#V _ІВ5.Гѓ.БСХЕzіВA.Гѓ.! 9^#V!‹ 9Н5%Кl.! 9^#V+s#r!‹ 9~#fon& }!‹ 9^#V+s#rСХБСХЕГ#.!Џ 9^ zіВц.!Ћ 9^ zіК±.!ђ 9^ !0 Н*%лzіК±. КС.!™ 9^#V+s#r!- }  !Ћ 9sСХСХ!  Н%Кц.!™ 9^#V+s#r!ђ 9n& }ГС.!Ћ 9^ zіКееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее1TНd Н                                                      CP/M Version 3.0COPYRIGHT 1982, DIGITAL RESEARCH151282    6543210123456789ABCDEF
ERROR:  $Reading file:  $Writing file:  $Directory full$Reading file: $Writing file:  $Invalid drive.$) ? $) ? $) ? $Bad character, re-enter $   
 $
 Disk read error:  $File cannot fit into GENCPM buffer:  $Unable to open:  $BDOS3   BIOS3            
Setting up directory hash tables:
$ Enable hashing for drive $: $Unable to allocate space for hash table.$
Setting up Allocation vector for drive $
Setting up Checksum vector for drive $
*** Bank 1 and Common are not included ***
*** in the memory segment table.       ***

$Number of memory segments $
CP/M 3 Base,size,bank ($)
$
Enter memory segment table:
$ Base,size,bank $Zero length segment not allowed.$Bank one not allowed.$
ERROR:  Memory conflict - segment trimmed.
$Memory conflict - cannot trim segment.$
ERROR:  Memory conflict - segment trimmed.
$
ERROR:  Memory conflict - segment trimmed.
$ CP/M 3 Sys   $ Memseg No. $  Bank $
Accept new memory segment table entries $Default entries are shown in (parens).
Default base is Hex, precede entry with # for decimal
$
Use GENCPM.DAT for defaults $Create a new GENCPM.DAT file $Display Load Map at Cold Boot $Number of console columns $Number of lines in console page $Backspace echoes erased character $Rubout echoes erased character $Initial default drive ($:) ? $Top page of memory $Bank switched memory $Common memory base page $Long error messages $Double allocation vectors $Accept new system definition $

CP/M 3.0 System Generation
Copyright (C) 1982, Digital Research

$
 RESBIOS3 SPR$BIOS3    SPR$BNKBIOS3 SPR$BDOS3    SPR$RESBDOS3 SPR$BNKBDOS3 SPR$
 64K TPA
Copyright (C) 1982, Digital Research

*** CP/M 3.0 SYSTEM GENERATION DONE ***$   Н Й!дTq:UТM*дT& лН Й!жTp+q:UТd*еTл	Н Й!иTp+q*зT#6 :UТЂ:гTЪЂЙ*зTл
Н *зT#N ! 	л*зT6 ЙН7
Н7Й!мTr+s+q+СБqХ!U6яђНN*лTDMНN:кTюВХЦTНNНњ:йTТвН.:гT/!U¦Ты!] 6 !m 6 Г Й!оTp+q *нT	6   *нT	6 *нTлН Й!рTp+q*пTлН Й!тTp+q*сTлН Й!фTp+q*уTлН ю К]	яЕ›Н§Й!цTp+q*хTлН ю К}	яЕ«Н§Й!шTp+q*чTлН юяВќ	яЕ» Н§  *чT	6 Й!ъTp+q*щTлН Й!ьTp+q*ыTл!Н ю КЦ	яЕКН§Й!юTp+q*эTл"Н ю Кц	яЕЩН§Й! Up+q*яTл$Н Й!–Vr+s+p+q+СБqХ:’Vю В
Й*’Vе*“VDM*•Vлб
-В-
Й!™Vs+p+q:™Vю ВJ
*—VЙ*™VM!—VНLSЙЙ!љVq:љVю Тe
>Й:љVЦaџ/х>z!љV–џ/БHЎТ„
:љVж_2љV:љVЙ!›Vq:›VЦ џ/х>!›V–џ/БHЎТ¦
>яЙ Ей Н§> Й!ќVp+q(Н7*њV~юяВР
YН7ГХ
NН7шНNИTНe:ЙTю Вк
Й*КTMНV
ЦYЦџ*њVwЙ!ћVq:ћVжшO !Ђ	NН7:ћVжO !Ђ	NН7Й! Vp+q Н7*џV|OНы
*џV}OНы
HН7Й!ЎVq*ЎV&  Н+SDMН$Й!ЈVp+q!ЁV6 !¦V60!'"¤V> ўVН‡SµВ†*¦VMН7Ги!§V6 >!§VѕЪи¤VўVНzSЪЅ!ЁV6я:¦V<2¦V¤VўVНzSл+s#rГ”:ЁVТР*¦VMН7!¦V60*¤Vл!
 НSл"¤V:§V<2§VВ‹Й!ЄVs+q(Н7:ЄVю
В#Н7*©V& DMНZГ*©VMНы
эНNЙ!ЇVs+p+q+СБp+qХН
:ЙTю В:НњЙ*­V6 :ІV<2ІVO !ИT	NНV
2±VюК:±Vю,Вu*­V#"­V*­V6 !°V6Г:±Vю#В…!°V6
Г:±VЦ02±V:°VЦЦџх>	!±V–џБHЎТЅ>!±VѕТё:±VЦ2±VГЅ!±V6я!°V:±VѕТж*­V^ *°V& Н+Sе*±V& Б	е*­VБqГ!±V6 *­V6  Е Н§Н
*­V6 Г?НњЙ*«VDMНN*«V~ю В(Н7*­VNНы
!ІV6>!ІVѕЪn*­V#"­V:ІVЦЦџх:-Q/БHЎТX*­V6 Гd,Н7*­VNНы
:ІV<2ІVВ,*­V++"­VНNГЉ*­VN*ЇVлНй!°V6!ІV6ИTНeЙ!µVr+s+q:-Q/Т®> Й!·V6яяя#q#p!¶V6:5Q!¶VѕЪі *¶V& Н+SFQ	 	лґVНzSЪ©:іVюВM *¶V& Н+SFQ	 	~Ц Цџ *¶V& хН+SFQ	 	лёVНzSџБHЎТJ:¶V2·V *¶V& Н+SFQ	 	^#Vл"ёVГ© *¶V& Н+SFQ	 	~Ц Жяџ *¶V& хН+SFQ	 	лёVНzSџБHЎТ©:¶V2·V *¶V& Н+SFQ	 	^#Vл"ёV:¶V<2¶VВї:·VЦяЦџх:іVЦЦџБHЎТ`!¶V6:5Q!¶VѕЪ` *¶V& Н+SFQ	 	лґVНzSџ/ *¶V& хН+SFQ	 	~Ц ЦџБHЎ *¶V& хН+SFQ	 	лёVНzSџБHЎТV:¶V2·V *¶V& Н+SFQ	 	^#Vл"ёV:¶V<2¶VВР:·VЙ!$V6 !U6яН¬#НQ$Ни!НH> 	UН‡SµК”я *	U|2UГџя *U|2U!U:.Q–2їTя *U|!U–O:/Q‘2ГTя *U|O:ГT‘2ВTUTНСНI:-Q/Т!$V>–O:їT‘2АTя *U|O:їT‘!$V†2БTГ:їT=2АTя *U|O:їT‘2БTНТ®Н :-QТ›*nVл*Uе*ђVБ	я |!U–O:/Q‘2ГTя *U|O:ГT‘2ВTНС2UН¬:U/Т!!V6 >!!VѕЪ*!V& Н$S›Q	 	6 :!V<2!VВsГ !U6 :V/Т«НйН*:U2ДT:їT2ёTTН©:-QТв…Е*їT&  Н+SDM*UлНчГъ’Е*їT&  Н+SDM*UлНч:-Q/Т&:U2!V! ""V*!VM"VНџ:!V2U! U6 Г›я *U|!U–2!Vя *U|!U†o& )##""VџЕ*ГT&  Н+SDM*!VлНч*!VM"VНџ:!V2 U:U2!V! ""V>ЂЖTН‡Sл+s#r*!VM"VНџ:!V2Uя *U|!$V–2ДT:БT2ёTU(TНС(TН©НC *$V& Н+SЖTНЉSл+s#rя *U|!$V–2!V:-Q/Т
¬Е*БT&  Н+SDM*!VлНчГ"№Е*БT&  Н+SDM*!VлНч*!VM"VНџ:!V!U†w:-QТў!ДT6я:ВT2ёTULTНСLTН©я *U|2!Vя *U|!U–o& )л*"V""VЖЕ*ВT&  Н+SDM*!VлНч*!VM"VНџ:!V! U†w:,Q/ТІ:VЦ2VЕ*V& U	лУН
:БTжю2БT*БT& л!
 НS!0 е*V&  U	Бq*БT& л!
 НS0 е*V& !U	Бq:VЖ2V *їT& Н+S"!U$Е-UЯН
ЕRUжWН
!‘T6 #6 #6 :.Q2U:/Q2UЕЦTqTН
ЕЯTyTН
UН§	pTНЧ	!‘T6ќUН§	pTНЧ	pTН	:;RТ»!;R6 :%V2.Q:4Q/24QЕЦT•TН
ЕЯTќTН
НL!U6яНNЙ!ЅVr+s+p+q*єV6 *єV#6 *јV|жшO !Ђ	е*єV##Б
w*јV|жO !Ђ	 е*єV	Сw*јV}жшO !Ђ	 е*єV	Сw*јV}жO !Ђ	 е*єV	СwЙ!БT:АT–O `iНPSжW	њ "їV *їV	:0Qw *їV	:2Qw *їV	:1Qw. *їV	:3Qw*їV	:4QwЕX *їV	л Н
:+Q/ТјW *їV	>¦*їV	w:<R/х:-Q/БHЎТЮW *їV	>@¶*їV	wГнW *їV	>ї¦*їV	w^ *їV	:/QwЙ!)X"БV*БVN#F!жW	"ГV*ГV"БV*БVюяН•SµВ(!$V6Г-!$V6 *БVлюяНSТD*БVжWНлRЙ!яяЙЙНщ"&V!V6яяя&VНSµКР!ЕV6 >!ЕVѕЪ·*ЕV& )л*&V> Н’SµК­*ЕV& )л*&VжWНлR"(V *(V	яяН•SµК­!V6 :ЕV<2ЕVВf:-Q/!V¦ТЛ!$V6ГР!$V6 ЙЕЖV>XН
жW*ЖV"ЖV*ЖV~юЙВу> Й>яЙЙ!МVs+p+q+СБp+qХ%НN*ИVDMНN Н7*КVDMН$ Н7*МVMНE:,QТЁЕ*V& U	л*ИVDMН
:VЖ2V*V& U	DM*КVлНЗ:VЖ2V*V& U	е*МV&  Н+SлБНЗ:VЖ2VЕ*V& U	л)Н
:VЖ2VЙ!ОVp+q*НV"TНЈNю КИяЕ,Н§*НVDMН	Й!ТVr+s+p+q*СV^#Vл"№T*СV##^#Vл"»T *СV	^#Vл"ЅTЕ*ПV#DMЦTН
Е	 *ПVDMЯTН
я *№TНZSUНЉSТ@яЕ?Н§*№T+НZS}<2ФV!УV6 !ФV:УVѕТ†Ђ *УV& Н+SжW	"ЖTDMН§	*ПVDMН>	:УV<2УVГSЂЕ*ЖTDMЊOН
жW*№T"ЖTЙ!ЧVr+s+q:ХVю КGЕЦTqTН
ЕЯTyTН
*ЦVn}2‘T*ЦV#~2’TpTНЧ	жWЖTНS} НpS}ЖTНзRл+s#r*ХV& )+л!ЩVs+6 :ЩV!ШVѕЪ4>ЂЖTН‡Sл+s#rBKН§	pTН^	:ШV<2ШVВpTНч	Е*ЦVл‘TН
Й:-Q/ТkЕ)TwН
ЕTН
Гz!LT"ЪV!U"ЬVН™!T"ЪV!U"ЬVН™!(T"ЪV!U"ЬVН™ЙЕ*ЪV#DMЦTН
Е	 *ЪVDMЯTН
*ЪVDMНьюяВТяЕeН§жWН§	*ЪVDMН>	*ЬVе*зWлбs#r*ЬV##е*кWлбs#r *ЬV	е*рWлбs#r*ЪVDMН>	Й!ЮV6 яя&VНSµВ(> Й!ЯV6 >!ЯVѕЪе*ЯV& )л*&V> Н’SµКЫ*ЯV& )л*&VжWНлR"(V	Е*(V##л‡Н
 *(V	юяН•SµЦџ *(V	юяхН•SµЦџБH± *(V	юяхН•SµЦџБH± *(V	юяхН•SµЦџБH± *(V	юяхН•SµЦџБH±ТЫ!ЮV6я:ЯV<2ЯVВ-:ЮVЙ!вV6 !пV6я!аV6 >!аVѕЪЮ*аV& )л*&VжWНлR"(V*аV& )л*&V> Н’SµКФ *(V	люяНSТ?!пV6  *(V	юяН•SµВФ:вV/Тc!вV6яђНN:аVЖO !=R	~2гT *(V	жWНлR"*V **V	N#F`i))"зV¶НN:аVЖAOН7СНN*аV& 6Q	DMНґ
Нњ*аV& 6Q	~/ТЪ *(V	яяq#pГФ:-Q/Т!пV6 *аV& ,V)	е*зVлбs#r*зVл*LV"LVГФ*зVлН›2гVюяВ' ЕФ Н§ГФ *гV& Н+SFQ	 	 е*(V	Б
w *гV& Н+SFQ	N `iНPS е*гV& Н+SFQ	 	N `iНPS е*гV& Н+SFQ	 	СН•SБ	 е*(V	Бq#p *гV& Н+SFQ	 	лзVНzS е*гV& Н+SFQ	 	Бq#p:аV<2аVВш:-Q/!пV¦Тя!$V6:АT<<2АT:БT<<2БTЙ!рV6 >!рVѕЪ8*рV& NV)	> w#6 *рV& pV)	> w#6 :рV<2рVВ:<R/х:-Q/БHЎТP!сV6ГU!сV6!  "nV!  "ђV!тV6 !рV6 >!рVѕЪЎ*рV& )л*&V> Н’SµК—*рV& )л*&VжWНлR"(V *(V	жWНлR"*V *(V	юяН•SµВэНN:рVЖAOН7:Н7!тV6я **V	^#V! НS*сV& Н+Sе*рV& NV)	Бq#p*рV& NV)	nVНЬRл+s#r *(V	юяН•SµВ—'НN:рVЖAOН7:Н7!тV6я **V	>НиRл! НS*рV& pV)	s#r*рV& )	ђVНЬRл+s#r **V	 ЂНшRе*рV& pV)	СНCS е**V	Бq#p:рV<2рVВk:тVТ«НњЙ:ВT2FQ!ВT:/Q–2GQ!  "IQ!HQ6 !цV6 OНN:GR2гT¬Е
5QНЗНN*FQMНы
,Н7*GQMНы
,Н7*HQMНы
бНN:цV/Т€!еНN!фV6:5Q!фVѕЪг !хV6 :хV/ТЩ :фVЖ=O !=R	~2гTЕ *фV& Н+SFQ	DMН *фV& Н+SFQ	 	N `iНPS е*фV& Н+SFQ	 	Бq#p *фV& Н+SFQ	 	~ю ВА Е Н§ГЦ  *фV& Н+SFQ	 	~юВз Е7 Н§ГЦ  *фV& Н+SFQ	~2щV*щV&  е*фV& Н+SFQ	 	N б	"ыV*ыV|Ц Жяџ*ыVх}O:/Q‘џБH±Т†MНN!щV:/Q– *фV& хН+SFQ	 	БHq!щV:/Q–O `iНPS е*фV& Н+SFQ	 	Бq#pГЦ *ыV}2ъV!уV6 !хV6я!фV:уV–џ#¦ТЦ  *уV& Н+SFQ	~2чV *уV& Н+SFQ	 	:чV†2шV *уV& Н+SFQ	 	 е*фV& Н+SFQ	 	Б
ѕВМ !ъV:шV–џ/+х~!чV–џ/БHЎТ+  Е| Н§!хV6 ГМ :шV!ъV–џ+х~!шV–џБHЎТc ЈНN *фV& Н+SFQ	:шVw!хV6 ГМ :чV!ъV–џ+х~!чV–џБHЎТМ ТНN!щV:чV– *фV& хН+SFQ	 	БHq!щV:чV–O `iНPS е*фV& Н+SFQ	 	Бq#p!хV6 :уV<2уVГ—Г1:фV<2фVВ"Нњ!фV6 :5Q!фVѕЪo!:фVю В!НNГ!НN:фV=OНы
 *фV& Н+SFQ	NНE *фV& Н+SFQ	 	NНE:-QТb!НN *фV& Н+SFQ	 	NНы
Нњ:фV<2фVВл !гT6 !цV6я%НNцVНґ
ГНњЙPНN”TНь2эVюяКЯ!ЕЦT•TН
ЕЯTќTН
°НN!эV6яэVНґ
Нњ:эVТЦ!НГF”TН	Гз!!U6я+6 Й! W6 НЊ!: W/Т—#:ШR2гTНњПНN;RНґ
:=R2гTНњНњнНN,QНґ
НњНњ:>R2гT:2Q<22QЕ
2QН:2Q=22Q:?R2гT:1Q<21Q'Е
1QН:1Q=21Q:@R2гTHНN3QНґ
Нњ:AR2гTkНN4QНґ
НњНњ:BR2гT‹НN:0QЖAOН7ЈНNИTНe:ЙTю Кв"*КTMНV
ЦA2W*WMН€
/ТЬ"Гћ":W20QНњНњ:CR2гT©Е.QН*.Q& НPS "U:DR2гTЅНN-QНґ
Нњ:-Q/2ЕT:-QТ[#:ER2гTУЕ/QННњ:FR2гTмНN+QНґ
НњГx#:ЩR2гTНњНN<RНґ
Нњ!/Q6 !гT6 ! W6яНњНN WНґ
НњГр!:.Q2%V:.Q<2.Q:4Q/24QЙ:НNpTН.	pTН~	!ђT6 !W6 >!WѕЪж#*W& U	6 :W<2WВИ#!W6Ђ>я!WѕЪ	$*W& U	6$:W<2WВл#!V6ЂЕ*V& U	л‚Н
!V6ѓЕЦTqTН
ЕЯTyTН
жWН§	pTН^	pTН^	ЙжW НS#НZS"U!W6 >!WѕЪ‹$*W& ,V)	> w#6 :W<2WВh$!  "LV:] юAВЗ$!U6я#6 !W6 >љ!WѕЪД$*W& =R	6 :W<2WВ¦$ГП$!U6 #6я:m юDВЬ$!U6я!гT6 Й
     Available space in 256 byte pages:
     $TPA =$, Bank 0 =$, Other banks =$Unable to allocate Dir deblocking buffer space.$Unable to allocate Data deblocking buffer space.$Unable to allocate Data deblocking buffer space.$Drive specified has not been defined. $0FFFFH is an invalid value in the
DPH directory BCB address field.$
Setting up Blocking/Deblocking buffers:
$
The physical record size is$:
$     *** Directory buffer required  ***
     *** and allocated for drive $: ***
$               Overlay Directory buffer for drive $: $               Number of directory buffers for drive $: $Minumum number of buffers is 1. $               Number of directory buffers for drive $: $
*** Maximum number of directory buffers ***
*** for the current drive is$.     ***
*** Number of directory buffers reduced ***
*** accordingly.                        ***
$               Share buffer(s) with which drive ($:) ? $     *** Data buffer required and ***
     *** allocated for drive $:   ***
$               Overlay Data buffer for drive $: $               Number of data buffers for drive $: $Minumum number of buffers is 1. $               Number of data buffers for drive $: $               Share buffer(s) with which drive ($:) ? $               Allocate buffers outside of Common $
Accept new buffer definitions $!W6 >!WѕЪЫ**W& )л*&V> Н’SµКФ**W& )л*&VжWНлR"(V 	юяН•SµЦџ *(V	юяхН•SµЦџБH±Тё* *(V	жWНлR"*V **V	^Ђ Н6
е*W& Н$S›Q	Бq#p*W& Н$S›Q	 	6  *(V	яяН•SµВФ*яЕн% Н§!W4В*!W6 >!WѕЪЬ+!  "HW}2W>!WѕЪ=+*W& Н$S›Q	еHWН|Sџб 	х~Ц ЦџБHЎТ6+*W& Н$S›Q	^#Vл"HW!W4Ву**W& ))lW	е*HWлбs#r*W& ))	 	> w#6 !W6 >!WѕЪХ+*W& Н$S›Q	HWН|SµЦџх> Н‡SµЖяџБHЎТО+*W& ))lW	 	е*Wл Н6
СНDSл+s#r*W& Н$S›Q	 	6я!W4Вh+!W4Ва*!W6 >!WѕЪ7, *W& Н+SFQ	 	е*W& W)	гN#Fбq#p *W& Н+SFQ	 	е*W& 7W	Б
w!W4Вб+:-QТF,!fW6ГK,!fW6!W6 :WЪ4:fW=2iW!  "gW"dW}2	W!W6я*БT& НPSл*LVНiS"bW:-QЪћ,nVbWНzSл*ђVНiS"bW!W6 >!WѕЪл,*W& W)	 е*W& Н+SKQ	 	гN#Fбq#p*W& Н$S›Q	 	6 !W4ВЈ,!W6 !W6я#6я!W6 n& ))lW	 	^#Vл"JW*W& ))lW	> Н’SµЖяџх:WЦџБHЎТк3:WЪE-1&НN!W6я]&НN*W& ))lW	N#FН${&НN!W6 >JWНфR>НfSµЖяџх:WЦџБHЎТљ-!JWНVSл+s#r!W4Гg-!JWНVSл+s#r:WюКП3*W& )л*&VжWНлR"(V 	жWНлR"*V 	>НиRНZS"^W **V	 ЂН•SµВъ-!W6яГя-!W6  *(V	юяН•SµВc0НbB*W& Н$S›Q	 	>¶w:-QЪа.:WТd.!W6 *W& Н$S›Q	 	6&НN:WЖAOН7К&НNГЭ.:WЖ{O !=R	~2гTТ&НN:WЖAOН7'НN*W& Н$S›Q	 	DMНґ
Нњ*W& Н$S›Q	 	~ЪЛ.*W& Н$S›Q	 	6ГЭ.*W& Н$S›Q	 	6 Гt/:WЖ;O !=R	~2гT'НN:WЖAOН7>'Е*W& Н$S›Q	 	DM
Н:WТt/!W6 *W& Н$S›Q	 	~ю Вt/ ЕA' Н§b'НN:WЖAOН7'Е*W& Н$S›Q	 	DM
НГ&/*W& Н$S›Q	 	~^WН‡SТ№/›'НN*^WDMН$з'НN*W& Н$S›Q	 	е*^Wлбs*W& Н$S›Q	 	~ю ВR0:WЖ[O !=R	~2гTM(НN*W& Н$S›Q	 	~ЖAOН7(НNИTНe:ЙTю КL0*КTMНV
ЦA2
W*
WMН€
Ъ*0ГЯ/*
WMНFТ80ГЯ/*W& Н$S›Q	 	:
WwНњГc0*WMНTCю Вc0Г4 *(V	юяН•SµВn3!W6 *W& Н$S›Q	>ЂН’SµВ°0 *(V	яяq#p*W& Н$S›Q	 	6 Гn3НbB*W& Н$S›Q	 	>¶w:-QЪ«1:	WюК1:WЪ1!	W6!W6я*W& Н$S›Q	 	6…(НN:WЖAOН7К(НNГ1:WТ1!W6!W6 :WюяКЁ1:WЖ‹O !=R	~2гTФ(НN:WЖAOН7)НN*W& Н$S›Q		 	DMНґ
Нњ*W& Н$S›Q		 	~Т‘1*W& Н$S›Q	 	6 ГЁ1*W& Н$S›Q	 	6!	W6ГS2:WЖKO !=R	~2гT)НN:WЖAOН76)Е*W& Н$S›Q	 	DM
Н*W& Н$S›Q	 	>¶w:WТS2!W6 *W& Н$S›Q	 	~ю ВS2 Е9) Н§Z)НN:WЖAOН7‹)Е*W& Н$S›Q	 	DM
НГ2*W& Н$S›Q	 	~ю В$3:WТЊ2!W6 *W& Н$S›Q	 	:WwГ3:WЖkO !=R	~2гTЋ)НN*W& Н$S›Q	 	~ЖAOН7А)НNИTНe:ЙTю К	3*КTMНV
ЦA2
W*
WMН€
Ъз2Гњ2*
WMНFТх2Гњ2*W& Н$S›Q	 	:
WwНњ*W& Н$S›Q	 	:W¶wГn3:U!W¦Т]3:WЖ+O !=R	~2гTЖ)НN*W& Н$S›Q	 	DMНґ
Нњ*WMНTCю Вn3Г4!W6 *Wл Н6
dWНDSл+s#r!W4>JWНфR>НfSµЖяџх:WЦџБHЎТї3!JWНVSл+s#r!W4ГЊ3!JWНVSл+s#rГ§-!W4n& ))lW	 	^#Vл"JWГ-!гT6 !W6я:WТ4НbBщ)НNWНґ
НњГP,!  "PW}2Wo& "TW2W>!WѕЪu5*W& Н$S›Q	 	~ю Кn5*W& Н$S›Q	 е	~Ц Жяџб 	х>¦ЦЦџБHЎТ»4:-QТ|4!W4ГЎ4*W& Н$S›Q	еСе! ^ бN#FН-Sл*TW"TW*W& Н$S›Q	 	^ *PW"PW*W& Н$S›Q	 е	~Ц Жяџб 	х>¦ЦЦџБHЎТn5:-QТ/5!W4*W& Н$S›Q	 	~Ъ,5*W& Н$S›Q	еСе! ^ бN#FН-Sл*TW"TWГT5*W& Н$S›Q	еСе! ^ бN#FН-Sл*TW"TW*W& Н$S›Q	 	^ *PW"PW!W4В#4*fW& л*PWН+Sе*W& )Б	"RW:-QЪя9жW*U"jW*RWл*Uе*TWБ	Ее*LVБ	е*ђVБ	е*nVБ	я |O:.Q‘O:їT‘2UO:їT‘2їT:БT‘2БT:АT‘2АTбе|2U!їT†2.QжWб"ЖT*їT& НPSе*UБ	"ZWе*RWБ	"VW*№T"`W*`WжW	л!ЖTН•SТC6*`WжW	6 *`W#"`WГ6!W6 n& ))lW	 	^#Vл"JW*W& ))lW	> Н’SµЖяџх:WЦџБHЎТ9!W6 >JWНфR>НfSµЖяџх:WЦџБHЎТ¶6!JWНVSл+s#r!W4Гѓ6!JWНVSл+s#r:WюКк8*W& )л*&VжWНлR"(V*W& Н$S›Q	 	>¦юВ«7*W& Н$S›Q	 	~ю Кh7*jW6я
 *jW	е*VWлбs#r*W& Н$S›Q	VWНЬRл+s#r *(V	е*ZWлбs#r:fWZWНзRл+s#r:fWjWНзRл+s#rГ«7*(V"LW*W& Н$S›Q	 	n& )л*&VжWНлR"(V 	^#Vл"NW*LW"(V	е*NWлбs#r*W& Н$S›Q	 	>¦юВЈ8*W& Н$S›Q	 	~ю К48*jW6я
 *jW	е*VWлбs#r*W& Н$S›Q	VWНЬRл+s#r *(V	е*ZWлбs#r:fWZWНзRл+s#r:fWjWНзRл+s#rГЈ8*(V"LW*W& Н$S›Qе	 	>¦o& )л*&VжWНлR"(VБ!›Q	 	>¦ю К‚8 *(V	^#Vл"NWГђ8 *(V	^#Vл"NW*LW"(V 	е*NWлбs#r!W4>JWНфR>НfSµЖяџх:WЦџБHЎТЪ8!JWНVSл+s#r!W4Г§8!JWНVSл+s#rГГ6!W4n& ))lW	 	^#Vл"JWГ\6!W6 >!WѕЪc9*W& ,V)	> Н’SµК\9*W& )л*&VжWНлR"(V 	е*VWлбs#r*W& ,V)	VWНЬRл+s#r!W4В
9!W6 >!WѕЪь9*W& )л*&VжWНлR"(V*W& NV)	> Н’SµКЅ9 *(V	е*VWлбs#r*W& NV)	VWНЬRл+s#r*W& pV)	> Н’SµКх9 *(V	е*VWлбs#r*W& pV)	VWНЬRл+s#r!W4Вh9ГaB!W6 >!WѕЪ::*W& W)	 е*W& Н+SFQ	 	гN#Fбq#p!W4В:*ђVл*RWе*nVБ	"RW> 	UН‡SµЦџUхНzSµЦџБH±Т‡:*TWл*Uя |O:.Q‘O:їT‘2UГЎ:*TWл*	Uя |O:.Q‘O:їT‘2U!U:їT–2їT:БT–2БT:АT–2АT:.Q–2.Q*	U} НpS}	UНзRUНЉS"`W> 	UН‡SµЦџUхНzSµЦџБH±ТB;я *RW|O:/Q‘2ГT*U}НpS}UНзRжW"\W*ГT& НPS"XW*їT& НPSе*UБ	"VWГ‡;*RWл*`Wя |O:/Q‘2ГTжW*U"\WO `iНPSе*`WБ	"XW*їT& НPSе*	UБ	"VW*RWл*\W"ЖTя *U|O:ГT‘2ВT*W& )л*\W"jW*XW"ZWжWЖTНS"U*№T"`W*`WжW	л!ЖTН•SТн;*`WжW	6 *`W#"`WГЙ;!W6я!W6 !W6:5Q!WѕЪS< *W& Н+SFQе	 е	Б
†2WБ!FQ	 	~Ц Цџх:W!W–џБHЎТL<:W2W:W2W!W4Вь;:ВT2FQ!ВT:/Q–2GQ:WюяКх< *W& Н+SFQ	 е	Б
†O:ВT№Тх< *W& Н+SFQе	 е	N `iНPSСе! СН•S"`WБ!FQ	е:ВT–б 	w *W& Н+SFQ	 е	N `iНPSл*`WНiSСе! Бq#p!W6 n& ))lW	 	^#Vл"JW*W& ))lW	> Н’SµЖяџх:WЦџБHЎТ“A!W6 >JWНфR>НfSµЖяџх:WЦџБHЎТh=!JWНVSл+s#r!W4Г5=!JWНVSл+s#r:WюКxA*W& )л*&VжWНлR"(V*W& Н$S›Q	 	>¦юВ0?*W& Н$S›Q	 	~ю В>*(V"LW*W& Н$S›Q	 	n& )л*&VжWНлR"(V 	^#Vл"NW*LW"(V	е*NWлбs#rГ0?*\Wе*ZWлбs#r *(V	е*XWлбs#r*XW##"XW*\W##"\W!W6*W& Н$S›Q	 	~!WѕЪ
?*W& Н$S›Q	^#VН›2W*jW6я *W& Н+SFQ	еN `iНPSСе! N `iНPSе! СН•SБ	
 е*jW	Бq#p *jW	6  *W& Н+SFQ	 	е*W& Н$S›Q	СН|Sл+s#r:fWZWНзRл+s#r *jW	s#r:fWjWНзRл+s#r!W4В6>:fWjWН‡Sл+s#r! > w#6 :fWjWНзRл+s#r*W& Н$S›Q	 	>¦юВ1A*W& Н$S›Q	 	~ю В¤?*(V"LW*W& Н$S›Q	 	n& )л*&VжWНлR"(V 	^#Vл"NW*LW"(V	е*NWлбs#rГ1A*\Wе*ZWлбs#r *(V	е*XWлбs#r*XW##"XW*\W##"\W!W6*W& Н$S›Q	 	~!WѕЪA*W& Н$S›Q	 	~Т©@*W& Н$S›Q	^#VН›2W*jW6я *W& Н+SFQ	еN `iНPSСе! N `iНPSе! СН•SБ	
 е*jW	Бq#p *W& Н+SFQ	 	 е*jW	Б
w *W& Н+SFQ	 	е*W& Н$S›Q	СН|Sл+s#rГЮ@*jW6я
 *jW	е*VWлбs#r*W& Н$S›Q	VWНЬRл+s#r *jW	6 :fWZWНзRл+s#r *jW	s#r:fWjWНзRл+s#r!W4ВХ?:fWjWН‡Sл+s#r! > w#6 :fWjWНзRл+s#r!W4>JWНфR>НfSµЖяџх:WЦџБHЎТhA!JWНVSл+s#r!W4Г5A!JWНVSл+s#rГu=!W4n& ))lW	 	^#Vл"JWГ=!W6 >!WѕЪИA*W& 7W	 е*W& Н+SFQ	 	Б
w!W4ВA!W6 >!WѕЪaB*W& )л*&VжWНлR"(V*W& NV)	> Н’SµК"B *(V	е*ZWлбs#r*W& NV)	ZWНЬRл+s#r*W& pV)	> Н’SµКZB *(V	е*ZWлбs#r*W& pV)	ZWНЬRл+s#r!W4ВНAЙ!  "¬W"®W!°W6:5Q!°WѕЪЭB *°W& Н+SFQ	 	~ю В¶B *°W& Н+SFQ	 	НVSл*¬W"¬WГЦB *°W& Н+SFQ	 	НVSл*®W"®W!°W4ВpBв$НN%НN!bWНVSDMН$:-QТMC%НN*¬WDMН$:UТ C$%НN*®WDMН$> ®WН‡SµЖяџх> ¬WН‡SµЖяџБH±ТHC!W6яГMC!W6 НњНњЙ!ІWs+q*±W& Н$S›Q	^#Vл"єW:-QЪ‹C:fWєWНзRbWНЉSл+s#rГF!iW55:ІWюВ®D*±W& Н$S›Q	 	~2іW!ґW6:іW!ґWѕЪ«D!fW:iWѕТYD!iW6я*gW#"gW!¶W6я!ёW6 !µW6:5Q!µWѕЪ7D *µW& Н+SFQе	 е	Б
†2·WБ!FQ	 	~Ц Цџх:ёW!·W–џБHЎТ0D:µW2¶W:·W2ёW!µW4ВаC *¶W& Н+SFQ	 	л НSл+s#rГcD!fW:iW–2iW*єWлН›2№WюяВ…D Е4% Н§> ЙГ¤D *№W& Н+SFQ	 	лєWНzSл+s#r!ґW4В±CГF*±W& Н$S›Q	 	~2іW!ґW6:іW!ґWѕЪF!fW:iWѕТoE!iW6я*gW#"gW!¶W6я!ёW6 !µW6:5Q!µWѕЪME *µW& Н+SFQе	 е	Б
†2·WБ!FQ	 	~Ц Цџх:ёW!·W–џБHЎТFE:µW2¶W:·W2ёW!µW4ВцD *¶W& Н+SFQ	 	л НSл+s#rГyE!fW:iW–2iW*±W& Н$S›Q	 	~ЪјEєWbWНzSл+s#rНYSл:/QНpSТ№E Еd% Н§> ЙГэE*єWлН›2№WюяВЮE Е•% Н§> ЙГэE *№W& Н+SFQ	 	лєWНzSл+s#r!ґW4ВЗD>яЙ!јWq*јWл Н6
dWНщR> НfSµК'F> Й ЕЖ% Н§>яЙERROR:  $ at line $Missing parameter variable$Equals (=) delimiter missing$Invalid drive ignored$Invalid character$Invalid parameter variable$! "ИWжWН§	!ЕW6!ЗW6 :ЗWЪ	GНъG:ЗWЪGН€K2ЖW:ЖWюяКюFНIГGЁF Н
GГЩFЙ!МWr+s+q:U2НW!U6я5FНN*ЛWDMНN>FНN*ИWDMНZ:КWТCGН.Нњ:НW2UЙ:ЕWюВoG!ЕW6 ”TН ю КlG!ЗW6яГsG!ЕW4ЙНMG*ЕW& жW	~2ОW:ОWЦ Цџх:ОWЦ	ЦџБH±х:ОWЦ
ЦџБH±ТКG:ОWю
В·G*ИW#"ИWНMG*ЕW& жW	~2ОWГ„G:ОWЦaџ/х>z!ОW–џ/БHЎТйG:ОWж_2ОW:ОWюВцG!ЗW6я:ОWЙ!СW6 :СW/х:ЗW/БHЎТI!ПW6 >!ПWѕЪ/H*ПW& ЅW	6 !ПW4ВHНtG2РW!ПW6 :ПWЦџх:РWЦ=ЖяџБHЎх:РWЦЖяџБHЎх:ЗW/БHЎТ~H*ПW& ЅW	:РWwНtG2РW!ПW4Г:H:РWЦ=Жяџх:РWЦЖяџБHЎх:ЗW/БHЎТ§HНtG2РWГ~H:ЗWЪI:РWЦ=Цџх> !ПW–џБHЎТНH!СW6яГI:РWю=ВаHHF Н
GГрH:ПWю КрHcF Н
G:РWЦЖяџх:ЗW/БHЎТIНtG2РWГрHГяGЙНtG2ФW!УW6 !ИT:УW–џх:ФWЦЖяџБHЎх:ЗW/БHЎТ[I*УW& КT	:ФWw!УW4~`i+wНtG2ФWГI:ФWЦЖяџх:ЗW/БHЎТxIНtG2ФWГ[I!ШW6 #6> !УWѕТ‡K *ЖW& Н+SPе	 	^#Vл"ХWБ!P		 	~2ТWжю КJ:ТWжю КНI:ДWЦA2ШWГщI:ДWЦ0џ/х>9!ДW–џ/БHЎТпI:ДWЦ02ШWГщI:ДWЦAЖ
2ШW *ЖW& Н+SP	 	^ *ШW& Н+Sл*ХW"ХW*ЩW& ИT	~ю?В[J *ЖW& Н+SP	
 	:ШW†O !=R	6я!U6я!ЩW4!ЙT5> !ЙTѕТ‡K:ТWжю К§J*ЩW& ИT	~ЦAџ/х>P–џ/БHЎТњJ*ЩW& ИT	~ЦA*ХWwГ¤JЂF Н
GГ‡K:ТWжю КЗJ*ЩW& ИT	~ЦYЦџ*ХWwГ‡K!ЧW6*ХW6 !УW6 :ЙT=!УWѕЪ‡K:ЩW!УW†O !ИT	~2ФWю,В	K*ХW#"ХW6 !ЧW6ГЂK:ФWю#ВK!ЧW6
ГЂK:ФWЦ02ФW:ЧWЦЦџх>	!ФW–џБHЎТQK>!ФWѕТLK:ФWЦ2ФWГQK!ФW6я!ЧW:ФWѕТxK*ХW^ е*ЧW& Н+Sе*ФW& Б	лбsГЂK–F Н
G!УW4ВЦJЙ!ЬW6 !ЪW6 :ЪWЦџх:ЬW/БHЎТьK!ЫW6 :ЫWЦџ *ЪW& хН+SP	е*ЫW& Б	е*ЫW& ЅW	Б
–ЦџБHЎТеK!ЫW4Г©K:ЫWюВхK!ЬW6яГщK!ЪW4Г’K:ЬWЪL>яЙ:ЪWЙЙжWН§	”TН.	”TН~	!бW6я!ЯW6 >!ЯWѕЪN!ЮW6 #n&  Н+SP		 	~2ЭW!вW6 :вWЦџх:ЮW/БHЎТ
N!аW6 >!аWѕЪћLН'N *ЯW& Н+SP	е*аW& Б	е*бW& жW	Б
w!аW4ВgL:ЭWжю В°L!ЮW6яГчL:ЭWжю КМL:вWЖA*бW& жW	wГчL:вWю
ТжL:вWЖ0*бW& жW	wГчL:вWЖAЦ
*бW& жW	wН'N*бW& жW	6 Н'N*бW& жW	6=Н'N*бW& жW	6  *ЯW& Н+SP	 е	Се! ^ *вW& Н+SСНмR"гW:ЭWжю КmMН'N*гW~ЖA*бW& жW	wГзM:ЭWжю КћMН'N*гW~ТђM*бW& жW	6YГ›M*бW& жW	6NГзM*гWNНbN:ЭWжюВзMН'N*бW& жW	6,*гW#"гW*гWNНbNН'N*бW& жW	6,*гW#"гW*гWNНbNН'N*бW& жW	6Н'N*бW& жW	6
!вW4ГPL!ЯW4В'L>!бWѕЪ N”TН^	”TН	Й:бWюВ]N”TН^	!бW6 >!бWѕЪUN*бW& жW	6!бW4В:N!бW6 ГaN!бW4Й!еWqН'N:еWжшO !Ђ	е*бW& жW	СwН'N:еWжO !Ђ	е*бW& жW	СwЙЊOН *№TDM}жoВИNеЕ*TлН Бб·В†O] !ЊO>2PжWе:ёTgx±КЂO{ЦжжВ
Oг:PЅВOЕХ*TлН СБ!ЊO·В†O~#гo}oТ|Oе<ВO:їTГzO<В.O:АTхЖњсГzO<В8O:БTГzO<ВBO:ВTГzO<ВLO:АTГzO:ДTg:ЕT·КgO”ЪtO>љ:АTГzO:ГTo”ЪtO…ГzO:ёTg„бГЬNб!  |Йб!яя|Й                                                                                                                                 PRTMSG   ,QPAGWID  2QPAGLEN  1QBACKSPC 3QRUBOUT  4QBOOTDRV 0QMEMTOP  .QBNKSWT  -QCOMBAS  /QLERROR  	+QNUMSEGS 
5QMEMSEG00KQHASHDRVA6QALTBNKSA
+ћQNDIRRECA
;џQNDTARECA
K QODIRDRVA
[ЎQODTADRVA
kўQOVLYDIRA
{ЈQOVLYDTAA
‹¤QCRDATAF ›;RDBLALV  њ<RяяяяА O яяяяяяяяяяяяяяяяя      Ђ    А   А   А   А   А   А   А   А	   А
   А   А   А   А   А   А        яя      яя      яя      яя      яя      яя      яя      яя      яя      яя      яя      яя      яя      яя      яя      яя я                                                                                                                                                             i`N#FЃo€gЙл_ л…oЊgЙл_ лҐo¤gЙDM!  >х)л—)лЌ‘o|gТS	с=ВSЙ^#Vл)е))Б	ЙDM!  >)л)лТ:S	=В2SЙл_ лµoґgЙ^#Vл)ВPSЙ^#Vл|·g}oВZSЙ_ {•ozњgЙO {‘ozgЙi`N#F‘ogЙo& •oњgЙ_ {–_z#ћWлЙ                                                                                                       BNKBIOS3SPR                         RESBDOS3SPR                         BNKBDOS3SPR                         CPM3    SYS                         GENCPM  DAT                                                             .   $ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее;******************************************************************************
;* H D B O O T  * C P M S Y S 4 b *  T h o m a s   H o l t e  *  8 5 1 0 2 3  *
;******************************************************************************
;*									      *
;*  	 B O O T   L O A D E R   M O D U L E   F O R   C P / M   3 . 0	      *
;*       =============================================================        *
;*									      *
;*									      *
;*  Thomas Holte						 Version 1.0  *
;*									      *
;******************************************************************************
;
; Version um von Festplatten Laufwerk C: zu booten.
;						V.Dose	15.9.93


	.Z80

	TITLE 'BOOT LOADER MODULE FOR CP/M 3.0'

;ASCII control codes
BEL	EQU  07H		;bell
LF	EQU  0AH		;line feed
CR	EQU  0DH		;carriage return
SUB	EQU  1AH		;substitute
ESC	EQU  1BH		;escape
RS	EQU  1EH		;record separator

        GLOBAL ?INIT,?LDCCP,?RLCCP,?TIME
	EXTERNAL ?PMSG,?CONIN,?USERF
	EXTERNAL @CIVEC,@COVEC,@AIVEC,@AOVEC,@LOVEC
	EXTERNAL @DATE,@HOUR,@MIN

BDOS	EQU  0005H

	DSEG			;init done from banked memory

?INIT:  LD   HL,8000H           ;assign console to CRT 
        LD   (@CIVEC),HL
        LD   (@COVEC),HL
	LD   HL,4000H		;assign printer to LPT1
        LD   (@LOVEC),HL
        LD   HL,1000H           ;assign AUX to TTY1
        LD   (@AIVEC),HL
        LD   (@AOVEC),HL
	LD   HL,SIGNON$MSG	;print signon message
	JP   ?PMSG


	CSEG			;boot loading must be done from resident memory

;This version of the boot loader loads the CCP from a file called CCP.COM on
;the system drive (C:).

;First time, load the C:CCP.COM file into TPA
?LDCCP:	XOR  A                  ;zero extent
	LD   (CCP$FCB+15),A
	LD   HL,0               ;start at beginning of file
	LD   (FCB$NR),HL
     	LD   DE,CCP$FCB		;open file containing CCP
        CALL OPEN
	INC  A                  ;error if no file ...
	JR   Z,NO$CCP
	LD   DE,0100H 		;start of TPA
	CALL SETDMA
	LD   DE,128  		;allow up to 16k bytes
	CALL SETMULTI
	LD   DE,CCP$FCB		;load the thing
	CALL READ		;now, copy CCP to secret bank for reloading

;move copy of CCP into secret bank:
	LD   HL,0100H		;source      address --> reg. HL
	LD   DE,3500H		;destination address --> reg. DE
     	LD   B,30		;record count        --> reg. B
LDLOOP: PUSH BC			;save record count
	LD   A,10H		;source      bank = 1
        			;destination bank = 0
	LD   BC,128 SHL 8+15	;byte count --> reg. B
	          		;function # --> reg. C
	CALL ?USERF		;move CCP record
	LD   BC,128		;record length --> reg. BC
	ADD  HL,BC		;bump source address
	EX   DE,HL
	ADD  HL,BC		;bump destination address
	EX   DE,HL
	POP  BC			;restore record count
	DJNZ LDLOOP		;move next record	
	RET			;return to caller
	
;here if we couldn't find the file:
NO$CCP:	LD   HL,CCP$MSG		;report this ...
	CALL ?PMSG
	CALL ?CONIN		;get response
	JR   ?LDCCP		;and try again

;reload CCP:
?RLCCP:	LD   HL,3500H		;source      address --> reg. HL
	LD   DE,0100H		;destination address --> reg. DE
     	LD   B,30		;record count        --> reg. B
RLLOOP: PUSH BC			;save record count
	LD   A,01H		;source      bank = 0
        			;destination bank = 1
	LD   BC,128 SHL 8+15	;byte count --> reg. B
	          		;function # --> reg. C
	CALL ?USERF		;move CCP record
	LD   BC,128		;record length --> reg. BC
	ADD  HL,BC		;bump source address
	EX   DE,HL
	ADD  HL,BC		;bump destination address
	EX   DE,HL
	POP  BC			;restore record count
	DJNZ RLLOOP		;move next record	
	RET			;return to caller
	

*EJECT
;External clock.
?TIME:	PUSH HL			;save reg. HL & DE
	PUSH DE
        INC  C  		;time get/set flag ?
	JR   Z,SET$TIM		;set time
	LD   HL,@DATE		;^(time & date buffer) --> reg. HL
	LD   C,18		;function # 	       --> reg. C
	JR   GET$TIM		;get time & date and return to caller
SET$TIM:LD   HL,(@DATE)		;date		       --> reg. HL
	LD   A,(@HOUR)		;hours		       --> reg. D
	LD   D,A
	LD   A,(@MIN)		;minutes	       --> reg. E
	LD   E,A
	LD   C,19 		;function #	       --> reg. C
GET$TIM:CALL ?USERF		;set time & date and return to caller
	POP  DE			;restore reg. HL & DE
	POP  HL
	RET


;CP/M BDOS function interfaces
OPEN:	LD   C,15		;open file control block
	JP   BDOS
SETDMA:	LD   C,26		;set data transfer address
	JP   BDOS
SETMULTI:
	LD   C,44		;set record count
	JP   BDOS
READ:	LD   C,20		;read records
	JP   BDOS
	

*EJECT
SIGNON$MSG:
        DEFB CR,LF,LF,LF,LF,LF,LF,LF,LF,RS,ESC,'R'
	DEFM ' C P / M   V e r s i o n   3 '
	DEFB ESC,'S',CR,LF,LF
	DEFM 'GENIE IIIs SYSTEM'
	DEFB CR,LF
	DEFM 'Version b of BIOS (851120)'
	DEFB CR,LF
	DEFM 'Thomas Holte '
	DEFB 98H
	DEFM ' 1985'
	DEFB CR,LF,LF,LF,LF,LF,LF,LF,LF,LF,LF,LF,LF,0
ENDMSG	EQU  $

CCP$MSG:DEFB CR,LF,CR,LF
	DEFM 'BIOS Err on C: No CCP.COM file'
	DEFB 0

CCP$FCB:DEFB 3
	DEFM 'CCP     COM'
	REPT 20
	DEFB 0
	ENDM

FCB$NR:	DEFB 0,0,0

	END
> reg. D
	LD   D,A
	LD   A,(@MIN)		;minutes	       --> reg. E
	LD   E,A
	LD   C,19 		;function #	       --> reg. C
GET$TIM:ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее;******************************************************************************
;* H D B O O T E R * C P M S Y S 2  *  T h o m a s   H o l t e  * 8 5 1 1 2 0 *
;******************************************************************************
;* 		  *  V O L K E R  D O S E  *  9 3 1 2 1 0  *                  *
;******************************************************************************
;*    B O O T S T R A P   L O A D E R   F O R   C P / M   3   O N   T H E     *
;*    ===================================================================     *
;*									      *
;*        G E N I E  I I I s   M I C R O C O M P U T E R   S Y S T E M        *
;*	  ============================================================        *
;*									      *
;*									      *
;*  Thomas Holte			                         Version 1.1  *
;*									      *
;*									      *
;*   ge{ndert von Volker Dose, um von einer Harddisk zu booten.               *
;*	Nov. 1992							      *
;*   jetzt mit Initialisierung des Z180- Prozessors, Wait-Zyklen	      *
;*   und Refreshzeiten m}ssen optimiert und an den Z180 ausgegeben werden.    * 
;*      Jan. 1993							      *
;*									      *
;******************************************************************************
  
	.Z80

	ASEG
	ORG  0000H

;hier erst ein mal ein Verschiebeprogramm, mein Booteprom ist f}r GDOS
;ausgelegt, und l{dt die ersten 2 Sektoren nach 4200 und springt die dann an
;der Bootstraploader muss danach nach fc00 geschiftet werden.

	.PHASE 4200H
	DI
	LD	A,0C4H		;muss so sein
	OUT	($SYS1),A	;
	LD	SP,41E0H
	
	ld	HL,begin	;alles was nach FC00 assembliert wird
	ld	de,0fc00h
	ld	bc,01ffh	;schad ja nix
	ldir
	jp	0FC00h		;und den 'WAHREN' Lader anspringen.
	
begin:	
	
	.DEPHASE
			
	
	.PHASE 0FC00H

;load CP/M-system:

SECLEN	EQU  512		;length of a disk sector
$BUZZ	EQU  3860H		;buzzer address
$SYS0	EQU  0F9H		;port of system byte 0
$SYS1	EQU  0FAH		;port of system byte 1

	DI			;disable interrupts
	IM   1
	LD   SP,0FC00H		;init stackpointer

;clear screen:

	LD   A,00000001B	;enable bank 0
				;disable character RAM
	OUT  ($SYS0),A		;write system byte 0
	LD   A,01010100B	;enable memory mapped I/O
				;disable graphic display
				;disable boot EPROM
				;disable graphic page
				;enable full screen
				;disable video display
	OUT  ($SYS1),A		;write system byte 1

	.XLIST
	.XCREF

	.CREF
	.LIST

	LD   HL,3800H
	LD   DE,3801H
	LD   BC,7FFH
	LD   (HL),' '
	LDIR
	LD   A,11000101B	;disable memory mapped I/O
				;disable graphic display
				;disable boot EPROM
				;disable graphic page
				;enable keyboard
				;enable video display
	OUT  ($SYS1),A		;write system byte 1

;read first two tracks:

	LD   B,34              	;sector counter	        --> reg. B
LOOP: 	PUSH BC        		;save it
	CALL RDSEC 		;read selected sector into main memory
	OR   A			;disk error ?
	JP   NZ,ERROR
	LD   HL,(BUFFER)
	LD   BC,SECLEN
	ADD  HL,BC		;calc new load address
	LD   (BUFFER),HL
	LD   A,(SECTOR)
	INC  A			;increment sector #

;hierzu mu~ gesagt werden, das das COPYSYS leider nciht begreift, wie meine
;Harddisk angelegt ist, also nicht 136 128Byte Einheiten wie im DPB sondern
;nur 80 Einheiten wie das Floppyformat. Also muss hier nach 20 Sektoren 
;(entspricht 80 * 128Byte) der n{chste Track angefahren werden
; Macht ja auch nix



 	CP   20			;track exhausted ?
	JR   NZ,NXTSEC		;jump if not
	ld   a,1
	ld   (trk),a		;step in one track
	XOR  A			;reset sector #	
NXTSEC: LD   (SECTOR),A		;store sector #
	POP  BC			;restore sector counter
     	DJNZ LOOP		;read next sector

;move common code to the right place:

	LD   HL,3505H          	;source address      --> reg. HL
	LD   DE,0FE05H		;destination address --> reg. DE
	LD   BC,1FBH            ;byte count	     --> reg. BC	
	LDIR

;move CP/M loader to the right place:

	LD   HL,3700H          	;source address      --> reg. HL
	LD   DE,4400H		;destination address --> reg. DE
	LD   BC,0C80H           ;byte count	     --> reg. BC	
	LDIR
	JP   4400H		;jump into CP/M loader



;Routine liesst einen Sektor von der Harddisk.

; Die Sektornummer steht in SEKTOR
; Die Adresse wo der Gammel hin soll steht in BUFFER
; Die Routine ist aus dem LDRBIOHD.MAC meines Systems. Die Kommentare finden
; sich im HD2/MAC. Hier hab ichs mir gespart.

RDSEC:


hdport	equ	40h
hdstat	equ	hdport+1
hdres	equ	hdport+1
hdsel	equ	hdport+2
hdconf	equ	hdport+2
hdmask	equ	hdport+3

hdread:	xor	a
	ld	(head),a
	ld	bc,(trk)
	ld	a,c
	ld	(cylind),a
	rr	b
	rr	c
	rr	b
	rr	c
	ld	a,c
	and	0c0h
	ld	c,a
	ld	hl,head
	ld	a,(SECTOR)
	cp	17
	jr	c,hds0
	sub	17
	set	0,(hl)
	jr	hdsok
hds0:	res	0,(hl)
hdsok:	or	c
	ld	(sect),a
	
rdsect:	di
	ld	bc,0508h
	call	hdscmd

rd1$:	call	wcr
	call 	wcr
	in	a,(hdstat)
	cp	0cfh
	jr	z,termcmd
	cp	0cbh
	jr	nz,rd1$
	ld	hl,(BUFFER)
	ld	c,hdport
	jr	rd_dat
	
hdrdlp:	call	wcr
	call	wcr
	in	a,(hdstat)
	cp	0cfh
	jr	z,termcmd
	cp	0cbh
	jr	nz,hdrdlp
rd_dat:	ini
	jr	hdrdlp
	
termcmd:
	ld	c,8
tr$:	ld	b,0
tr$1:	call	wcr
	call	wcr
	in	a,(hdstat)
	cp	0cfh
	jr	z,tr$2
	djnz	tr$1
	jr	tr$3
	dec	c
	jr	nz,tr$
	
tr$2:	call	wcr
	call	wcr
	in	a,(hdport)
	and	2
	jr	z,exit
tr$3:	jp	ERROR
	ld	a,1
exit:	ret



cfield:
head:	db	0
sect:	db	0
cylind:	db	0
bcount:	db	1
termin:	db	2

	
wcr:	push	bc
	ld	b,0
wcr1:	in	a,(hdstat)
	bit	0,a
	jr	nz,wcr2
	djnz	wcr1
wcr2:	pop	bc
	ret
	
	
hdscmd:	in	a,(hdstat)
	cp	0c0h
	jr	z,hdc_id
	xor	a
	out	(hdres),a
	jr	hdscmd
hdc_id:	out	(hdsel),a
	call	wcr
	call	wcr
	ld	a,c
	out	(hdport),a
	ld	c,40h
nxbhd:	call	wcr
	call	wcr	
	outi
	jr	nz,nxbhd
	ret
								
DELAY:	dec	bc
	ld	a,b
	or	c
	jr	nz,delay
	ret
		


trk:	dw	0000		;current track #
SECTOR:	DEFB 1			;current sector #
BUFFER:	DEFW 0000               ;current load address


*EJECT
ERROR:  ld	hl,cfield	;der Verschiebebefehl sichert den
	ld	de,8000h	;letzten Parameterblock zum 
	ld	bc,5		;Begucken an eine sichere Stelle
	ldir
	LD   A,11000100B	;enable memory mapped I/O
	OUT  ($SYS1),A		;write system byte 1

	LD   HL,MSG		;^message		--> reg. HL	
        LD   DE,3C00H		;^first screen position --> reg. DE
	LD   BC,COPYRGT-MSG	;length of message	--> reg. BC
	LDIR			;output error message
	LD   B,100		;beep counter  --> reg. B
ALARM:	PUSH BC			;save counter

	LD   BC,0     		;repeat counter --> reg. B
                                ;  wait counter --> reg. C
BEEP:	LD   A,($BUZZ)		;turn on buzzer
	PUSH BC			;save base value of wait counter
BUZZON:	NOP			;little delay for lower frequency
	NOP
	NOP
	DEC  C			;decrement wait counter
	JR   NZ,BUZZON		;wait `til end of buzz
	POP  BC			;restore wait counter
	DJNZ BEEP		;turn on buzzer eleven times
	
	LD   BC,8000
        CALL DELAY

	POP  BC			;restore beep counter
	DJNZ ALARM		;beep 100 times
	JR   $			;hang up		

MSG:	DEFM 'HDBOOTER HARD-DISK ERROR'

COPYRGT:DEFM 'Enhanced BIOS written by Thomas Holte  (c) 1985'
SERNO:	DEFS 7			;serial number field
	.DEPHASE


*EJECT
	ORG  01E0H

LDRBYTE:DEFB 2


	END
 --> reg. DE
	LD   BC,COPYRGT-MSG	;length of message	--> reg. BC
	LDIR			;output error message
	LD   B,100		;beep counter  --> reg. B
ALARM:	PUSH BC			;save counter

	LD   BC,0     		;repeat counter --> reg. B
                                ;  wait counter --> reg. C
BEEP:	LD   A,($BUZZ)		;turn on buzzer
	PUSH BC			;save base value of wait counter
BUZZON:	NOP			;little dееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее         	INC  HL
PMSG$LOOP  012D'   18 F3                 	JR   PMSG$LOOP
PMSG$EXIT  012F'                         PMSG$EXIT:
  012F'   D1                    	POP  DE
  0130'   C1                    	POP  BC
  0131'   C9                    	RET
                                
                                ;print binary number 0-65535 from reg. HL
?PDECTABLE10  0132'   01 0157'              ?PDEC:	LD   BC,TABLE10
  0135'   11 D8F0               	LD   DE,-10000
NEXT  0138'   3E 2F                 NEXT:	LD   A,'0'-1
PDEC1  013A'   E5                    PDEC1:	PUSH HL
  013B'   3C                    	INC  A
  013C'   19                    	ADD  HL,DE
STOPLOOP  013D'   30 04                 	JR   NC,STOPLOOP
  013F'   33                    	INC  SP
  0140'   33                    	INC  SP
PDEC1  0141'   18 F7                 	JR   PDEC1
STOPLOOP  0143'                         STOPLOOP:
  0143'   D5                    	PUSH DE
  0144'   C5                    	PUSH BC
  0145'   4F                    	LD   C,A
?CONO  0146'   CD 000C'              	CALL ?CONO
  0149'   C1                    	POP  BC
  014A'   D1                    	POP  DE
NEXTDIGIT  014B'                         NEXTDIGIT:
  014B'   E1                    	POP  HL
  014C'   0A                    	LD   A,(BC)
  014D'   5F                    	LD   E,A
  014E'   03                    	INC  BC
  014F'   0A                    	LD   A,(BC)
  0150'   57                    	LD   D,A
  0151'   03                    	INC  BC
  0152'   7B                    	LD   A,E
  0153'   B2                    	OR   D
NEXT  0154'   20 E2                 	JR   NZ,NEXT
  0156'   C9                    	RET
TABLE10  0157'   FC18 FF9C             TABLE10:DEFW -1000,-100,-10,-1,0
  015B'   FFF6 FFFF             
'ROOT MODULE OF RELOCATABLE BIOS FOR CP/M 3.0'	MACRO-80 3.44	09-Dec-81	PAGE	1-9


  015F'   0000                  
                                
?PDERRDRIVE$MSG  0161' * +щ"Sя"В "К  ш"А "И Їgo"Q"`2п 2!2!2X2Z2]2^2c2_2\2W!С*"Д "ј "Ж "ѕ "=";!"а "Ю "д "в 2® 2Њ !яя"Ь Гъ?No Start Address ?Loading Error ?Nothing Loaded ?Out of memory ?Illegal Polish Exp :!·В‡!‹Гг!№Гг!ЄЇ2!Гу!љГу!БНРЇ2Ђ *Sщ!м ~·В4!†НР>2¬ Ї2YНщ:cж2cНъЪрюКЙю,КЙю/ВрНЪђЕюMВEЂЙюG@ИюRК юSИюUИюXИюYИюEВ{ ЙНOН:  ЕГ™&Г  юOВ†2W ЙЦHВO2WGЙ:c°2cНЪю:В'Х>` КрН‡лAx·КрюТрНЪВ№НЪСГ'"UН хН с_Н Ї2Ђ :f ·ДћЇ2Ђ UЕ!c~жюѕwК·ъ:f ·КР~жэѕwВ:f ·И2YГ¦2Y*`|µИНлЪ#К#yюИ·В#НjЪC~ж@В#ГI"К Г#Н¬*`|µИГ#*U~жюВ!:Y·:cК~юЂНСGж@Вxж ВkГцюЂФСГo
Link-80  3.44  09-Dec-81  Copyright (c) 1981 Microsoft
 ?Command Error ~·ИНP#ГР~ж#ю КЪю
КЪю`Ъфю{ТфЦ юА+ЙХЕ!Ђ ~·GК #~ю ВГex+#К<~Г:¬ ·К/Н”>*НP
dН >
НP:e!fе…o> Њg6бБСЙЦ7КЊЦфКЊЦ
ВрНЪюКyю:+Вy#НЪюPВр2\Ї2f еg !‹  НцбЙхНЪю:ВрН\сеGЏ‡OВ:® ·ВНеле  НШ"а "д б"Ю "в *ј е*Д "ј ";НС*Д лН*Ж ·НBK*Д л*Ж еХН"=Ї2­ G<2® СбхГСХНбzіИ6 #zіВЙхЪ:® ·ВOНесхЪ4ХНбНхН…К{СНШлНТЋе!  ННбеЕyН	БлгНхХНyBKСбеХхНсOСбН НхбсШхе!;	s#rС!Ю 	s#rсШ!в 	s#rбЙХлНюН…хФБсбгхесЪ¬!в 	s#rСбХхНхл!;	схЪБs#rбсеТФНблyЕН	БН сШбЙ!Ю 	~#foЙ!ј ГЫХНбНхНлСµЙл!Д НЫлЙХНШНхННбСЙ}“_|љWЙ>2­ *Ю л*а НЪ<*ј л*И :® ·К<Н…ТP*ј л*И НW{_*ј лл#"Ж "ѕ "=Й  :WGллНЪOЦ0Ъ—ю
ЪxЦЪ—л)))юТ–КЊюТ–)…o> ЊgГdлyюИ+Й%Overlaying   area ґ№Data Program НЗГ”е!ќНР!°	~#foНР!ЄНРбЙеГЛеЕ  НШН…ТеНюлгН…блКН…Ъ&б}<К =№ДБеyюВкБбЙеy7ГлгЕyM№е7К>,К>НШ#лН…лбБСеЪ!MНбГц>	хЕХеж_Н бСБсЙ!h >?НP~#НPю!ЪyВk!‰:!·К†!;Гг Not Found >НP>
ГP>Ђ2є жН g НрН <Кa>я28ЙеХ:є ·ьШ_ <2є !ж~СбЙЕжН g Н Б·ВНЇЙ! Їw#Вч!  wЙНO|µл!yКулеН:е!(НРН”*QDMбЕГ™&[Begin execution] :Z·Кк:X·КГ*В л*К лН…КГ~жаю`~ВЁо@wже+++юЪo>GOД~+Вt>‘КЉл6 #=ВѓС*В НХ!ГН®Ї2XНР*В СНл~Oж_ Нл+++y·тј++:X·ВKН”:cж2cНР*Q>[НPН"НN  Нюе!CН ЪьКьН\*Ю лs#r!IН Ъ	К	Н\!п ~#·В	!=Н Ъ=	К=	Н\*И лН…Т=	С*Н…Ъ=	Сs#rХбеН"НNЇ2° *А л*И Н…Кђ
жюК…	ЦЕ2і ХНMН\л:і ·Вz	x/Gy/O~Ѓw#~€wСГM	ХНMб"± zжюТС	_z !Ј	^#Vлй»	в	в	ы	



$
2
=
]
m
`i·тЕ	^+Vле!° 4*± лГM	!° 4Гђ
!° 5ъђ
бгЙхPYН\сНШ	Вђ
лsюВК	#rГК	НШ	lЇgГЕ	НШ	Гя	НШ	Н
ГЕ	НШ	Н
#ГЕ	|/g}/oЙНШ	лНШ	НлГЕ	НШ	лНШ	ГЕ	НШ	лНШ	DM!  >=КЕ	)еЕб)гБТK
ГK
НШ	лНШ	zіД
лГЕ	НШ	лНШ	zіКi
Н
ГЕ	BKяя}‘o|gТ„
	Йб  Ню:® ·К«
лНюН…Т«
л Ї•|О ’НЫ
>]НPН”:° ·ВЪ:Њ ·Д$>Г2 *Q"Г!o& Х 'НиНd Н
 Н>0…GСГ/}“o|љgТxЦ0В№В >xГPH>G~#В'ЇНjШ~ж@И+^+VЙ$MEMRY$$PROG$COMNM*QA·И!Hw#В]ЇНjЪ{~ж@К{+^+Vл"QЙе!ђНРбНГЇ2A!ЎГг?Start symbol -   - undefined g ~ж#ВіНћГ         RELц7х*`}ґ2X:cж`КисШхГщ Нj:® ·ДjН”сЪ
АНp@НpН”`НpЂНp Нp*В Н}К,>п¦wНkГНц:`·К?НЫ
!KНР*Ь НЮ
!bГР Undefined Global(s)
  Bytes Free
 Ї2bНPЪцНе~жO~жа>-К‘> т‘>/НPх+^+V+~НPВ™сю/МPНNг~ж лКј!џНРГїН"л~·гтЫНN+^+Vл><НPНЮ
>>НPНN:bю?Ож2bМ”б>¶wГt:b·ИЇ2bГ”ЕеНkН[ЪMВСлеХ~++жGжOЕёЪ&H+ѕЪDВ;В&БyёЪE>БбСБЕХГБбСБЕеГбБЙ*В Н[ШИГSН}7И~жВk~жаёИ~·тr<<жЖ/_я·Йл*К лГ…|’А}“Й!” 6S#6Y#6MН<$>х*В л*К лН…Кр~жO~ж@КЭе+^+VлНьл> Нh%+~Нh%ВГ>	Нh%бс=ВЬН>х~·тд<<жЖ/Oя	ГџсюДН‘&Г%|Н}хНсхНсЂGЙН[Гh%>Нh%>
Гh%:W·КGЇ)О0НPЕЇ)ЏВ6Ж0НPВ3БЙ|НL}хНUсН[ГPжЖ0ю:ШЖЙН”сЙ!° 	~#foНРНNНШН"НNНюН"НN><НPНзНЮ
>>НPГ”RQUEST Н¬Г¦*В :Ї ·Кыл*К Н…лКы~ж_ ~еж@Кр+++~Ц#ВрН*К лНBKлбеН"К бГ¶бНл+++Г¶Ї2!2­ 2Ї 2µ :® ·МЇgo"¶ "ж "и 2X"к <2ґ :® ·*ј л*Ж Д *ѕ л*И Н *=ебНќНлТQНiГEВZНїГEе !њ		~#foBKйХЕе#:ґ =лКќ:к ·В”*ј |’КЉТ”ВЏ}“Т”л·НбНќБp#СЙ:л ·В”*ѕ |’КІТ”В·}“Т”л·НГ”Х:і =Вл:­ ·КлеНUлгНОелџжЂw+p+qСБ+p+qляя#НBНiе++sбСЙ"н Н‡ю:7> ВлНЪю[?ШЦ@Шл2g Ф‡xюЪ"ЕлХh К5НЪГ)бБ>
ђЪFл6 #=т>лx2f y ю.хМ‡глХp xюЪaКnНЪГbсКѓ!p ~ю Вѓ6R#6E#6Lбy·Й еНЪю[ТҐю0ЪҐюAТЎю:ТҐГЉю[КЎю]КЎю@КЎю\КЎю^КЎю_КЎOСЙлСХНb:­ ·Вф:ґ 2і НBK|µКA~_q#¶VpН\лВгГAлеНU:і =КН>Ђ<G:ґ =К>@Ђw+r+s+Сж@еМгбН1:ґ 2і Нr+sГA:ґ =Ае*¶ лбЙ>ЂНjЪVе/o/g	Ъ®бГA~ц@w:]2^·Кsе+++~бю КsЇ2^лq+pЕ:^O !;НЫел>2і Нл}|бСл!;	s#rНблН…yФ	ГA!ФНРбНГ>/НPН”ГA~жW+++~НP+ВКЙ%2nd COMMON Larger / *;л"ж л	|2к л*ј лН…ФеНбГA> Нj~ц@wГAц7хНU:­ ·>АК8:ґ =К->ЂG:і =К7>@ЂЖwсџ<†w+НлглХН1:ґ 2і Н:­ ·Кd:ґ =еМгбr+s+лбглr+sГA:Iю5КШ'юAК‘юBКпюCКюHКKГФ:JюКЇюКЇюТФхНU6З+сwГAхНU:­ ·КБ:ґ =КГ>@ц‡w+сw++СХН1:ґ 2і Н:­ ·Кй:ґ =еМгбr+sГA!HIF5#wВчЇНj~+ЬѕеНU6З+6Ђ++Сr+sГA*Kл:J2і НfННU:­ ·К;:і ·В=>@ц‡w+6 ++r+sГA:!·ВA>.2!2P*н е!JНъНћНАю!Ъg2!ю+В}2_НА!п w#ю!ЪђНАВ‚!п Н\л"Ю "в :® ·ВЦ:Z·ВЬНАю!Ъ«!п  w#ю!ЪЖНАВё+Їw2!бНъНћГA!вГг!Гг?/D illegal with common runtime ?No code can be loaded before program withcommon runtime  not found, please create header file ?End of file on common runtime header !aГгББГUН„zіБКЈЇН„л"Q  Нb!ж 	^#V!в НЄ!;НЄyюЪ©:® ·А*ј л*Д Н…ВЬ*а "Ю   Нюл*а НЪ'*ј еН*Ж л*ѕ НBK*Ж лб"Ж Н…ФЬц"ѕ "ј ";  Ню"д "в ЙНюлНюН…Ъ7л*а лНХ*Ж л*ѕ НбН…Т]!  Н*ѕ Н*Д л*ј НBK*а л*Ю Н*Ж л*Д лН*а "Ю *Ж л*ѕ НBK*Ж л*Д "Ж Нц"ј "ѕ ";Г	~ѓw#~ЉwЙPYНb>Н„BKЇНjФ~ж@Въ:­ ·ВЯ~ц@w+~_q+ГзлНU:і =Км>ЂЖCw+p+q+r+sГAе!НРбНГН”ГA%Mult. Def. Global  ~ж@Ае*`+"`бЙPYНb>Н„BKЕЇНj~+ЪnN+Fж@лбВ‡:­ ·В›:B(·Кb:і =В›лzіКAНпГAлНѕб|µКA:­ ·В›лr#sГA:­ ·В›|µКAлН\лГЮлzіКA#еНU:і =КЇ>ЂЖBw+r+s+Сr+sГAе*`#"`бЙе!7~#4ВЧНА6ш‡+wбЙ НИxGВаЙЇ2і НИЪъНЬ7ЙНЮ·КНYЇЙеНЮюхЪ!юКHНЮНYсхюТHХНЮ!H·wВ74#6 _ъGНЬw#Г;Сс! яюВT"7O<·бЙх2і НЬXНЬPсюМЉ‡еКwюТwоO !9	N#Fл	џ2[лбЙх:­ ·КљЇ2[сгбЙсЙAкC(	r>-ій Жј’Ќ:­ ·МгХНб"и л*=>я2л л*ѕ лН…ФГA*=лГ>ЂНjЪФ+^+VН\л"?ГAбЕНb:і =ъ#<2ґ =ВA:­ ·КA*=	гГAPY Х7НС*а лНТK"а !  Н*="=  *Ж Бе!  "¶ }2л <2ґ ГA:[·ИГа*В Ехл*К л|ЄG}«°Кј~жOсх®жёВ©H©В©еA+++ѕВЁ+В—лбсБЇЙб~·т°yЖ/Oя	ГoБHхЖOxЃеХ_ НлНюСбсO°wю#Ве2Ї еЇ+w+w+w+ВмС·ет Їw+w+"К лСБ7Й©їФ))ш'):B(·В$:­ ·ИН„:­ ·КrЇ2­ *ј л*Ж ХлНлDM*¶ 	"¶ л*=е	"=С*ѕ ХНBKСб"Ж Нц"ѕ   Ню"а "д *А "ё еН¶'С*И |’В‡}“К л~‡ж_ |Ее!^#Vлй*ё "И Г(НMбгеН\л~#¦+<Вlq#pЙНMбгеН\л^q#Vp{ІВЕЙНMбгеЕб#~ж@Х+^+VлглВБ{ІИr#sЕН\л^#V{ІВуСr+sЙБГЕНMбгеЕб~Oц@wyж@+Ns+FrЕХБСА{ІИГЕбе~2f НMбге*ё :f жцАw+r+s+p+q+"ё Йбг~+V+^+F+N+ге*а ·ъeллж@А	DMЙе!ґНР`iН"СНN*=Н…Т€*;лНлН"НPНNбСХе! еН"НNС*А НлН"Н”Й%%Bad fixup offset entry, will be ignored
Value	Loc	Entry A	Entry rel.
 >Ъ>Ъ>Ъ> ЕюТ<2Z=O Хею!Ж Ъ$!є 	^#VбюЪ0елНхyюЪ=сбхсеТUyю?Ъ\ХНхН…С?Ъ\хЕН|Бсхyю!ј Ъi!Д 	сСТus#rГx^#VлСБЙеХНћХНЪаКабНх!Ъ p#В”  *Д е!М N#F#~#foе!Ф Х^#Vл	СБлгЕе	Блбгле!И ~#foлгН…СТHе!Ъ {_{‡_~б·КHг!Ж Х^q#Vpлглбге!ѕ лгл~s#_~rWбглХНбг}гл·К&х:µ ·К$с#МqеЕбБеН…ФЬцбС{_е!Ъ 6 л)лБЕ`iБ{юЪ !Ъ Ї†#ВY·Вљ*Т л*И 6 *В Нл"К *М л*Д "ј СбЙхЕХеНћл*Ь лН…Т™"Ь бСБсЙЕХ!ј yюЪ¬!Д 	^#V	 юЪ»хя	F#fhюЪЖлНбе!ј   Х^#VХ	 ^#VглНбггчяВХбСБЙy  Хе!ј 	^#VХ ^#VбхНс№Вбел!М 	s#rGyюx Выб!Ф гН@гs#r#В1бЙxЦКS|W}_ХНлСллЙХЕыяx2µ *И 	·НЇ2µ  БСЙлеy•oxњgХл*¶ "¶ л*="=*?PYН…Ъ™"?СблЙХ:ґ юК№=ВЇл*¶ л!  "¶ лСЙел*¶ л*Ж Н…бТЇлГЇНќВвХл*={•OzњGлСЙеХл*Д лН*Ю DMСб7Йx±Иw#Гц	ел	+x±КЯ~+Гx±Иw+Г:і 7=шеЕюМ{о‡O ·К>:­ ·7ВJлНхННШлБбЙ?Intersecting  хЕея НеТwOХНхНШлНблбБсЙ*ј Н…џ<Й26НШеЕ:і ю?џж OКЈ:­ ·ВJНШН…ТJНюлН…лТJе!MНб>,НP*6& 0M^#VлНРy·ВабНяГц!HF#~#НPВе>(НPбНя>)НPГц:і юџжНхНГ" Start =   External   Public =  %                             Р*               Ђ                                                                                                                                                                                                                                                                                                                                                                                                                                             Нз В"!Нз2Z!:Z·ИНзК?!НШН™!НюН™!yюВ-!*Ю л*а Н…Ь	#*Д   Н" НбНхеНбН…бВ|!л*SллН…Ф"yюВb!Нбл*SН…Ф"Га Н…Ъµ!л*SН…лЪ®!Йе!б!Г№!е!Ы!е!з!НРбНР!п!НРЇ2¬ НщНЪюYбИГxbelow above Origin   loader memory, move anyway(Y or N)? ЕХ лНюХлНШН…лСК0"Н…ЬD"т"! Н…ЬD"лСБЙЕеy·ВS":® ·КW"ЇЖю*SКЂ"Ъa"ЇOНШХлНюН…лСВЂ"y·*SВЂ"!а НЫН…Т‡"л! 9щбе;;;;;;лН…ЪЕ"гН…ЪЈ"лбХНz·СКЙ"&'7НМ"Ъї"НМ"КЙ"БББББЙСлБЙлБЙЕХеЕбхН…Ъ#сСХхлН…Ъ#сТо"бБЕеЕблХНz·Кэ"СБББ7ЙСбСБЇЙБбСБ·Й*ј ";*ѕ "=*Д л*;НВ)#іКЙ#т+#ЂK PЕ*;еНл";л!жНцС*ј ХНBK±С*;Дц*Ж л*=НБЕВl#іК®#№Тl#O*ј СН*Ж ЕлНц"ј *Ж СХл*=НBK*Ж СХллНц*=СХНл"=жБНцГ#PY*ј Нл"ј *Ж СХНл"Ж Г#*Ж л*=НЪж#BKі*Ж л*ј Дц"ј *а л*Ю "а л"Ю *="Ж *;"Д Йю И!” 8$Е~юRА#~юEА#~юLА4$:cжК)$7$w+В)$ЙCOMHEX`$ЕжН ‹ НрН ‹ Н <Кх%Ї2є Й  :® ·К$НзК}$*а л*Ю Н…Ъ$!c~жКЊ$‹Х~жКЖ$:\·КІ$:® · Вµ$*QелН\л"Д б"Ю Н&yоO:® ·Д&Нw&Г%*Q |µКх$Н…Кх$НЩ%Н… Ъх$ЂН…Тщ$Н.%Н>%7Ф’%НR%:® ·К%НюлyоOНзК%Н>%НR%:є ·Д‚%‹ Н <Кх%Й>ГНh%*Q}Нh%|Гh%НШНШіИЇНh%zіВG%ЙНд%НблНzіИ~#Нh%Г\%Хех!ж:є _ сw{<ь‚%2є бСЙЕ‹ Н ·Вх%БЇЙНЩ%"Г%еЕyоOНюБСНл#"Ж%йя!В%Н\%Н.%fЇНh%В№%Й!    Ђ	л	~+x±В:_·КШ*QЙ:_·КхЕ*QлН\БЙ!ы%Гг?Can't save object file НюлНШлХН{ІбИЕеХНхлС{Ц _zЮ WЪ;&> ГA&{Ж   ·ВH&ББЙO >:Нh%yНгХНь YСгЇН~#НВc&ЇђННГ+&>:Нh%ЇGН*QНь>НЇђНН>Гh%е!*'Нћ'!0'Нћ'!3'Нћ'!9'Нћ'##ВІ&##Нћ'##Вї&#Нћ'!z'Нћ'!…'Нћ'Х*Д "‰'л*ј Нл"‡'*Ю "‹'*Ж "Џ'л*ѕ Нл"Ќ'*а "‘'СбБщЕл&'m Г&'                Н“'Г,'  НV'ЪG' НV'Фl'Ь|'НV'Гl'Н|'НV'Фl'Ь|'Й!‡'	N#F#^#V#~#fo|’А}“Й	л	+x±И~+Гq'x±Иw#Г|'            x±Иw#Г“'ЕеХ~#fo&'НлСеБбq#pБЙ:B(·ИеС*И Н…Ил~жюј'ЕеКНMбгйН(:J2A(*;"ј Ї2к НU6Ж+:A(wГAНMбгеzхН(с2A(·ИГ7(:B(·ИН(*;"ј Й:A(·И2B(  Нзл*;r#s+:A(Гi(*;Нў("ј Й  Ї2A(2B(!°* p#ВP(!HN#°*~#В^(ГAеХr#sН*Нп)С{жК…({жЂЖЂ_Т…(zібКћ(ХеНЗ)бЂ гЂялГ…(НЈ)ЙеН*НЪ)!.*Нґ)!.*V#^бНц(Ън(ХЂ Ню(Се!ЂялбНц(ЪЮ(ХеНґ)бЂ ГГ(zіКр(е!.*ХНґ)СбНю(еНЈ)бЙz·А{·ш7Й.*zіИ
w#Г)жЖ0ю:wШЦщwЙ:®*!;)хН)+сН)!1)ГР?Segment    ,  file not found can't create file read error Disk is full Н)!@)ГгН)!O)ГгН)НЈ)!a)ГгН)НЈ)!l)Гг.*Н Ї*Н ЙлН Ї*Н ·В‹)ЙлН Ї*Н ·В—)Й.*Н Ї*Н <Кy)Й.*Н Ї*Н Ї*Н <К‚)Йх2®*!є*Н)с+Н)##Ї2Ї*w#В'*Й                                                                                                                                          V                       0                                               ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее;******************************************************************************
;*  L D R B I O S  *  C P M S Y S 3  *  T h o m a s   H o l t e * 8 5 0 9 0 8 *
;******************************************************************************
;*									      *
;*  		 M I N I M U M   B I O S   F O R   C P M L D R		      *
;*               =============================================                *
;*									      *
;*									      *
;*  Thomas Holte						 Version 1.0  *
;*									      *	
;*									      *
;*									      *
;******************************************************************************
;
; Jetzt angepasst an Tandon TM 262 HD mit 20 MB . 3.Aug 1993
;
; Nun an Seagate ST 225 mit 2 Partitionen. Die Charakteristik von 
; Partition 1 wird in LDRBIOHD zum Bootvorgang von der Festplatte ben|tigt
;
  
	.Z80

;ASCII control codes:
BEL	EQU  07H		;bell
LF	EQU  0AH		;line feed
CR	EQU  0DH		;carriage return
SUB	EQU  1AH		;substitute
ESC	EQU  1BH		;escape
RS	EQU  1EH		;record separator

$SYS1 	EQU  0FAH		;system byte 1

PUSHHL	EQU  0E5H		;machine code of PUSH HL

;BIOS jump vector.

;All BIOS routines are invoked by calling these entry points.

?BOOT:	JP   BOOT		;initial entry on cold start
        JP   DUMMY		;not used jumps in LDRBIOS
	JP   DUMMY
	JP   DUMMY
?CONO:	JP   CONOUT		;send console output character
        JP   DUMMY		;not used jumps in LDRBIOS
	JP   DUMMY
	JP   DUMMY
?HOME:	JP   HOME		;set disks to logical home
?SLDSK:	JP   SELDSK		;select disk drive, return disk parameter info
?STTRK:	JP   SETTRK		;set disk track
?STSEC:	JP   SETSEC		;set disk sector
?STDMA:	JP   SETDMA		;set disk I/O memory address
?READ:	JP   READ		;read physical block(s)
        JP   DUMMY		;not used jumps in LDRBIOS
	JP   DUMMY
?SCTRN:	JP   SECTRN		;translate logical to physical sector
        JP   DUMMY		;not used jumps in LDRBIOS
	JP   DUMMY
	JP   DUMMY
	JP   DUMMY
	JP   DUMMY
	JP   DUMMY
	JP   DUMMY
	JP   DUMMY
?MOVE:	JP   MOVE		;block move memory to memory
	JP   DUMMY		;not used jumps in LDRBIOS
	JP   DUMMY
	JP   DUMMY
	JP   DUMMY
 	

*EJECT
BOOT:
;====

;Initial entry point for system startup.

	JP   ?INIT		;perform any additional system initialization
				;and print signon message 


CONOUT:
;======

;Console output. Send character in reg. C to all selected devices.
	LD   A,C		;character  --> accu
        LD   C,4  		;function # --> reg. C
      	JP   ?USERF		;display char


HOME:
;====

;Home selected drive. Treated as SETTRK (0).

	LD   BC,0		;same as set track zero
	JR   SETTRK


SELDSK:
;======

;Select disk drive. Drive code in reg. C. Invoke login procedure for drive if
;this is first select. Return address of disk parameter header in reg. HL.
;
; DS0= Harddisk partition 1
; DPB0= disk parameter block parttion 1
;
	LD   HL,DS0             ;^extended disk parameter header --> reg. HL
	RET

;Extended Disk Parameter Headers (XDPHs)

	DEFS 8
	DEFB 0,2	        ;relative drive zero
DS0:  	DEFW 0			;no translation table
	DEFW 0,0,0,0		;BDOS scratch area
	DEFB 0,0		;media flag
	DEFW DPB0   		;disk parameter block
	DEFW 0            	;no CSV
	DEFW ALV0  		;allocation vector
	DEFW DIRBCB		;DIRBCB alloc'd by GENCPM
	DEFW DTABCB	
	DEFW 0FFFFH		;no HASH
	DEFB 0			;hash bank

;Disk Parameter Block (DPB)

;:---------------------------------:
;:HARDISK 20MByte, Partition 1 C:  :
;:---------------------------------:
; this data are from hddtbl.asm
;
 
DPB0:	DEFB	10h,01h	    ;SPT= 272      128 Byte records/track
	DEFB	005h	    ;BSH=   5      block shift factor  
        DEFB	01fh	    ;BLM=  31      block mask   
	DEFB	001H        ;EXM=   1      extend mask  
        DEFB    01fH,0aH    ;DSM=	   maximum block number 
	DEFW	1024        ;DRM=1024      maximum directory number
	DEFB	0FFH,0FFH   ;AL0= 255      allocation vector 0
        		    ;AL1= 000      allocation vector 1
	DEFB	000H,080H   ;CKS=   0      checksum size is zero
                            ;              ,permanently mounted
	DEFW	2	    ;OFF=   2      reserved tracks of partition 1
 	DEFB	2,3         ;PSH=   2      physical sector shift
			    ;PHM=   3      physical record mask 

;directory buffer control block:

DIRBCB:	DEFB 0FFH		;drive
	DEFS 4			;record #, written ?
	DEFB 0
	DEFS 4			;track, sector
	DEFW DIR		;buffer address

;data buffer:
DTABCB:	DEFB 0FFH		;drive
	DEFS 4			;record #, written ?
	DEFB 0
	DEFS 4			;track, sector
	DEFW DATA		;buffer address


SETTRK:
;======

;Set track. Saves track address from reg. BC in @TRK for further operations.

	LD   (@TRK),BC
	RET


SETSEC:
;======

;Set sector. Saves sector number from reg. BC in @SECT for further operations.

	LD   (@SECT),BC
	RET


SETDMA:
;======

;Set disk memory address. Saves DMA address from reg. BC in @DMA.

	LD   (@DMA),BC
	RET


READ:
;====
;Read physical record from currently selected drive. Finds address of proper
;read routine from extended disk parameter header (XDPH).

hdport	equ	40h
hdstat	equ	hdport+1
hdres	equ	hdport+1
hdsel	equ	hdport+2
hdconf	equ	hdport+2
hdmask	equ	hdport+3

hdread:	xor	a
	ld	(head),a
	ld	bc,(@trk)
	ld	a,c
	ld	(cylind),a
	rr	b
	rr	c
	rr	b
	rr	c
	ld	a,c
	and	0c0h
	ld	c,a

	ld	b,0		; head count
	ld	a,(@sect)	; sector # (only low byte significant)
fdhead:	cp	17		; find head #
	jr	c,hds0		; if head 0
	sub	17		; else convert to sector # and head #
	inc	b		; next head, if more than 26 secs
	jr	fdhead
hds0:	or	c
	ld	(sect),a	; set sector and track msb
	ld	a,b		; head #
	ld	(head),a

	

;	read sector into dma buffer
rdsect:	di			; disable interrupts
	ld	bc,0508h	; get length and command
	call	hdscmd		; send command
rd1$:	in	a,(hdstat)	; hdc get status
	cp	0cfh		; test if status is to send
	jr	z,termcmd	; skip if yes
	cp	0cbh		; test transfer direction
	jr	nz,rd1$		; loop until o. k.

	ld	hl,(@dma)	; get sector buffer address
	ld	c,hdport	; get hd port address
	jr	rd_dat		; branch to get first data byte

hdrdlp:	in	a,(hdstat)	; get hdc status
	cp	0cfh		; test if transfer is terminated
	jr	z,termcmd	; if yes quit loop
	cp	0cbh		; data available  ?
	jr	nz,hdrdlp	; loop if not
rd_dat:	ini			; read data
	jr	hdrdlp		; and loop

;	test if hard disk command is correctly terminated
termcmd:			; test termination of command
	ld	c,8		; set loop cont to 8
tr$:	ld	b,0		; set retry count to 256
tr$1:	in	a,(hdstat)	; get hdc status
	cp	0cfh		; ready to read status  ?
	jr	z,tr$2		; skip if o. k.
	djnz	tr$1		; else retry b times
	ld	hl,hdmsg2	; print error mesage if command
	jr	tr$3		; is not correctly terminated
	dec	c		; decrement loop count
	jr	nz,tr$

tr$2:	in	a,(hdport)	; get command status
	and	2		; to test completion
	jr	z,exit
	ld	hl,hdmsg1	; else print terminate error

tr$3:	call	pr_msg		; print message
	ld	a,1		; set error condition

exit:	ret			; return with status in accu


															

SECTRN:
;======

;Sector translate. Indexes skew table in reg. DE with sector in reg. BC.
;Returns physical sector in reg. HL. If no skew table (reg. DE = 0) then
;returns physical = logical.

	LD   L,C
	LD   H,B
	RET


MOVE:
;====
      	EX   DE,HL		;we are passed source in DE and dest in HL
	LDIR			;use Z80 block move instruction
        EX   DE,HL              ;need next addresses in same regs
DUMMY:  RET


*EJECT
?INIT:	DI			;disable interrupts
	IM   1			;interrupt mode 1 (RST 7)
      	LD   C,23		;function # --> reg. C
	CALL ?USERF		;general system initialization

	.XLIST
	.XCREF


;hard disk init routine:
DS$INIT:

hdinit:	out	(hdres),a	; reset hard-disk controller
get_st:	in	a,(hdstat)	; get status
	cp	0c0h		; test if hdc is idle
	jr	nz,get_st	; else loop until hdc is idle

setmsk:	xor	a		; clear accu and send mask to disable
	out	(hdmask),a	; interrupt and dma from hard-disk

w0:	in	a,(hdstat)	; get status
	cp	0c0h		; and wait until hdc is idle
	jr	nz,w0

;	init hd controller with hd-drive-characteristics

trpara:	ld	hl,ifield	; point to init-parameter field
	ld	bc,050ch	; get command to set hd characteristics
	call	hdscmd		; send command
	ld	hl,hd_charact	; point to table of hd characteristics
	ld	c,hdport	; get hd port
	ld	b,8		; get length of table
tr_p1:	in	a,(hdstat)	; get hdc status
	cp	0c9h		; request for data --> hdc  ?
	jr	nz,tr_p1	; loop until hdc requests for data
	jr	nx1		; else send data from data table

nxtbyt:	call	wcr		; wait for controller ready
nx1:	ld	a,(hl)		; get byte from table
	out	(c),a		; send byte to hd controller
	inc	hl		; increment pointer
	djnz	nxtbyt		; loop until done

;	test if command successfully completed

rdy1:	in	a,(hdstat)	; get hdc status
	cp	0cfh		; test if status is to be send
	jr	nz,rdy1		; loop until o. k.
	in	a,(hdport)	; get command status state
	bit	2,a		; test if correctly terminated
	jr	z,pri_ok	; skip if o. k.
	out	(hdres),a	; reset controller
	ld	hl,hdmsg1	; else print hd-init-error
	jp	pr_msg		; and return

pri_ok:	ld	hl,iniok	; print init o. k.
	jp	pr_msg


iniok:	db	'Reading CPM3.SYS',cr,lf,0
hdmsg1:	db	bel,cr,lf
	db	'HD Term. Error !'
	db	cr,lf,lf,0
hdmsg2:	db	bel,cr,lf
	db	'Hard Disk Read Error  !'
	db	cr,lf,lf,0

; Subroutine Area				

pr_msg:	ld	a,(hl)
	cp	0
	ret	z
	ld	c,a
	call	conout
	inc	hl
	jr	pr_msg
	
	

; hard disk subroutines

; wait controller ready
wcr:	in	a,(hdstat)	; get hd controller status
	bit	0,a		; test for data request
	jr	z,wcr		; quit if request
	ret

;hd send command	hl -->	parameterlist
;			b  -->	count
;			c  -->	command
hdscmd:	in	a,(hdstat)	; get hdc status
	cp	0c0h		; to test if hdc is idle
	jr	z,hdc_id	; skip if o. k.
	out	(hdres),a	; else reset hdc
	jr	hdscmd		; and try again
hdc_id:	out	(hdsel),a	; select hd controller
	ld	hl,cfield	; set pointer to command field
	call	wcr		; wait for controller ready
	ld	a,c		; get command
	out	(hdport),a	; to send it
nxtpar:	call	wcr		; wait for controller ready
	ld	a,(hl)		; fetch next parameter
	out	(hdport),a	; to send it
	inc	hl		; increment parameter pointer
	djnz	nxtpar		; and loop until done
hd1ini:	ret

;  hard disk data area
cfield:				; hdc command field
head:	db	0		; selected head, lun and c10
sect:	db	0		; sector #, c8 and c9
cylind:	db	0		; cylinder #  < modulo 256 >
bcount:	db	1		; block count
termin:	db	2		; step rate --> 25 us

hd_charact:			; drive characteristics
				; 614 cylinders, 4 heads 
	db	2		; last cylinder  (msb)
	db	67h		; last cylinder  (lsb)
	db	4		; 4 heads
	db	02h,58h  	; start cyl reduced wr current
	db	01h,2ch		; start cyl wr precomp
	db	0		; always zero

ifield:	db	0,0,0,0,0	; hard disk init-parameter field
								
			

*EJECT
;table of driver entry vectors:
$VDINIT	EQU  0    		;initialize the video controller chip M6845
$RSINIT	EQU  1    		;initialize the RS-232-C interface
$KBCHAR	EQU  2    		;get a keyboard character if available
$KBWAIT	EQU  3     		;wait for a keyboard character
$VDCHAR	EQU  4    		;display a character
$PRSTAT	EQU  5    		;test printer status
$PRCHAR	EQU  6    		;output a character to the printer
$RSRCST	EQU  7    		;get a character from the RS-232-C interface if
				;available
$RSRCV	EQU  8    		;receive a character from the RS-232-C
				;interface
$RSTXST	EQU  9    		;test the RS-232-C output status
$RSTX	EQU  10    		;transmit a character to the RS-232-C interface
$READ	EQU  11   		;read a disk sector
$WRITE	EQU  12   		;write a disk sector
$GETTIM	EQU  13   		;get time and date in binary format
$SETTIM	EQU  14   		;set time and date in binary format
$XMOVE	EQU  15			;interbank data transfer
$GTIME3	EQU  18			;get time and date in CP/M 3 format
$STIME3	EQU  19			;set time and date in CP/M 3 format
$LDCHAR	EQU  20			;load bit pattern into character RAM
$RSTCHR	EQU  21			;restore original character set
$SCRNIO EQU  22			;direct screen I/O
$INIT	EQU  23			;general system initialization
$CLOCK	EQU  24			;turn clock display on/off
$DISP	EQU  25			;turn on/off graphic display
$CLS	EQU  26			;clear graphic screen
$PLOT	EQU  27			;plot dot    on graphic screen
$POINT	EQU  28			;read dot  from graphic screen
$LINE	EQU  29			;draw line   on graphic screen
$CIRCLE	EQU  30			;draw circle on graphic screen
$ARC	EQU  31			;draw arc    on graphic screen
$COPY	EQU  33			;copy area

;call ROM driver routines:
?USERF:	LD   (SAVESP),SP	;save stack pointer
	LD   SP,0E100H  	;temporary stack --> stack pointer
        PUSH BC			;save register set
	PUSH DE
	PUSH HL
	PUSH IX
	PUSH IY
	DI			;disable interrupts
       	RST  0     		;call driver routine
	PUSH AF    		;save accu
	LD   A,11010101B	;disable memory mapped I/O
				;disable graphic display
				;disable boot EPROM
				;disable graphic page
				;7.2 MHz clock frequency
				;enable video display
	OUT  ($SYS1),A		;write system byte 1
	POP  AF    		;restore accu
	POP  IY			;restore register set
	POP  IX
	POP  HL
	POP  DE
	POP  BC
	LD   SP,(SAVESP)	;restore stack pointer
	RET			;return to caller

SAVESP: DEFS 2			;temporary memory for stack pointer


*EJECT
@TRK:	DEFS 2			;current track number
@SECT:	DEFS 2			;current sector number
@DMA:	DEFS 2			;current DMA address


ALV0    EQU  $
DIR     EQU  ALV0+203
DATA   	EQU  DIR+512 
SPARE$DIRECTORY EQU DATA+512 

	END
LD   SP,0E100H  	;temporary stack --> stack pointer
        PUSH BC			;save register set
	PUSH DE
	PUSH HL
	PUSH IX
	PUSH IY
	DI			;disable interrupts
       	RST  0     		;call driver routine
	PUSH AF    		;save accu
	LD   A,11010101B	;disable meееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее;******************************************************************************
;*  L D R B I O S  *  C P M S Y S 3  *	T h o m a s   H o l t e * 8 5 1 1 2 0 *
;******************************************************************************
;*									      *
;*		 M I N I M U M	 B I O S   F O R   C P M L D R		      *
;*		 =============================================		      *
;*									      *
;*									      *
;*  Thomas Holte						 Version 1.0  *
;*									      *
;******************************************************************************

;
; Ausserdem wurde die gesamte Copyright-Geschichte entfernt, da ich
; mit einem Z180 arbeite, und die Routine ILLEGALs enth{lt !!!!!!
;

	.Z80

;ASCII control codes:
BEL	EQU  07H		;bell
LF	EQU  0AH		;line feed
CR	EQU  0DH		;carriage return
SUB	EQU  1AH		;substitute
ESC	EQU  1BH		;escape
RS	EQU  1EH		;record separator

$SYS1	EQU  0FAH		;system byte 1

PUSHHL	EQU  0E5H		;machine code of PUSH HL

;BIOS jump vector.

;All BIOS routines are invoked by calling these entry points.

?BOOT:	JP   BOOT		;initial entry on cold start
	JP   DUMMY		;not used jumps in LDRBIOS
	JP   DUMMY
	JP   DUMMY
?CONO:	JP   CONOUT		;send console output character
	JP   DUMMY		;not used jumps in LDRBIOS
	JP   DUMMY
	JP   DUMMY
?HOME:	JP   HOME		;set disks to logical home
?SLDSK:	JP   SELDSK		;select disk drive, return disk parameter info
?STTRK:	JP   SETTRK		;set disk track
?STSEC:	JP   SETSEC		;set disk sector
?STDMA:	JP   SETDMA		;set disk I/O memory address
?READ:	JP   READ		;read physical block(s)
	JP   DUMMY		;not used jumps in LDRBIOS
	JP   DUMMY
?SCTRN:	JP   SECTRN		;translate logical to physical sector
	JP   DUMMY		;not used jumps in LDRBIOS
	JP   DUMMY
	JP   DUMMY
	JP   DUMMY
	JP   DUMMY
	JP   DUMMY
	JP   DUMMY
	JP   DUMMY
?MOVE:	JP   MOVE		;block move memory to memory
	JP   DUMMY		;not used jumps in LDRBIOS
	JP   DUMMY
	JP   DUMMY
	JP   DUMMY


;EJECT
BOOT:
;====

;Initial entry point for system startup.

	JP   ?INIT		;perform any additional system initialization
				;and print signon message


CONOUT:
;======

;Console output. Send character in reg. C to all selected devices.
	LD   A,C		;character  --> accu
	LD   C,4		;function # --> reg. C
	JP   ?USERF		;display char


HOME:
;====

;Home selected drive. Treated as SETTRK (0).

	LD   BC,0		;same as set track zero
	JR   SETTRK


SELDSK:
;======

;Select disk drive. Drive code in reg. C. Invoke login procedure for drive if
;this is first select. Return address of disk parameter header in reg. HL.

	LD   HL,MF0		;^extended disk parameter header --> reg. HL
	RET

;Extended Disk Parameter Header (XDPH)
	DEFS 8
	DEFB 0,0		;relative drive zero
MF0:	DEFW 0			;no translation table
	DEFW 0,0,0,0		;BDOS scratch area
	DEFB 0,0		;media flag
	DEFW DPB0		;disk parameter block
	DEFW CSV0		;checksum vector
	DEFW ALV0		;allocation vector
	DEFW DIRBCB		;DIRBCB alloc'd by GENCPM
	DEFW DTABCB
	DEFW 0FFFFH		;no HASH
	DEFB 0			;hash bank

;Disk Parameter Block (DPB)
DPB0:	DEFW 80			;128 byte records per track
	DEFB 4,15		;block shift and mask
	DEFB 0			;extent mask
	DEFW 389		;maximum block number
	DEFW 191		;maximum directory entry number
	DEFB 0E0H,0		;alloc vector for directory
	DEFW 48			;checksum size
	DEFW 2			;offset for system tracks
	DEFB 2,3		;physical sector size shift and mask

;directory buffer control block:
DIRBCB:	DEFB 0FFH		;drive
	DEFS 4			;record #, written ?
	DEFB 0
	DEFS 4			;track, sector
	DEFW DIR		;buffer address

;data buffer:
DTABCB:	DEFB 0FFH		;drive
	DEFS 4			;record #, written ?
	DEFB 0
	DEFS 4			;track, sector
	DEFW DATA		;buffer address


SETTRK:
;======

;Set track. Saves track address from reg. BC in @TRK for further operations.

	LD   (@TRK),BC
	RET


SETSEC:
;======

;Set sector. Saves sector number from reg. BC in @SECT for further operations.

	LD   (@SECT),BC
	RET


SETDMA:
;======

;Set disk memory address. Saves DMA address from reg. BC in @DMA.

	LD   (@DMA),BC
	RET


READ:
;====

;Read physical record from currently selected drive. Finds address of proper
;read routine from extended disk parameter header (XDPH).

FD$READ:LD   A,(@SECT)		;sector number	       --> reg. B
	LD   B,A
	LD   A,(@TRK)		;track number	       --> reg. E
	LD   E,A
	XOR  A			;absolute drive number --> accu
	LD   HL,(@DMA)		;user buffer address   --> reg. HL
	LD   C,11		;function number       --> reg. C
	CALL ?USERF		;read physical disk sector
	OR   A			;any errors ?
	RET  Z
	LD   A,1		;common error code
	RET


SECTRN:
;======

;Sector translate. Indexes skew table in reg. DE with sector in reg. BC.
;Returns physical sector in reg. HL. If no skew table (reg. DE = 0) then
;returns physical = logical.

	LD   L,C
	LD   H,B
	RET


MOVE:
;====
	EX   DE,HL		;we are passed source in DE and dest in HL
	LDIR			;use Z80 block move instruction
	EX   DE,HL		;need next addresses in same regs
DUMMY:	RET


;EJECT
?INIT:	DI			;disable interrupts
	IM   1			;interrupt mode 1 (RST 7)
	LD   C,23		;function # --> reg. C
	CALL ?USERF		;general system initialization

	ret			; Einfach wieder zur}ck zum Aufrufer !
	


;EJECT
;table of driver entry vectors:
$VDINIT	EQU  0			;initialize the video controller chip M6845
$RSINIT	EQU  1			;initialize the RS-232-C interface
$KBCHAR	EQU  2			;get a keyboard character if available
$KBWAIT	EQU  3			;wait for a keyboard character
$VDCHAR	EQU  4			;display a character
$PRSTAT	EQU  5			;test printer status
$PRCHAR	EQU  6			;output a character to the printer
$RSRCST	EQU  7			;get a character from the RS-232-C interface if
				;available
$RSRCV	EQU  8			;receive a character from the RS-232-C
				;interface
$RSTXST	EQU  9			;test the RS-232-C output status
$RSTX	EQU  10			;transmit a character to the RS-232-C interface
$READ	EQU  11			;read a disk sector
$WRITE	EQU  12			;write a disk sector
$GETTIM	EQU  13			;get time and date in binary format
$SETTIM	EQU  14			;set time and date in binary format
$XMOVE	EQU  15			;interbank data transfer
$GTIME3	EQU  18			;get time and date in CP/M 3 format
$STIME3	EQU  19			;set time and date in CP/M 3 format
$LDCHAR	EQU  20			;load bit pattern into character RAM
$RSTCHR	EQU  21			;restore original character set
$SCRNIO	EQU  22			;direct screen I/O
$INIT	EQU  23			;general system initialization
$CLOCK	EQU  24			;display tim continuously
$DISP	EQU  25			;turn on/off graphic display
$CLS	EQU  26			;clear graphic screen
$PLOT	EQU  27			;plot dot    on graphic screen
$POINT	EQU  28			;read dot  from graphic screen
$LINE	EQU  29			;draw line   on graphic screen
$CIRCLE	EQU  30			;draw circle on graphic screen
$ARC	EQU  31			;draw arc    on graphic screen
$COPY	EQU  33			;copy area


;call ROM driver routines:
?USERF:	LD   (SAVESP),SP	;save stack pointer
	LD   SP,0E100H		;temporary stack --> stack pointer
	PUSH BC			;save register set
	PUSH DE
	PUSH HL
	PUSH IX
	PUSH IY
	DI			;disable interrupts
	RST  0			;call driver routine
	PUSH AF			;save accu
	LD   A,11010101B	;disable memory mapped I/O
				;disable graphic display
				;disable boot EPROM
				;disable graphic page
				;7.2 MHz clock frequency
				;enable video display
	OUT  ($SYS1),A		;write system byte 1
	POP  AF			;restore accu
	POP  IY			;restore register set
	POP  IX
	POP  HL
	POP  DE
	POP  BC
	LD   SP,(SAVESP)	;restore stack pointer
	RET			;return to caller

SAVESP:	DEFS 2			;temporary memory for stack pointer


;EJECT
@TRK:	DEFS 2			;current track number
@SECT:	DEFS 2			;current sector number
@DMA:	DEFS 2			;current DMA address


CSV0	EQU  $
ALV0	EQU  CSV0+48
DIR	EQU  ALV0+49
DATA	EQU  DIR+512

	END
reen
$ARC	EQU  31			;draw arc    on graphic screen
$COPY	EQU  33			;copy area


;call ROM driver routines:
?USERF:	LD   (SAVESP),SP	;save stack pointer
	LD   SP,0E100H		;temporary stack --> stack pointer
	PUSH BC			;save register set
	PUSH DE
	PUSH HL
	PUSH IX
	PUSH IY
	DI			;disable interrupts
	RST  0			;call driver routine
	PUSH AF			;save accu
	LD   A,11010101B	;Г§COPYRIGHT (C) 1980 DIGITAL RESEARCH                                                                                               °?      OVL

LINKING $
$   1L9M9НИНЩ!Ћ96 Нw:o9Ц Жяџ!Ќ9¦ТОНDНБ:€Тк! "‹"Ќ! "‰"ЏНб! "¤9*¤9^#Vл"¦9"q::u9ю КНҐНи6*Џл*=;"`:"b:q:b:Нћ8Ъ.К9Нв6`:q:Нћ8"Ё9Н|!Ћ96НwНj1:Ќ9ТRН,Н  ыv!<q:t9юXВm*<MНx6Г|:t9юYВ|*<MН~6Й!<p+q*<~ю$Кќ*<NНW*<#"<ГѓЙ:t9юYВ±!s96 L9Н}Й!<q:s9ТАНћ*<MНWЙ!<p+q:s9ТШНћ*<DMН}Й:€Т
*.:#"n;е*r;Б	"–;е*љ;Б	"ѕ;е*В;Б	"ж;*‰+"¬:*‰"®::€Т,*к;л*ж;"°:Г3*.:#"°:*‹+"Ы:*‹"Э:*‰л*°:"Я:*Ќ+"
;*Ќ";*‹л*Я:";*Џ+"9;*Џ";;*Ќл*;"=;Й!]:6 >!]:ѕЪ¤*]:& f;)	N#FН‹4НЫ1!]:4ВЃЙ:u92ё:2з:2;2E;2u;2ќ;2Е;2н;Й!D:6 +6 !E:6 ! "p9!  "m9}2o9!z962v92x92w9!t96XЙ!  "y:"{:"}:":"Ѓ:"ѓ:"…:"‡:"‰:"‹:"Ќ:"Џ:"‘:"“:"•:"—:"i:"k:"m:"o:}2™:!љ:6#6#6*¦9"q:2C:2D:2E:2R:!яя"X:o& "Z:Н|!яя"s:!  "p;";"А;"и;"Є:"Щ:";"7;*‰+"¬:*‹+"Ы:*Ќ+"
;*Џ+"9;! "І:"б:";"?;!  "ґ:"г:";"A;Й:Џ9ю ВЙ*b:Й:Џ9=o& ))ђ9	 	^#VлЙ!<p+q!<6 >!<ѕЪ4*<& ^<)	л<Нћ8Ъ-*<& ^<)	^#Vл"d:НMе*<& ^<)	Бq#pГу!<4ВкЙ*Џ9& ))ђ9	 	е*`:лбs#r *A:ЂяН)8"p9е*Џ9& ))ђ9	Бq#pЙ:Џ9<2Џ9O>№ТНDЙ:Џ9=2Џ9юяВЏНD:Ћ9Ъ—Й*Џ9& ))ђ9е	^#Vл"p9б	 	^#Vл"`:*`:DMНЯЙ!Ќ96#~ТОНтН¬.":\ 
-ВЩ:+:ю Вщ.+:‘
-Вс:Ћ9Т”НИ":Н5ЎНИ*.:~ю=ВН¬:Ћ9Т(Нж'*.:~Ц(Жяџ*.:х~Ц)ЖяџБHЎТ^*.:~ю,КNНDН¬:Ћ9Т[Нж'Г(:Ћ9ТvНC(Н)!o96Н>Н5Й!†B".:Н¬.":\ 
-В€*.:~ю=ВџН¬ГЇ.+:¤
-В§:Ћ9Т№Нж'*.:~Ц Жяџ*.:х~Ц(ЖяџБHЎТп*.:~ю,КЯНDН¬:Ћ9ТмНж'Г№:w92y9:Ћ9ТF:Ќ9ТН(НC(Н†7:Ќ9ТН):o9ЦЦџх:o9ЦЦџБH±Т4!  "p9Н>:o92Љ9*p9"‹9Н5*.:~ю(Вђ*.:~ю КђНnНА*.:~ю)ВpНЂНРГ^*.:~Ц Жяџ*.:х~Ц(ЖяџБHЎТЌНDГO:Џ9ю К›НDЙ*НІ!Ђ 6~Ђ Н„6*Ѓ & ‚ 	6 :Ѓ <oе*.:#л‚ б
-ВЖНІ
НІЙ!‡B".:.Ђ†BЂ 
-Вз*.:~ю К*.:~ю&ВНњ*.:#".:ГпЙ =.:<>[],()?$! <q: <ю Т,>Й: <ЦaO>№Ъ@: <ж_2 <: <Й!€B"!<.:!<Нћ8Ъѓ*!<NНOНІ*!<~ю&ВyНІ
НІ*НІ*!<#"!<ГJНв6Й!#<6 >!#<ѕЪІ*#<& 	:<ѕВ«>Й!#<4ВЏ> Й*.:#".:*.:NН2<ю&КМЙГµЙНµ:<ю ВбНµГУЙ!<6 !%<6 +6я:%<юТ
	:%<юВ	!<6 Нё	Гп!\ 6 НРНЉТ	!яяЙ!%<6 НЉЪ>	:%<юЪ5	!яяЙНё	НµГ"	:<ю:В„	:\ Ц Цџх:%<ЦЦџБHЎЪb	!яяЙ:] ЦA<2\ O>№Тv	!яяЙ*%<& \ 	6 Гґ	!%<6:<ю.В°	НµНЉЪ°	:%<юЪ§	!яяЙНё	НµГ”	!  ЙГ	Й:%<<2%<O !\ 	:<wЙ:<Ц0O>	№Ъе	:<Ц02<>ЙГю	:<ЦAO>№Ъю	:<ЦAЖ
2<>Й> Й!  "&<НµНЉЪ6
НЛ	Т-
*&<))))е*<& Б	"&<Г0
НDНµГ

*&<Й:<ЦAO>‘џ/ЙНµН:
ТW
:<ЦA<ЙНDЙНµН:
Тl
:<ЦA<Й:<юZВw
>ZЙНDЙНµ:<ЦXO>№ЪЋ
:<ЙНDЙ:<Ц]Жяџх:<ЦЖяџБHЎТ НР:<юSВА
!_:6НµГќ:<юBВШ
!r96!o96НµГќ:<юPВо
!C:6Н
"F:Гќ:<юDВ!D:6Н
"H:Гќ:<юLВН
"p9Гќ:<юMВ&Н
"m9Гќ:<юOВzНµ:<юPВA!o96Гt:<юCВQ!o96 Гt:<юRВa!o96Гt:<юSВq!o96ГtНDНµГќ:<юAВЌ!€6НµГќ:<юQВ !z96 НµГќ:<юGВв!E:6Нµ!Q:6 НЉЪЯ>!Q:ѕТИНD*Q:& J:	:<w!Q:4НµГµГќ:<ю$ВfНР:<Ц,Жяџх:<Ц]ЖяџБHЎТc:<юCВН{
2t9Г]:<юIВ'НF
2u9Г]:<юLВ8НF
2v9Г]:<юOВIН[
2w9Г]:<юSВZН[
2x9Г]НDНРГнГќ:<юNВљНµ:<юLВЃ!t96ZГ”:<юRВ‘!x96ZГ”НDНµГќНDГ’
:<юК«НµЙ!_:6 НвяяН—8µВБНD:<ю ВМНР:<ю[ВЧН’
:<ю ВвНРЙ*:#":л!:Н№8Ъ	!  ":†@Е*:DMь9НЏ5*:†@	~ЙНг!ъ9†2(<Нг!ы9†2)<юЂЪ7:)<ЦЂ2)<!(<4Нг2*<ЙН!Ў:6 Нг2-<ююТs*Ў:& ў:	:-<w:Ў:<2Ў:юЪp©=Нв6ГFЙЂ *(<& Н\8е*)<& Б	"+<л!ц9Н№8џ/ш9+<хНћ8џ/БHЎТДц9+<Нћ8Ђ Н\8е**<& Б	+"1:Гь!h :(<ѕКк:(<2h \ Н•6юяВе©=Нв6!| 6я:)<2| Н/ **<& +"1:Й*:":Н>> !Ў:ѕТ*!^:6 Н+":^:Т$НtН8'Н>ГЙ *0<	~ЪL *0<	DMНB5 *0<	6*0<N#FЕ *0<	 е*0<	гN#FСН”5Й!2<q*0<##N#F*.<	:2<w*0<##N#F+q#pЕ *0<	СН№8Ъ©Н+*0<##> w#6 Й!4<p+q*3<}OНk*3<|OНkЙ*0<N#FЕ *0<	 е*0<	гN#FСНЏ5Й*0<##N#F+q#pЕ *0<	СН№8Ъ
НБ*0<##> w#6 *0<##N#F*.<	~ЙНахНаO `iН~8сНp8Й!6<p+q*5<"0<^#Vл".<ЙяНk *0<	~Т™*0<##> Н¶8µКiНkГS *0<	DMНv5 *0<	DMНd5 *0<	е*0<##гN#Fбq#pГ¤*0<##яяq#pЙ*u:#^#VлЙ *u:	^#VлЙ *u:	^#VлЙ*u:~жюжЙ*u:~жьжЙ*u:>¦Й*u:~Й *u:	^#VлЙ *w:	^#VлЙ!8<p+q*u:#е*7<лбs#rЙ!:<p+q *u:	е*9<лбs#rЙ!<<p+q *u:	е*;<лбs#rЙ!=<q*u:>ы¦х:=<ж‡‡БH±wЙ!><q*u:>ч¦х:><ж‡‡‡БH±wЙ!?<q*u:>п¦х:?<ж‡‡‡‡БH±wЙ!@<q*u:>ь¦х:@<жБH±wЙ!B<p+q *u:	е*A<лбs#rЙ!D<p+q *w:	е*C<лбs#rЙ!I<s+p+q!  "E<*I<& i:)	^#Vл"u:> Н”8µВщ> ЙНҐG<Н®8Т'*u:"w:*E<#"E<Нє"u:> Н”8µВ$> ЙГщНҐG<Н®8µЦџЙ!T<s+p+q+СБq+Бq+Бq+Бq+Бp+q+Бp+qХ> J<Н«8µЦџх:P<Ц ЦџБHЎТrЙ:Q<ТЃ!U<6	Г†!U<6:U<q:Н«8л+s#r!`:Н№8ТЈЄ9Нв6:T<Тє*J<DM*P<лНОТє*q:"u:6 *J<DMН> E<Н«8µВй*P<& i:)	N#FН,ГсНхDMН,*L<DMН:Q<Т*R<DMН *O<MНC*N<MН‹*Q<MНZ*Ё=MНr> E<Н«8µВF*P<& i:)	е*q:лбs#rГN*q:DMН·Й!V<6 >!V<ѕЪ·!  "Y<*V<& i:)	^#Vл"u:> u:Н«8µКќНє"W<*Y<DMН,*u:"Y<*W<"u:Гt*V<& i:)	е*Y<лбs#r!V<4ВTЙНO![<6 >![<ѕЪ,*[<& i:)	^#Vл"u:*[<& <)	N#FН.> u:Н«8µК%НдOНkНҐDMНЄН®DMНЄНСТНйDMНЄНє"u:Гк![<4ВА!  "i:"k:"m:"o:Й*d:##6  *d:	6 Й*d:^#VлЙ!`=p+q*d:е*_=лбs#rЙ *d:	>¦Й!a=q *d:	:a=¶wЙ*d:##>?¦Й!b=q*d:##:b=¶wЙ*d:##~жажЙ*d:##>ж¶wЙ*d:##~жАжЙ*d:##>ж¶wЙ *d:	~жЙ!c=q *d:	>¦х:c=жБH±wЙН„d:Н8++"\<*\<^#VлЙ!e=p+qН„d:Н8++"\<*\<е*d=лбs#rЙ *d:	^#VлЙ!g=p+q *d:	е*f=лбs#rЙ *d:	~жржЙ!h=q *d:	>џ¦х:h=ж‡‡‡‡‡БH±wЙ!k=s+p+q!^=6 :k==2k=юяК±*i=:^=†2^=*i=#"i=Г‘:^=ж2^=Й!n=s+p+qНЅ"d:`:d:Нћ8ТН№Т Нh!n=ѕВ *l=е *d:	DM*n=лН>*Т >ЙН„d:Н8л+s#rГИЙ!r=s+q+СБp+qХ*o=DM*q=лН„*^=& ^<)	^#Vл"d:> d:Н«8µК†Нh!q=ѕВ}*o=е *d:	DM*q=лН>*Т}НUЦЦџ!r=®Ъ}>ЙНM"d:Г<> Й!|=r+s+q+СБq+Бq+Бp+q+Бq+Бp+qХ:u=Ж2}=:z=Тє!}=44*`:"d:е*}=& Б	"`:q:Н®8ТЪЄ9Нв6Н<*s=DM*u=лН„*^=& ^<)	N#FНU*^=& ^<)	е*d:лбs#r*}=MНЌ*v=DMН>*y=MНа*u=MНs*x=MНf*u= е*d:	л*s=DMб
-ВB:z=ТY*{=DMН *d:	~ю#Вk!{96Й
MODULE TOP   $UNDEFINED START SYMBOL: $YY????  $$$XX????  $$$RQST$
UNDEFINED SYMBOLS:
$ABSOLUTE     $CODE SIZE    $DATA SIZE    $COMMON SIZE  $USE FACTOR     $!Ѓ=q*Ѓ=MНІ!~=4Й!‚=q>	!‚=ѕЪ8:‚=Ж0OНІГC:‚=Ц
ЖAOНІЙ!ѓ=q:ѓ=жшOН:ѓ=жOНЙ!…=p+q!„=Н„8MНD>я„=Н08MНDЙ:њ;!t;¶!Д;¶!м;¶ТБ:u;2\ .] •
-Вџ\ Н©6!t;6 !њ;6 !Д;6 !м;6 Й!‡=6 +6 >!†=ѕЪ*†=& f;)	^#Vл"= *=	~Т
 *=	DMНv5 *=	6 !‡=6:†=<2†=ВК:‡=Т7:ё:2\ .]  
-В)\ Н©6Й*p9###H:Н®8џ!D:¦ТU!\:6 ГЬ*p9###F:Н®8џ!C:¦Тr!\:6 ГЬ*p9###X:Н®8Т‰!\:6 ГЬ:R:ТД> S:Н«8µЦџх:U:ЦЦџБHЎх:C:/БHЎТј!\:6 ГБ!\:6ГЬ:E:!C:¶ТЧ!\:6ГЬ!\:6 Й:C:Тн*F:"“:Г:\:Т *p9###"“:Г*p9"“::D:Т*H:"—:Г8*ѓ:л*“:"—::r9Т8я *—: яН)8"—:*‡:л*—:"•:Z:X:Нћ8Т_X:Z:Нћ8#"y:Гe!  "y:Й!ќ:6 *X:"‘:!€=6 >!€=ѕЪћ*€=& y:)	> Н¶8Т”НҐ:€=<2€=Вv!  "‘:Й:ќ:2‰=!Љ=6 :€=#w:‰==2‰=юяК*‹=& ‘:)	е*Љ=& ™:	N !‘:		СН 8Т*Љ=& ™:	~2Њ=*Љ=& 	:‹=w:Њ=2‹=:Љ=<2Љ=Гµ*Љ=& ™:	:‹=w:ќ:<2ќ:Й*b:"d:`:d:Нћ8ТqНњ/хНФ!Ќ9¶БHЎТ`Н2еНUO !‘:		СН8DMН>НЄН„d:Н8л+s#rГ&Й!]:6 >!]:ѕЪ7*]:& f;)	N#FН‹4:€Те*]:& <)	N#FН.НBНа2ђ=:ђ=юяКвН"‘=Н"“=:ђ=жO> №ТЦН"•=НnНа2ђ=Г°Г-*]:& i:)	^#Vл"u:> u:Н«8µК-Нд2ђ=НҐ"‘=Н®"“=НСТ!Нй"•=НnНє"u:Гц:]:<2]:ВwЙ!љ=r+s+p+q*™=}*—=_DMН4*—=#е*™=|_БН4Й!њ=p+q*›="d:Н2Й:ђ=ж2Џ=:ђ=жO> №Тђ*“=DMН^"Ќ=ГЈ*Џ=& ‘:)	“=Н8"Ќ=:ђ=жO> №Те:ђ=жO> №ТЪ•=Ќ=Нћ8еНUO !‘:		СН№8"Ќ=Ге*•=л*Ќ="Ќ=*‘=DM*Ќ=лН8Й *d:	~Ц Жяџ*d:	х:‡–Цџ!z9¦/БHЎЙ!  "џ=НЅ"d:`:d:Нћ8ТЕНФхНтБHЎТґ>џ=Н08> Н”8µВSНШ6!~=6 НUюВ`/ННwНUюВp/Н>џ=Н08 Н\8	 MН`Н№Т–«НИГћН2DMН_ Н Н Н*џ=#"џ=Н„d:Н8л+s#rГ > !џ=Н¶8ТУНШ6!ћ=6> #w#6 2~=НЅ"d:`:d:Нћ8ТNНФ/Т=:ћ=Т!ћ=6 °НИ>џ=Н08> Н”8µВ'НШ6!~=6 Нw*џ=#"џ=>Н&8)))MН`Н„d:Н8л+s#rГи> !џ=Н¶8Т\НШ6НШ6Й!Ў=q!Ў=:~=ѕТv НГdЙ!ќ=6Нh!ќ=ѕЪ¤:ќ==O ! 	л*d:NН:ќ=<2ќ=В|Й:E:Т J:Е*Q:M НТЖН2"V:Гэ!  "V:|НИ!ў=6:Q:!ў=ѕЪъ:ў==O !J:	NНІ:ў=<2ў=ВЧНШ6ГD:R:Т*U:& ‘:)	S:Н8"V:ГD> !{:Н¶8Т1*“:"V:ГDяяX:НЈ8µКD*X:"V:ЙЗНИZ:X:Нћ8ЪmX:Z:Нћ8#DM*X:лНвГv    НвНШ6ХНИ*ѓ:DM*“:лНвНШ6гНИ*…:DM*•:лНвНШ6сНИ*‡:DM*—:лНвНШ6яНИ`:s:Нћ8Ё9Н®8е*Ё9|<o& СН=8KНDНШ6Й!¦=r+s+p+q*Ј=DMН_> Ј=Н«8µВЙ НІ(НІ*Ґ=DMН_-НІ*Ј=л*Ґ=+DMН_)НІЙlНИ*|9DMН_НШ6ЙН8НЭНfН НҐНOНr:t9юZК^ННEНФ.:€ТnН~:x9юZКyНU/НВЙ?OVLAY?OVLA0RELIRLIRLRELНс)хНс)O `iН~8сНp8Й> !Ў:ѕТЭ!>6:Ў:!>ѕЪЭ:>=O !ў:	NНІ!>4ВЅЙНс)2ћ:Н•"џ:ЙНс)2Ў::Ў:ю В !Ў:6!>6:Ў:!>ѕЪ. Нс)жх:>=O !ў:	БHq!>4В ЙЂ *h & Н\8е*| & Б	"ц9†>Е*7:DM\ НЏ5л*ц9+"ш9Й!>q:>2]:*]:& f;)	N#FН‹4Й!>q:]:ЦЦџ!f:¦ТЋ Й*]:& y:)	N#F*>лН4:]:ю ВО Z:y:Нћ8Тј *y:"Z:X:y:Нћ8ТО *y:"X:*]:& y:)	N#F+q#pЙ!>s+p+q:ћ:2>O !Ѓ:		џ:Н8">*>DM*>лНОТh!Н®"!>НЭ2>:>Ц Цџх> !>Н«8µЦџБHЎТA!Н±!">ГG!*!>">*>DMН*>MНC:>ю Вe!*]:MН‹Г !*>е*>е*]:е*>е*>е Е   Н5:§=Т¬!Н±!"!>> Н”8µВћ!Й*!>">!>6 Г­!ЙГ !Й:]:2%>*>MН^ *>DMНЬ4х*>#DMНЬ4O `iН~8сНp8"#>*%>MН^ *#>Й*b:"d:`:d:Нћ8Т%" *d:	~ю#В" *d:	6 Н„d:Н8л+s#rГт!!{96 Йў:Е*Ў:M НТH"НФЪH"!^:6Йў:Е*Ў:MНТi"Н2"g:Нњ2f:Гo"ц=Нв6Й*Ў:::ў:
-Вy":Ў:29:Й*Ў:лў:Нє/Тґ"ў:Е*Ў:е  Е ЕЕ   Н‰НЖЙў:Е*Ў:MНТс"Ныл!џ:Н№8То"/НІНЇ/НІ НІЭ=НИНШ6Г#ў:Е*Ў:е*Џ:л*‡:еЕЕ*џ:лН‰*џ:л*Џ:"Џ:Йў:Е*Ў:M Н/ТI#ў:Е*Ў:е  Е Е Е   Н‰*d:DMНб Йў:Е*Ў:M НТџ#НФТ{#µ=НИНЇНШ6Гњ#*ћ:& Ѓ:)	џ:Н8DMН>На*ћ:MНfГЗ#ў:Е*Ў:е*ћ:& Ѓ:)	џ:Н8е*ћ:еЕ   Н‰Й*]:& y:)	N#FЕ  Е Е Е*]:еЕ*џ:DMН5Й!Ё=6НИ#!Ё=6 Й*џ:"Ќ:Й*ћ:MН^ :]:юВ$$*g:л*џ:":ГC$*]:& Ѓ:)	џ:Н8е*]:& y:)	Бq#p:]:ю ВP$!§=6Й*]:& y:)	N#F Нб Й*џ:"‹:Й> !џ:Н¶8џх:ћ:Ц ЖяџБH±ТІ$:R:Т”$Л=Нв6ГІ$*ћ:& Ѓ:)	џ:Н8"S::ћ:2U:!R:6:0:юКЖ$Нс)ТГ$ГІ$!&>6>!&>ѕЪ%%*&>& Ѓ:)	е*&>& ‰:)	СН8е*&>& Ѓ:)	Бq#p*&>& Еy:)	Бq#p*&>& ‰:)	> w#6 :&><2&>ВЛ$s:q:Нћ8Т7%*q:"s::€ТG%Нё*¦9"q:Н^ :_:/2^::{9Т]%Нм!Й!)>s+p+q:)>юВ€%*g:л*'>"'>:f:Т…%!)>6 Гќ%*)>& Ѓ:)	'>Н8л+s#r*]:& y:)	N#F*]:лНОТЗ%*'>DMН*)>MН‹Гп%*]:& y:)	N#FЕ*'>е*)>е Е*]:е Е   Н5 Нy  Нy Й!*>q:*>юЪ	&НЮ>!*>ѕЪ&Нн:*>ю В#&Н+"Гї&:*>юВ1&Нp"Гї&:*>юВ?&Нk$Гї&:^:Тї&:*>=O !Ґ&		^#VлйНI"Гї&Гї&Н€"Гї&>НИГї&Нµ"Гї&Н#Гї&НT#Гї&Нт#Гї&НИ#Гї&Н $Гї&Н$Гї&НQ$Гї&Нd$Гї&W&]&`&f&o&u&{&Ѓ&‡&Ќ&“&™&џ&Й!+>6Нс)ю Ви&Нс)2->:^:Те&*->MНy Г('Нс)2,>ю В'Нс)2+>:+>юТ'*+>MНъ%Г('Н•".>:^:Т('*.>DM*,>лН^%:+>ЙНА&юК7'Г,'Й!0:6НА&юКH'Г='Й!0:6! "1:"7::!:ТЕ'*: Н—8"1:"7:. ь9\ 
-Вu'Нс)2ъ9!h ѕК¦':ъ92h \ Н•6юяВ¦'\ ©=Н45Нс)2| 2ы9!:6*7:"1:!  "ц9"ш9Н^ :_:/2^::!:!_:¦Тв'НэГе'Н,'Й:e жю В (.e ‰
-Вш'ЊЕe Н>*2!:\ Нd5НI'Й}Е Н/ТB(}ЕЕ  ЕЕ Е   Н‰ЙНЅ"d:`:d:Нћ8Т)Н№Тю(:v92\ !0>6>!0>ѕЪЇ(Нh!0>ѕТ€(*0>& \ 	6 ГҐ(:0>=O ! 	л*d:е*0>& \ 	Сw:0><20>Вg(!!:6.e Џ
-Вј(\ НW5/Тк(!!:6 .e ’
-ВЬ(\ Нd5*d:"1>!_:6НI'*1>"d:Н„d:Н8л+s#rГI(Й.ў:ѓ
-В)!Ў:6!ћ:6Н^ НЅ"d:`:d:Нћ8Тр)НФ/ТЯ)*{:DMН>НfНy  Н^%ГНy ! "џ: Нy  Нy *d:"4>Н#*4>"d:!3>6>!3>ѕЪЕ)Нh!3>ѕЪ¶):3>=O ! 	л*d:NНy Г») Нy :3><23>ВЊ) *ѓ:"ѓ::€ТЯ)Нё*¦9"q:Н„d:Н8л+s#rГ5)Й !0:4~ю	Ъ(*6*1:#"1:л*7:{•zњЪ*!  "1:ЕН/ Б*1:л!†>~26>xжюG:6>26>ж°GВу)xЙ{бг_
ѕВP*#ВB*>ЙЇЙ`i q#zіВV*ЙCOMPRLRSPSPROVLSYM!;>q*5:†>	:;>w*5:#"5:л!3:Н№8Ъ¦*†>Е*3:DM\ Н”5!  "5:Й!<>q:8>!<>¶28>:7><27>юВУ*!7>6 *8>MНq*!8>6 Й!=>q*=>MНq**A:#"A:Й!?>p+q*>>}OНФ**>>|OНФ*Й:ќ:ю В+Й:o9ю К+Нh,*p9"A::\:Т,+ГНФ**V:DMНз**X:"‘:!@>6 :ќ:=!@>ѕЪq+*@>& ™:	N !‘:		лp9Нћ8Ъj+*@>& ™:	NНЌ+!@>4В7+:o9Ц Жяџх:o9ЦЖяџБHЎТЊ+Н-Й!C>q:C>ю Вў+*X:"D>Гі+*C>& ‘:)	^#Vл"D>D>A:Нћ8ТЕ+Ю9Нв6D>A:Нћ8ТЩ+ НФ*ГЕ+*C>& f;)	N#FН‹4*C>& y:)	> Н¶8Т,:C>ю В,*X:DMН',Г,  Н',|9A:Нћ8Т&,*A:"|9Й!G>p+q*F>"H>*C>& y:)	F>Н8+л!H>Н№8Ъg,*H>DMНЬ4OНФ* *H>"H>Т3,Й:ќ:=O !™:	N е!‘:		е!y:		СН8л*p9Н—8"A> НФ*б*A>DMНз* НФ*:o9юВБ,  Нз* НФ**p9DMНз*ГФ,*m9DMНз* НФ*  Нз* НФ*:r9Тл,*ѓ:DMНз*Гс,  Нз*!J>6>ф!J>ѕЪ- НФ*!J>4Вц,Й*p9"A::\:Т(- Н¦- Н¦-Н¦-!L>6 :ќ:=!L>ѕЪ|-*L>& ™:	~2K>ю Кu-*K>& ‘:)	A:Н 8Тe- Н¦-ГJ-:€Тr-Н.Гu-НУ-!L>4В--*p9л*A>A:Н®8Т•- Н¦-Г|-:7>ю КҐ- Н¦-Г•-Й!O>q*O>MН§**A:#"A:ЙM>A:Нћ8ЪН- Н¦-Г№-Н¦-Й*K>& i:)	^#Vл"u:> u:Н«8µК.НҐе*K>& ‘:)	СН8"M>Н№-Нє"u:Гд-Й*K>& <)	N#FН. *0<	~ТR. *0<	DMНd5 *0<	е*0<##гN#Fбq#pГ].*0<##яяq#pНа2P>:P>юяК¤.Не*K>& ‘:)	СН8"M>Н"¤9:P>жO> №Т.Н"¤9Н№-На2P>Гc.Й>5:Н08> Н”8µКѕ.Нq*ГҐ.†>Е*5:DM\ Н”5\ Нv5Й:w9юZВЭ.Й.\ ":
-Ве.:e ю В/.е*o9&  Н\8_*	DMe б
-В/:w9ю К#/:w92\ \ НB5:9ю ВA/.~9\ 
-В9/!  "5:}28>27>Ню*НҐ.Й:x9юZВ^/Й.	\ ":
-Вf/.e n*
-Вv/:x9ю КЊ/:x92\ \ НB5!  "5:}2R>НЅ"d:`:d:Нћ8Т(0Н№/хНтБHЎТ0Н2DMНv0 Нq*!Q>6Нh!Q>ѕЪч/:Q>=O ! 	л*d:NНq*:Q><2Q>ВП/:R><2R>жю В0Нq*
Нq*Г0	Нq*Н„d:Н8л+s#rГў/Нq*
Нq*НҐ.Й!S>q>	!S>ѕЪO0:S>Ж0OНq*ГZ0:S>Ц
ЖAOНq*Й!T>q:T>жшOН60:T>жOН60Й!V>p+q*U>|OН[0*U>}OН[0Й*9>л!Ђ Н=8л"W>*W>л!Ђ Н=8!Y>s:h ѕКК0:Y>2h \ Н•6юяВК0\ >6Н45*W>л!Ђ Н=8л!| sЙН2л*‹9Н—8"9>.\ ~9
-Вп0:Љ9ю К	1 *9>"9>\ Нd5НЌ0CЕ\  НЏ5л!Z>s*9>л!Ђ Н=8C	"¤9*¤9е*|9лбs#rНЌ0CЕЂ *Z>& Н\8DM\ Н”5:j ж2j \ Нv5Й:Ќ9ТЃ1 *|9ЂяН)8"|9:y9юZВЉ1Йa9Е НТџ1НЪ0Г±1g9Е НТ±1НЪ0Й!_>q. *[>	:_>wЙ *[>	~Й!`>q *[>	:`>wЙ *[>	 е*[>	^#VбN#FНR* *[>	6 Й*[>^#V!Ђ Н=8л"b>лН?8!a>sНВ1!a>ѕКP2 *[>	DMНv5*a>MНЛ1 *[>	DMН•6юяВP2 *[>	DMНL5*b>л!Ђ Н=8MНІ1Й *[>	
 е*[>	лБНћ8ТЌ2 *[>	
 е*[>	гN#Fбq#p *[>	~Ъ®2 *[>	DMНB5 *[>	6Ню1 *[>	N#FЕ *[>	 е*[>	гN#FСН”5НЫ1Й!e>p+q *[>	N#Fе*d>лН?8Н^8е*[>Бq#p*[> е*[>	СН8+е*[>##Бq#p*[> е*[>	N#Fб^#VН?8 *[>	s#rбЙ
 *[>	N#F`i"h> *[>	N#F`i"j>*h>"f>j>f>Нћ8Ъђ3*f>+ е*[>	^#VбН\8DMНЧ2Н_2 *f>"f>Т\3 *[>	^#V*j>Н\8DMНЧ2Й *[>	
 е*[>	лБНћ8Тѕ3ЙНю1 *[>	N#FЕ *[>	 е*[>	гN#FСНЏ5Й!n>s+p+q*[>l>Н 8Т4 *[>	~Т4Н_2*l>DMНЧ2Н¦3ГЉ4*[>##лl>Нћ8ТЉ4 *[>	~Т34Н_2*l>DMНЧ2:n>Тj4 *[>	
 е*[>	N#FPYбН№8Тd4Н63Гg4Н¦3ГЉ4 *[>	
 е*[>	лБНћ8Т‡4НЫ1ГЉ4Н¦3Й!p>p+q*o>"[>Й!s>s+p+q*q>DMНд3 *[>	^#Vл"]> *[>	N#F*q>лН?8л*]>:s>w *[>	6Й!u>p+q*t>DM Нд3 *[>	^#Vл"]> *[>	N#F*t>лН?8л*]>~Й
жю Д+5И{ю>.М+5Г5ЕХOНІСБЙХНИБН5w6Нв6ЕН©6БЕНЃ5БНѕ6<А56Нв6ЕНЃ5БН•6<И>ЙЕНЃ5БЕН•6<СА>6Н45Нњ6<АH6Нв6! 	Їw#В€5Й> Г–5>2,6бг""6л"$6yжЂo`"&6!  "*6Н‹6-6Ьв6*&6|µК6Ђя	"&6*"6MDНМ6*$6DM:,6ю Кл5Н·6·g6Дв6Г6Н°6·К6**6|µВ6U6*$6лН45*"6Ђ ""6**6#"*6Гє5Ђ НМ6**6Й           ABORTED$NO SPACE$NO FILE: $CANNOT CLOSE$DISK READ ERROR: $DISK WRITE ERROR$YГ YГ YP
Г Г Г YPГ ЕЂ НМ6СГ YPГ YPГ YPГ YPГ YPГ YPГ љГ НІ
ГІНИГ  !ѓ>6 #6 Нђ6"Ѓ>*Ѓ>|ю В$7>¦9Н«8"|>## е*|>	~б¶ю К!7!ѓ>6ГD7*Ѓ>|юВ?7!„>6НУ6µ "|>ГD7!ѓ>6:ѓ>ТY7!~>6я#6я#6яГ…7*|>~2~> *|>	~2>:„>Тz7:>цЂ2> *|>	~2Ђ>Й!…>6 >!…>ѕЪ°7*…>& v>	~/*…>& ў:	w!…>4В‹7ў:ЕНЪА7ЙН2"g:Н^ *:"|>	 *g:":*у9MНy *ф9MНy *х9MНy *~>MНy *>MНy *Ђ>MНy *|>":Йi`N#FЃo€gЙл_ л…oЊgЙ_ {Ґoz¤gЙл_ лҐo¤gЙDM!  >х)л—)лЌ‘o|gТV8	с=ВD8ЙDM!  >)л)лТk8	=Вc8Й_ {µozґgЙ^#Vл)В~8Й^#Vл|·g}oВ€8Й_ {•ozњgЙi`N#F‘ogЙo& •oњgЙ_ {–_z#ћWлЙ                                                                                                                                          LINK 1.31
$01/04/83?MEMRY$MEMRY     X                                                    MEMORY OVERFLOW, USE [A] SWITCH$INSUFFICIENT MEMORY$OVERLAPPING SEGMENTS$                                                                                                  яя                         яя                                                                XXABS   $$$                                   XXPROG  $$$                                   XXDATA  $$$                                   XXCOMM  $$$                     Є:Щ:;7;       YYABS   $$$                            YYPROG  $$$                            YYDATA  $$$                            YYCOMM  $$$                     n;–;ѕ;ж;                                                                                                                                                                                                                                                                                                                                                                                                                   INDEX ERROR$MULTIPLE DEFINITION: $MAIN MODULE ERROR$FIRST COMMON NOT LARGEST$COMMON ERROR$UNRECOGNIZED ITEM
$                                                                                               А№ЇЅ±§                                                     XXABS   $$$                                   XXPROG  $$$             ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее!
ГGMAC "'@</W ")@Ї;!м<_s#x±В!5O"A=w$$$$"@  	"@! ш"Г>!+@й=~·КvхжO#~ВQеНьСсжшw#6 #wлГDН„K>2м<Ї2@2Ѓ>2-=2у<2ф<2и=2х<2ъ?2д=!Т=
w#В—<2(=2.=2/=2С=>
2с<:€@2к<:Ќ@2*=>;23=<22=! "4=+"@+"6=*'@щ!Ме!6еЇ2[?21=2+=29=2ы?<2)=Н?беьЕй!H="F=„~№М#юКВБбеЕRЕйхе*4=#"4=!яя"6=:2==23=бсЙ!9=>2@2@Н–ю
КCНЖКC·тlжКCНЖКCю0ЪCw#ГCѓ!H=ю
КЋК~w#юВЋw:9=·И=28=ЙН–жГq:,=·КЁНфNРЇ2,=Н4OНMЪЇЙ! НМF>2H=НоJ>
НоJ7ГІ-юАГ!  "C=Ї20==2ы?*Ъ="Ю=:H=ю*Вн>$2H=Ц$2E=НUВю:К‹:E=·В$:й==В$НU!й=~ёТ4#>$Nwy#В*F=+~#юКїеН+НUНВЃ~·тЃ#~ю"КRюКRюВЃб*F=+"F=х:(=·КkН+схюКs·НьН-сю"Кx-юКЇ7ГD-б"F=Н+Гї:(=·К№Н1НьН-"C=лНjлц хН#ю:Вµсц@хНк
сНЫНUВН6:(=·КПНК’8НВ·х:(=·Вистlхж`Кkсты#~!
‡_ ^#Vлйж#NхН1!и	сГсю;ИюИ!H="F=*C=|µДU:(=·КlГЌ'!й=ь=Nwy#В3Й!>">!>  q#ВKЙН6НИ·КUеюКlю;КlННхсб:м<·В—:>юVК‹юMК‹юDК‹юXВЮ2[?НН~ГЮН+ГЮЕAГиЕCГиЕDГиЕEГиЕMГиЕNГиЕOГиЕPГиЕQГиЕRГиЕUГиЕVГиЕXех!>~ю Вьp:Ф>ц2Ф>сбБЙ%No END statement ГБ:к=ю.КЉю$К’ю[<РЦB·ш‡ЕХ_ !^#Vл:й==O~·К†·ъ[:к<‡~ВVюPТ[ГzюPТzж№Вzл=еA##ѕВy#ВhбЇ~СБЙб~жЖ_ Г=СС<Й!H	ЕХГ8!Р	ГЌМыjё‡®ЇЭу1UVТ%	,	-	.	/	F	G	*ОCI€DCR DCЂDDRDD*ЖDI NARND*жNIѓ SEGѓ"SET ZITѓ>YTE 3НALLSALL1ЬCj?CF1ьM/MA?MCёMP2ФNC2ДNZ…OMMONГOND1фPQ
Pr©PDs№PDR2мPE*юPIrЎPIs±PIRj/PL2дPOѓSEG1МZ 'AAj'AA	ADЃBЃC"CRCXRECѓEFBѓ"EFLѓEFMѓEFSѓEFWуIiуISJNZЃSѓSEGЃW ыIiыIГLSE‚	NDЈ
NDC¤
NDIF‹NDM„NTRY‚QUQXjЩXX„XITM‚XT‡XTERNAL„XTRN  … LOBAL kvALTvLT БFВ2FBД9FDIFВFEВFFД:FIDNГ3FNBВFTaM)ЫNQNRNC†8NCLUDErЄNDsєNDRrўNIsІNIR"NRNXВF1ВF2ДFDEFЕFNDEF’RP“RPC 1ЪC1ъM2ГMP2ТNC2ВNZ1тPQP2кPE2вPOQR1КZ  QD2:DA
DAXrЁDDsёDDRr DIs°DIR3*HLD„OCALJXI …8ACLIB”ACRO:@OVBVI ѓAMErDEG OPj OP QR°RA‚RG*цRIs»TDRsіTIR*УUTR UTs«UTDsЈUTI ѓAGEйCHLБOPR"OP… UBLICЕUSHS$USH  ALARШC“!EPTZ&ESЙETR(ETsMETIsEETN IMY*LjLALCZ,LCkLCAroLDшMРNCАNZрPиPEаPOY.RjRARCZ0RCkRCArgRD"ЗSTR2STИZ BB*ЮBIR4BCj7CFZ6ET‚"ET3"HLD0IMZ8LAщPHLZ:RAZ<RL22TATAX7TCђUBR>UB…#UBTTL*ЦUI „$ITLE    лCHGR@ORЁRA*оRIгTHL   „68080ѓ7Z80‡%COMMENT„&CREF‡'DEPHASE„(LALL†;LFCOND„)LIST…*PASS2…+PHASE†,PRINTX…-RADIX‡5REQUEST„.SALL†<SFCOND†=TFCOND„/XALL…0XCREF…1XLIST …EJECT‡8INCLUDE…4TITLE yЂЏћЄ№ЗУфhknytп&Ћ,'Ќ'>(ѓ('Ч()І-к((5‰*Б5Э,Э,)‡)‡))”)ћ)Ё)©)h6f6(5БC,~&ѕ+‰*A4Бѕ*µ*i7+†9M++[9;7’+U+\+!++г)д)й*к+ѓ+‹+,ш)ч)d+h+m+'-€Ђ  @Н ё 
F Г"  °  Б ЕЂ  ЗА (8 ђ Ё5„vїйѓCНdђЈП}µ е*F=~#"F=юКл
oюAТю0Ъю:Ъ7џ}бЙ·бЙю[ЪюaЪю{ТЇ}бЙНк
Г6Нк
хюВЗНБсе*F=+"F=бЙ*F=#"F=ЙНк
АюaЪSЦ їЙНИН6!к= q#Вa!й=6 #Н±Д2ж< юaЪЦ w#yюКџН±тxНЪТ—тxGy2й=ЇxЙН±тџНЪТ—тџГ—Нк
рю$Ию.Ию@Ию?Ию_И/·/ЙНк
рю КИю	КИ/·/Йх·Кдю&ВЗ:ы?·ВнсЙсН±·Кою&КоН6Н±7ЙНЪТ	ИБ GЙ!r?:й=хН'К"с2й=·~ЙБЙ!ґ?НЬ 		"p?^#V!g?	Їw#В:!й=~юЪK6!й=NzіКѕл^#VХ#^#VХе#~=Кy л=GѕВ‹#Вnб#~=№Вё#"?=#~+ББЙ?џжбхлхХj?!g?w#ВџСсw#s#rсбСКPлГP+>Гђ<*A=~Й*@####~·7И#еЖ _"@бЙ:к=ю$ Ию.Ию?Ию_Ию ИЦ;OЙхН$"?=БхЕсН“сИе*n?лzіКО:m?л O	Сs#rлЇw#В&й=юЪ7>wG#Їw"?=#w#w#w###w#ВI"A=####p л*@НЌЬ ;*?=|·> Й!xНМFГ ?Symbol table full
 |’А}“Йх:м<·КЗ:Њ@·КЗ:-=·ВЗ*?=~ж@ВЗсЪ№>‚Ъ>ЃНvLе!й=F#~НvLВГбЙ*p?ГхНГ G~ж8В#~ж В+~цЂw#~°w#s#r#Хл*Ю=лs#rСЙ~ж@w:к<·МН#Гй~ж”Дa~ЁжДa#Х^#V#гНЌДRСе*Ю=лxжюВD{ѕДa#zѕДaС:>ю *?=#КйЙ:0=·Вa*?=~·тЗех*?=#~цwxцGсбГµ>нНLyНLГ@ЕНZН6‡‡‡БЃГLЕНZН@‡‡‡БЃГLЕНZНRБЃГLЕНZНRБ‡‡‡ЃГLyхНZOсНLyГЩyхНm-сНLГХЕНZНRБ‡‡‡ЃOЕН*НZНRБЃюvМќГLЕНZНRБ‡‡‡ЃхН*НZOсНLyГЩЕНZБН@‡‡‡ЃхН*Нm-сНLГХН6Нк
ю,ДБЙ·ИюИжГќюхТKжКNНќсжЙюШжГќНm-z·Кf<Дќ{Й ЛнY !„
^#N!Ж
^#VлйЕНZюФќНBБxНL{ю?О ж‡‡‡ЃГLЕНZж8»ДќНBБЃГLЕНNЬќжДсБНc:и<жГњНѓ :В>·ВмНH:з<ю0Д:и<жАГњ>ЙГL:и<ж ЖЭНL>2и<ЙюВќ:и<<юК=юВќ<2и<ЙЕЇ2й<НИН6ю(В-2й<Нm-yЦ,Б·АНH:з<ю0Д7ЙНТ]Д:и<‡‡‡ж8ЃOЕНm-НBБyНLГХНЪ‹:з<ю ?Т]ю(МсН[:и<юДќНH>йГLВГKНТ«:и<юФќж‡‡‡Ж OЕНm-БН·yHНLyГL:Б>GжЂВЇНBxжGНjёВУюВвХ*Ъ=л*Ю=НЌСВУНj##лНT9z·CКы<Вќx·тќЙx·ъќЙЕНm-БГ«Н*ЕЇ2й<НИН6ю(В2й<Нm-Б:з<·Ию0Мќo:й<·}КHю(ВHz·КM<WКMНќzіДќЙН:з<·Кќю Й:й<·МќЙ:й<·ДќЙН:з<юА:и<юШГќНkН*Н[:з<юКЇ·ДќН;>УНL{НЩНNФќ:и<юДќГc:и<=ДќНNФќНc>нНLНcНnAГњНNФќНcНnхН	Н[:з<юК ·Дќ>ЫНLсюДќН;{ГЩ:и<=Дќ>нНLс@ГњНNЬќН*Нe КR:и<юКfюДќН[НNЬќНcНH:з<ю(Мс:и<юДќ>гГLНcНNЬќНe Дќ>ГLНcНNЬќ:з<ю Дќ:и<юДќ>лГLЕНZюФќж‡‡‡БЃOН*Нkц7х:з<ю(хМсбсех>ЛФLсЪєс{МЩхх:з<·Мќж :и<ВФЃНLНcссЙюДќ>ЃНLН[сТЗГ/Нk:з<·МќюК"ю(хМс:и<юВ:й<·В*НcсyюВ:и<жГњ:и<жГњ>Н%с{МЩЙН:з<·КiюК`ю(хМсН[:и<жюДќ>ЃНLГ/:и<жЃГL>FЃНLН;{ГЩНNН*Нc:з<юКґю Дќ:и<юДќ>нНLyожЖBOНNДќНe МќНcГ:и<юДќГ5НNН*Нc:з<юКґю(Кв:и<юДќ	Гў:и<хНсНNЬќхНe МќНc:и<юМќGсxКсёДќ>хБж	Гњ:з<юДќЙН:з<·К[юК4:й<·КБ:и<жюК™ФќхННcН:и<юДќсГњХН(Н[:Ѕ>х:Б>хН	Нc:з<·Мќю Ъ±:и<OжюКЎ>нНLyCНњН(с2Б>с2Ѕ>СГХ:з<ю(Мс>"НLГ’:и<юДќ>2НLГ’:и<хН	:з<ю Тс·Дќ:й<·В
схж`ЖќюАФLсжНњГХДссюДќНc:и<юДќ>щГLс2и<OжюВ$yю@Фс>*НLГХ>нНLyжKНњГХНc:и<юТ}хН	:з<·В^:й<·ВКН;сНњ{ГЩ:з<юМ
ю Вs:и<юЪШс‡‡‡Ж@OГњхН	Н:и<юДќ>нНLсжGГњ:и<ХхН(Н	Нcсхж`ЖќюАФLp:з<·КйНњН(сСю@{ФЩЙсюДќ>:НLГХН[сюДќ:и<
ГњН;Нc>6НLKBН(сСю@{ФЩН(YPyГЩ:и<юO:з<ШбсюДќ>нНLyжWГњЕХе!Ф>?AFwx#В3бСБЙх:з<·ДНсЙG:м<·7Дbе*Т=#"Т=бВ'ЙеХЕхНh'*>'>НЌЕФ+Б*>л:Џ@·КУ`Ї)Џ)ЏЖ0Ї)ЏВ‘Ж0ВЋлсхЪК:Ф>ж ККжЂВИ:Б>жюЪЕКВ6!6"6'6*#">сБСбЙНГџG:Ф>ц@2Ф>:м<·Дbе*Т=#"Т=бВюЙ:Ф>жї2Ф>е!Ф>~жКНЇ~ж@Гґ~ж К№ХЕ#~ж?Gx·Кљ#~·ъ72Н>>AНѕГжЪhюВS#^#Vл"Ю=лЕGНѓБ2Н>#^#Vл"О>л>CГ1#^#VЕел+~юЪz><2Е>= 	GМ>>B#~ВЉНЕбБГ:Ф>ж@х>В§>2Н>>AНѕсБС М'Н'бЙ2М>{2Е>Ее!Ж>"?=Н©бБЙ:м<·ДЙе*Т=##"Т=бИ:Б>G:Ф>ж@xМ“:Б>GНѓ*>жѓВ#">CН'BГ'xжЂЕВ&xжюъ7К46!Г96*л*ї>##~#foл6"6'Б##">НѓxжЂКP:Ф>ж@ВцxжЕК€Н:CН+BН+БxжЂИ*Т=++л*ї>#:С=G~жь°w#s#r#л*Ь=лs#rЙCН'BН'Гbх·тЗ:ѕ>2Б>:Ѕ>·КЗеЕХxНѓжВіzі	Д©Ї2Ѕ>СБ*ї>#~2Б>бсЙхеХ*>#>НЌФ+*>лбе:Џ@·КЇ)О0ЕЇ)ЏВсЖ0Вол">БСбсЙЕDНEНГяxНxжЖ0ю:Ъ(ЖЙхЕХеН:*=·КG:)=·КG:(=·КN:/=·ВS:>ю Д~:>ю Кo:ґ@<Кo2[?Н~Ї2[?<2+=Н?Н1бСБсЙ:ъ?·Кї=Вџ:ы?·Вџ:.=·Вї>+2+>Гї>+2+>:>ю Вї:.=·ъїИ:>ю И:1=·А:,=·КЛ>C2*>:[?·Вэ:/=·ВЯ:>ю И!3=4:2=ѕМp:[?·Вэ:Њ@·Кэ>ѓНvL!> ~#НdВ:+=·ВZ:ъ?=ъ#В#:ы?·К#!9=~#ю0Ъ6НdВ(>ёВC:8=·КH>	Нd!H=~#юКZюДdГK>Нd>
ГdO:[?·yКvLГоJ>23=:/=·КЌ>НvL!1>НХ!чНХ*4=#|µ+х:/=·К¤схКННЯс*6=#"6=:/=·И|µКѕ>-НvLНЯНZ!Ѓ>НХНZГZ>SНvLГ¤~#·ИНvLГХцяPX	Ъдел|µДв>:БЃГd	MACRO-80 3.44	09-Dec-81	PAGE	 :>ю ИюQК)*н<#"н<Й*п<#"п<ЙНjх:м<·КЗ:>ю ВЗсл!>">НЙжЕO !f	~*>w!>">БЙ '"!*Т=:д=·КХл*е=С:з=Й:С=ЙхЕxжюВ¦Хе*Ь=л*Ю=НЌ"?="Ь=Д©бСБсЙЕ Н:A>НБyюЪРюИ>НCН+BН+yюРеюКЭюВЮ*?=+~ёЪиxGW>Н#######FyюКxжGН+#ВцбЙХW>’К_x‡ВGx‡GНFВСЙЇНFЕxGНFВ.БЙ7НFxНFxе!Г>~w#4ВZНЭL>ш2Д>бЙЕНUБКCтю К\ю	К\ю'КГю"КГю(К¬ю)КЇю+КІю-Кµю*Кёю/К»ю;КЁю,КЁюДБЇГА>>>>	>
>>юЙ!  ЕGН)ёВЩН#ёВщН)o2в=Н)ёВпН#ёxВфН)eoН)ёБГnв=·В=xГф*F=+еНHт2в=*F=++"F=НHб"F=ВыюGТHg:с<юТыo|юDКHюBВы}юТы|юBКwюDК•юHКќюOКdюQДБВ•НјюOКqюQДБ лГѕ!  НHюBКqЦ0ь»юФ»)·Кz#ГzНҐюDГnНХюHГn!  НHИшЦ0)T])) _ГЁ!  НHИшЦ0юФ»)))_ Гї!  НHшюGТхЦ0ю
ЪкЦ))))_ ГШюHИГ»:т<·В4!  ЕНHъ0Ц0ю
ЪЦЬ»O :с<=№Ь»<_PЕНc$лБ	ГБГ=НҐГ=НјН6ГqЕН6:й=2в=юТї=КдН$Кї!  КїКo#Гgк=ѕВb#Вt!S 	~юВЊ2л<Б·тАНИяяю;К№юК№·В°Нк
ю&Мк
Г—Нк
юВ°Н6Гѕ*F=еНк
ю#ВнНк
ю#Вн7НьН-#~Gж ДµxжцЂwБ+Г!б"F=Н$Кt:к<‡КНК®:л<·К7Н“Н$К!Ї*@wГ!7НьжЈGжЂxК22ѕ>Ђ"ї>жД©:к<‡> ВC~ж@·x##^#VБOКQ жюВbХ#^#Vл"Ю=Сyж yВѕжЂМЩ  Гѕех7Н“сб"?=~жюBЪЁ~ж8х:з<·ДБс2з<##~2и<Нe Мz +~+Г!#~+Г!·ъ#^жxO B!Ъ	~·КФюВО2З>Б ГАБ Гѕ   :к=юXВ  Н#ю'ВїНк
НХю'БГnю$ВїНjлЖ БOГѕXOR AND NOT MOD SHL SHR OR  EQ  NE  LT  LE  GT  GE  LOW HIGHNUL TYPEя:з<ю А:и<юА:ж<юAИюaЙН#ю'Мк
ЙЇG og2З>2Ѕ>2в=2л<2Ф>2Х>2У>2з<2и<9"И>л*)@НЌТ4ЕН\ъ!К]!юъ~!Кт!юЪО юЬf!O2Ж>Нѓ!=ёyТ"юК"ю	К"Н?"y2W?НЋ!юК<!·В!:Ж>юВ<!МБЕГ<!ЕНѓ!х:W?OсНf!G:Ж>ГО хН6Нк
ю,В8!:З>·К8!сЇ2З>>ГО сГџ!:W?O:Ж>юКO!ЕНf!Г"БЕxНѓ!G:W?OГ`!НД"Нf!Гі бХ_yжю{Вy!л*Ю=гелYХйGЕГі Х!ы"_ ~СЙбБxюВћ!НБЕЇGюйб|юџ2В>еН?"y2W?НЋ!ъП!юКF%Е:W?OНf!ГЁ!  Н@Ї2W?:W?G2Б>жOКЮ! xжЂ±!Ф>¶w*F=+N{*И>щЙ2Ж>СzюМБ·МБХГе г|г=Ке yБWЕx=zК6"zюК6"юКі юК6"юК6"юК6"ю	ДБ>GЕНѓ!GГі б"Y?Сz·ХВR"  Х ХНЄ""а=л"К>лy2W?НЋ!ъЎ"ЦКЎ"2X?юК‹"юК‹"юК‹"юК‹"юК‹"НЄ":X?*Y?е!#‡…o> Њg~#foйЕ:W?O*Y?йбБДБК¶"ЕйСyжюВ}!г"Ю=ЙхХеyжцЂНМ%жюВг"Х*Ю=лНу"СГм"юВм"*ї>лНу"бСсЙ{НМ%zГМ%					



P#Z#d#n#П#ю#N$ћ$%ќ#®#Q%\%h%u%{%„%¶%§%…#ф% &&&-&C&c&Н„$zґW{µ_ЙН„$z¬W{­_ЙН„$z¤W{Ґ_Й*К>|/W}/_:W?Oжѓ>ВВ%ГМ%*К>|/W}/_:W?Oжѓ>ВВ%ГМ%Н„$лzіК¬#)Гў#лЙН„$#+}ґИzW{_ГІ#*К>:W?жЂИyжЂьЇЙНа#:W?±OжѓюЂА2Ѕ>Й:W?ю Ко#*а="Ю=*К>лН”$>ВВ%ГМ%*К>НG$:W?жѓъ%$К%$yжѓъ%$К$$:W?№В%$ Г?$=х:W?жѓВ9$yжѓюЂВ9$2Ѕ>:W?±Oс>ВВ%ГМ%{•_zњWЙ*К>Нi$:W?±Oжѓ>	ВВ%ГМ%Нi$ ЙDM!  >=К‚$)еЕб)гБТp$Гp$лЙ:W?№ДУю ДУ*К>Й:W?жѓИyжѓЙ*К>Ні$:W?±Oжѓ>
ВВ%ГМ%ЕлzіМБz·Bь%|ЁG|µКШ$|·ль%ЕНЫ$с·ь%ллБЙ|/G}/O!  >х·Гц$хе	Тх$с7>б{_zW}o|gс=Вм$|·g}oЙЇO“_yљWЙ*К>ЕлzіК5%|µК5%|ЄхХлНі$лбсь%ллБ:W?±Oжѓ>ВВ%ГМ%>OЕ!ХЕGГиН™%НЌЦГo%Н™%НЌЦ?Гo%Н™%лНЌџW_ ЙН™%Г€%Н™%НЌГo%Н™%л{•_zњЪo%і7Кo%?Гo%:W?№ДУНL&*К>Й*К>\ЇW:W?O>ГВ%*К>]ЇW:W?O>х:Ф>ц@2Ф>сех!Х>4~ж?Кв%…oТЮ%$сwбЙ5yжѓКс%:Ф>ц2Ф>сбЙН„$}НRжѓ_ЙН„$}НRжѓ_ЙН„$}Н@жѓ_ЙН„$}Н6жѓ_ЙН„$}НRжo{НRж…_ЙН„$}ж?ѓ_ЙжюАеХ*Ю=л*а=НЌДУСбЙ:W?_  :>ю ИюOВx& > 2>ЙНФ,Нѓ лxж КЯЇ2и=xжGК±&:С=ёВУюВ±&е*Ъ=л*Ю=НЌВУб:С=Gл*Ъ="Ю=:м<·Дѓл"Т=л:и=·ВЯ&:м<·Д©:\?·М2':\?·ИЇ2\?НUКНЙН2'Н1> G2С=<2\?2и=*Ф=Гµ&Н2'Н1>2\?G2С=*Ц=Гµ&Н2'Н1>2\?G2С=*Ш=Гµ&:\?·ДФ,:С=Ф=жюК`'‡o& 	е^#V*Т=НЌСШлs#rЇ2и=Й*Ъ=##ГK'х:м<·К‡':и=·К‡'ЕХе*Ф=л Н©бСБЇ2и=сЙН1НИН6ю"К 'ю'В(GН)Н)*F=++её КА'Н)юКЗ'ёВі'Нк
ёКі'Н6НИю,КЭ'ю;КЭ'ёКЭ'юб"F=В(yюЪ(Н#GН)Н)Гя'ЕНLБН)юИёВч'Н#ёК(Нк
ю,КЌ'ЙНLГЌ'НZх:в=·ъЗсНЩyю,КЌ'ЙНѓ хxжѓДУсЙН1НИю"КN(ю'ДќOЇхН)юКЗ№Вd(Нк
№Вo(GсЕ·ДLсГP(Бхx‡xК|(цЂНLсю,КA(ЙН1НД(Нh'yю,В›(ХНZCСГ¤(:‘@·К№( zіИ*Т=#"Т=:м<·Д'Г¤(*Т=:С=GГµ&Н2(:м<·А:>юUА<2>ЙН1Нh'Нѓ НХyю,КЧ(Й:у<=ъ)G2у<:ф<=ёВ )2ф<:ф<ђџ<2(=Н?)2х<Г@НЈЙ:х<·ДЈ:у<·МЈ!ф<–К;)=В@4=2(=<2х<Г@5Г1):у<_ю2> РW!ц<7~ЙхН?)х<Т\)wЇ!у<4:(=·КЗс2(=!ф<·Кv)4Й:у<=–2)=ЙНС)zіГP)НС)zі/КP)ЇГP):м<Н@=ГP):м<Н@·ГP)ц7х:(=·КШ)НUН$ВА)ж ВЛ)НКЛ)сџГP)с?џГP):(=·ВД(БЇ!‹"F=ГP)ц7хН2*ВШ)"F=x±КЛ)ГЖ)ц7хН2*ВШ)ХЕ~ю,В**#"F=Н2*В-*"F=yБб№ВЖ)ѕВЖ)#В*ГЛ)НБббГШ)НИю<ДќН#·ВR*Нк
Н#ю&ВR*Нк
Г:**F=+  #~ю>Вb*T]ю,Вl*zіВr*юВY*#е*F=zіМќл}“O|љGб:>ю ЙНUOЕДќ7НьН-#~ц@wБж МЩ~жЂДµ¶wyю,К‰*Й1> OГЕ* Ѓ>;НИ*F=+~#юКв*№Кв*КМ*ГМ*Ї#"F=ЙНИю(ВќН)ю'ВќOНА*Н6Н)ю)ДќГ@>2/=ГY+Ї2/=ГY+Ї2-=ГY+НUВG+КG+хНД$В:+~ц@wсю,АНUВБГ,+>2-=Й>я2.=ГY+Ї2.=Г@>2.=ГY+ЇГ}+>яГ}+:Ќ@/o:м<·КY+}2Ќ@2*=ГY+>2к<ГY+Ї2к<ГY+>я2т<НД(Ї2т<z·Вќ:>ю А{=шКќюТќ<2с<ЇgkГ4НД(z·Вќ:м<·И{·Кб+ю
Ьќ:>ю Вб+{22=Н+Н?ГpНUВќх:й=юЪю+НН>!г=w#"?=:м<·Д©сю,Кк+Й:,=·ВБНИ*F=+НqN·К1,Н4OГЯ=2,=*F=~#"F=ю!Т5,ЙНИю(ВќН)ю'ВќНUВќю'ВќН)ю)ВќН@:м<·А:й=юЪx,>к=!]?G~·Вµw#В„,pЙНФ,НИю/ВќНUДМ,ю/ВќН@Нь#~жРВµе~ц$wН2'б+"Ъ=>2С=!  "Т=Г±&х>2й=сЙ:д=·ИБГЗЂ НUВ-х·ХНьН-С~Іw#~жdВ-~жіwсю,Ка,ЙНќГ -цwНµГя,~жюBШЇwеЇ#w#w#wбЙНUН~‡ФБ#~юК>-юДБЂГа,"C=Нm-:>21=юUИxжЂВЇxц 20=*C="?=НЫлxГ4Нѓ :В>·ИГН"C=~цЂw|21=Нm-xжЂВЇ*C=Н-#~ж”Вµ~ж@°ц w#s#r#Хл*Ю=лs#rбГ4хНёK:ъ?·Дw/:у<·ДЁ/с!м<4~=ВZ.!]?~·Вв-!1>~·Вв-!Х@# ]?~#ю К.ю	К.·К.юК.Ви-!V?p#"?=Н©Н2'!5O"@НДЪA."?=~жw#~ж@Вk/~жК.#^#V Н©Г.*Ш=л
 Н©*Ц=л{ІД©Гn*F=хФѓ ХЕН+!яя"4="6=}2/=Нp!ф/НХ!3=44!r?>Н—;НZ:3=ю8Фp!3=44!й/НХ!ґ?>Н—;НZНґ/*н<|µКЛ.еНЯб:ґ@<2[?ДЯЇ2[?ГС.!L/НР/!O/НР/*п<|µК/>,НvL:ґ@<>,ДоJеНЯб:ґ@<2[?ДЯЇ2[?!_/НР/Нґ/БСсТ/   НѓН©*Г>|юшК,/ЇНFГ/ Н© Н+:Њ@·КC/>ЂНvLНЫKНLГ No  Fatal error(s)  Warning(s)  :С=GН©Г.НН/!†/НР/Н)Гґ/REPT/IRP/IRPC/MACRO Unterminated  НН/!Э/НР/Н)>НZ>
НZ:ґ@<И>НоJ>
ГоJ!љ/еНХб:ґ@<ИГМFConditional Symbols:
 Macros:
 !вя9л*)@НЌТ4:ъ?·!  "#@"%@*ш?В#0*)@+<2ъ?Ї2ы?2@л*@$НЌТ>0л"ш?Й%леНO;бГ.0НА~·<р=хжКr0:@<2@сжоА:@·И:@=2@<Й#~юВ^0:@·В^0:@·В^0с7Й"ш?:ъ?=2ъ?ЙНк
ю&ВС0*F=~ю КП0ю	КП0еЕНUНЭ0Бб"F=ВП0>&2ь?Г>1ю&ВС0:ь?·ВЦ0>&Н;:·шхЇ2ь?сЙ*@ ~·К1й=ѕВ 1O+ѕВ 1Вр0xцЂїЙ+~юТ 1Гв0:@·А*@А~·К<1й=ѕВ11O+ѕВ11В#1ЇxЙ+~юТ11Г1<Й*F=еНUхНЭ0Вw1Gсбх~#ю К\1ю	Вd1еНС0бГP1xНС0сGхсВГ0ю&ВГ0Г6сбх"F=Нк
ю Кђ1ю	Кђ1Н6Г–1НС0Г}1Н±Вk1ГҐ1Н±ъk1НС0Гџ1Нк
ю;КЗ1Г№1НЖ:НС0юКћ:Нк
Г№1НЖ:НЖ:ю КК1ю	КК1·Нн:"%@Кћ:юКћ:>Н;:Гћ:ех:@·Кя1Хл*@4Ссжх‡ъI2*@~·К82сЕG+К#2~Х/_яСГ2~·КF2=G+~КF2НШ3Г*2с+<=КC2+Г;2~бЙБбЙ>.НШ3НШ3сж?Е*@O 	DНEНБбЙеНUбД‚2хй=<Ow+Вx2сЙюИю;ИСГќ Ее+НИю'К}3ю"К}3ю<К›3ю>К¦3ю%КУ2ю,К°3ю К°3ю	К°3ю;К°3ю!М)юКН3w+Нк
Г”2"{3Еq3ЕНД(л :>ю В63:с<юК.3юК3цяPX	Ъы2ел|µДщ2>:БЃГf3Ї)О0НR3>хЇ)ЏВ3Ж0НR3с=В3Г63DН>3EН>3А>0Гf3xНG3xжЖ0ю:ЪR3ЖВf3ю0ИOю:Ъf3>0Нf3yе*{3w+"{3бЙБН6*{3ГН2  Ow+Нк
№КЏ3юКТ3Г~3w+Нк
№К~3Г”2Кў3w+ГН2КН2ъµ3ГЛ2ВЛ2С{•=Бл*F=+~ю М6ю	М6лЙКµ3НеГµ3хе!К=НЌТл3#6+лбсЙбсЙН>1ю&Кр3ю:К>1ю!РюИхНК4НКЗсГ>1!4Гr?Stack overflow, try more P switches
 НД(:>ю КO4  л"э?Ню/БСбc4ЕХ>Г\Б^4ЕНUю:МUНH0К„4H=Н;:юВy4ЙЇН;:Нћ:БСб!МеХ*#@ее*э?е!Ме!¦4еЕЙНщ4БбСНЌВХ4:@·Вѕ4x±ВХ4*ш?еН”9бНЉ0Ї2@СХ*я?елйХНr:·К5H=Н€:НШ3юВа4еЕ*@е*@е*я?йСб"я?б"@б"@лйbkГ«4:ъ?·Ке2@БбС+5ХеЕЇ2@Г@ГБ:@·КЉ5БЮЕНUю:МUНА·рOжВ^5yжВf5yж Вn5yж@В{5Й:@=2@Й:@<2@Й:@·А:у<·ИГк(:@·А#~юИ>яГP)БСб!МеХЕЙ·хНю/"@Нi2O:>ю К°5*@НЉ0сЙy6 +ю,ДќсхКм5Н)ю<Дќсwех +:>ю ВG6схGКъ5НЊ2юКD6ю>КG6ГЫ5Н#Ц<2@Мк
ГЖ5Нк
юК=6х:@·К6сG6Хю Ию	Ию;Ию,ИСГ76сю<К36ю>В76КG6Г76Г76w+Гъ5:@·ВG6НН6 +Н.0x·Дќсб"	@& i"э?БСбm6Г\4ЇВ>Г”5Б^4Е*%@>2@еНр3хНH0К±6сбюК¶1ю;К«1ю'КЎ6ю"КЎ6Н>1Г‡6GН•0юК¶1ёК›6Гў6сб"%@ЇН;:Нћ:БСб!МеХ*#@ее*	@е*э?е!Ме!Ь6еЕЙНщ4БбС>2@"@бНЌВ7:@·Вэ6x±В7*@##~ю#Т7+ГБ4лХНr:·К47H=Нr:·ьо1Нн:НШ3юВ7е*@еЕГн4bkСГс6НИюКќOНоJН)юКV7НоJ№ВG7>НоJ>
НоJ:>ю АГ@НИюКќ2@OНк
юК„7№К@Гu7бСБЌ7Г\4Б^4Е!H=:@O~№КҐ7юИ#Г™7БСб!МеХЕЙ·НФ#"ц?~ц(wНю/"@ ЕНi2Бю,КГ7Їw+2@2@<w+"@"@6 y2@Н;:ЇН;:БСб!ч7еХЕЙБ^4Е*%@еЇ2@2@Нр3хНH0Ъ8КO8с2@бГ‡6сНUДќ*@хВ18:@<2@й=<Ow+В786 "@сю,К8б"%@ЙсбЇ"%@Н;:Нћ:*#@ л*@:@w*#@л*ц?#Хе^#VzіД”9бСs#r*@НЉ0БСб!МеХЕЙе7Н“Ню/6 +6"@+ НЊ2GН6НИюКН8ю;КН8ю,КҐ8xю КҐ8ю	ДНГҐ8г##^#VлН€:г·Кк8№Кк8Ък86 +ГЬ86 +Н.0бБН€:е*@еЕO 	"@Б*@е!Ме9ХЕЙНщ4б"@б"@бЇ2@Нr:·КI9H=Нr:·ьо1Нн:НШ3юВ+9е*@е*@еГн4*@#Ї2@ГЖ4}“_|љWЙ:д=·ВЗНѓ :>ю А2д=xжЂВќxж2з=*Т=лНT9л"е=Й:д=·МНЇ2д=Г@!!@Ns#FrН¦9НЇ9q#pЙ*@^#V+Й*@##^#V+Й*!@}ґКП9лХНЇ9л"!@СГы9*@  л"@Хл*)@НЌСЪI;*ш?%:ъ?·НЌЪI;*@лНT9ХН¦9л*%@л{жа_{ІВ:СХs#r#> w#wНЇ9СК%:s#rГ*:л"#@л*#@ХлН¦9Сs#r{ц_ЙХх*%@л{жМє9*@схw{жюКW:Мa:л"%@сСЙ{жа_НЇ9zіКє9ЙХл*@л}жВ‚:}цoл~лСЙНr:хХл{жюК—:Мa:лСсЙл{жа_ХНЇ9{ІБИЇw#w*@s#rЕН”9Б*#@лН¦9q#pЙ*%@Хл{жюМб:*@л"%@л~лСЙ{жа_Н¦9{ц_ЙХхл{жюКщ:Мa:лсСЙ*@л*ш?:ъ?·В;*)@%НT9Ъoz·КoW{_Х*@л*@НT9BKС*@л"@x±КE;+wГ8;"@ЙНO;ГП9Х*A=л*@НT9ЪozюЪoW{_бЕе*@лгНT9BKС*@е*A=е"@	"@бСx±К•;w#Г€;БЙ2Б>2В>O!^#V#еЕН·;БбВ ;:Б>№ДZЙ  ЕzіКЗле^#V{ІВА;б}ґИНж;++V+^{ІКК;Їw#w+++еГА; 	F#"?=~ж@А#~жЂДФ<~#^#VЕеGжВ5<ЕНА<с_жЂВ<{жВ…<{ж@Дђ<{ж К€<{ж_ !f~НvLНz<бБ###Е~#НvLВ;<Б>ђВL<<GНu<ВM<!Б>5Вm<:В>wНZ!3=4:2=ѕМp*?=~ц@wЙ> Г|<>	ГvL>*К>MК>CК>UНvLГ2<ХЕ*?=е#{жG#^#V#Х^#Vл"Ю=СНѓб"?=#~ж Д©БС>IГvL!>">НЙ*>6 !>ГХЕе~жG#^#VН©бБЙ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     QAQB QCQDQEQHQLQMbSPcPSWQIQR	bBC bDEbHLbAFjIXDjIYdrNZ qZrNCqPrPOrPE                                                                                                                                                                                        RELCRFPRN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      P                                                                                   ?Command error ?File not found ?Can't enter file ~жИНоJ#ГМF!›FГжF!ЄFГжF!єFНМFГXGCOMSCN                        тF",AтF·К<G:GG:
GO* . ѕВ2G#В$GГ<GВ2GИГGЇ2тF* +щ++"‚@*,Aе:Ћ@·В  2…@*‚@щНKJ:IFюКXGЇ2’@2‰@2ђ@2Џ@2Њ@2Ќ@2‹@2‘@<2Љ@2€@ЧFЕЇ2Ѓ@НбHШ8AНДH-Aю В§G>Ђ2Ѓ@е!“@НёHб> 2-A25AЇ2,AyЦ,·2‹@ВСG:Ѓ@оЂ2‹@НбHШ>A:Њ@·КЮG;AНДH-A:,A2‡@Ц 2†@ВыG:Ѓ@Ж@2Ѓ@е!ґ@НёHбyю=7АНбHю7АНДH,A·ъ#Hю 7Ие!Х@НёHб:Ѓ@‡!“@ЬH‡!ґ@х:Њ@·КSHЅ@;A>х
с=ВIHсЬH:‰@·ВhH:†@·ВhH:‡@2‰@Н хН с_Н Ї2Ђ Н„KН%KН;Kб*‚@##:Љ@2…@GЙх,A	~·ВІH·ъІHw#ВЁHсЙ#ГЁHw#В»HЙ:„@·Ие!5A~ю ВЯHжw#ВХHбЙН*Jю:7> ВIx·КбHлНЧJOx=yВ&Iю[РюAШЦ@л2,AФ*JxюЪIЕлХ-AКoIНЧJГIюTВ?IНЧJюT7АНЧJюY7Аџл·ГIюLВYIНЧJюS7АНЧJюT7А>юл·ГIюR7АНЧJюD7АюR7А>юл·ГIбБ>
ђЪЂIл6 #=тxIлy Ц.2„@М*JлХ5AxюЪIКҐIНЧJГ™IбyЦ/·yАНЧJюLВѕI2‰@НЧJOГ¦IюNВЙI2ђ@Г·IюOВФI2Џ@Г·IюRВЯI2‹@Г·IюCВнI2Њ@2‰@Г·IюMВшI2‘@Г·IюIВJ2€@Г·IюXВJ>я2Ќ@Г·IюZВJЇ2€@Г·IюP7А:Љ@<2Љ@Г·I еНЧJю[ТHJю0ЪHJюAТDJю:ТHJГ-JOСЙЕХ!Ђ ~6 ·GКzJ#~ю ВcJГUJHFx+#КtJ~ГiJ2Ћ@ГљJЇ2Ћ@:…@·ВЌJНK>*НоJ
GFН >
НоJСБ:HF!IFе"™F…o> Њg6#>
wб:…@·ВЦJе!IF~юКХJЦaЪСJюТСJЖAw#ГѕJбЙ~#ю КЧJю
КЧJюВK#"™FЙсеХЕхж_Н сБСб·Йе*™F+~жю
#МKJ#"™F+~бю7И·Й>НоJ>
ГоJхЕХеEB!  "CB!ґ@:‰@ГNKхЕХеCA!  "AA!“@:‹@·КKеН б~·ъKНЎKХН СХН <КгFбНЎKН <КЭFбСБсЙхЕХе! "EDGDН !Х@~·ъKГsKеХ Їw#ВЄK wбСЙхХХ@·ъШKЕеХGDН СЕеН бБСсЙх:‰@·К°HХ:ґ@<КШKъdL>НvL>
НvL>НvLе*CBEBЕґ@НNLEBН Ббґ@ГПKх:‹@·К°HХ:“@·ъШK>НЭLе*AACAЕ“@НNLCAН Бб“@ГПK|µИ}жКYLЖЂж)„`iГ­L>НvL>
НvL>НvLСсЙх:‰@·К°H:ґ@<КнJъUMгеХ*CB|юМҐL#"CBDBСсхжwсбЙEB!ґ@>хЕХеН СХН ·ВЎMСбЂ 	лБс=В­L!  ЙCA>!“@Г­Lх:‹@·К°H:“@·ънJгеХ*AA|=МТL#"AABAСсwбЙ:Х@<К KъђMеХ*ED|юМ%M#"EDFDСГKGD>хХЕН Х@Н БС=КNM!Ђ лс=В*M!  Йс>ГJMсеХЕхж_!’@ю ТsMЦКqM<КqM~=w4{ю	В€M> НvL~жВzMГ‹MН сБСбЙеХЕН БСбю7И·Й!БMНМFСЖ@ю@ВІM> НоJ!ЗMНМFНKГ  DISK   FULL                                                                                                                                                                     еХЕл!НMю:> ВЊNЦ@юТрNw#2„@ю.К·Nю!Ъ·Nw#ВђN2„@ю.КѕNю!ТҐNГѕN6 #В·N:„@ю.КЛNw#ВЛNpсMН НMН юяКрNЇ2нM2оMБСбЙеХЕ:оM=тOсMН НMН ЖяЪ0O!сM"пM>2оM*пM~юВ+O7Г0O#"пM·БСбЙЙ0                                                                          СБсЙхЕХе! "EDGDН !Х@~·ъKГsKеХ Їw#ВЄK wбСЙхХХ@·ъШKЕеХGDН СЕеН бБСсЙх:‰@·К°HХ:ґ@<КШKъdL>НvL>
НvL>НvLе*CBEBЕґ@НNLEBН Ббґ@ГПKх:‹@·К°HХ:“@·ъШK>НЭLе*AACAЕ“@НNLCAН Бб“@ГПK|µИ}жКYLЖЂж)„`iГ­L>НvL>
НvL>НvLСсЙх:‰@·К°H:ґ@<КнJъUMгеХ*CB|юМҐL#"CBDBСсхжwсбЙEB!ґ@>хЕХеН СХН ·ВЎMСбЂ 	лБс=В­L!  ЙCA>!“@Г­Lх:‹@·К°H:“@·ънJгеХ*AA|=МТL#"AABAС;******************************************************************************
;*  M O D E B A U D * C P M S Y S 4 g * T h o m a s   H o l t e * 8 4 1 0 0 5 *
;******************************************************************************
;*									      *
;*  	E Q U A T E S   F O R   M O D E   B Y T E   B I T   F I E L D S       *
;*      ===============================================================       *
;*									      *
;*									      *
;*  Thomas Holte						 Version 1.0  *
;*									      *
;******************************************************************************

MB$INPUT     EQU 00000001B	;device may do input
MB$OUTPUT    EQU 00000010B	;device may do output
MB$IN$OUT    EQU MB$INPUT+MB$OUTPUT
MB$SOFT$BAUD EQU 00000100B	;software selectable baud rates
MB$SERIAL    EQU 00001000B	;device may use protocol
MB$XON$XOFF  EQU 00010000B	;XON/XOFF protocol enabled

BAUDNONE     EQU 0		;no baud rate associated with device
BAUD50       EQU 1		;50 baud
BAUD75       EQU 2		;75 baud
BAUD110      EQU 3		;110 baud
BAUD134      EQU 4		;134.5 baud
BAUD150      EQU 5		;150 baud
BAUD300      EQU 6		;300 baud
BAUD600      EQU 7		;600 baud
BAUD1200     EQU 8		;1200 baud
BAUD1800     EQU 9		;1800 baud
BAUD2400     EQU 10		;2400 baud
BAUD3600     EQU 11		;3600 baud
BAUD4800     EQU 12		;4800 baud
BAUD7200     EQU 13		;7200 baud
BAUD9600     EQU 14		;9600 baud
BAUD19200    EQU 15		;19.2k baud
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее;******************************************************************************
;*  M O V E  *  C P M S Y S 4 d  *  T h o m a s   H o l t e   *  8 5 0 7 1 7  *
;******************************************************************************
;*									      *
;*     M O V E   M O D U L E   F O R   C P / M 3   L I N K E D   B I O S      *
;*     =================================================================      *
;*									      *
;*									      *
;*  Thomas Holte						 Version 1.0  *
;*									      *
;******************************************************************************

	.Z80

	TITLE 'MOVE MODULE FOR CP/M3 LINKED BIOS'

        GLOBAL ?MOVE,?XMOVE,?BANK,?USERF

$SYS0	EQU  0F9H		;system byte 0
$SYS1 	EQU  0FAH		;system byte 1


	CSEG

?XMOVE: LD   A,0FFH		;remark interbank move
	LD   (IBANK),A
	LD   A,C		;source bank number --> accu
	ADД  A,A		;source bank number --> upper nibble
	ADD  A,A
	ADД  A,A
	ADD  A,A
	ADD  A,B		;destination bank number --> lower nibble
	LD   (BANK),A		;store bank numbers
	RET
BANK:	DEFS 1			;bank numbers
IBANK:	DEFB 0			;flag for interbank move


?MOVE:	EX   DE,HL		;we are passed source in DE and dest in HL
	LD   A,(IBANK)		;interbank move ?
	OR   A
	JR   Z,NIBANK		;jump if not
	XOR  A			;clear interbank move flag
	LD   (IBANK),A
	LD   A,(BANK)		;get source and destination bank number
	PUSH BC			;save byte count
	LD   B,C		;byte count --> reg. B
	LD   C,15		;function # --> reg. C
	CALL ?USERF		;perform interbank move
	POP  BC			;restore byte count	
	ADD  HL,BC		;calc new source address
	EX   DE,HL
	ADD  HL,BC		;calc new destination address
	RET
NIBANK:	LDIR			;use Z80 block move instruction
        EX   DE,HL              ;need next addresses in same regs
        RET


?BANK:	PUSH BC			;save reg. BC
      	RRCA			;bank number --> highest two bitsЉ	RRCA
	AND  0C0H
	OR   1
	LD   C,A		;bank number --> reg. C
	IN   A,($SYS0)		;read system byte 0
	AND  00111101B		;disable character RAM
	OR   C			;set bank number
       	OUT  ($SYS0),A		;write system byte 0
	POP  BC			;restore reg. BC
	RET

;table of driver entry vectors:
$VDINIT	EQU  0    		;initialize the video controller chip M6845
$RSINIT	EQU  1    		;initialize the RS-232-C interface
$KBCHAR	EQU  2    		;get a keyboard character if available
$KBWAIT	EQU  3     		;wait for a keyboard character
$VDCHAR	EQU  4    		;display a character
$PRSTAT	EQU  5    		;test printer status
$PRCHAR	EQU  6    		;output a character to the printer
$RSRCST	EQU  7    		;get a character from the RS-232-C interface if
				;available
$RSRCV	EQU  8    		;receive a character from the RS-232-C
				;interface
$RSTXST	EQU  9    		;test the RS-232-C output status
$RSTX	EQU  10    		;transmit a character to the RS-232-C interface
$READ	EQU  11   		;read a disk sector
$WRITE	EQU  12   		;write a disk sector
$GETTIM	EQU  13   		;get time and date in binary format
$SETTIM	EQU  14   		;set time and date in binary format
$XMOVE	EQU  15			;interbank move
$GTIME3	EQU  18			;get time and date in CP/M 3 format
$STIME3	EQU  19			;set time and date in CP/M 3 format
$LDCHAR EQU  20			;load bit pattern for user definable char
$RSTCHR	EQU  21			;restore original character set
$SCRNIO	EQU  22			;direct screen I/O
$INIT	EQU  23			;general initialization routine
$CLOCK	EQU  24			;clock/display on/off


;call ROM driver routines:
	DEFS 50			;space for temporary stack
?USERF:	LD   (SAVESP),SP	;save stack pointer
	LD   SP,?USERF  	;temporary stack --> stack pointer
        PUSH BC			;save register set
	PUSH DE
	PUSH HL
	PUSH IX
	PUSH IY
	PUSH AF    		;save accu
	IN   A,($SYS0)		;read system byte 0
	LD   (PORT),A		;remember port data
	AND  00111101B		;enable bank 0
				;disable character RAM
	OR   00000001B		;enable common memory
	OUT  ($SYS0),A		;write system byte 0
	POP  AF    		;restore accu
       	RST  0     		;call driver routine
 	EI			;enable interrupts
	PUSH AF    		;save accu
	LD   A,(PORT)		;select current CPU bank
	OUT  ($SYS0),AЉ	IN   A,($SYS1)		;read system byte 1
	AND  11010111B		;disable graphic page
	OR   01000101B		;disable memory mapped I/O
				;disable boot EPROM
				;7.2 MHz clock frequency
	OUT  ($SYS1),A		;write system byte 1
	POP  AF    		;restore accu
	POP  IY			;restore register set
	POP  IX
	POP  HL
	POP  DE
	POP  BC
	LD   SP,(SAVESP)	;restore stack pointer
	RET			;return to caller

SAVESP: DEFS 2			;temporary memory for stack pointer
PORT:	DEFS 1			;temporary memory for system byte 0

	END
ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее1ЖГј                                                          CP/M Version 3.0COPYRIGHT 1982, DIGITAL RESEARCH151282    654321
ERROR: Not renamed, $
ERROR: Drive read only.$Invalid wildcard.$ERROR:  No such file to rename.$
Disk I/O.$Currently Opened.$Bad password.$file already exists$Enter password: $, delete (Y/N)?$ERROR:  Invalid File.
$Requires CP/M 3.0$Enter New Name: $
ERROR: Incorrect file specification.
$Enter Old Name: $1Ж1ЖНq"6*6}Ц0џ*6х|ЦЦџБH±Тл\Н7   Н !Ѓ "Х!\ "к"ЧЃ Н«	ТХНе	"ЧяяНBµКН„	Г№nН7(Ђ НG29> !9ѕЪEН7   Н !Ѓ 6 е*9& Б	":Н)ЁН7*:DM(НG29Н)*:6 *:#":*:6=:9:Н2#л+s#r*:6!Ѓ "Х!\ "к"ЧХНе	"ЧяяНBµК№Н„	яяЧНNµВЙНo	:\ ю Кр:мю Кй!м:\ ѕКжНo	Гр*к~2мНJТэНсГмН.юяКНс   Н ыv  Н Йя Н Й!Жq*Ж& лН Й!Иp+q*Зл	Н Й!Лs+p+q*Й:Лw*Йл
Н *Й#"Й~Й  Н Й  Н Й!Нp+q*МлН Й  Н Й!Пp+q*ОлН Й!Сp+q*РлН Й!Уp+q*ТлН Й!Фq*Ф& л-Н Й!Эq:Э2Щ!Ъ6 Щ1Н Й!Юq:Ю2Щ!Ъ6 Щ1Н Й!бr+s+q:Я2Щ!Ъ6юе*алб#s#rЩ1Н ЙН'
Н'Й!s+q+СБp+qХ:=2юяК^*:w*#"ГAЙ!q:ю ВyГН7   Н :юВЏгН7   Н :юВҐ—Н7   Н :юВі¦Н7:юВБпН7:юВПН7:юВЭН7:ю	Ву±Н7   Н Й!p+q!6>!ѕЪ-:ю	В.Н'*& л*>¦OН'!4ВяЙ!p+q. е*л*кDMб
-ВEвНіяНГ*DMНЈ" НГ*}юяВ‹*|2:юТ‡*MН_:Й>яЙ!q:юaЪЁ:ю{ТЁ:Ц Й:ЙН)#Н7вЕ Н4!6 >!ѕЪCНOНЋ2ю Ък*& в	:w:юВшН)ГC:юВГµ:юВ):юТГµ:=2O !в	6 ГО:юВ9   Н :<2ВЕНh2Й!6 +6>!ѕЪ *& м	~ю?В–*& л*к~ю?К‘ЂН7±Н7   Н Г–!6я:<2ВR:Й! p+q*:мw!!6>!!ѕЪр*!& м	~ю?Вж*!& л*е*!& л*кБ
w:!<2!В¶ЙЂ НімНz2#юяВ
 Н_:#юяКM	:#‡‡‡‡‡o& Ђ "$EНл"&GНл"(IНл"* Нл",Нл".Нл"0*$DMН¤*$DMН.2"юВџ*кDMНN	4Н7НOНЋюYВњ*кDMН“*$DMН.2"ГџГи:"юВЅ*$DMНN	Н¬*$DMН.2":"юяКР*$DMНN	ГиН)*кDMНф=Н'*$DMНфЂ Ні*&лEН*(лGН**лIН*,л Н*.лН*0лН!(мНYµКD	.е*(лмб
-В<	НЉ2#Г
Й!3p+qЂН7*2DMНф Н'*"MН_ЙЂН7DН7   Н Й*Ч#"Х!м"ЧХНе	"Ч.вь
-Вў	Й!5p+q*4~Ц Цџ*4х~Ц	ЦџБH±ТХ	*4#"4Г±	*4~ю Вб	> Й>яЙЙ!  ее`i^#V#~#foН"На
В
y·В€
wГ7
Gю:В4
xЦAЪ€
юТ€
<wНа
В7
ю.К€
ю:К€
ю;К€
Г7
6 НЋ
ю.КI
НШ
ГM
НЋ
#6 ВO
ю;Кc
НШ
Гg
Н±
ХН"На
Вv
33Гw
Сy·БyБ#q#p#wлА!  Йбб!яяЙНа
КШ
#ю*ВЈ
6?ВЋ
ГҐ
wВЋ
На
ИбГ€
На
КШ
333333Хе. г;;33г,г;;#wК©
На
ВД
#6 ВШ
ЙO·И юИOю	Ию ЪИю.Ию:Ию;Ию=Ию,Ию/Ию[Ию]Ию<Ию>ИюaШю{Тж_жЙбГ€
ю К.ю	К.ЙГ"л_ л…oЊgЙ_ {•ozњgЙi`N#F‘ogЙ_ {–_z#ћWлЙ                                                                                                                                                                                                                           юYВњ*кDMН“*$DMН.2"ГџГи:"юВЅ*$DMНN	Н¬*$DMН.2":"юяКР*$DMНN	ГиН)*кDMНф=Н'*$DMНфЂ Ні*&лEН*(лGНееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее                                                                                                                                                                                                                                                                    Г$ ГдГтГъ       N      Гwy!  "(9"f1f!ЛеюТ”2Я!†  		~#foйCOPYRIGHT (C) 1982, DIGITAL RESEARCH 151282                 яХХћ ¤ Ё ¬ г й п ХНяГИKГяKГя{<КГ <КЅ <КИ KГяНО ГИНО ·ИНШ ГИ:  ·>яАГя!  ~6 ·АГ	яН6яГИН9яГИBK!У
ѕИЕOНSБГс л}ґВ!,"є*Ше*Х NлНKя6 СХ
НХ:+O СбГKя2$л^#V#N#Fлx±ИЕеNpХ:$юpКя:ПGжКjxжКjжВяГяYГХб#БГA>НQяFЇНQяxЙЌХ>НQяйGЇНQяxЙю3Ъ°юbЪјюqТјюoК5юpК5ГПюКЗюКЛюВПл"Ш" Йл"г*гл!вyюbЪЫ!і 	~GЕХЪнЪьГ*Шл!N НKяСХЇ2 !*$ НKя*бБЕе" НХСБxжьИ!*л! Ъ@$Ъ@ЪhЪKяЪ\ГKя: ·КKя 	л	~#~	л	wЙ*Ш NГKя*ШЂ NГKял^#V#N#F!ЇеЕХ",!."*Ђ НKя6 *НХБ}ґКґ}¤<Кґ.}“o|љg	"(бС$ ГKяюКt> ЪИ=2(*fщ*(}DЙЇНQяНь"(>ГQя·КKяНQяНKяЇГQя>НQяГл"%НQя!ЦеЇ2 *%DM* л*беНЭСµИеле+))	 ќ®жВHНАК~лб#г+}ґгелВ#<ббЙ: <КІ<В7ХНАСВ7: <Кў<Кo~жВ7Г~®жВ7~ж0ю0К7*блб+"бБ}жюИ{жь_}жьoНЭµИ>я2 ЇЙ~жК7®жВ7Гё~юхВ7лб" Г9:њ·ИOG® Ае#НдбЙхЇНQясЙ{•ozњgЙѕА#ИГд   ѓ‚""‚‚ѓ      ѓ  ‚‚BB   ‚‚        ѓ                                                                                                                                                                                                                                                                                                                                         ГяГѓГяГѓГ	яГѓГяГѓГяГѓ                         1                                               j$  њЂ               яяя       Ђяяяяя  Г|ь  ’@ "H$Ђ       UUT‘€‰$$Ѓ $’‚I 	  D$BA„@„!	B$$A IA ђ$‚!"  	 ђ	 Ѓ ‚@‚$@’$BI!!  @’ ""$D‚  ЃA	                                                   $’I$  @      !    ;******************************************************************************
;*  S C B  *  C P M S Y S 4 a  *  T h o m a s   H o l t e   *   8 5 0 2 0 5   *
;******************************************************************************
;*									      *
;*   S Y S T E M   C O N T R O L   B L O C K   D E F I N I T I O N   F O R    *
;*   =====================================================================    *
;*									      *
;*  	       		    C P / M   3 . 0   B I O S			      *
;*	                    =========================           	      *
;*									      *
;*									      *
;*  Thomas Holte						 Version 1.0  *
;*									      *
;******************************************************************************

	.Z80

	TITLE 'SYSTEM CONTROL BLOCK DEFINITION FOR CP/M 3 BIOS'

	GLOBAL @CIVEC,@COVEC,@AIVEC,@AOVEC,@LOVEC,@ERDME,@DATE,@HOUR,@MIN
	GLOBAL @MXTPA


SCB$BASE EQU 0FE00H		;base of the SCB

@CIVEC  EQU  SCB$BASE+22H	;console   input  redirection vector
				;(word, R/W)
@COVEC  EQU  SCB$BASE+24H       ;console   output redirection vector 
				;(word, R/W)
@AIVEC  EQU  SCB$BASE+26H	;auxiliary input  redirection vector
				;(word, R/W)
@AOVEC	EQU  SCB$BASE+28H	;auxiliary output redirection vector
				;(word, R/W)
@LOVEC	EQU  SCB$BASE+2AH	;list	   output redirection vector
                                ;(word, R/W)
@ERDME	EQU  SCB$BASE+4BH	;BDOS error mode (byte, R/O)
@DATE	EQU  SCB$BASE+58H	;date in days since 1 Jan 78 (word, R/W)
@HOUR	EQU  SCB$BASE+5AH	;hour   in BCD (byte, R/W)
@MIN	EQU  SCB$BASE+5BH	;minute in BCD (byte, R/W)
@MXTPA	EQU  SCB$BASE+62H	;top of user TPA (address at 6, 7) (word, R/O)

        END
SYSTEM CONTROL BLOCK DEFINITION FOR CP/M 3 BIOS'

	GLOBAL @CIVEC,@COVEC,@AIVEC,@AOVEC,@LOVEC,@ERDME,@DATE,@HOUR,@MIN
	GLOBAL @MXTPA


SCB$BASE EQU 0FE00H		;base of the SCB

@CIVEC  EQU  SCB$BASE+22H	;console   input  redirection vector
				;(word,ЙЂ"Й           Ђ# я DIRLBL                                                                                                                                                                                                                                    1Ё!ГM
                                                          CP/M Version 3.0COPYRIGHT 1982, DIGITAL RESEARCH151282    654321!  ее`i^#V#~#foНЅН{ВЎy·В#wГТGю:ВПxЦAЪ#юТ#<wН{ВТю.К#ю:К#ю;К#ГТ6 Н)ю.КдНsГиН)#6 Вкю;КюНsГНLХНЅН{В33ГСy·БyБ#q#p#wлА!  Йбб!яяЙН{Кs#ю*В>6?В)Г@wВ)Н{ИбГ#Н{Кs333333Хе. г;;33г,г;;#wКDН{В_#6 ВsЙO·И юИOю	Ию Ъ№Ию.Ию:Ию;Ию=Ию,Ию/Ию[Ию]Ию<Ию>ИюaШю{Т¶ж_жЙбГ#ю КЙю	КЙЙГЅ Copyright (c) 1982 Digital Research  File not found  or no directory space Invalid file name. Directory Label   attribute set  Read Only  (RO) Read Write (RW) ,  set to  ERROR:  READ WRITE DELETE NONE     on        off   LABEL       @ Ђ         @ ЂOption requires a file reference Option only for drives. Assign passwords to input files. Assign a password to this file. Directory needs to be re-formatted for time/date stamps.
       Please see INITDIR. Protection not enabled for disk. Unrecognized option. There are no modifiers for this option. Modifier missing or unrecognizable. Not a valid modifier for this option. This option needs a modifier. Only first 8 characters of default password used. Only first 11 characters of label name used. Only first 8 characters of password used. Cannot have both create and access time stamps. Cannot set both sys and dir. Cannot set RO and RW. No options specified. Page and nopage option selected.   Nopage in effect. Cannot set local options for file. Protection modifier is only ON/OFF for drives. Password protection is not supported in NON-BANKED SYS. Requires CP/M 3 or higher.                                                                                                                    ACCESS0ARCHIVE0CREATE0DEFAULT0DIR0F10F20F30F40NAME0PASSWORD0PROTECT0RO0RW0SYS0UPDATE0PAGE0NOPAGEя "%(+.3<DGJNUZ` OFF0ON0READ0WRITE0DELETE0NONEя я  []=, :;<>%\|"()/#!@&+-*? я?Directory       Passwds  Stamp    Stamp    Stamp
Label           Reqd     Create   Access   Update
--------------  -------  -------  -------  -------
 Press RETURN to continue.  ? Password ?  Disk I/O Drive  Invalid Drive. Wrong Password ? in filespec. ?ON OFF system (SYS) directory (DIR) ,  Drive  Default password =  Password =  Label for drive  Protection =         or protection not enabled for disk. Modifier:  Option:  FILE:  1Ё!1Ё!Н1"§"*§"}2W#|2X#НЂ2п"!р"6 :W#ю0Тw
ГnНЋ2©!НЅНl2¦"*U#& Ђ 	~ю Вњ
!U#4Г†
*U#& Ђ 	"е"*U#& 	~ю[Вб
*е"#"е"НB!‘:к"ѕВО
Нo ГЮ
з!Е Н !ж!6 ГЃ НS :"Тъ
*""е"НBГQНџНДН9 :В"!Б"¦Т"gНџНР!Ё!6 Г=:В"Т1!Ё!6 Г=:Б"Т=!Ё!6]НB|ю ВM!"6НБ :"Тk*""е"!"6Нo НБ ГPНД&НџНДыv!Є!q*Є!& лН Й НyЙ!¬!p+q*«!~ю КЇ*«!NНy*«!#"«!Г•Й  Н ЙНy
НyЙН№   Н Й:Ё!Т!р"4~<<+х~БH№ТН№Н№0	НЏН°ЪэГу  Н 2­!:­!юВНД!р"6Н№Н№Й!Ї!p+qНР*®!DMНЏЙ  Н Йэ Н Й!°!q*°!& лН Й!І!p+q*±!лН Й  Н Й  Н Й!ґ!p+q*і!лН Й  Н Йя  Н Й!µ!q*µ!& л-Н Й!·!p+q"Нu*¶!лН Й  Н "ё!Й!»!p+q"Нu*є!лdН Й!ј!q*ј!& лeН Й!ѕ!p+q"Нu*Ѕ!лfН Й!А!p+q"Нu*ї!лgН Й!Б!q*Б!& °)	^#V%Н Й!Г!p+q*В!лН Й!#q:#2л"!м"6 л"1Н Й!#r+s+q:#2л"!м"6юе*#лб#s#rл"1Н Й!л"6#6 л"1Н ЙxН> "Н9!µВ®*«"DMНЏГ¶*Ї"DMНЏJ	НЏННДЙ«"НЂ"#яя#Н1!µВвН‘Г> #Н9!µК*#~ю[Вя!"6Г*#~ю]В!"6 *##"#Г!"6 *#Й!#s+q+СБp+qХ:#=2#юяКJ*#:#w*##"#Г-Й!#s+p+q+СБp+qХ:#=2#юяКЃ*#е*#Б
w*##"#*##"#ГZЙН:2#юaЪ›:#ю{Т›:#Ц Й:#Й!#p+qxН*#DMНЏНРЙM	Н"Е Н !#6 >!#ѕЪ?Н‚2 #ю Ъс*#& "	: #wГь: #юВьГ?: #юВГЅ: #юВ-:#юТГЅ:#=2#O !"	6 ГЦ: #юВ8НД!#4ВНН°2 #Й:¦"ЖAOНy:НyЙНF!!#6>!!#ѕЪ‹:!#ю	Вs.Нy*!#& л*Д!>¦OНy!!#4В]ЙxН*©"|2"#юТПxННFН‰:"#юВёY	НЏ:"#юВМb	НЏMНЏНД:"#юВЭMНЏ:"#юВлi	НЏ:"#юВщx	НЏ:"#ю	В‡	НЏЙ!##q&"Нu–	НS2##Й!$#q:$#юяК>:$#‡‡‡‡‡o& &""Д!:\ wЙ!"6 !"6 &"Нu*#лEНZ*#лGНZ*#лIНZ*#л НZ*	#лНZ*#лНZс"Е*#DMНKНc2%#юяВЎ> Й*%#MН>Й!'#q=НЏ:'#ТЕ—	НЏГЛљ	НЏЙpНЏ
НZТдћ	НЏГк«	НЏ»	НЏ	НZТMНЏWНЏГ]НЏ	НyНZТ!AНyНZТ/1НyНZТ=2НyНZТK3НyНZТY4НyЙ!(#q*(#& л*Д!~Тq>Й> Й:"Ъ’:"Ъ’&"Нu\ НSOНЙ!)#q:)#юВЁН…2*#ГІ*¦"MН2*#:*#юяКйѕ	ННFН‰pНЏ:)#юВгMНЏWНЏГй]НЏЙ:"ТтЙ*¦"MНЯ2+#!"6 > !+#ѕТIНa:,#‡‡‡‡‡o& &""Д! 	>р¦w *Д!	~ю КF *Д!	~ю КF!"6Г[!\ "Д!«Е] НK!"6Й&"Нu•НS2,#:,#юяК—:,#ж`O !&"	~ю ВЋЙНc2,#ГpЙНРНUН‰Н‰Й:"Ъэ!"6*Д!еЖ!НK!"6 +6 Ж!Нп"©"}юяВн*©"|ю КгНЊГмтНџНЙ:Т!2"ю Кэ!"6Й:"ТоНџЙ"Е Н *Ь"е*в"л"НK"jН Е	Н!	"6 "НЏЙ:"Тb:"ТTоНџЙНҐ:"ц2"ГpНк *Д!	>¶w	"Е Н :г"ю В‰!"6Й!"6*а"е*г"л	"НKЙ:Ш"ТҐЙ:"ТёсНџ!Ш"6ЙНк*Д!#е Н > !д"ѕТ3!-#6 :д"=!-#ѕЪ"*-#& л*Ю"~ю.В*Ю"е*Д!#DM*-#лНK:-#Ю"Н!#е	 *Д!	DMНKЙ!-#4ВХ*Ю"е*Д!#DM*д"лНKЙ!0#s+q+СБqХ:Ш"ТGЙ:"ТZ!Ш"6сНџЙНк*.#& Д"	~Тz *Д!	:/#¶wГ† *Д!	:0#¦wЙ:"ТжНҐ:П"21#юВ¤!"6ЂГФ:1#юВґ!"6@ГФ:1#юВД!"6 ГФ!"6	"Е Н :"Тг:"ц2"Г!:"ТфоНџЙ:П"21#O>№ТїНџЙЕЂН4 *Д!	е Н Й!3#s+q:Ч"Т0Й:"ЪC!Ч"6РНџЙ*2#& Д"	~Тb*3#& л*Д!>Ђ¶wГp*3#& л*Д!>¦w!"6ЙЩ	НЏ!"6 	"НЏЙе	ННFНР–ННU *Д!	>Ђ¦юЂВµ—НЏГ»ЎНЏ *Д!	>@¦Ц@Цџ25#*Д!	>¦юВв—НЏГиЎНЏ:5#Тш—НЏГюЎНЏ *Д!	> ¦ю В—НЏГЎНЏНР *Д!	~Т1НРНvЙц	НЏ:"жЂюЂВKЂНЏГ”:"ж@ю@В^…НЏГ”:"ж ю Вq‹НЏГ”:"/х:	"Ц ЦџБH±ТЋ’НЏГ”ЂНЏ:"Т¤mНЏНvЙ!6#q*©"|юВ.НР:6#юКГНГЙ,НН·:"ТЦНР:6#юВм*Д!DMН§"©"Г:6#юВ*Д!DMНЙ"©"ГЖ!Н"©"*©"|ю К.НЊ:6#юВ(,НГ+Н> Й>Й*Д!DMН§"©"*©"}юяВt*©"|ю КkНҐЪXЙ*©"|ю КhНЊНЙГtтНџН*©"}юяК *Д!	 е*ё!	~бѕЪННМЙ*Д!DMНЙ"©"*©"}юяВа*©"|ю КЩНҐЪАЙ*©"|ю КУНЊ,НЙНРГаJНџЙН€Й>!"ѕТ(:"ТчГ(:"ТГ(:"Т	Й:"Т	НџГ"*НџН!"6Й:"юВ?:"Т?:"цЂ2":"2Т!Ж!Н"©"*©"}юяВЉ*©"|ю К}НҐЪjЙ*©"|ю КzНЊНЙГЉтНџ
НЙ:"юВ¦:Л!цЂ2Л!Ж!Н2o& "©"НН2Й:ж!ю КЖ:ж!=2¦"*¦"MНCНЅЙ!7#6>!7#ѕЪо*7#& \ 	~ю?Вз>Й!7#4ВМ> ЙН­ж!Е\ НKц!Е"НK:] Ц Жяџх:e Ц ЖяџБH±ТY!"6&"Нu\ НS28#юяВO!\ "Д!тНџННД*8#MНГ^!"6 Й!:#s+q*9#& )))A	е*:#& Б	~Й!;#q!<#6*<#& u	:sѕВ—> Й*<#& u	:;#ѕВ«:<#Й!<#4Г„Й!@#r+s+p+qНф!G#6 Н:H#ю К:H#2G#*D#MН{2к"!L#6:к"ю ВН=:L#ЪъГ
*D#MН{2к"ГеГНГИ:A#2и"Н}> Й:A#2и"2K#:H#2I#!L#6 :H#2G#Н:H#ю ВDГџ*H#&  	л*?#е*H#& л*?#С–=2J#!K#ѕВ–!L#6!B#6:K#!B#ѕЪ“Н=:L#ЪЊГ0!B#4ВuГ™Г0Н}> Й:и"е"Н!л+s#rНф:к"ю КВ*е"#"е"ГИ:ђ2к":I#Й:G#2M#O *?#	~2C#*C#& л*=#:sѕК!M#4~2H#*C#& л*=#:D#ѕВЙ*M#& л*?#~2C#ГЭ!H#6 Й*е"~2D#НМ:C#2E#!A#6*е"#~2D#Й!E#4N *=#	:tѕВW!L#6 Гm*E#& л*=#:D#ѕКm!L#6 !A#4N *е"	~2D#Й*A#& л*е"~2D#*D#MН{2к":к"ЦЖяџх:к"ЦЖяџБHЎх:к"ЦЖяџБHЎх:к"ЦЖяџБHЎТб!A#4N *е"	~2D#*D#MН{2к"Г•:A#2и"е"Н!#л+s#rЙ*е"NН{2к"!ђѕВ*е"#"е"ГфЙ:и"е"Н9!+"O#!N#6:и"!N#ѕЪA*O#NНy*O##"O#!N#4В"Й!к"6!з"6 !й"6 :к"ю ВZЙ!‘:к"ѕВeЙ!’:к"ѕВpЙ:ЩНі2з"ю В„Г"!‘:к"–Жяџх:к"#–ЖяџБHЎТФ!“:к"ѕВФ:з"=o& )))A	~ЪѕГ+:з"=o& )))A	 	~Ъ
lNНі2й"ю ВйГ4:з"=o& )))A	е*й"& Б	~ЪГ=ГФ*е""Ъ"!й"6#6 !Q#6 :к"ю В=*е"NН{2к"*е"#"е"!Q#4Г!ђ:к"ѕВX*е"NН{2к"*е"#"е"!Q#5> ѕТФ:з"=юВЊ*Ъ""Ь":Q#2в"O>№Т‰eНџ!в"6ГФ:з"=ю	В¶*Ъ""Ю":Q#2д"O>№Ті!д"6—НџГФ*Ъ""а":Q#2г"O>№ТФДНџ!г"6:й"Ц Цџх:з"=o& )))A	~БHЎТцГF:з"=O !±"	6> !й"ѕТ:й"=х:з"=O !Д"	БHqГQАНџГXХНџГXэНџГO!НџГOGНџГX/
НГ^:
ННГQЙ:І"ТsН":¶"ТЃН":·"ТЏН":ё"ТќН":№"Т«Н":є"ТµНќ:»"ТїН?:ј"ТЙН‡:ґ"ТУНю:і"!±"¦Т:Ж"!Д"¦Т:"ТцсНџоНџНРГP:±"Т):Д"Т!Ж"6 ЕпН4 Еї@Н4:і"ТP:Ж"ТF!Д"6  Еї@Н4ЕпН4:ї"!µ"¦Тt:"ЪhРНџНџНРГ:µ"Т…
Н"Г:ї"Т!Т"6
Н":А"Т©ЕЯ Н4:ѕ"!Ѕ"¦ТА;НџНРГ :Ѕ"Те:"ТЭ!Р"6	Н"ГвН“Г :ѕ"Т :"Т !Р"6 	Н"Г Н“ЙEНB"#GНB"#IНB"# НB"#НB"	#НB"#ЙНЗ2"ТO ж!Ес"НKНсЙ!T#p+q*S#"«""Ї"!ж!"­"НЖ""Й*е"DMНS :"Т њНџ!т!6 C
Нз!НЏНД> "Н9!µК¬ !"6Г± !"6 ж!Е\ НKН9 Й:"Т!:"ТТ Н НeяН—:"Тз Н™Гы :"Тс Н1:"Ты Нд Н—:"Ъ!!"6 Г!Н?Ъ!!"6 ГБ Йл_ л…oЊgЙi`N#F‘ogЙo& •oњgЙ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       ГГ  яяDIRLBL     хyюdК'с*
йс!  9"ь1>л"ҐлН#2’Н#:’OНg}жВ**ҐНIхжp2“~жwж2•iХ™Н#С1ЅН#"і:’НRН¶е   :ћO~ю!К«:џ<2џ№ВЋ:“·В"2Ў"Јx2 *Ґлбе#НO:•·Дј:Ў<Вз: G>ђ O*Ј#
 КзГЯСХел лбХ:ќ<ВяНtГ Сел лбХНtббНIцwНэЇ!  Г/>я!я Г/>я!яе*µ6яхН#:’_Н#:’НБсС*ьщлЙНБНY"«л
 	НY"·л 	НY"µ
 	Н>*·НY"Їл#####НY"»л##НY"§лНY"©лНYлz··2ћ*ЇKНg"ЇЙЇ2—2!  "±*­DMНоНую В6 :ћO*­  Ї2џ~ю Въе ~·бИею бВ†Й:<К~юеВ:—2ў>я2:џ<№Ва*»л*±	"±Н_Ъ?:—<2—ГЛ>я!яБГ/:<В}:ў2—Ну*­   ~юеКbГW6 y2џ> е #КvwГmб>я2ќЙ>я!я БГ/е N
 л*іл~©ЕO№ВІБ+В—л"іб>я2”Й>я!яББГ/ *і:”<КН	"і~ЂG#ВНСбХ p
 л*і~Ёлwл#ВзЙН
ННШЙ:—Н
ННЮЙ*ЇН8*©лНИЙ:—*ЇН8y•O:—‘ O*«лНдлНРЙ   х}ЃOс№Т=Й ~ЙИw#ГP^#V#лЙ·{•ozњgЙИ|·g}oГh:Ў<М‰БСелЕН‰БлбХЕЙ™НOЙ               я                           <   O ГфBK ГфBK Гф$ Гф' ГфХ- * Сй! Гф*   й                                                                  ^#Vл"­Й                                                                                                                                                                                           Ђ  DD ’	$ђ€‘$HD‰ @" ’  @@ $B	 $Ѓ$ЂH$HЂ$HH$$! Ђ €‚HD$D’$D’@A D  ЂH€  D‘$‰!A"   Ђ    Ђ                                      ~юеВ:—2ў>я2:џ<№Ва*»л*±	"±Н_Ъ?:—<2—ГЛ>я!яБГ/:<В}:ў2—Ну*­   ~юеКbГW6 y2џ> е #КvwГmб>я2ќЙ>я!ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее1}Ге                                                          CP/M Version 3.0COPYRIGHT 1982, DIGITAL RESEARCH151282    654321 Copyright (c) 1982, Digital Research 10/27/82Show 3.1ERROR:  INPUT:  OPTION:  DRIVE:  Unrecognized Option. Unrecognized drive. Requires CP/M 3 or higher. No directory label exists on drive  Unrecognized input.  A:0B:0C:0D:0E:0F:0G:0H:0I:0J:0K:0L:0M:0N:0O:0P:яSPACE0DIRECTORY0DRIVES0LABEL0USERS0PAGE0NOPAGEя 	!$'*-/ #(.я  []=, :;<>%\|"()/#!@&+-*? я   ; Z x — µ Ф у 0NSun$Mon$Tue$Wed$Thu$Fri$Sat$????????????   ?Directory     Passwds  Stamp   Stamp Label         Reqd        Update  Label Created   Label Updated ------------  -------  ------  ------  --------------  -------------- Press RETURN to continue. :           Drive Characteristics 128 Byte Record Capacity Kilobyte Drive  Capacity 32 Byte  Directory Entries Checked  Directory Entries Records / Directory Entry Records / Block Sectors / Track Reserved  Tracks Bytes / Physical Record , Space:  Number of time/date directory entries:  Number of free directory entries:       Active User :  Active Files:  # of files  :  Label for drive  Access Create     on        off      on       on       off      on     off         1}1}Н{o& "О >0О НТ Н‘ГД*и!& Ђ 	~ю В:и!<2и!Г*и!& Ђ 	"И Нэ2Р Нh2Н !и!6 >!и!ѕЪY*и!&  	6я:и!<2и!В;Н6ю Вf!$ 6Н(2я!  6 НDю В~!% 6Н±!и!6 >!и!ѕЪД*и!&  	~2 юяКє*и!&  	NННт*и!MНz:и!<2и!В†Ныv!Х q*Х & лН Й НЙЙ!Ч p+q*Ц ~ю Кя*Ц NНЙ*Ц #"Ц ГеЙ  Н ЙНЙ
НЙЙН	   Н Й:$ Тe!  4~<<+х~БH№ТeН	Н	рНЯН ЪMГC  Н юВ]Н!  6Н	Н	Й!Щ p+qН *Ш DMНЯЙ  Н }Й!Ъ q*Ъ & лН Й:~ТќЙ:}юяВ¦Й:}ж`O !	:Н ѕВЅЙ  Н 2}Г•Й!Ь p+q*Ы ~Ц?Цџ2~*Ы лН 2}Н•Й  Н 2}Н•Й  Н Й!Ю p+q*Э лН Й  Н Й  Н Й!Z 6Z 1Н Й!Z 6,Z 1Н Й!Z 6]Z 1Н |Й  Н Й  Н "С Йя  Н Й!Я q*Я & л.Н Й!а q*а & лeН Й!в p+q¶Нi*б DMНЯЙ!и q:з <2з O *е 	:и wЙ!к p+q*й ~ю$Кл*й :з <2з O е*е 	Б
w*й #"й ГГЙ!л q:л Ж0OН¦Й!м q:м жшOНм:м жOНмЙ!н q*н MНъ:Н¦Й!о q*о & л!
 Н†KНм*о & л!
 Н†MНмЙ!п q*п MН&	/Н¦Й:р ю Вe	Й:з юВs	!р 6 Й:з <2з O *е 	~2р Й:р ю В”	Н\	Г†	Й:р Ц0Ц
џЙ!т s+q!у 6 Н†	Н•	Ъ¶	НН•	Ты	:у жаю КК	Н:у ‡‡‡х:у ‡БHЃ2у џТг	Н:р Ц0!у †wџТх	НН\	Г¶	!с :у –џ#х~!у –џБH±Т
Н:у Й!ц s+q+СБqХН†	!ф :р ѕК4
НН\	*х M*ц лНћ	Й!ш s+q:ч жю2щ :ч жЦ Цџ*ш & )	лх>;НџБHЎТ{
:щ =Й:щ Й!ь q*ь & л!
 Н†л))))е*ь & лН€Б	}ЙНћ	=2э :э ЦЦџ2!ТД
!!6ГС
*э & х	~2!/Е*!лН
2ю /ЕcNН
2я :ю ЦЦџ!!¦х:я жЦ ЖяџБHЎТН*э & )	:я ЦN_ е!mНҐСНqе*ю & Б	е NНC
СНле*я M*э лНC
_ бе*г #Бq#p Нћ	OН
 *г 	w:Е; Н
OН
 *г 	w*г ~юВ¬:р ю:В :Е; Н
2! *г 	6 ГВ:Е; Н
OН
 *г 	wЙ!!s+q:!‡‡‡‡!!¶Й!я 6N!m"!:я жю Вр!n"!!ъ НхЪэЙ!ъ Нхл+s#r!я 4ГЪЙ!э 6> !э ѕТP:э =2э юТ2!
!6 *э & )	:
!Нmл!ъ НТMЙГЙ *г 	~2 !*г 	~2!*г 	~2!*г #^#Vл"ъ +л! Н†л!	!sНХ!
!6 :я жЦ Цџх>;!ъ НџБHЎТ®!
!6Н*э & )	:
!Нmъ Нл!ю s+4Й*г ~ю Во:	!‡‡O !	DMНЅ Н¦*э MНK	*ю MНK	*я MН&	 Н¦* !MН	*!MН	*г ~ю В&*!MНъЙ!!p+q!  "!*!"г  	"е *г ~Ц Цџх~ЦЦџБH±ТeНQ!з 6яНПГћ*г ~ЦЦџх~ЦЦџБH±Т›!з 6 *е ~2р Нў
*з & л*е "!ГћНЙ!-!p+q!!6.е*,!DM!б
-В¶!Н'!.!6 >!.!ѕЪн*.!&  	!	NНЙ:.!<2.!ВЙЙН\*С ##N! НЛЂ НҐ"/!Й!1!q:1!2Р OН…НоЙ!3!p+q!2!НСл*У >2!еНy#MбН№Й!7!s+q+СБp+qХ:7!=27!юяКf*4!:6!w*4!#"4!ГIЙ!‰!s+p+q+СБp+qХ> ‡!НµКг*…!л*‡!Н†!Љ!s*…!л*‡!Н†"…!*‡!л!
 Н†л"‡!> ‡!НµВєГТ:Љ!ю КЕГТ:‰!ТТНЩГа!‰!6 :Љ!Ж0OНЙГvЙ!Њ!p+q!'"Ќ!!Џ!6> Ќ!НµК8*‹!л*Ќ!Н†:Џ!=2Џ!O !8!	s*‹!л*Ќ!Н†"‹!*Ќ!л!
 Н†л"Ќ!ГхЙ!ђ!6#6:‘!=2‘!юяК}*‘!& 8!	~Ж0OН~:‘!ЦЦџх:‘!ЦЦџБH±Тz,Н~ГAЙ!’!q*‘!& 8!	~ю В¤:ђ!Т¤:‘!ю К¤НЩЙ*’!MНЙ!ђ!6 Й!–!r+s+p+q!—!6 #6 >!!ѕЪ0*!& л*“!е*!& л*•!~б†!—!†#N *•!	w*!& л*•!^ !
 Н†!—!s#N *•!	^ !
 Н†е*!& л*•!Бq:!<2!ВГЙ!љ!p+q8!Е Н<?!Е Н<*™!N#FНд*™!##~2њ!!›!6 >!›!ѕЪ™:њ!Т‡*›!& w!)	N#F?!Н±:њ!·2њ!:›!<2›!Вd8!?!Н±Н9Й!ћ!p+q*ќ!##~жа2џ!*ќ!##~жь*ќ!##w*ќ!НСе*ќ!Бq#p*ќ!#:џ!¶*ќ!#wЙ!Ў!p+q* !#е*С ##NбН№ *С 	¦* !##е*С ##СNлхНАБH±* !##w* !е*С ##NбНЗе* !Бq#pЙ:Р ЖAOНЙ
НЯЙ!Ґ!r+s+p+q*¤!/!Нaе*¤!Бq#p*¤!л НъЪ’*¤!л Нъе*¤!Бq#p*ў!N#F*ў!q#pГcЙ!¦!q!  "§!"©!!­!6 !  "«! *С 	л«!НхЪм:¦!ТО*«!DMН2­!:­!/ТЯ©!§!НH *«!"«!Т«*§!Й!"®!НiН8НЯ*®!##6  *С 	N#F*®!q#pНйНх,НЯН¦НхEНЯ *С 	N#FН^НЯ *С 	^#Vл))DMНyНЯ *С 	~<o& Ђ НҐDMН”НЯ*С ##N! НЛDMН®НЯ*С N#FНѕНЯ *С 	N#FНОНЯ!Ђ "°! *С 	> ѕТг *С 	N!°!НЗл+s#r*°!DMНЯНЯН ЙН Н1:НЙНЩЙ!і!p+q*®!##6 *®!е*І!лбs#rНхЙ!µ!p+q!'"ё!!·!6 > ё!НµКљ*ґ!л*ё!Н†{2¶!*ґ!л*ё!Н†"ґ!*ё!л!
 Н†л"ё!> ё!НµЦџ!·!¶+х~Ц ЖяџБH±Т—!·!6:¶!Ж0OНЙГ5Й>0О НТ№Н"У Н“DMН$ГТН*Р MНqН¦Н1kНЙЙ!»!p+qН Н8RНЙ*є!}ТщOНЙГюWНЙчНЯН›Й: ТЙ:Р 2Б!Н"ј!НS"ѕ!!А!6 > ј!НµК€*ј!}Тg: /ТX!Б!:А!ѕВU*ѕ!DMНШГg*А!MН*ѕ!DMНШ!ј!НСл+s#r!ѕ!НСл+s#r#~<wГ': Т”! 6Н ЙН Н Н8> !X НТДНЯ*X еиНgН Н8)НЯ*V еиНgН Й!В!6 >!В!ѕЪ*В!& & 	6 *В!& 6 )	> w#6 :В!<2В!ВЯ!  "X Н5НМ!  "Д!:}юяКЪ:}‡‡‡‡‡2Г!*Г!& 	~2В!юеКФ:В!ю!КН*Г!& ‹	"Ж!*Ж!##"И!*Д!#"Д!:В!2Г!:В!ж2В!O !& 	6>!Г!ѕТђГФ*Ж! е*С 	~бѕТ¤ГФ*И!~ю ВК*В!& 6 )	N#F*В!& Е6 )	Бq#pГФ*X #"X НоГ%*Р &  	6> !X НТ *С 	N#F`iНХ"X  *С 	N#FPY*X Ндл*Д!Нд"V ЙН Н8QНЯНhO ЕиНgН Н8`НЯ*Р &  	~/Т\НЪ!К!6 >!К!ѕЪђ*К!& & 	~Т†*К!& еиНg:К!<2К!ВaН Н8oНЯ!К!6 >!К!ѕЪШ*К!& & 	~ТО*К!& 6 )	N#FЕиНg:К!<2К!ВЎНЙ*Р &  	~/ТоНЪНЙ!Л!qНDНМ> !Л!ѕТЙ:}юяК0:}ж`O !	~ю В*ЙНоГЙ*Р MНЃ2М!> !М!ѕТ/ Нт:}‡‡‡‡‡o& "Н!~НiН8Н EНijНi:М!ж@ю@В†ЏНЯГЊ–НЯ‚НЯЄНiН НB:% /х:М!жЂЦЂЦџБHЎТЅќНЯГГ§НЯ:М!ж@ю@ВЦ±НЯГп:М!жюВйєНЯГпГНЯ:М!ж ю ВМНЯГУНЯЪНЯ *Н!	DMНџЯНЯ *Н!	DMНџГ>Н‘:Р ЖAOНЙН Й!П!6>!П!ѕЪx:П!ю	В].НЙ*П!& л*Н!>¦OНЙ:П!<2П!ВGЙ!Р!q!С!6*С!& Ф	:ТѕВ•> Й*С!& Ф	:Р!ѕВ©:С!Й:С!<2С!Г‚Й!Х!r+s+p+qН)!Ь!6 Н?:Э!ю К:Э!2Ь!*Щ!MНy2М !б!6:М ю В	Н]:б!/ТьГ*Щ!MНy2М ГжГН?ГЙ:Ц!2Л Н©:Э!Й:Ц!2Л :Л 2а!:Э!2Ю!!б!6 :Э!2Ь!Н?:Э!ю ВJГ±*Э!&  	л*Ф!е*Э!& л*Ф!С–=2Я!!а!:Я!ѕВЈ!б!6!Ч!6:а!!Ч!ѕЪ Н]:б!/Т–Г6:Ч!<2Ч!В~Г¦Г6!Э!6 Н©> Й:Ю!2Э!:Л И Нlл+s#rН):М ю КЪ*И #"И Га:п2М :Э!Й:Ь!2в!*в!& л*Ф!~2Ш!*Ш!& л*Т!:ТѕК9:в!<2в!:в!2Э!*Ш!& л*Т!:Щ!ѕВ(Й*в!& л*Ф!~2Ш!Гш!Э!6 Й*И ~2Щ!Нд:Ш!2Ъ!!Ц!6*И #~2Щ!Й:Ъ!<2Ъ!*Ъ!& л*Т!:УѕВ}!б!6 Г“*Ъ!& л*Т!:Щ!ѕК“!б!6 :Ц!<2Ц!*Ц!& л*И ~2Щ!Й*Ц!& л*И ~2Щ!*Щ!MНy2М :М ЦЖяџх:М ЦЖяџБHЎх:М ЦЖяџБHЎх:М ЦЖяџБHЎТ:Ц!<2Ц!*Ц!& л*И ~2Щ!*Щ!MНy2М ГБ:Ц!2Л :Л И Нl#л+s#rЙ*И NНy2М !пѕВD*И #"И Г)Й:Л И Н+"д!!г!6:Л !г!ѕЪy*д!NНЙ*д!#"д!:г!<2г!ВWЙ!ж!q *ж!& НҐ^ 	е*V& Б	~ю КћН *ж!& НҐ^ 	е*U& Б	~ю КѕН1 *ж!& НҐ^ 	е*T& Б	~ю КЮНр *ж!& НҐ^ 	е*W& Б	~ю КюН# *ж!& НҐ^ 	е*S& Б	~ю КНЬЙ: юяВ::Р 2 * &  	: wЙ*И #"И *И NНy2М Н:М ю ВZГ”!ф:М ѕКq!р:М ѕКqГ” * & НҐ^ 	е*V& Б	6*И #"И >Й * & НҐ^ 	е*V& Б	~юяВК * & НҐ^ 	е*V& Б	6 КЉНґ2К ю ВЮГ!X:К ѕВр!$ 6Г!Y:К ѕВ!$ 6 Г * & НҐ^ 	:К =O 	6Г-ЧН‘ЖНiНE!р:М ѕВ:>Й!ф:М ѕВG>ЙГКЙ№ZНґ2з!ю В_Гћ:з!=2 * &  	: w * & НҐ^ 	е*V& Б	6я!т:М ѕКќ*И +"И ЙмН‘ПНiНEНЙ! 6я*И NНy2М !рѕВйН * & НҐ^ 	е*V& Б	6! 6Й!у:М ѕВьН;2М Г-:М ю В
НKГ-!с:М ѕК!!п:М ѕК!ГL! 6я*И #"И !р:М ѕКK*И NНy2М !рѕКKГйЙ?Н‘ѕНiНEНЙi`N#FЃo€gЙл_ л…oЊgЙл_ лҐo¤gЙDM!  >х)л—)лЌ‘o|gТџ	с=ВЌЙDM!  >)л)лТґ	=В¬Й~ВєЙ~‡ВБЙ^#Vл)ВЛЙ^#Vл|·g}oВХЙ_ {•ozњgЙO {‘ozgЙi`N#F‘ogЙo& •oњgЙ_ {–_z#ћWлЙ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    	  	F!M!T![!b!i!p!                                                                                                    В
НKГ-!с:М ѕК!!п:М ѕК!ГL! 6я*И #"И !р:М ѕКK*И NНy2М !рѕКKГйЙ?Н‘ѕНiНEНЙi`N#FЃo€gЙл_ л…oЊgЙл_ лҐo¤gЙDM!  >х)л—)лЌ‘o|gТџ	с=ВЌЙDM!  >)л)лТґ	=В¬Й~ВєЙ~‡ВБЙ^#Vл)ВЛЙ^#Vл|·g}oВХЙ_ {•ozњgЙO {‘ozgЙi`N#F‘oеееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееен{ !Ђ ^ #6Ѓ Нш,ю(dю/(`ю: 	НР ЪбV!  ›Q н°!\ УQХ н°!5ЬQ н°СНйНя*0(%>Ђ2ѓ!  Н% 8ю(ю 0у#Н% 8
ю(	ю 8уг*0л
!  Ъбъ J8PЇЅ(. $л* . ·нR8> нR87еЭ!я  |ђG! Э~ юя(	_~ЂwЭ#рбяI	л! 	нёл·нRй=йм	Н Г  RELOCATING ERROR
$y
'
3	3				"		

	
	

	
		A			:$





	')
'	/	±
#

“#	o2	>


		!
"	
			


	™		
	]
		
	%
		
M!


	6	
	
<H 4				KKL				
		
%	&	#
	2G	%!	

	+
	
			@

	#
	
	(*		*		‘4
"5)	
Зяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя       Г­BГ                              PPя     COMSYMPRNT80    
,.;:_/

        T               Чя  f>Г¦QГмГxГ­ЭеэееН¶бэеБA:µO:¶·:ґ(Эеб+#н[ІэбЭбЙЇ=2ґ2µ2¶э! еЭбЩ Э~ юЭ Ђюэ АЭ~Э#Э~ !єM!кLюн(юЛ %ЛГ!cLЛ{(Э#ЭF> юx(> Г­!„L Э#Э~ WЛ~#(ыz®#¦# фН>Э#ЩЙЇ2µЙzЎЙбЛ~#А~еж!9ею 8cю`ЪэЖ‰8Цр!ѓ‡…o> Њg~#foй! ‡…o> Њg~#fo+Н3<Л~#(ы= ш»ЈЁІѕА·ГПЈ./*Ї2¶ЙН3H!.NЖzж85Э#Э~ .ЇyoЭ#Э#Эf ЭnяЭ#ЭебеБ#
O 0	"ІЇ2ґ|Нм}хНхсжЖђ'О@'э+Г!dN!rNzЎў>Н3!`Nю “Л{(ЏЖЛs(‰<†Н3z<ЎЛ{('ЛC Pю8Gzоpжx(>zоFжЗ(7x№ ЛЛЭ#ЖЛs(Ж!пNНxЛKИЛ‹·(G>+тxxнDG>-НэxНм>)Гэx№(ЙУхyНQс№ИGzо@ж@ИЇН­xЅҐNгNУN¶N®NЄNЗNБN‡N     Э!RН‚%>№В¦?н[R*RГю  :*C<ЕХе=_НЎбСБЙеЕ! 6 #ы!  6 БбЙНйХНxНЎ<СЙХНЎ<КкСНяКЙХНЎ<СЙХ:ѓ·ДaЪИСХНЎ<САН­CLOSE ђГЪ!УQН¬!л§!УQНэ ЪыЙНXеНD%Їё !\ СНйл н°Й>яЇ2(Н­„НЪ$!фQ	Нэ ЪыеНD%"†НЯСНРНяК>Ђ2Q!я "&ГФХ!\ Н!!l Н!СНк!Ѓ  6 ю(w#у!Ђ pЙю АщН/НјНlря! НўН НџBНU3Ђ Н­B! еН)бГЕ?Н/э!  Н·еХУQНРНя(&Н­EXISTS, DELETEџНjю ФН юYВЪН НСбеХ~Нр#э#Н0фУQН)эебНK Н­ SAVEDђНMЭ!/TЭ~·(AНяД НСбН­‡ХЭFЭN НЈ;ФЯ
 ЭСЭ~· з>НрУQН)Н­DISK ђНџBГ¦>НџB#ХНЎ2RСЙН­DIRECTORY ђЯН­ђГ-@Н­NOT FOUNDђЕН­TOO LONGђ¶Н­LOADђУН­„Н8м!УQ Нэ 8№›! "R!яя"R!  "RЭ!RНX%НG%*Rн[RГУQНРНя(Ћ>Ђ2ѓЙН/НDеХНlнKRx±(Н% 0цСбеХНg<Нў`э!  Н% 81Хя
Н	ЪСwѕэ#ВЈ#Н0гН­EXCEEDS UPPER LIMIT, Н­NEXT FREE Н”Н эебНK Н­ LOADEDђЙНMКФ>Ђ2ѓэ!  СбЭ*Э6 Н=ЪmЭееНЁDMбКxю  *Эq Э#Эp Э#ЕНЗ((Э6  Э#хБНЈ;Б8Аэ#Э"ёЭ*Э6 Н­ ђН­ ђГЪэебНK Н­ S LOADEDђГФН­MEMORY IN Н”Г НЏН!  НШюИю!8уНЈ Ш)8ыµoНШо	НШю!ШЭw Э#уЇЙН% РГ[ЭеНx:НчЭбН­	ЉЙН>РГИЭ~ю ИНрЭ#уЙ/Tе7нR?бЙх|µ(ссс7ЙН	Ъ¦?ЙхЕХяJ?хЕХB?хЕХJ? Н±Н‰(НjG:bёx(#НЎ(СБсЙхНєсх>/НН­ЂлсйхЕХJ?Нє>-ННjG:bёx Н4@: @ЦLДњСБсЙНЎ(ДГJ?U\}Йе!Zѕ(
ѕ(#ъбЙхЇ2&сбЙЇ№АГ”Н‚%>№Эn Эf 
яяЭsЭrЙЭ^ЭVГЭ!ћНАН­ADDR  0  1  2  3  4  5  6  ·:(юH8Н­  8  9  A  B  C  D  E  ЖН ЕХН$"LН4СНБШнЭ!ўНАХНњ"LМ Н4СН0нЙВ¦?:)=GЕНњ"LК¦>Н4Бр НlдЭ!¦НАХН[0^#VеН-б"LН Н4СН0еЙ я
 я
 я
ю#(ю"(НX%>№К¦?0Х+!R н°Сю((Э!0Нh.y2/*+н[-Н:/ю)Т¦?еХН "JлН=лН”Н НlСб#Н4Н0ЭЙеЭ!0:/G~Эѕ  Э##хЇбЙяя  я9Нm81жю(+ю
(сю +кGЇј Ѕx бю Н‰g Н€%Э!  !Шя9щЭ9(Нш,ЦЭw Дh.*Rн[RНЭеЕЭ~ Нi3Э##НЪ¦> оБЭбжН3е·нBб8лнRеЕбБНЕ#щл·нRеЕбБл	л	НЕ+щ/Нi3/Нi3x±К¦>Й(Н3"-нS/нC1*-н[/нK1Н
ѕ(+еЕХЕН­MISMATCH AT "JН[0бН0Н[0Н СБбНl#Н4Н0ЗЙяя    Н€%НG%*Rн[RНнKRЙ    НTеН­ЂН&Нњх:)Ц	G:†6·(<<ђ0"нDG:|ё8xGс(
Їё(Нњ цЇё(Н цсН НtчН­  A   B  C   D  E   H  L      SP    IX    IY    I  IFFђ:иBНVНгйBНкBНмBНоBН0НҐCНҐшBНҐъBНАН Н НtчН­  A'  B' C'  D' E'  H' L'     н[CНџыН :рBНVНгсBНтBНфBНцBН0н[CЕН…БщН Н ‡6Нш,юДюбНТН`Й*C7нR0$К0ел^#V#лН”бЙ*CЕЇнR|· µ(
Н­­}НЖН0БЙНюB: CЛW>0(<ГН­‚:76·ДрЇ276еНЯбН­ЂЙ)Н0Н­REAL TIMEђЙлН„2Н|%Ї№К ЕЭn Э#Эf Э#НѕБйЇ2I2JЙН”Н±BНўеЕ~Нm#БчбН0BНў~НP#щГ ю0ю 8Г>.щНv>:(	}ж>.(> Н~ГЖХЕе!иB
^#V#гНAг(у–2Нш,Ц 8	НD%лгНAгбБСЙ}ЈИ=хЕAН0Бст:(юHРЙН”Н±BеЕН_#БшН0бB~НP#щГ НT:*ю7Ъ хНЉсюAх:иBФVНйBНЇкBНЇмBНҐоBНЇCНЇшBНҐъBсюgхФАсхФ0сю_хФXсФхН”еС:*юsТЁюUТ­юKФ=еНЋН бГ е!охЕOЛ~#8>.НуБН0сбЙе!чЫхЇ<2‰сЙ :‰·И:*ю7ШюAФаН­A__B_C__D_E__H_L___SP___IX___IY__ЯюgФФю_ФаН­_PC_ЯГ Н­_I__IFFЯЙН­_________ЯЙSZ1H1PNC 8421842±ХЕэеэF!яя"GЇё($э#э#н[Iэn эfлН	л8жн[GН	8Э"GШ*G#"I+эбБСЙе·нRбЙ    :‰·Д еНњбЙэ!КOНr3>GН"э!&OНr3>BН"э! OНr3>CН"э!фOНr3>JН"ГхНTХНXгНC Нхб	НTНXННџеНА!СН=леНЋЭбЕеН0· Э!/TНJ:81Н	Н :)Э~ жЯюЭ Э#>ЖЭ® жЗ(ЦА +~ю 8ю0Н	~Нh0Н бБy·БСэбЭбЭбЙН­»Йн[CНAВ0Н­ PC ЙКъН>/ГЭ!/TНJ:ШН	Г :Э!/TНJ:
8	Н :>:НГ0ЭгеэеХЕЭеЭгЙЭгББСэббЭгЙНTхOНxсН`ЙН¬QГ±НTННQН`·ЙНTН¦QН`·ЙНTхOНЇQсН`ЙЭеэеН QэбЭбЙ!,~·А#~юЂА:*жА:'·АyхЕХен[(*+Нцю	МюМюМю 8·Д”"+нS(бСБсЙW}<(=јЬzю
А$Й{ґИЇ»Дg>Н”ЇЙ>Н”Ї_Й> Н”>Ј хЙеХХлНЎСНЎН Сб·6 И6Ђ7Йе+N#Ї№( >Ђ‘wе+6 #	гЂ СлнёбЙеХЕ!-~юЂМG~юЂМџ~юЂ7(4^ е~бНЌБСбЙю7?АЇ2'6Ђ>Нк7Й:'·ИНШ®Н*РбН‰АН~ИНfШНД:y·(л=ъН‰АН~(чНfШНДоК¦?:'·В•?!®Нэ ЪыНш,НG%®НРНяКНџB>Нк>я2'ЙВ¦?!-Г’еХ*CН	СбЙ      ЂНJ‡СЭб. Ш,ЙН¤sЪ rН}sю)В¦ЊЙюN Ію: «Нs>­oЙЕ:НoБЙНLsAНbsАеНLsБyҐoрНьoНjsOНbs(XНbsАеНjsБy­oйеНjsБyµoЯНьoХНЬs(ю)(юIхМПsс(лю( жН¤s0НПsЭ7СЙЕХе!,O~#ѕ7(	_ +4#нZqyбСБЙх:'· схНП0НfНДссЙжю84ю 0ю0=ЕнK*Л@ДkЛH(ЛA ЛP(ЛIДкЛXДcЛ`ДкЛxДрБЙеЕ!lO 	F!+pБбЙеЦ!цH·(Л~#(ы=хНЎбЙЛAАЛIИГкЂгеНїНЎГ·геНї~жК·Нk#фгеНї~жК·Н”#фх~НЛ~#(чсЙгх~НЛ~#(чсгЙЕенK**AН
Ѕ >©Oј >©Oх>Нк>
НксЯнC*бБЙНjG:CёxА:96<xА296НTНћ4Н``еХЕ*†нK(н[&Н*"†нS&БСбЙ    Ї»(<є 9Н 81жю(+ю
(сю +кGЇј Ѕx бю Н‰ Ї№>И	ю	А> ЙГ-@НЙ:-·(Н€ю{РюAШю[8юaШо Й  НTН©QН`жЙх|НЖ}НтсЙН”ГхгеНјНџгеНјН”б##гЙНїх~#foсЙхНМсЙхНХсжЖ0ю:ЪЖГгеНї~НтНхГ·НЖН­ ЙН­  ЙН­ђЙгеНї~НтГ·геНјх|Нт}НтсНхГ·НcН­ЂЙх> (НшсЙеХЕх!ѓ^>Ђ»еМaб8^ 4#сw·БСбЙс7ш„НЎУQНЎН ю?Ш!ѓЃ6 #ыЙTACK UNDERFLOWђГ-Ќе!YНћvбЙХе*ЖvНєvСХs#r#"ЖvбС:Еv<И2ЕvЙ-ЎН	_Р!/џЙ /џе~юЭ(4юэ(0юн(!юЛ($!wOy®#¦## ш+FЛx ЛpЛ°бЙб7Й#N!>wабЙ#~хЕХен[(CНЎбСБсЙеХЕ!Q^>Ђ»фQеХЕ!ѓ^>Ђ»УQМ*8^4# ~·БСбЙЭ!p Э!l Э^ ЭV>0·нR8<шНЭ#Э#жЙ'иd 
  Л|>+(	л·!  нR>-НБ!  НЈ 0§Й)Ш)Ш)Ш)Ш…oкю0Шю:8	юG?ШюAШЦжЙ!  ю0(ю1(ю_(§Й7нjШй!  ю08!ю:0Ц0ХеС)8)88)8С…o> ЊШgЪ§ЙСЙН!ШГ.%е6 #6 #ы6 #ыбНш,Шю:6  Н}!Ше#ю*(НP!8	НЊ!бШю. kеХ	 СНЊ!бЙyю ю?Ию+Ию-Ию!Шю[?Шю@Рю*?Рю0Шю:?ШЙНP!юAШюQ?ШЦ@wЙyю ю*(НP!?Рw#ч7Й7И6?#ы·ЙХе	  л!2	н°бСЙНИ)хНЙ!сЙ~Нт#шЇ№ИН0хю+(ю-(ГЗ"Е НЗ"НБ"БЙНк!Хл!  ·нRСЙН("""Й  Е#Н"БЙёА№АёИГ¦?Н_"OН"(XН"АНP"¬gy­oзНP"ґgyµoЫеНБ" Н_"НБ"БxЙН|"AН"Ае Н|"НБ"Бx¤gyҐoжюN ю#В¦? Н"НБ"|/g}/oЙ!   еН#xБ	Gю+(сю-(нЕ НЮ!НБ"БЙН("ЇёАГ¦?Н¬#ГН"Нй"ИГ¦?г>ѕ0ѕ# цЇѕ# ьгЙ#гЙНФ", +-)/\#:*>=< Йхе*}Ж@o0$нrТ¦?бсЙНЮ!ю\(ю*(-ю/АНБ"еНІ"лгНp#ЕбСаНБ"еНІ"лгНp#ЩеЩбСКНБ"еНІ"БХлН\#С·!  >=ИЛЛ0Л#Лсzі(.е!  Щб  Щ>=ИЛ:ЛЩЛЛ·нRЩнR?Ф›#ЛЛеЩЩнZ·ЙН­/0 Г¦?Нь"ю. ЕЭеН<ЭбВ%БЙю!  Н¶ Ъ¦?ГБ"ю%  НР Ъ¦?ГБ"ю$ *CЙюX Х–2Н("СЙюY *"ЙюZ *JЙю@ 	НІ"~#foЙюH НІ"l& ЙюL НІ"& ЙюP НІ"ЕЇјВ¦?MнhБЙю^ НІ"ЇјВ¦?Mg.№И)ъГ¦?ю( ЕН("НБ"ю)В¦?БЙю[ ЕНІ"Бn& ЙюU НІ"Х7л!  нRСЙюM *LЙю' ю!Ъ¦?o& ЙюI 8ю(В¦?Н}&ю,В¦?еН"НБ"е!  ю, Н"ЭбБю)В¦?Ї№ИЭебЙюR "НБ,>№(8
~ !  И,Й~#foЙn& ЙНЉ Ъ¦?ЙН­ђГ-@Нш,Н"Нш,юИю,Ию ИГ¦?Н(%Нш,юИГ¦?Нш,Н}&ЦЭе ЕН(%Їё(БЭu Э#Эt Э#кЭб§ЙБЭбЙ
Э!RНX%ГG%ЕНX%yБёИГ¦?еНѕ"БЇнB!  ЙНѕ"ю=(=ю>(ю<В¦?ю=(ю>(;Н”%ШИ,ЙН”%Ш,Йю=(ю<(#Н”%(Р,ЙН”%ИР,Йю>(лю<(ФН”%А,ЙН”%И,ЙНP%ГG%ю((2юT(юS(юQВ %ХЬ1Н}&СЙ.ЙЭеХн[CЭ!/TНJ:СЭб. Ш,ЙН¤&Ъ %Н}&ю)В¦?ЙюN Ію: «Н&>­oЙЕ:Н"БЙНL&AНb&АеНL&БyҐoрНь"Нj&OНb&(XНb&АеНj&Бy­oйеНj&БyµoЯНь"ХНЬ&(ю)(юIхМП&с(лю( жН¤&0НП&Э7СЙю(МП&ю) хЙНФ"<>=T:QS ЙЇ'ьНИ)Ъ·?~#ъН4нsRн{C    нsCн{RНв3"CЙ(
э! OНr3Вш(НF(~#Н9(& ж8oC(
э! OНr3Вр(НF(###Н9(++y*оB$*шB*ъBg'ХнMНP(нsRн{CбнsCн{R"CГЃ'лњя!Ѓ@	~##†#–Ц (
ле}lgwбГЃ!Ѓ"'лГЃ:.· (е#^#V! ·нRбКЪ(еf>·нRКf>б#~#foЄ#~#O·яъЬ'	њнKкBнCкB з~ж8цВ2ъ'н[иBХс 8'###"CЙ~2(нKиBЕс §'к~ж8цВ2!(нKиBЕс g'Щ~жцВ24(нKиBЕс С'Ел*C+r+s"CлЙн[ьBнSьBЙн[ьBнSьBЙяНj(Г“7 Нj(Г“7~юЙКg'юНК8'юГК§'юКС'юКЯ'юйКR'жзю К&(жЗюВК(юДКм'юЗК'юАК(~юнВј(#~+юMКa'юEКg'Ги&~юvК™>жЯюЭВи&#~+юйВи&~юЭКW'Г\'е*C^#VбХНB6С·енRбАГP(еСГB6:{ѕК•?еСГB6"!)#"%):{ж8o& "))! )+)ГB6Н  е!  гГ   Ї2‰ен[C*C·нRбЬx)Нћ):ЛO·(
э!КOНr3В:6:фO·Кb(э!фOНr3Кb(ГЪ(еХ*Cн[C·нRЬx)СбЙ:/·ИН­STACK UNDERFLOWђГ-@е!Нћ)бЙХе*Ж)Нє)СХs#r#"Ж)бС:Е)<И2Е)Й-TН	Р!/RЙ /Rе~юЭ(4юэ(0юн(!юЛ($!*Oy®#¦## ш+FЛx ЛpЛ°бЙб7Й#N!>*абЙ#~юЛ(!e*Р##~жю ЬбЙВЗCДЗCГяCНяCП"зЖЗЗ зBчBУч  BЗcч„CЗpю„@ЖGзgчDюFпMя^я д  Ђ	П!я"ч#ч$ц&чvяЂpшFЗ†ЗDЖ„Ж`рбыгяйпBщя4ю6я  ЂН,)Г–>НИ)Ъ·?H 	"CН­SKIPЂН4@еНњМ бГТН4@Н,)НKГТН,)НN:*жАН­…ГЦ*ц*ДD%"ц*Г–> е*+Д+"+|µгКЈ>Н,)НNН*.г+н НD%НБ"|µАГ¦?е*K+Д+"K+}¤<(|µгК–>Н,)Н,г+рбН,)Н,ш е(Н(%еЕНD%Їё("‡+Ббё("‰+н[‰+нK‡+бХЕН,)Н,БСНA сx±К–>й    е! ,М¦@Нп+ХНP%Н(%ю(НP%юВ¦?С!  "ю+бН,)Н,е ,НP%ЇЅ(Н(%еБ*ю++"ю+#	|µК™>Н(%ю(СНP%ЇЅ(КбеНNН*.АеХwю СбЙ#у  TђГ  Н­jNO BREAKPOINTS , CONTINUEџНjkю ФjН lюYИГ¦‹   Ї2њеГА‚нSњеНБ,Н·,>№(+8DеЕН9.НG%yюТ¦?БС ·(HбЕХН,)Н,СБ № сГ™>еНD%Нб.MСбЕХН,)Н,СБ№ тГ™>еНD%еБСбЕХН,)Н,СБ№ тё мГ™>ю ИюИГ¦?!|HН+CЪ93НН"!иByю0		ЙЦю0O	ЙЦO!ЬH		~#N!иB	 GЙю Аще!яяДD%н[ьBгН,)Н,гн[ьBНAг пГ–>В¦?НP-В•?еНZ(СеХНA(
Н,)Н,СХсНZ(БСНAХЕPY(гГ–>~юИюйИжзю ИжЗюВИжГюАИ~жЯюЭА#~юй+ЙНЉ-ВЎ*В¦?НЉ-В•?Нћ)Нр(Г–>~юНИжЗюДИюЗЙНЁ-НЪ(Г–>НЁ-Н)Г–>еНD%Їё(БебГћ)НD%ЇјВ¦?ё(ЅК¦?}2!.:!.G:Е)·Иё0G*Ж)ЕxнDGНє)##щНє)^#V#еЕНє)^#V#еЭебЇнRД лН"НAхМлсБСZ Д‹еЭб`iCПЙяВ¦?Ї2Е)ЙЕнK}Н4x± шБЙеН(%хЇјВ¦?MсбЙЭе ЕН9.Їё(Эq Э#БпЭбЙБЭбЙеЭб Нь"Нш,ю"(ю#(.ю(;ЕН(%НБ"БНб.}х3Эю Ъ¦?ю"(х3Нь"нН.%ДЕН(%НБ"Б}lgеіx№Ъ¦?Ї№К¦? !  	9+AХлЭебНi3#шл+щлСA3эЙ$И%ИГ¦?Н9.НБ"ЕНh.К¦?yБЭF нAЭ#= цЙ!L/М¦@Нп+Нh.НG%Ї№ИЕН­PORT: Э~ НтН­ HEX: ЭN нxНтН­ њНyЭ#Н БЛ! њэ!фњН·…э!КњХНe†СЙНе‡НdэFЇёИЕэеХеНяeеБбСНЈ€8	ХеЕбНњfбСэбН"_БН»еХ!Dѕ(#щСбю 8йЙлN Сбг	гю Й(ю"К…0ю#К…0Н(%Їё(";0юВ…0*;0Н[0";0=0Н’/8х;Н4@+к#Н дГ :)=G_ нRН ЕН[0^#еVН-бБоН А:)GН #б7Н¦1(±еЭбяНh.Ї2' Н ГJ? 
T      TT4лЕХЭеН=ЭббБН”ЙНK0Е~Нh0~БГтНs0ТхГ0ю Шю?ШНЂ0НН­§ЙЭ*;0яНh.";0Н­NEXT Н”Г ЕХT]Оя	Н1НA(8цлСБ+ЙнBСБЙеНБ0бЙНџХеНА!СХН=бНЋ=OН0сЙ(
Н(%Їё("¤1ю*¤1В›1Н»0|1"¤1Н’/8хfН4@Нџ0иН1гН НИ)0H 	ЙН1:)GЕНБ0М-Н БтјН #¶Г е:)=GНџ0ыН ебНБ0М-Н СХЇенR0$(кббЉ!Н¦1(†Н©FЇ2'Гп0Н ГJ?>A{8     {{ Н­ASSEMBLEђГ-@Н©F"¤1Г‘0 НB@ИНш,юК¦>Н­†ГB!Ь1М¦@Нп+Нэ%}·(	Н­TRUEђЙН­FALSEђЙЭ#Эf ЭnяЭ#ЭебеБ#
O 0	"ІZЇ2ґZ|НмY}хНхYсжЖђ'О@'э+Гj!d›!r›z!–2М¦@Нп+НD%НБ"Н­HEX: Н”Н­ ње|Нuбе}НyН­ќбеНK беЛ|(Н­ / беНv б НA0}ю 8Н­ ASC: Нh0Г НЉ2Г еС~юИ#Нц>)ГэYx№(ЙУхyНQZс№ИGzо@ж@ИЇН­YxЅҐ›г›У›¶›®›Є›З›Б›‡›     Э!џН‚r>№В¦Нш,юИНБ,ю (	ю(ю,В¦?еЕ>№('8Н9.yюТ¦?Бб·(~°wx/¦wБН(%еБбq#p
БН(%Нб.Mбqю,(ЄНш,ГG%Н­REGISTER ђГ-@В¦?НU3Г™>!иB6 #ы! "C"CЙwѕИНЏГ-@ЕэF (э#э#}эѕ  т|эѕ мy·БЙэ~эѕ ИэеХ<эw_ эээu эtСэб·ЙЕэеэFНr3 эбБЙнDЂGДП3эбэ5БЙэ~эw э~эwэ#э#оЙхе!к3енEнW2юBхб}2 CбснsRу1ьBэеЭеЩеХЕхЩеХЕхн_2яBн{Rы*CЙнsR"Cу1иBсБСбЩсБСбЩЭбэбн{Rых:юBнG: CЛW(сЙсуЙэFЇёИэ#э#э^ эV~#нэFЇёИэ#э#э^ эVw:{#йНњ8:86·ИЇ286э!&O!xOНO4э!O!O±э!O!OНe4э!&O!xOНe4:{ж8o& >ГwН4#s#r>я286Йгг+"Cг33нsCн{RНв3Н4НЃНf)*CН“7:R6·(н[O·нR Ї2R6Bу6Нш,ю(8НP%ЇЅ(1Н(%Їё(	нK97·нB(!Нш,ю(	*CНNН*.*97#"97*CН,еГЙ5*CЙВ¦?НP-В•?еНZ(СеХНA(
НB6Н,СХсНZ(БСНAХЕPY(гГ–>Ї=296Ї2OНf)™>ЕеН(%ЇёБ `iеНш,ю(э!OНМ7:O· :'O· Н65беН·8НlНћ)Н•)!  "97бэ!OНr3(НZ(
э!&OНr3ДZ(е:96<Дћ4>я276б"6"CНr8Н4нsRн{CГ  Н­NO BREAKPOINTS , CONTINUEџНjю ФН юYИГ¦>   Ї2OеГА5нSO>2O2R6еГА5 НD%:)Ц	_ Н}2|Й!‡6М¦@Нп+Ї2†6:)Ц
ё0GН‚%y2†6Й  ђГЪ\эебНKmН­j S LOADEDђГФ\Н­jMEMORY IN Н”kГ lНЏ^Н!  НШ^юИю!8уМ¦@Нп+Нш,юИНP%·Й!у6НН6юИН(%юИНP%ГG%Г[^ЭеНx‡Нч^ЭбН­j	ЉЙН>lРГИ\Э~ю ИНр^Э#уЙ/Ўе7нR?бЙх|µ(ссс7ЙН	_Ъ¦Њ  !L7НН6!’76 ИНG%5ЙЕХJЊ Н±hН‰g(НjkG:bXёx(#НЎ_(СБсЙхНє_сх>/НjН­jЂлсйхЕХJЊНє_>-Нj :’7·ИЕХеL7НP%-бехМNсК-@бСБЙН·8э!&Oэ! Oэ!фOН·8э!КOюК¦?ю/(Н|%Ї№ИЭn ЭfЭ#Э#ЕН8ФњН"БеНЯ:Э!%TХеНо9бСИХеНi;8у`iН8ФњН"жэеНr3 эбэеН‘3(эб·ЙНW8Н­ALREADY Ђэб7ЙН­ADDRESS TABLE ђГ-@ехН­„НњсбЙВ¦?>я2—8ЙВ¦?Їц:—8·И28ЕХе ™8!f н°>Г2f !К4"g бСБЙ     :8·ИЇ28еХЕ !™8f н°БСбЙеХу6Нш,ю(лН­PASSєН0Н„2<лСбЙН·8э!&OГ_9э!&Oэ! O
э!фOэ!КOК¦?ю/(Н|%Ї№ИЭn ЭfЭ#Э#Н±3М99кНЯ:Э!%TеХНо9СбИНi;еХ8у`iН±3М99йНW8Н­NOT SETЂН"Йэ! Oэ!фOН·8э!КOХНe9СЙНе:НэFЇёИЕэеХеНяеБбСНЈ;8	ХеЕбНњбСэбН"БЪНЩ8Н[9НL9ГR9Н¬9НІ9Нё9Гѕ9э!&Oэ! O
э!фOэ!КOХэеНе:э~· эбСЙэ#э#эN эFНЈ;=8йэбЕбН±3СЦЭбХ
 ЭЭN ЭFЭ~·СЙЭеЭ~ю (НЭ#тЭбЙЕН :xБЂЦGГ0Х*/TЇнR    >·нR?хЛЛс8Л:Л= нСЙЕеН":z{Х!/T·	 Нe:СбБ?ЙнЎа ъѕ(у+еЭб7ЙеЭn ЭfН”бЙНЯ:Ї2П:ЕХеНМ;Эеэб!П:Ня;Н±бС("ЭN ЭFНi;8ЮХеНx:
Н:бСБОН Н"ДБ>ёИГ      SP    IX   Нш,Ня:Н(%Їё !  еНD%лЇё яябГН;Г.%!а=6*#ыНш,ю/А!Я=6 	ю* 	Н2=?Р6я#Н2=8w#ю*ИпГ%И6 #ыЙю*(ю?(
Эѕ(эЙ> Эѕ(фЭ#бЇЙЭеХЕа=ЕХЭеНH;(ю (ю* :Я=< ЭбСБЭ#ЯБСЭб7ЙЭбСББСЭб7А7енB?бШленBблЙэ~ѕАеэеЕэ~ѕ э##хБэббЙЧ:!П:>яэ!/TOЇэѕИН±;л8(Н±;0	Ня; эеЭблy
 э	OЫеэеэ~w#э#чэббЙНT=Нй"ХН":Н(<Св%<ЇЙЇ=Й!1T	 :а=нЎа ънRеЕНV<Бб	 :а= м+++еЭбЭfЭn ЇЙб= нЎАашНе:еН":бЭ!/Tэ!/Tx±('ЕЭN ЭFНЈ;8	
 Э	Бз
Э~ эw Э#э#фБХэ"э6 ЙНш,Нt=юКБ<ю,В¦?НБ<зХН=8C*/TХХнRеБ9T"лб	##нёС!Ю=
 н°СЙН­ ALREADY EXISTSЂГ-@Н­ ЂГ-@еХ*ЎQjяЇн[нRСбЙю:0ю0?Шю_Ию%Ию$Ию.Ию[?Шю0Шю?Рю:?ЙХН<СКс<!а=Н*=Ъ%	Н2=8w#хГ%6 #ыЙНL=ю В¦?Н(%НБ""Ю=ЙЭ!/Tю/(Н<В%Н.%НГ=Нш,юИмНЯ:Э!%T
 Э	Э~·ИЭN ЭFНi;8лНГ=лЭе
Э~
Эw Э#цЭ~· оЭ"ЭбЙФаeН­j_PC_Ян{ !  ›Q н°нW2юB2R! " * е0 ЈQн°С! н°Ї21TНЎ2*CыНЕ?Ђ юC0sНш,ю: НР Нш,ю(`ю/В}Нш,!FPеНп+бН­ЃНQ@НЉ2Н uГi>н{ЎQН­ WARMBOOTђН4НU3! "CНШНЕ?Н­BГФ"Cн{ЎQ*CНN"Cн{ЎQН4@Н­ЃНQ@Н»!Dd?ѕ(e#шю 8йDНB@(в!°PлF н°Н­ѓНQ@НBFPНш,!GН+CЪ•?В•?Х!ДG		^#VлСеЇ2'296Эб*CН­Ђ¦>ЕНш,юЭеЭ!Rэ!@ЙлF#fhею!8ТН­†НQ@НН­ЂБх*CНNсн{ЎQ*CН4@Н­ЃНQ@Г·>Н&Г¦>ґ>¦>™>^?Ў*Ч*§*Л*r-Ђ?‡>ґ>-@‡@!°PFPF н°Н­ЃНBГЫ>Н­COMMAND ђГ-@Н­ARGUMENT ђvН­TRACEђhНђmНtс?*+@НK Н Нt@! НK Н­ FREEђГЯ TRACE80 V2.07­COPYRIGHT (C) 1981,82,83 BY L. LAUTERBACHђЏ Ї2&Г¦>хНhсН­ЂЙ хFP>2FPсГв@хНT!’7Їѕ(еFЕЇw. L7НP%-Ббp>+(>-НН`:&·>*ДНсЙ!°PНњ@DFPН­ЃНє@ГР>лХ!FPНп+бЙНњ@FPDНє@(ыН­ѓГB ю(Н2BцХFPНш,Сю НаA ы>Н­ЂЙН»жН­ЃеХЕ!R"Bѕ(#шБСбю 0НИAїл^#VлБСгЙхx№МИA(
НРAсН2B¤сЎНаAњx№МИA(•НРAН2BЊЕХю(чю (щ>Ссё0
хНс<уЇ=FPГ ю(Ею цсё(щНаAКЖ@>НмAГЖ@Ею щсхсё х> НмAГЖ@ю(Н2BхНаAКЖ@> Н2BНаAпх>НkсЙхю > >сЙИН­€ЙЕx№ >ю(Н2Bп> Н2BсёИНаAще!FP~ю(Н#хН­Ђб·Й:A:A:A%A*A¬AЏAhAГВ¦?Н Нђs:*C_НЎ  !›Q н°* л!ЈQ0 н°:RнGГ  НD%"}ЙВ¦?!GЕН‹BБК цН Н"м~жНЛ~#(фН0ЇѕЙеХ:R_НЎСбЙ>№ 	!Ђ "(CГ Q>№В QнS(CГ QВ¦?  C!иBн°ЙВ¦?  иB!Cн°Г™>                                                          Ђ  я Х®ж(Л~#(ыЇѕС( м~Л#(зю (НeC8СЩбюИю,Ию Йя7Йю'Ию0Шю[?ШюAРю:?ЙНш,НЪCЪЉ1Нш,е!|J 	NбЙ!G6 #ыЭ!GНш,!PIН+CЭqЪЉ1ВЉ1>C№ШНш,юИю,КЉ1НwCЭqюИю,ВЉ1НwCЭqНш,юИГЉ1!'JН+CРю( d!'JН+C8fyю
ь(Hю(Bю	(> ю(8ю(2ю(юВЉ1ЭЛжю)(ю+(ю-ВЉ1ЕН"еЇЛ%ЊбВ¦?Эu
ЭЛЮБю)ВЉ1yЂOЙНaDЭЛоЙНaDю)В¦?#нН"НБ"ЭuЭt	·Йэ!ўJ Ї№ИэF э#эьсэF э# Э~э® э¦ 
Э~э®э¦Иэз7Й юШю"Шю*Шю-Шю1ШЦ,OЙЭ~ж_WЭ~жogэ~жOэЛ^(лэ~жЭ†GЭ~Э¶жАЂgЛw(ЭЛvМEЭЛvМEэ~Н&EЭwЭtЙЭЛ~ИЭЛ~ИГЉ1И Л"ЛІ‚Й ЛCИЛзЙ ‚Й ‚ЛEИЛЗЙ ‚…Й ѓЙ НнEѓЙ НнEЖFЙ хЭF>З В¦?Л¬Н"FсЂЙ Л¤Л\ВЉ1Й ЭFЛ¬Н"F>FИЛзИЛЯИГ¦? ЭN е!ZJ	~бЙ Н FЙ Н F‚Й Э†ѓЙВЉ1Э†хЇЭѕ	В¦?Э~юТ¦?Л¬GсЂ…ЙЭ~юA>ђИ>УЭ†Ж Йхе*G##Э~•ЭwOЭ~	њЭw	ЛО В¦?бЛ”сЙЇЭѕ	ИГ¦?Э~Н©D!KL 	NНpDН†DВЉ1ГВDЭебееЭF>ЭЛx(Лp(Ж #wЛ@(#6ЛЛx(Э~
#wЛ ЛH(	#6н>Б В¦?Э~#wЛ`(Э~
#wЛh(Э~#wЛPЭ~	(#w·(<В¦?С·нRСлsЙ"GеХНT=Нш,ю:*G"Ю= лглН<Кс<НБ<СНш,юбИеХСНЌCбPЪe.Н*FНCF!GНИ)ЪЉ1Э~ ёВЉ1G*GНi3#шЙ               ДМLДLРЦVР  БРFILМMOVЕFCВBUЖЙПТЛSTПREГPГ   ВBЖИHЖCРЖHELРWAIФSУSГSДSМФХ  UХUТUМUВUФЧHМHГЗGОGВ КГЕ GУGГGДGМJУJГJДJМCУCГCДCМBУBГBДBМMГMМ  NУNГPASУ SPМSPЕ  LOAДSAVЕRUО BAФBAТBYЕBOOФ гA{\f6S6    Ъ0¶/Xљdј/и.Э2L3ИBЧBк*      В1№1,2#2ХЄqBjBЁ<d<†=„:ш*#+    M+F,я, -‹+;7¶-".5z5J5  –-r-џ-  Е7ѕ9х8X9ї7ё9п8R9№7І9й8L9°7¬9г8Щ8 9”9    c8l8Ю6  Ы    }с  Ѓ}7B	AЖBГDЕHМAF§BC§DE§HL§IШIЩSМ  PГSРSВЖБГВЕДМИF§A§C§B§E§D§L§H§LШHШLЩHЩ  ЙТCБОРHГЪУCA§N§P§HC§Z§S§IFЖ     @ Ђ @ЂЉBYTES CANNOT FULL INVALID FILE SYMBOМBUFFER OVERFLOW ERROR NAME HEX: BIN: DEC: SEФ? <Y> NOРRLCБRRCБRLБRRБDAБCPМSCЖCCЖHALФEXШDЙEЙNEЗRETОRETЙRRДRLДLDЙCPЙINЙOUTЙLDДCPДINДOUTДLDIТCPIТINIТOTIТLDDТCPDТINDТOTDТRLГRRГRМRТSLБSRБSLУSRМBIФREУSEФANДXOТOТCРPOРPUSИJРCALМJТDJNЪREФLДEШINГDEГRSФIОOUФADДADГSUВSBГIНDEFВ ВГДЕИМ(HL©БBГDЕHМSРAЖIШIЩAF§ЙТNЪЪNГГPПPЕРНHШLШHЩLЩ  '/7?vЩуыDEMgo ЎўЈЁ©Є«°±Ііё№є»љЪ" !01234567”•ФХ8–Ц;:9<=<8я$<юя088я@я<ю
89я?"9яя2?9я*я9я:??  ”ѕю  ю”ѕ  ”ѕ>  88@`9яьC.ь9яK& яяG!яяOя яWя!я_я?щя"яяял:я?гљїя  ?<	(я8Ђxя8яЖя8€xя8яОяьJ*я8xя8яЮяьB*8 я Ђ8я я ђ< я 8 я@< я 8 я@я яШ я яЙ0ш яА@я8яЬ8я яН0ш8яДDя8яЪ8я яГ0ш8яВD? яй°я я  8 яЕ я я  8 яБ 8я яЗ 9яяУ;яшAJя9яЫш;я@B8я яFВ8я яая8я8а8я яа0ь8я р8 яЮ8я8Ч я я Р я я Т
	 Ђ А{ф@АBITh,фЂАRESh,фААSETh,фЂpюЂ@Зv
C©AЗ(CцBП,лJП,лcчЂKПk
p©CП(pлDяNEЗMяIуEяNуFя°Vя±^яІGзшgяДoяДічOTъ дjъ  ЂЂvяHALФ@Аv,фЗv,пзщ:яA
p©2я(pБПk,рхя„ЕПлся„БПл зJR~,сяJRqуяDJNZ сНярДЗ},рЙяуАЗэЖiцПлПлЂАфЖЗпГяpуВЗ},рля	,’ЩяEXШя	,§з|БЫяA
o©Уя(oБ'яDAБ/яМ?яCCЖуяDЙыяEЙ7яSCЖЗЗRSTм яNOРvяЂ*яu
p©"я(pхщя,хйя(k)у	Пu,лгя	(х@дЂGзЂxьЂяЂ@Аv,ф&чv,п!яk,рбял6яv,п,юiц$оiц#ял+ялеял†Зф„Жф  ЂЂINVALIDзѓ   AЖPUSH POP‚CALL REФEXѓ,Ё)¬JPѓIMѓRМRТBГDЕHМSРIШIЩC‚C‚LДCРIОOUФADДADГSUВSђADDA¬ADCA¬SUB‚SBCA¬AND‚XOR‚ORѓѓыыЋЏГГ  SLБSRБSLУSЋЙДIТDТNЪЪNГГPПPЕРН(БA
©(БA
©I,БR,БA,ЙA,ТЂБВГДЕИМ(©HШLШ(”HЩLЩ(•
 јж¤N№Hцћ^вqЬcДяxў[‚          ( SfH№Еa”ПТў4оNfэЄЏ^=„№HєЌ«tњ}ycHйндЅ гА<5‰цс$·)њ„µ+aЋжфj^ГEОкъСйEvй9АF&ZбГПРЩТЙЗИФ ЁГ© ±№ё±¬ёІ¬ёі ВЩ М® МБХФЕТВБГИ ;)_W’ЎИt$ј!e4Tщa№HЮµ;ъ¤tД‰\т }ОкЗxO ¤Ґ=z`ЄђG№HЬ\"‹l4ЮҐџgOO48€MЌ+­ќ%г”зO( К]УФЕJ›ЯЌ•.;Uр%©CqГёL~ЌќZMѓ?'умх[|q +%э'{Ўа]CtЬuЪ№™ 1:оЯtј©у№H#3ЂАо­¦X7)                                                                                                                                                                                        ГZ3ENV  Г    Ђ0°_UИ#]ЇZDE 1.6, Copr. 1990 C.Wilson  яWZ80NWS WCMDN   WяяяяяяA $$яя  p )3=*          GENIE IIIS      P я      S    S    R    S     S=   V    W                          EPSON FX/LQ     яA @x              @     !    !     !    !     !    !     -    -     xR                                                                          ф   фъъ  ф ф           фф    ъ  ъ ъ  ф   ъфъф   ъ  ъфъ  @““‘У=] ![›ю.11~.<2= 2=2
‘У= [‚‘P›;![Ѓ–SS‘УBKV_‘ES0=SwCh 1=Soft 2=SentBg 3=ParaBg 4=Reform 5=Browse 6=DelLft 7=Undl 8=SwLn 9=Hlp ;;;P                                                                                                                                                                                                                                                                                                                                —и1C>!П;Р;C6 н°Н 2-ю00!0Н |юS(юD 2-dН "•лЛ‹eН Н--юФ Н 2з;<2\  яН 2и;2й;:’2<Н;4:2ь;*X"э;:n2Ў,: /ц
2<!’=5Ї2ж!Ђ ~#Н9-НЂ! НZ4>2ж!Ћ:Нё&:ж;· #НдНя&Н№1Н`Н	:] ю (.Н[&Н‹%:ж;ю !> · " Н/(`i6###6ГlН¤Нm4ј:Р;!@¦2П;Ї2С;1C>Нґ7Нр5*$<""<:'<2&<:Ф;· *<"$<:<2'<Нa6Нщ9Н"хН	Н-9сНЛ	Н/џ ЂG!Ѓ©‚Кѓ…„7C'©х)џбK!	з
G>№© m KzќЙC!ў'K›!-:ж;·Д¤Г!ќ;НйНFН/	3"Ћ#3R%к#G>	А?"=%њ&Р>|%В%G"Я#&);# Й! ;НйНЛ	НYю08ю:ЪбН/їЃ‚чѓr„ѓ[
	ЂM#З!’=~+А;bЙ!—;НйНFНа	Н/	Ѓ›ж'а+y'а+ѓ'	µ
(Q(La',2<(Д'ц2@х3€(Dњ њЙ!”;НйНFНЛ	Н/	ЂЮ!Ѓ‚ѓс„ЭTN"uЎЌ	6н`х!'!Й!ји иЙеJ Н5Н§4бН`4Нy4M Н5Н%х:a· J Н5Нy4Нј4сЙНј4Нґ7Н3сЙНВ%:ж;·АНВ%:ж;·АГ±:С;·(!;Н’4Ні	Вґ7Ї2Т;Н;4" Н/(!@ 	<л н°!ЁНZ4:з;_Нѕ,:и;_ Н Н-ЪюS(юD e  Н - Н ГН„Н-9:Ф;·ДЋЇ2Ф;:ж;ю
Т9:^·Д5Н§4Н2Нл3Ђ[[Ы :ж;‡o& :^#VлНК3Нр3 ]]] Нј4Н		:ж;ю(	ю(ю	Ъґ7Г9Н%юИю  цЙ> ">>>>>>
>>	>
2ж;Й*c& ))))#еН}	б+ :Ь;_:Ы;іґµ м/2Ь;Н[7Нщ9аН}	И!O<5#~T]# н°жЙНћ	(!O<4^ w{ю8>Й2џ	:O<·А2џ	ЙЇ яН ·ЙН}	И:P<жЙН%НYюYИю(юКюN к·Йю Ђ!“ѕ(!„ї!“ь	ѕ(
лѕ(#ф№OGyHЙН%ЦAК©=КК=К…=К7Г	>B23
!Ђ Щбе^#VнS<ЩЇ2<}ЦЂю 0L:<· iеН%НЛ	бюЂ(:ю„(6юѓ(Uю(yюКю(zyю(%ю(?w#ю е0Ж@хН¬4сНю4НБ4Ню4б­НЋ
¤НЋ
 ы’>ЂЅИ+Нб4 Нб4Нб4цЙЩ*<|µЩК/
Щ~Щ·К 
юяК 
Щ#"<Щю 2<™6 }ЦЂСХЙеН%НFбГf
Е>Н
  С BKx±ЙЂ еbk ~ю08ю:0	#xю0Eоx  ·(<ю($8*ю(8ю ,!'НR8$!иНR8!d НR8!
 НR8! НR8бx±Йб7Йю0И=е	DMбШфO Нв
Нх
ШЇ° ±Й7ЙЭ!ЖХЭFЭN yю(-нB0	Э#Э#к>1нB8л4лч	Э#Э#ЭN ЭFyю(>0б}ц0лБнB>•И	6 #= ъЙ'иd 
  !ь;Їѕ <2о;Ї2ы;2ц;/2х;2[>2н;2ф;:2ш;:2ч;!©:Н’4Н
  Ђ !о;ЕНYю ИюB(dюD(ZюP(SюL(<юT(Bю*(*ю^(Iю@(Pю#(mю=КГю"КУБ·В,	:[GЇ2[° °Гф НhЪр2н;ЙНhЪр2ш;ЙНh8{2ч;ЙЛжЙЛЮЙЛЦЙ~жВ iЛоЙЛF bНh8]·(Z2ф;ЛцЛю<нDG:х;ёШx2х;ЙЛF AНh8<·(9G:ф;Ђ82x2х;ЙЛF )Нh8$·(!2ц;ЙЛF ЛОнSщ;2ю"(ш>2ђ2ы;ЙбГ,	Н¦,!F#НР*,<"0<*(<Н№:ц;· :ф;!ф;–2ц;!о;Лn(Нq"ЛOКенRбИ+лН°Ъ*,<н[.<"п;нSс;Н8!о;Л~(ЛцЇ2у;<2д;:ь;G·хМЇсД8o*п; НМНЫю 9Н>ЕеНh	юбБ($:о;Л_(НїН8x·((	x·:<(Н80>2н;НН>Ї№ ін[с;{•zњ0©Н8:<O:ь;·(yН>!  Л~(ЛѕЕХе F#НРбСБи!н;5ВK!F#НРН,	*0<+НРН§7Гґ7Ее:у;·>Д>:о;Лg(Н§7!«;НйюКСН¦,!у;4КСN:ф;_:х;=ѓЪС№ЪС:ф;O:у;№!о;8Л¶>Й2Ї:ч;·(GНјы!о;ЛN(E:ы;ЖG:ю;ђ0>FђхН<с= ш*щ;:ы;GНЕН<:у;!ц;†o& ХНt!ХНЕНјНјНјЇ2ЇНЇбБ:ь;G·ЙбБ7Йnnnnn ю(ю.(:д;юяИЇ2д;ЙНг>2д;Й:е;юW л:д;·(е>я2д;Йю РюИю
ИеЕ!Ў, н±БбИх:о;ЛW сЙ>^Н>сц@Й>> юяИЕХе!о;Лv `ю 0O!Ў, н±(R!o н±( н± 4>‘‡‡‡_ !`F#НР->‘‡‡‡‡_ ! Л~ FЛю#гЛѕ Щ_хНЯс!<ѕМЇбСБЙ :ш;·ИGН<ыЙН8:<Г>x·И~Н>#цЙx·И^ЕеНЯбБ#тЙГ !®B:_· !]>"(<* .ь%".<Ї2<<2<2<2<2'<! "<" <"<"$<*(<+"*<6*.<#",<6ЙбF#^#V#ѕ# ^#V##улХйНYю@Шю`РжЙю0Ж@ЙюaШю{Рж_Й:Ф;·К	>G:Ф;·Аx‡‡хНс= шЙ:bG x± ыЙьЙнK*<*,<++е·нBDMбЙ*(<DMе**<Н™бЙ*.<нK,<аНҐШн[,<**<нё"*<нS,<ЙНіШн[*<*,<н°",<нS*<ЙНў0ЇЦЙН[,ю >» 7Й>н№в ш##ЇЙ#7?(Й#И+ЙН°0ЇЦЙS>*,<н±в3 ш7?Йz» 7Й*.<+>яян№##цЙ>4:<Л?-Щ*<+"<Щ:<ю(=Щ*<#"<Щ:<Щ!<ѕЩ(<:<2<Й>5:<=(,НQ)!<–8#$:<=И:<=Щ!d¶Щ<:<Щ!ђѕЩР<:ђ:<< Й2<ЙЇ№ 	~#юЂ0	юЙ> юЙжюЙНў8&T]~ю  ю > 8Л>  цЂ#x± бнS*<Н°Ш*.<T]ю  >ѕ0Л~ ЛюнЁкнS,<ЙoеНђЬеНђЬ	б}Й> Н7Шю(!nѕ(!С;6я**<#w"*<·ЙН7Ш!С;6я*,<+w",<·Й! "<Нў*0<#НҐШ  >**<н№ к•*<"<Й*0<+НіШ  >*,<н± кµ*<·нR"<Й!н:Н’4Н%НY2м;юN(юQ Ны4Н%Ц0Ъ,	ю
Т,	W>я!’=Ѓ н±>Ђ‘_!z·(N 	#= ш~·(Хе^ 6 #лDMе!·нBDMбн°НЂбС{·(I:· :“Ъ	s#K е!T]·нBБенBDMбнёN #л!’=Хн°б:м;юN(юQ +~ю#8#Лю+ЛюНЂГґ7
!ф Э!>ЂЭѕ 8Э^ нR8ЭЭ#м"|µИЭ6  Э#+|µ хЙ!ф"Э!!юе!Ф;ЛFИНЋН%ю0Ъ0	ю:Т0	хН„Ї2Ф;с!Ф;ЛFАЦ0G!(^ #щ~#·К,	O ЕЂ Хн°бЛ~Лѕ(#Л~ЛѕД~>1+!О:Н’4Н
’=·(cO Е!Х:Н’4Н%НYюQ 	Ны4Н~Н%Бхy·(!Ђ ’=н°л6яНґ7сяю*( Ц08ю
0Gx2<·К„!’="<>я2Ф;!R~2
<Л~Д'Й>я2’=Гґ7:Ф;·К0	2а;Н%!а;6 ю[(+ю](.ю>(5ю<(<_!’=Ђ~#юяК0	ю(уГ0	{ѕ м#"<Й!’="<ЙЇ2Ф;_НЋГ„Н°Ъ,	Н…	НўЪ,	Н7*<++++"<Й>К>В2:Ф;·К0	Н%_НR,»К’Г%Ї>я2Ы;:Ф;·К>	Нh	ю *<^!M"<)*<~#"<юя($_~< :а;· !<~<(5(!’="<Н„{жЙЇ2Ф;НЋГ>	!56ЙЙ!5ЇѕИwГж9:
<!RѕД'Й!5~6Й2<Й:<·А25Й!5~6 2	<Й:	<юЙА25ЙН§4Н&2Нл3Ђ !"НК3НеНђЕ`ic;Нt*.<#н[(<·нRБнBW;Нt*(<н[*<Н.Е*,<н[.<Н.б	E;Нt:С;·>Y >N29;!/;НК3Нј4Н		Г9  {•zњШ~#ю(юЂ8рн:Т;·Дх3!ХНZ4! НZ4Н		Н№1Г9*(<Н№НIН…! "<Г9**<"0<*.<НРН~Н»Н…Г9" Н/К,	PY!¦~юN >>w44!> N#Fx±Вv!¦~ю@К,	дН°8
*,<>н±Кa"Нў8
*(<>н±К\"Г,	НзШ>2<Н№Н…ГУ9Н°ЪJ)НR,КJ)Н…Шо:<=ИG:<хЕН©БщН-9сГГ:<!<–ИG:<хЕНКБщН-9сГГ!В::ь;·(:е;юN !И:Н’4 Нв
Ъ,	К,	:е;юN(:ь;·( _jbx±(ш#DMЕН`Сzі('ЇІ(Х Н+НРС тЇі(Н+НРНMН»НzГ9Нс9Дж6НзАеНi9НTбН№:<НцИГУ9Нс9Дж6Н+0А*.<~юАеНИ9НgбНРУ*"<Нt:&<=И*Ь;ехНJ)э!< Н°8"НR,(ю	 э~ =!d¶<эw э4 Н…схэѕ 0Щсб"Ь;<э– ЙН7ШНўШНЈ9**<~Л~(Лѕ> #+"*<Нpю	(ю(Нљ·АГУ9Н»НTНJ)=!ђѕФШ9·Й:<=МШ9Н‰·ЙН7ШН°ШНЇ9НR, еНс9Дж6б~Л(6 ж+#",<Н]·хю	(ю(Н®сЙНУ9НgН…>2<сЙ:ђ=!d–!<–ЬШ9НЎсЙНR,К…Нe,(яН(юИцяНАъЙЕН…8Нe,Дt,ЕББЙН[,юК7яНo,Дy, юИЕН7БШнН7яНo,Дy,ИЕН7БШсЙНR,КK!Н(Нo,Дy,хНkсАяНАюИЕНK!БтЙяНИЕНK!БхЙН(Нo,Дy,хНkсАяНАЕНK!БхЙНj,Дt,ЙН9:<=_!Z–8<_Н+ЪuВuн[*<нS0<НРН…(Н9:<_=!Z–8Ж_НзЪ`В`н[,<нS0<Н№НҐ:<Гц:<Л?Л?<GЕН] НКН]БсГ9:<Л?Л?<GЕНp Н©НpБсГ9Н] НКН]!НН{9Ъ9Н@9:<GГ¶7*<н[< ·нRИНp Н©Нp!ЖН{9Ъ9Н@9Гґ7!<~Ц!Ш<w!<~Ж :<Ж !ђѕР2<!<~Ц ШwГ9НIГ9Н~Ъ,	Нґ7:Ч;·(:Ц;·(НuН`:=·И:Ц;· sН°Ъ&*.<н[=ЇWнR#Л~(< ч‰OxО G!=y–OxЮ G81**<"0<*,<:Х;· #x±(:зюГ(X:==(Rн[=> є(I»(F&:Ч;·К$	*$<Нt:'<НцГ(	Нў8е*,<"0<**<Sx±(Ц:=н±кZ МЕе НкбБ з Г
:=2ЃT]	л нCк;НМНзю (
|Є о}« кЕХеНкбСБ лнKк;k:=2Ле·нBеСб## y2к;·(> 	++~#Л(жНзю (|Є Ю}« ЪГ&еХЕНкБСб кнKк;q:==ИG=НМНзлѕл(е!mѕбАкЙy++НР*,<Л~(·(~ж6 Н]НMН…Н»!Х;ЛFК9!=Ї†(O #>н±К9!P=Ї†К%9O #>н±К9Г%9y+Н№*,<Л~(·(~ж6 Н]НMН»НҐГ9!”:Н’4Н
==ИЇ2Х;2Ц;2Ч;>Г2з!Ђ ~ю/ -#~#·Ию/($НYюC(
юB(юG(7Й>Й2за2Ц;Ы>я2Ч;Ф ~#Нз·(уx2=ЙГY**<"0<:=·(GЕНK!БЪ,	ц!P=~·(GЕ#Ее~НJбБЬ	тБ:Ц;·К%ЕН7БШшНҐГ(>я2Х;!љ:Н’4Н
Q=хНґ7сP=ИO !Ђ н°ЇЙ>я2б;Н~Ъ,	:=·Кґ7:Ч;·(:Ц;·(НuН`:Ф;хН.с·Д,Нё8Нh	ю(	Ї2Ч;Нё0р:ж;юМ	НЈГ9>я2б;Нё:б;·(ФЙНѕ:ж;·7А:Х;·ИН[7Нз8(:Ц;·:=Мз)·ЙАНк:ж;ю?Й:б;·7ИН„J Н5Н§4!Ј;Н`4Нј4Нщ9Н>	хJ Н5:a·М§4Нy4Нј4сю ·7Йю* 	Н™Ї2б;7Йж_юYИюN І·Й!Ъ;Н'Н3:Ъ;·!є; !‘;; Г2НJ)!eѕ8#ъЙ~е=!ђѕФШ9б:R·~Кз(Гм(НJ)И:Ъ;·(HЇ!lѕ +ъЙyѕ0+ъГЭ~:d/ <хНЭсГз(!є:Н’4Н
  :<(!Ђ ~ю@(>ю#([лНh(1НЮ8,h_:l·7А !e~·(	»И0# ф+s·Й{!klнё·ЙГ,	eЇН‹лНh·(*O<eЃ8щeЇН‹лНh·ХДЮС8Ж· рНґ7Г3!є:Н’4:<Н`8®(¬!eѕ(#ъџ6 (ШT]#H н°ЇМ!љ;НйНFю(ю ИТ	!nѕК	ю	(VюКK ю ШхНЫ(0Нд(Н%9с_ю?8ю Ь)9ХФР4СХ{НJСШХ:<!ђѕФШ9Н®Н‘ С{ю ИюИ!nѕИГ…):Ъ;·В[>	НJШН%9Н‘ :<!d†!ђѕФШ9ГЎ:Щ;·Д :RЛ 2Нс:е;юN(Н[,ю  НG!фНщ9Н°8НУ9Н…ГБ НK :Щ;·ИНHЇ2<НУ9>НJШ:<!<ѕМZ9Н!9НgН…TНz :Щ;·И> Нg>НgШН[,ю !ЖНI9РГ!9:R·В)9**<~юК)9!nѕК)9*,<>ѕИ>	ѕМ%9:Э;хНK!с2Э;Й:Ш;·И:Щ;·АН°8:R·(!НЭНўШН©Н
)ЕНсН…Бxю	:<(<Гм(НR,ю (ю	АН…с·И=хНосцНђШНп!*,<+",<~юК!9Г)9НђШНп!x·( *,<++>н№А##",<Г!9Н7ШН°ШНп!Н)9*,<Л~(Нv!*,<~6 ж+wЙ~#",<юМ!9·ЙНђШx±7И**<#xЦ8„gT]#н°·ЙНv!Ш>Й*,<еНЭб",<Н0 *.<#",<Нп!!ННI9Ъ!9:<GГ¶7Н0
А*.<~ю# +е*,<еНЭН“!бН)9",<>я2С;Й!®;НйюИюИ2<НK!Н°ШНh	юИНR,!<ѕ(2<еюА:е;юNИ!<~ю А6СНЬ"Н#:nГўНП"Н#тНЬ"Н#ЙНq"л#ЛGК,	Лw Н№+НРНzН»НMГ9Э!<Э6  Нў8$:nн± ЭЛ ЖT]вњ"н± 	ЭЛ О+Э~ ЙЭЛ юЭЛ цН°8н*,<:nн± гЭЛ F ЭЛ ЖT]x±(ТжЭЛ О+ЙНўШ:nн±ка"ЙНўШ:nн±АН9ЕеT]НҐ8н°нS*<б+Бx± ЯЙН°Ш*.<:nн№к#ЙН°Ш*.<:nн№АН!9ЕеT]Ні8нёнS,<б#Бx± ЯЙНq"ЛOК,	Л 2Лw DM**<нBе`iБ(#н°нS*< лнK,<енBDMб(+нёнS,<	нS*<#",<Н»НzНп!Г9Нq"ж‚юВ,	НГ#ИНТ#0НеНq"НГ#НТ#Ъ	нёнS,<Н»НzНп!Г!9+е#нRDMбн[,<ЙеЕНђ`iБ7нBбЙНЋ#:ж;·АГ;#!¤:Н’4>	Н
  х:\ G:й;Oс(@G!Ђ ~НYw#шю: +6 Ђ НБ. %ю0Ъ,	ю:8	Ц@юТ,	GЕНhБ0:й;ю Т,	OЕY Н Б!n<p#6?p< н°6  н°Н§4:S·(Н5:ђЦ2<:<=2<:ђ!<wЇнgNЕn<Нѕ,Бюя Нр3NпFile Г(%Еn<Нѕ,БюяК%‡‡‡‡‡_ !Ђ #л!	 Л~(:[·(ХлеЛѕ#ы 6 +> w+w+w+T]+y нёл6.бOЕНК3Б §!<5(>Н‰3:<O–Нр3... y!<ѕ(>Н‰3Нј4НЧ5:й;_ Н Н9Г		:С;·(!;Н’4Ні	Вґ7Г±Н[&!‡:Нё&:ж;· Нґ1Н-:\ Ь-Н»,<М,	Нy&Гґ7Н[&!z:Нё&:ж;· +Н¦,НеНђ8**<Н#/ Н	0Н 	н[*<"*<л#Н№Нy&Н§7Нп!Г9:] ю  Нњ&:ж;·А:С;· !;Н’4Ні	хНґ7сАН¦,*,<"0<*(<Н№Н°0  *,<Нщ/0Н 	Ї2С;*0<+НРГ§7Н[&!Ђ:Нё&:ж;· .Н¦,*,<"0<*(<Н№Нq"ЛO(нRлBKНщ/0Н,	*0<+НРН§7Нy&Гґ7!\ n< н°Ї2l :й;:е;:П;Й!n<\  н°Ї2l ~2й;_#~2е;#~2П; Г Н[&!t:Нё&:ж;·Дy&Ня&Н№1Нп!Гґ7Н’4>Н
2<К,	GЕ!Ђ ~НYw#шБ!Ђ ~ю/ #ѕ+ xН9-Ъ,	Ї2П;Й#~юW(	юA(юNВ,	2е;Й!"я;:е;юN(Ї2Ш;=2Ъ;:T2г;:ю;= *X"э;>;!"э;Ї2Ъ;2г;=2Ш;>:2™,Г3НR,ж_юA8ю[0ЛnЛ® ЛоНп!Н…Г)9!І:Н’4:Н`Ъ,	2ь;Н№1Гґ7Н9!г;~/wЙ!UН'!Ѕ;:е;юN(:U· !‘;> Г2!RН':R!Ф;Л~(:
<·!·; !‘;7 Г2!Щ;Н'·Да':Щ;·!Г; !‘;D Г2!Ш;45И!Ш;Н'·(!Щ;45Д'ДО'>НZ(:Ш;·!А; !‘;A Г2:W·К	!VН': <=А:е;юN(	:V·!Й; !‘;G Г2Нg(O:э;№8>2э;y2ю;Нg(!ю;ѕ0*2э;=Да'Н3Гґ7:е;юN(: <=Д€(!є:Н’4:<Н`(РбГ,	Нљ(!ю; <Н (Нх1Г3!э;я;~ю(6Йw>Й:<G:ю;<OђРНБ(yѓђЙНR, **< ~+юИю	(чю 0ур:э;G:<ђЙ:э;хНцс!<–ШИGН%9ЕНHБШН®хЙ:э;=ИGмНЭНR,GЩЇ2<хНR,ю (ю	 ЩёЩ Н…с<еНЭЩсЙ·ИхНR,ю	(ю  рНK!с= нЙНQ)2<ЙН[,ю>GИНз  НМю	 xе!d¶бGxюю(Ї№ зЕНҐБ0аxЙ:ю;=Иэ!<э4 НЇ(Р ЕН7э5 БН[,юК4	ю- :U·(НR,ю (ЕНHНR,ю  РЕН…э4 НЫ((8Н@ НЭН)Б:<ЂЪс)=·ИхН…с=цБГ4	:ю;=ИНЭН°ЪU+НR,ККН™:Ш;· Н}+8Н
)хН­+сН4)Н)НЭН©	ю Нh	ГI+НJ)э!<>?2<Н°ЪU+НR,Къ*ю	 э~ =!d¶<эw %!V54(!ђ…o> Њg:<†ю]0ю"0	ЖЖвэ4 э4 2<Н…НЇ(0ЇН[,ю  НR,(\Н7Н[,юКO+НR,ю- :U·(Н…НJ)НЇ(0Н7МНHНe, ВН…НJ)НЫ(КO+ЪO+Н@ НR,(	ю  
НK!тНK!HН)CН[,ю  ?Н7Н[,ю  НG!фю-(GН…НK!НИ+>яН4)НR, НG!Н7Н7Н~, Н…НHГ%*Н…НИ+НC НЈГ9НЈГ4	НЈГ8	:U·(іН„Н[7НрхН™с0(оџМG!НyАНсН°0НЭ7ЙН…НR, Н©7Йю (НЭ·ЙН…НR, пН…кНЭН7Н[,юКВ+ю (сГЭН7ГЭНR,ю АН…НR,хН7сАНK!ГK!ю Й{2N,:ю;юИНЭНR,(HНe, НK!Ъ4	оНсН7Нe, НK!уНJ)НБ(!<:э;=G:ю;ѓђ–Ъ4	НN,(хНЭН)БЕНHБщНЭНа6НсГ…жЙ*,<~жюЙ**<~ЛИ> Й!Ј,! ,! ,!,!,
!њ,еНR,беН[,бЛ~ ѕИ#ч·Й,;:-.?!я  	яJ Н5Н§4!§;Н`4Нј4Й\ Н-Т 2ч,Х* #^#VнSн,м,r+sСН ен[н,* #s#rбЙ  * #s#r> 2\ 1C>Н4-Н 	ГЇ> ю0Й·(%!\Л¶ѕИ#Л¶ѕИхН Б<ё(! ()ъл%Г х:A2е;еНm4бT]с·КП-O >:н± z+6 НБ.6:(#x2\ y2й;_ еН бe+~ю08+ю:0'Ц0_+~ю08ю:0Ц0W‡‡‡‚‚ѓ_+ю 0}{2й; еН бЛ}(~ю (ЦA8e_>»8_+Л}(~ю  U#{<2\  >:н±> л+#ѕ(ь] Щ2<bkЇН‹ЩЇ†#(xю.(ю (TШю/ ѕ T#НЉ.(Щw#ЩЭ> Н‹Нm47ЙЇ†(Hю. (#Щ>.w#ЩЇ†#(6ю (Шю/ ѕ #НЉ.(УЩw#Щб~ю  #ш~ю/ #~·(
Нё. ґ2е;!e BНџ.FНџ.JНџ.NНџ.:] ю (Ќ·ЙеЕ!—. н±БбЙ .,;:?*=ею?(ѕ #фНё.бА2е;ЙюAИюNИюWЙеХл> +#ѕ(ьT]	Їѕ(#ъ8 Н/(0лPY·()еХю  45ѕ #рСб(л 	лЪл+N+FцяСбЙе*	|µ(	N#Fx±бЙЇ2h 2i 2| 2Р;/2в;еЕН»,< ББц7ЙЂ Нѕ,Н»,юКс/0жЭ!Ђ СЂб:е;юW KЭ~ ю >-Эw ю(oю  :в;·(e/Ї2в;Э~ юЌ ~ю (Лю0Лѕ> #wzіИю Лѕ~ю  +хЭ~ жю(8ю
 2в;"э!nэѕ (ю  ~ю 8Л~ Лю> #wzіИЭ#В`/еХГL/Сбц2Р;ЙЕе	еН-:\ Ь-!] Лѕ#ыНґ1?<Н fН»,2N<:П;·(4!\ Ђ  н°	 !\ н° !М;н°ђ Нѕ,< ґВ§1Ђ Нѕ,_Н-8NюS(JюD(F-яНѕ,Ї2в;2h 2| Н»,хе-юНѕ,бсх·(Hс|ю 'cЇ2} 2~ 2 Н»,·В§1Н»,х'Н»,< ґВ§1Ї2в;2h 2| Н»,х:N<= gН»,Ђ Н сСбБ<КҐ1x±Кќ1 ЂЭ!Ђ НМЩ!Ў, н±Щ(lЭw :е;юW <Э~ ю  Э~яю!8(ЭЛяю"ю(
ю
( Ї2в;Э~яжю  сЭЛ ю>я2в;:в;· пЭ~ Э#ЕХеН»,бСБ·(Нќ1BЂЭ!Ђ :я Эwяжю>
(Њ|ЄВф0}«Вф0±Вф0°(Э6 Э#шН»,·(Нќ1Н»,<·А7ЙбббЂ Н сЇ2i Й:a·А  Н5!‡;Н€4НJ2!ґ;:е;юN 	:ь;· 	!±; Н2НЁ'НIН‰'Ня'НО': <=!Ж;К#(G Г2:a·АеН5Н§4бН`4Гј4 :S·( Г5!aН'·(	Н;4НpГ9Н;4Н]Н№1Г9Н§4	 Н5Нy4 Н5:\ Ж@Ню4:й;O3Ц02yЦ01yЦ
хxФю4с0yЖ0Ню4 Н/(+`iF($:\ ё# N:й;№( з>/Ню4#~ю Дю4ч>:Ню4!] ~Лїю (Ню4#у>.Ню4!e ~Ню4#щНщ4>/Ню4:е;Ню4Гј4!SН'·Кw3Н;4Н]М9:S·Иэ!Ћ<:<<O:ђG-:Ъ;·(Еy!e н±Б(=!dy=¦(7:ю;№(%8':э;№(=№0эs э#Зэ6  Н&2!Ћ<Г€4LзRг.Я!ЫIЧН;4Нp_НзЇѓКґ7Г9ю(юЂ0)_!<5Вб44Й:<_Нш8:‘· 
Нб4
Нб4:ђ<2<ЙжН‰3> О:ђ<2<:<_~#·ИюЂ ~#GЕеНї3бБчжеН‰3бЯбНГ3йбНК3й:<юЪ,	!Т;Н'·(/Н;4:<жД9НI>я2У;Нf7:a·   Н5НЬ5НJ2Ї2У;Г9Н;4Г9:<!Т;ЛF(Л?2’!aЛF =!S†2<ЙЇ†7ИG#^#ЕеН5бБх·Й] > ъЙЕ Н5БчЙеН2беН§4бНГ3*еН2Н§4:ђ<_Нш8Нј4бЬ:`·И!°:ѕ·КZ4>Ђ2<Й:`·И!·:ѕ·КZ4Ї2<Й:<!ђѕ :<!<ѕИеХЕ:ї»8:<іН5БСбЙ?с> ю ШХх_Нб4сСЙ_ Г :<_:Sж!<†W:aў(:У;·(:’‚Wz2<:АюN !!БНА5z·(
Х
Н5С ц{·И!ГНА5 чЙюA(9!БНА5!ГХе:АюR(z†Н5бС#{†Н5{†Н5бС#z†Н5:Е·ИG Г…!С5z<Н°5!Ф5{<Н°5!О5НZ4Э60ю
84Ц
ч#Ж0wЙНЖ5~·ИХН`4СЙ[00;00H:`·АН§4:ђW-ХНб4С шГј4:<_Нз0НI:<“2<НJ)< ю:<Ox‘0Ї_:<»8	ё8x=жА{ц(<2<ђнD2<*<" <:е;юN:ь; Ї_ +BJ·(нR8щ#" <нC<ЙН}	 Нм9В[7Н–6Нс9 :Э;·И=Кн6=Ка6=КA7Гf7:Э;юЪа6КA7Гf7:a·АН¬" Н5Н§4*<:е;юNДТ6* * <НН62 :<o& НН6Нј4Г¶еН5бХНt!ХГ`4Н•	Ва9:<GГ¶7Н•	Ва9Н[,ю	Ка6:<W:Sж‚W:<=_Ка6Н5Нзе!<:<†=W=G:ђ<–_бН28S:<!<ѕ *,<Г28Н•	Вж9!ХНZ4:Щ;!<†(G)Нр5Н№1Н–6Н•	Вж9!ХНZ4Н3Н-9Ї2Ю;/2Ь;ЕН¶7Б:<<ђ у!ЬНZ4ЙJ Н5Н§4Нy4Гј4:a·(й:S·В3:5·АЕН}	Б:SжЂW ЕН5Б:<ђ(:8_Нз:ђ<_:<GяJнDЕ_НБх:ђW<_:<ё с8(Гс8:<G‚W$ЕНз:<G:<=W:ђ<_Н28Sс!<ѕ *,<z·ИЇЩGO_ЩOЂ(9НМКс8ю	(ЩЩрНм8И!Щ{!d¦®<хѓ_сЩх’нDWсђнDG П>	Нм8ИНМЩHGЩ((ю 8Х_Нб4СИ{=ИееЕХю	(2Ж@Н¬4Ню4НБ4>еЕХЩyЩю (:г;·(<Нб4СХ{юФс8СБбЙ:ђ<“!d¦®G(Нщ4СХ(хНщ4СБбџЩHGЩЙ!™НZ4РИ:<<!<ѕ ИНщ4 ъЙ:<=W Н/5:ђ_Ф>я>>>Ї
хг:Э;јг0с2Э;ЙсЙ:cGГ…>Й22Н{9Ф@9>22Й!НН{98»Б!Н:<=А!ЖН{98§Н@9ЄеНс9Дж6:a!Ф¦!Т;¶б еН2бНZ4Ш:Ф·Д3Й7Й:<=А:<=АїНR,(
:<!ђѕ(Й:<!<ѕКd9:<!<ѕКd9Й:<·ИН%9Ї2Ь;Й>я2Ю;Й>я2Я;Й!Я;!Ю;Ї†6 ЙН5НR,А:г;·ИН[, »(Н°8<НР4Гб4  0:<:G:P:P:J:J:Y:e:OuфoжMemory InvaliдKey I/ПError NoфFound SyntaшError CannoфReformat Nameє Readє Writeє Eraseє Loadє Findє Changеtoє Dirє Optionsє Lengthє Columnє Pageє Lineє Macroє Repeaфcounф([Q],0-9/*)є Keщnumbeт([N/Q],0-9)є Abandoоchangesї(Y/N)є Unchanged»saveї(Y/N)є  ChangedєQЂFilеsizeєNNNNNЂMemorщusedєNNNNNЂFreeєNNNNN Ђ[Menuуdisabled»seеManual] Ђ'LоЂCl     ^Q ^O ^P ^KESCChg?WaitRdy^QTOP Pg INSvt hy AI DS MR PS BAK                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        :_· !j;Нѓ4Н		Гґ7    :<юЪ,	!љ>Нѓ4НЧ5Н%НFю (!ћ?ю(ю(!єAю(!М@ю ЭНѓ4Н		Г9^Еcsтup ^ЖworдrtЂ^ЧlinеupЂ^ЗdeleteЂ^ХUNdeleteЂ^P Ptтcode^ШdownЂ^БworдlfЂ^Ъlinеdn DEМdeмleft ^ВreformЂ^PЪplacеmark^УleftЂ^ТpagеupЂ^ЦinsertЂ^Фdeмword ^Юcasеtoggle^ДrightЂ^ГpagеdnЂ^ОinsrфCR ^Щdeмline ^L(^\©rpфfindЂ(PRESУ^K/ESC¬^O¬^СFOТSUBMENUS) ^KВBegiоblock ^KЧblocлWriteЂ^KМLoaдnewЂ^KОNameЂEscНMacrпdef^KЛenдblockЂ^KЩdeletеblock ^KУSaveЂ	^KЙInfoЂEscЈstorеkey^KХUnmarлblkЂ^KТReaдfileЂ^KДsave+loadЂ^KРPrintЂEsc0..№usеky^KГCopщblockЂ^KЖFilеlistЂ^KШsave+eXitЂEsc-TAВtaвback^KЦmoVеblockЂ^KЕErasеfileЂ^KСQuitЂ	Esc-Arrowуshifфscreen Ђ^QВgotпBlockЂ^Q<uѕscтtopЂ^QЩdeмtпEOLЂ^QЖFindЂ^QЪtпplacеmkЂ^Q<dѕscтbotЂ^QDeмўtпBOLЂ^QБreplAceЂ^QТgotпTOFЂ^Q<lѕlоstartЂ^QФdeмtпcharЂ^QРtпlasфcursorЂ^QГgotпEOFЂ^Q<rѕlоendЂ^QХUNdeмlineЂ^QЙgotпPg/LnЂ(^QСgotпZCPТqueuеline ^OL,ТmarзsetЂ^OЙtaвsetЂ^OРPagеlengthЂ^O<uѕmakеtoрlnЂ^OБAuto-inЂ^OШmarзrelЂ^OОtaвclrЂ^OУdbмSpacingЂ^OЧWindowЂ^OСQuietЂ^OГCenterЂ^OЦVarйtabsЂ^OИHyphenationЂ^OКproportionalЂ^OЖFlusиrtЂ^OФrulerЂ^OДDisplaщCRsЂ^OЪZaрscreen                                                                                        ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее  21 00B9"              ?PDERR:	LD   HL,DRIVE$MSG	;error header
?PMSG  0164'   CD 0120'              	CALL ?PMSG
@ADRV  0167'   3A 00D5"              	LD   A,(@ADRV)		;drive code
  016A'   C6 41                 	ADD  A,'A'
  016C'   4F                    	LD   C,A
?CONO  016D'   CD 000C'              	CALL ?CONO
TRACK$MSG  0170'   21 00CB"              	LD   HL,TRACK$MSG	;track header
?PMSG  0173'   CD 0120'              	CALL ?PMSG
@TRK  0176'   2A 00D7"              	LD   HL,(@TRK)		;track number
?PDEC  0179'   CD 0132'              	CALL ?PDEC
SECTOR$MSG  017C'   21 00D0"              	LD   HL,SECTOR$MSG	;sector header
?PMSG  017F'   CD 0120'              	CALL ?PMSG
@SECT  0182'   2A 00D9"              	LD   HL,(@SECT)		;sector number
?PDEC  0185'   18 AB                 	JR   ?PDEC
                                	
                                	
XOFFLIST  0187'                         XOFFLIST:
  0187'   FF FF FF FF           	DEFB -1,-1,-1,-1	;CTL-S clears to zero
  018B'   FF FF FF FF           	DEFB -1,-1,-1,-1	
  018F'   FF FF FF FF           	DEFB -1,-1,-1,-1	
  0193'   FF FF FF FF           	DEFB -1,-1,-1,-1	
                                
                                
                                $EJECT
'ROOT MODULE OF RELOCATABLE BIOS FOR CP/M 3.0'	MACRO-80 3.44	09-Dec-81	PAGE	1-10


                                
  0197'                         	DSEG			;following resides in banked memory
                                
HOME  0032"                         HOME:
                                ;====
                                
                                ;Home selected drive. Treated as SETTRK (0).
                                
  0032"   01 0000               	LD   BC,0		;same as set track zero
SETTRK  0035"   18 2E                 	JR   SETTRK
                                
                                
SELDSK  0037"                         SELDSK:
                                ;======
                                
                                ;Select disk drive. Drive code in reg. C. Invoke login procedure for drive if
                                ;this is first select. Return address of disk parameter header in reg. HL.
                                
  0037"   79                    	LD   A,C		;save drive select code
@ADRV  0038"   32 00D5"              	LD   (@ADRV),A
  003B"   69                    	LD   L,C		;create index from drive code
  003C"   26 00                 	LD   H,0		
  003E"   29                    	ADD  HL,HL
@DTBL  003F"   01 0000*              	LD   BC,@DTBL		;get pointer to dispatch table
  0042"   09                    	ADD  HL,BC
  0043"   7E                    	LD   A,(HL)		;point at disk descriptor
  0044"   23                    	INC  HL
  0045"   66                    	LD   H,(HL)
  0046"   6F                    	LD   L,A
  0047"   B4                    	OR   H			;if no entry in table, no disk
  0048"   C8                    	RET  Z
  0049"   7B                    	LD   A,E		;examine login bit
  004A"   E6 01                 	AND  1
NOT$FIRST$SELECT  004C"   20 16                 	JR   NZ,NOT$FIRST$SELECT
  004E"   E5                    	PUSH HL			;put pointer in stack & <HL>
  004F"   EB                    	EX   DE,HL
  0050"   21 FFFE               	LD   HL,-2		;get relative drive
  0053"   19                    	ADD  HL,DE
  0054"   7E                    	LD   A,(HL)
@RDRV  0055"   32 00D6"              	LD   (@RDRV),A
  0058"   21 FFFA               	LD   HL,-6		;find LOGIN addr
  005B"   19                    	ADD  HL,DE
  005C"   7E                    	LD   A,(HL)		;get address of LOGIN routine
  005D"   23                    	INC  HL
  005E"   66                    	LD   H,(HL)
  005F"   6F                    	LD   L,A
IPCHL  0060"   CD 011F'              	CALL IPCHL		;call LOGIN
  0063"   E1                    	POP  HL			;recover DPH pointer
NOT$FIRST$SELECT  0064Ее Л!!; 	N#FЕЭббБЭй                                    Г я4fтєЧч#‰бры жЇю38  € _!М"т#$,$Y$|+Ь+9-Ж.#0#0                                                                                                                                 ф€  
@` aAbBcCdDeEfFgGhHiI	jJ
kKlLmMnNoOpPqQrRsStTuUvVwWxXyYzZ[{\|]}^~_^00 1! 2" 3# 4$ 5% 6& 7' 8( 9) :* ;+ ,< -= .> /?  ь э 	   ЂЂ ЃЃ ‚‚ ѓѓ „„ …… †† ‡‡ 00 11 23 33 44 55 66 77        ЊЊ ‹‹ ЉЉ ‰‰ €€ 88 99 юю    ,, -- ..  ы @` aAbBcCdDeEfFgGhHiI	jJ
kKlLmMnNoOpPqQrRsStTuUvVwWxXyYzZ[{\|]}^~_^00 1! 2" 3# 4$ 5% 6& 7' 8( 9) :* ;+ ,< -= .> /?  ЌЋэ Џђ‘’“”  •      –– —— 00 11 23 33 44 55 66 77            		 88 99 юю    ,, -- ..  ы Lќо?ђб2ѓФ%vЗimquy}Ѓ…‰Ќ‘                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Y  R E C X S D O H J    
    я=яFяIяJяKяLя яяяAяDяEяGяNяOяRяSяXяYяPяVяQ яW       яя         яяшшяя              яя         шш                   шш         8ра                   ар8  *         *          ~            ~           >>         6>         >>         kk      UЄUЄUЄUЄUЄUЄUЄUЄ  <B№……№B<        ъЖF&Юъ        я А?@?         ?@?               |*(((         "AAc"c         <BҐЃҐ™B<        <BҐЃ™ҐB<                                                >>         <
(         &&22         

*,                                        >           >                         >                                     ""*""                  " >         >  "         >         >  "         ""         >           """"         ""<                                            > >                    "           ":*:         "">""         $$$$         ""         $$$$$         >>         >         ":""         """>"""                       "         "

"         >         "6**"""         ""&*2""         """""         ""         """*,         ""
"         " "         >         """"""         """         """***         """"         ""         > >                                      "                     >                     <         """           <<           <"""<           "         $           <"""<        """"                            

                    ****           """"           """           """         <"""<           &           <          $           """"           """           ""**           ""           """"<          >>                                      L2               >>>>>          ":*:                                                                   L2             "
$("     " "">""       " """""       " """"""          <          """          """"         """"     pЂP pЂP pЂP pЂP pЂ P pЂ P pЂ P pЂ P 
`Ђ 	  Ђя	d @ И nPX 
j
    GДД >VНю !VyУц~Уч#ц:`2UЙ                 !tH Л!	N#fiйx«OжАЛЗ2©yжЛч2Ґyж`ц€2§x·Ысжр!њ9т 	Т     OжАЛЗ2рyжЛч2мyж`ц€2оx·ЫсжЛ#Л#Л#Л#!гіУс~·ИG#N#ніхт 	У     :ё·Ау:·(=2*~2ё#pлнRл ! "ыЙ                                                                                   ЫъхжЖцDУъНЃOсУъЙ!¦Э!›а8

жч_®sЈ n#ЭN 
жь_®sЈ `Э##ЭN 
_®sЈ RЭ#т§х*µ:·¦ Ї2№go"±*"ісЙхе*±#"±н[і|є }»б с/¦w>2№!  "±*"ісЂссЙ_ЕнK НЂяБ
ЈИ"µzWyЈ Лчy2·Z bk)нK	:Ђ8ЛG(#	ЛO(##~D:а8Л_(~юa88:Ґ·~(ю0-ю{0'ж_#:Ґ·~(:Ђ8ЛG~ 
ю[8ю_0ю{8ю0о W:№· нKНЂяzЙЂА @                      :|·(=2|*}~#"}O~2ёyГt!ё~юы(юь(>юэ(Cюю8\<w>0ЙеЫъжЦцTУъ! 8Э*LЭ~ WЭ~G~ж#Н	ч>Н	>
Н	 жб#>еНбе>Н:Ґ/2Ґ·(>G>AНбЇ-Л()еO_!~W#¶(fj Л#~_#VІ(2|нS}бГєyб6 ·АНтГє   OЫъжЦцTУъyЭ*L!ГЛV pЛN VЛF 9ю ЛЖЙю 8oЭ~Э–	ш}·тєю 0ЦЂЭ¶*ЖwГ”·И!ЦB н№А45 щЛ†!ЦB н№А45(щ!ь	N#fiйЛЋЦ W:Д!° н№!>zгЛ–Ц ЭѕРЭ†Эw	:ЕЭ†ЭwН–Гi2Д!ГЛОЙЭѕР2Е!ГЛЦЙЫъхжЖУъ  у:`8Е    ъБусУъЙЭ~Эѕ	ъi:И·ИЭ~Эw	Э5	Г$Э~Эѕт~Э4Г–Э~ЭwГіЭ~ЭѕрЭ5Г–Э~Эѕ	шхЭ4	сВ–:И·К\Э~Эw	Н–єЭ~Эw	Г$Э~ЭwЭ~Эw	Г–O:ЙАy·шюР‡Ѓ‡‡Ѓ O!N	"LеЭбЭ~·(Н\Г–Э~Эѕ	8тН–fЭѕ РGЭ–нDъ<ЭwxшЭwЭѕШЭwЭ*LГ–Эѕ РGЭ–ъ<ЭwxЭwЭѕрЭЭ#їЭ#ЯЖ юЂ8ю 0ЛїЭw
ЙЭ6я>
Уц> УчЙЭ6 Э~Э–	шЭ~·А>
Уц:UУчЙЇ2ҐГЬ :Й·ИЇ!К:Й·А/*LК н°!¶н[L н°2ЙГ–>яИ!
"Й!чЭ6ЂЙЭ6 Й>я2ИЙЇ2ИЙ*ЖЭ~Э–	ш(
 O	T]+нё#Э~
wЙЭ~Эw	Э~Э–ЭFЭp(Нее Э^нRС ЭNн°Э5=еНAН–Гi*ЖЭ~Э–	ш(№ OT]#н°+®НеЭ~Э–	шЭN
q#=тNЙЭ~Эw	Э~хНісЭwјНAЭFЭN	ЕЭ~Эw	Э~ђG(
Э4ЕНAБцБЭpЭq	ЙНѕТНе"Ж 8·нRц>нyнa<нyнiЙЭ~	хЭ~Эw	Э~Э–(Нее Э^С ЭNн°Э4=жНAсЭw	Й! 8 Э^ЭF(эЭ^	Й7So‡”µѕ!!!!!!!Xe†‘ґёїДЙОФЩф*AUh‘*Н'@DHNP  OP     P  OP     P  OP     P  OP     P  OP     P  OP     P  OP     P  OP     P OP        8               !еH Л!	N#fiййрЫэжро0ЙЫХжро0Й!H Л!	N#fiй	OНй ыyУэЙOНр ыyУФЇУХ<УХЙ!1H Л!	N#fiй5_ЫТжАG>УТ:§ЛПУТЫТЛG ш >УТ:§УТyЙЫУжАG>УУ:оЛПУУЫУЛG ш >УУ:оУУyЙ!—H Л!	N#fiй›ѕЫТЛG >УТ:§ЛПУТЫТЛG(ъ>УТ:§УТЫРЙЫУЛG >УУ:оЛПУУЫУЛG(ъ>УУ:оУУЫСЙ>ТЂO>нyнxж,Ц,Й_Нб ынYЙO>яOЇ2гyж2yжю8>Й2Ъ"ЮНЈ{Эѕ8>Й2ЫxЭѕ8>Й2Э:<2в>яЭЛ n =УмА:Ъю0Л±yУо!  "д>РУмЫм2бНґЭЛF ЭЛЖ>яЭwЇ[:ЫЭЛ n(ЭЛ f <ЭЛ V(‡Эѕ 3O>РУмyЭЛ V(Л?Ун:ЭЭЛ v(ЭЛn 	ЭFЛ8ё8ђЭЛ ^(<Уо\OЭ–0нD2дyУп>РУмЭ~УнЭ~ жх*д(T]GэDM)	:Ъю0) 	"дсцУмНґЫмЛВGяЛG т НЂяЫнЭwГ~:Ъ!аѕw:б8($!2 	ЭЛ ~ х! нKд·нB8(э НЂя+|µ хЫмЪGяНґ*Ю:г·х:Г яЫмЛw(>ЙЛo(>ЙжИЭЛ†!в5ВZЛg(>ЙЛ_(>Й>	ЙХ& o‡…‡oЧеЭбСЙ:Ъж·G>(эЭЛ v(O:ЭЭFЛ8ёy8ЛзУаЙ      я     уеНVЭ!ЌЭ~ж& ox‡…oљ н°Э~Э~Э~ж3Э~Э~ Э~Э~ж3Э~Э~	Э~
Э~Э~С!љ>ГюЫъхжїУъ!ЌД{У[’_ЫZжц0w#ссУъЙSatSunMonTueWedThuFri             WWW MM/DD/YY HH:MM:SSуЭ!ЌЭw}жЭw}жЭw xжЭwxжЭw|жЭw|жЭwzжЭrzжЭw{жЭw
{жЭw	Э6 Э6 !ЌТЫъж—цУъ{’_У[~УZ#хЫъц@УъГVO>яOЇ2гyж2yжю8>яЙ2Ъ"ЮНzЭѕ8(>юЙ{Эѕ0чнSЫxЭѕ8>эЙ2Эл Э^ Л;ьНХ2:Ъ‡‡‡ѓ_Э~ж`ѓцЂ_ЭЛF ЫWжАю@ шУVЭ~ жцУWЫWЛ ъЭЛЖЭ~УQ:ЭЭЛ f(<УS}УT|УU{УVЭ^Л;ьP*Ю:г·х(> >0УW:Г†яЫWжO(ЫQO>УVyЙХ& o‡…‡…oеЭбСЙ луГжуеНVЭ!Ќэ! юЭ~жOЭ~жЃэwЭ~	жOЭ~
жЃэwЭ~жOЭ~жЃэwЭ~жOЭ~ жНъ2Э~жOЭ~жНъ2Э~жOЭ~жНъ2:ЦN0ЖdЛ?ЛЛ?ЛЛ9ь!  ·(Gµэлy‡‡O‡ЃO:=Ѓ‡O!¶	~#fo:O	эu эtС! ю:Щ3·>Кю н°Й‡G‡‡ЂЃЙ   у" ю!юr#s#6 ЙХе+ЇµнR8<щл‡‡2>/& o)¶	F#fhнR8(=т) Ц8щЖ2:ЂЦ0Жd2}нD<2б|M !  ЛнjнR0?у}х:НЈW:НЈg:88Лф:НЈoBсСЛъГЇ Ц
8щЖ
Л!ьЃЙ   ; Z x — µ Ф у 0NmЊЁЗе"A`~ќ»Ъщ5SrђЇОм)HgѓўАЯэ;Yx–жхw >НюБЫъжЦцDУъЫщж?цуУщ: <2‡ x2 <w ! „w>„gч: <цЂ2 <w ! „/w>„gц:‡ 2 <Ыщж=УщЙ                 ЫъжЦцDУъЫщж?цуУщ: <2‡ ЇЧ2 <! „w>„gч: <<тЈ Ч2 <! „/w>„gц: << и:‡ 2 <Ыщж?цуУщ: <2‡ Э!V!:Ґ·(WЧЭ~ ·(Э#2 <! „w>„gчеЭ!V!:Ґ·(WЧЭ~ ·(цЂЭ#2 <! „/w>„gцв:‡ 2 <Ыщж=УщыЙ@[\]{|}~ Э*L2z"еХЭ~2u"Э~	2v"Э~2w"Э~2x":И2y"(НЙНДНXНФНѕС(Э~Э~Се2{":z"· Yэ!|"ЭFЫъжЦцTУъЕ*Ж~жЭѕ
 > ю 0ЖЂэw э#Н”БбЫъцUУъ!|"СХЭF>НюЭ~Эѕ(UНµНo*{"& Се§бе|"ЭF>Нюэ!|"ЭFЫъжЦцTУъЕэ~ НЈэ#БфЫъцUУъЭ~Эѕ(НµНo*{"& Сјб:u"Эw:v"Эw	:w"Эw:x"Эw:y"2ИН–Гi                                                                                       унVЫщж3УщН€ Ї!Н6>Н:.Н */}\Нf*1}\Нf!#~·(G#N#ніфЦЧПрХ >РУм>!8 с#Ню:с#юГ Ї! " ю!юЇw#w#w/2>!8 T]хНюс= с:3·(!%"_ !"a ЇGН,$ЇН,$нK&н[$ bjэ+"Ц$нK#Ш$! ЂЕ"п#нK&}|>„gф*п#P 	БбЭ!ш'  ХнK&!  э НХ2{ю	8#)Ш$~Эw Э##~Эw Э#С!ВНр2 МЙ   Э*L! 8K Э^(эY"$2$Й   OЫщж!(ЛзУщЫъжХ(ЛПУъЙOЫщж(ЛпУщЫъц]уУъy! ЂЂя·(>яwн°ЫъжЧУъЙЕхХжр(л·!БнRС8Х)ш'^#Vл·*Ц$нRС0ббЙХ)Ш$^#VбЇЛ<ЛЛ<ЛЛ<ЛO|· Ю}юP0ЩyЛьцЖБЛ@ жѕ2Н$ЫщжБ(ЛпУщЫъц]уУъЛ ЫъжЧУъыЙ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ЕХл·*Ц$нRС0ЇбЙХ)Ш$^#VбЇЛ<ЛЛ<ЛЛ<ЛO|· Ю}юP0ЩyЛьцF2П+ЫщжБ(ЛпУщЫъц]уУъЛ ЫъЛџУъы> И<ЙЕх>-НюсOжрyх(9сжхЭ!-ЕнK&ЭVЭ^ !  э НХ2{ю	8#ЭtЭu Э#Э#Э#Э#БС!  ")-*!-н[-Нр2ъA, яялнC5-·нR#"%-*#-н[-Нр2ъb, яялнC7-·нR#"'-Н	-*%-н['-Нр2ъД,*-н[!-Нр2К-*)-н['-")-н[%-Нр2ъґ,·нR")-*-н[7-"-*-н[5-"-Н	-Ѕ*-н[#-Нр2(6*)-н[%-")-н['-Нр2ъц,·нR")-*-н[5-"-*-н[7-"-Н	-ѕббЙбсБЕхе*-н[-ГY$                                ЕЛзх>-Ню!  ")-"-*-)л! "'-·нR"%-*-н[-л*-Н».*-н[-·нRл*-Н».*-н[-н[-Н».*-н[-·нRн[-Н».*%-н[)-"1-*'-"3-*-#"-*'-##"'-*3-Нц2л*1-н['-Нц2Нр28*3-")-*-+"-*1-н['-")-*%-##"%-*-н[-л*-нK-	Н».*-н[-·нRл*-нK-	Н».*-н[-л*-нK-·нBН».*-н[-·нRл*-нK-·нBН».*-н[-л*-нK-	Н».*-н[-·нRл*-нK-	Н».*-н[-л*-нK-·нBН».*-н[-·нRл*-нK-·нBН».*-н[-Нр2тЎ-ббЙЭбсБЕхЭеГY$ЕЛзх>-Ню!  ")-*-н[-·нR"-*!-·нR"!-*-н[-·нR"-*#-·нR"#-*-н[-л*-нK-	Н».*-Л| !яя"5-*-)л! ·нR*-)л! "5-"%-*-Л| *-)л! "7-!яя"7-*-)л! ·нR"'-н[)-"3-Нц2"/-*%-"1-Нц2"+-*1-н['-Нц2"--н[+-Нр282(0*/-Нр28(*-н[5-"-*1-")-5*3-")-*-н[7-"-"н[/-Нр2тЅ/*-н[5-"-*1-н['-")-С*-н[-л*-нK-	Н».*-н[!-Нр2В/*-н[#-Нр2В/ббЙнSУ2OжюКщ1хyжюК+1х>-Ню*-"+-*!-"--н[-Нр28(н[%-"--*+-"+-*-+"-!яя*-н[%-"-! "%-*-н[#-Нр2т±0+"-н['-"-*#-"#-!яя"-н['-"-! "'-*-н[-Нр2(Z*+-"-*--"!-*-н[-Нр2(.БЕ*-н[-Н|+бБЕе*#-н[!-НY$*-н[%-"-*!-"!-Ж*-н['-"-*#-"#-љббЙ>!-Ню*#-"-*!-"+-*%-}Л<ЛЛ<ЛЛ<Лж(#")-*!-н[%-"!-*#-н['-"#-*-н[#-Нр2(®*У2|":)-G>Ню*+-"-!  "/-*-н[!-Нр2(B!|"н[/-ЇЛ:ЛЛ:ЛЛ:ЛцF2В1Л > (<БЕ*-н[-НY$*-#"-*/-#"/-І*-#"-*У2н[)-"У2Гo1yжх>!-Ню*#-"-*!-"+-*%-}Л<ЛЛ<ЛЛ<Лж(#")-*!-н[%-"!-*#-н['-"#-*-н[#-Нр2К)1*+-"-!  "/-*-н[!-Нр2(DБЕ*-н[-Н|+O!|"н[/-ЇЛ:ЛЛ:ЛЛ:ЛцЖЛA жѕ2ќ2Л *-#"-*/-#"/-°!|"н[У2:)-G>Ню*-#"-*У2н[)-"У2ГE2  |M!  ЛнjнR0?уЛлgiЙе·нRбЙЛ|ИХл!  ·нRСЙЕХеЭеэеНpy·(0:GюP(%:№·(x· y*w#pлнRл ! "!4Н7!Н35 g6-:3· ю!О3<'– #ф* ю#" ю:$·(>:3·(! ю2Щ3Н%Ї2Щ3!юС3Нё3ыЫъхжюцУъ!С3н[$жЂ¶#чсУъэбЭббСБГя~жЖ0~жЖ0#Й-``$HH:MM:SS                                                                                                                                                                                                                                                                                                           OЫщхyХH ЕхЛ?Л?Л?Л?Н1ю@юн°сжН1юБ!@юСн°сУщЙжАцWЫщж=ІУщЙ                                                                                                                                                                                                нsя1 яхЫаЫщхж?УщГ3сУщсн{яыЙ  Н1юс((>€уУм НЂяпЫмЛO ЛG(8ЫмЛO Л(м>Йнўе>ЁуУм НЂяпЫмЛO ЛG(ЫмЛO Л(мЦнЈжЫщж=цУщГtx± ыЙЙхЫаЫщхж?УщГ3сУщсн{яыЙ  Н1юс((>€уУм НЂяпЫмЛO ЛG(8ЫмЛO Л(м>Йнўе>ЁуУм НЂяпЫмЛO ЛG(ЫмЛO Л(мЦнЈжЫщж=цУщГtRСЙЕХеЭеэеНpy·(0:GюP(%:№·(x· y*w#pлнRл ! "!4Н7!Н35 g6-:3· ю!О3<'– #ф* ю#" ю:$·(>:3·(! ю2Щ3Н%Ї2Щ3!юС3Нё3ыЫъхжюцУъ!С3н[$жЂ¶#чсУъэбЭббСБГя~жЖ0~жЖ0#Й-``$HH:MM:SS                                       "                         NOT$FIRST$SELECT:
  0064"   C9                    	RET
                                
                                
SETTRK  0065"                         SETTRK:
                                ;======
                                
'ROOT MODULE OF RELOCATABLE BIOS FOR CP/M 3.0'	MACRO-80 3.44	09-Dec-81	PAGE	1-11


                                ;Set track. Saves track address from reg. BC in @TRK for further operations.
                                
@TRK  0065"   ED 43 00D7"           	LD   (@TRK),BC
  0069"   C9                    	RET
                                
                                
SETSEC  006A"                         SETSEC:
                                ;======
                                
                                ;Set sector. Saves sector number from reg. BC in @SECT for further operations.
                                
@SECT  006A"   ED 43 00D9"           	LD   (@SECT),BC
  006E"   C9                    	RET
                                
                                
SETDMA  006F"                         SETDMA:
                                ;======
                                
                                ;Set disk memory address. Saves DMA address from reg. BC in @DMA.
                                
@DMA  006F"   ED 43 00DB"           	LD   (@DMA),BC
  0073"   C9                    	RET
                                
                                
READ  0074"                         READ:
                                ;====
                                
                                ;Read physical record from currently selected drive. Finds address of proper
                                ;read routine from extended disk parameter header (XDPH).
                                
@ADRV  0074"   2A 00D5"              	LD   HL,(@ADRV)		;get drive code and double it
  0077"   26 00                 	LD   H,0
  0079"   29   …IР“УХ Sф”д•Hэ1B?RLCCPЃOХSQeАUрp  „ Ђ     B  Ђ   "  @  †НЂ0А 	h јeRАD   Љ® „iа6ГЂа€ Н±Ђ ›d@4р›eЂ  D 5XЈаЂЂfЂ    лєШ!k$CF@Yёpљ  ‚ Ф"  Ѓѓ,Qр@3i    єБ.¶AЪЙrµA‚Ђ8„  ѓ СUn   qР  _ЩµlўбdѓЃм0( aЃ@ бc
 `P 4
Ѓ@ P(<)bЂЂ^ &€°ЂК 9bHЂЮ 7Ђ6S‚ЃDr)8’EI$“Ђ¦Y)•¤Рh(¬e9Н&уpЂД 7™„"I<¦ Ј€И`)‚Љ†ѓyґВsжГЎ”@G#ЃЁ4
Ѓ@ P(
Ђ РP4B$“Кb)Ид 7›„РЂњoИeqћMЌ&Г( C!” Ђ@C'“@                         FR 1ъzrJtx џ¤§$ЄG@ 1ъb"„eџЁ&©ЈЗS 1ъ’b„u џЄ$¦ўЖ`Ђ1ъЄљ*’4hL  ¤«"ЎЖ…Ђ2
zІ*h !¤«"ЎЖЃА2zІ*eФ " Є"Ж^ *BzЄ”h4 &'«"ЎЖ_ "jJtа  ћ†ѓyґВsжГЎ”@G#ЃЁ4мЂЉ¤€љ‹ZюЁ		кЄQВЇмЂћ¬Љ‡[ю€	©)СЖ/мЂљ°Ё ѓ8  ћ$ Зкj€‰Ё1Т~¦Ё¦Љ‡ ЗкjЉЉIqФа~Ё’›O §к‰)Ё±•°~Є¦Љ¤Ќ ЗкиIйк‘Т ~®¤’Ё‹W §л	©кС    OЫщхyХH ЕхЛ?Л?Л?Л?Н1ю@юн°сжН1юБ!@юСн°сУщЙжАцWЫщж=ІУщЙ                                                                                                                                                                                                ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее                 	ADD  HL,HL
@DTBL  007A"   11 0000*              	LD   DE,@DTBL		;make address of table entry
  007D"   19                    	ADD  HL,DE
  007E"   7E                    	LD   A,(HL)		;fetch table entry
  007F"   23                    	INC  HL
  0080"   66                    	LD   H,(HL)
  0081"   6F                    	LD   L,A
  0082"   E5                    	PUSH HL			;save address of table
  0083"   11 FFF8               	LD   DE,-8		;point to read routine address
  0086"   19                    	ADD  HL,DE
RW$COMMON  0087"   18 13                 	JR   RW$COMMON		;use common code
                                
                                
WRITE  0089"                         WRITE:
                                ;=====
                                
                                ;Write physical sector from currently selected drive. Finds address of proper
                                ;write routine from extended disk parameter header (XDPH).
                                
@ADRV  0089"   2A 00D5"              	LD   HL,(@ADRV)		;get drive code and double it
  008C"   26 00                 	LD   H,0
  008E"   29                    	ADD  HL,HL
@DTBL  008F"   11 0000*              	LD   DE,@DTBL		;make address of table entry
  0092"   19                    	ADD  HL,DE
'ROOT MODULE OF RELOCATABLE BIOS FOR CP/M 3.0'	MACRO-80 3.44	09-Dec-81	PAGE	1-12


  0093"   7E                    	LD   A,(HL)		;fetch table entry
  0094"   23                    	INC  HL
  0095"   66                    	LD   H,(HL)
  0096"   6F                    	LD   L,A
  0097"   E5                    	PUSH HL			;save address of table
  0098"   11 FFF6               	LD   DE,-10		;point to write routine address
  009B"   19                    	ADD  HL,DE
                                
RW$COMMON  009C"                         RW$COMMON:
  009C"   7E                    	LD   A,(HL)		;get address of routine
  009D"   23                    	INC  HL
  009E"   66                    	LD   H,(HL)
  009F"   6F                    	LD   L,A
  00A0"   D1                    	POP  DE			;recover address of table
  00A1"   1B                    	DEC  DE			;point to relative drive
  00A2"   1B                    	DEC  DE
  00A3"   1A                    	LD   A,(DE)		;get relative drive code and post it
@RDRV  00A4"   32 00D6"              	LD   (@RDRV),A
  00A7"   E9                    	JP   (HL)		;leap to driver
                                
                                
                                $EJECT
'ROOT MODULE OF RELOCATABLE BIOS FOR CP/M 3.0'	MACRO-80 3.44	09-Dec-81	PAGE	1-13


                                
  00A8"                         	CSEG
                                
LISTST  0197'                         LISTST:
                                ;======
                                
                                ;List output status. Return true if all selected list output devices are ready.
                                
@LOVEC  0197'   2A 0000*              	LD   HL,(@LOVEC)	;get list output bit vector
                                
OST$SCAN  019A'                         OST$SCAN:
  019A'   06 00                 	LD   B,0 		;start with device 15
COS$NEXT  019C'                         COS$NEXT:
  019C'   29                    	ADD  HL,HL		;check next bit
  019D'   E5                    	PUSH HL			;save the vector
  019E'   C5                    	PUSH BC			;save the count
  019F'   3E FF                 	LD   A,0FFH		;assume device ready
COSTER  01A1'   DC 01B0'              	CALL C,COSTER		;check status for this device
  01A4'   C1                    	POP  BC			;recover count
  01A5'   E1                    	POP  HL			;recover bit vector
  01A6'   B7                    	OR   A			;see if device ready
  01A7'   C8                    	RET  Z			;if any not ready, return false
  01A8'   04                    	INC  B			;drop device number
  01A9'   7C                    	LD   A,H		;see if any more selected devices
  01AA'   B5                    	OR   L
COS$NEXT  01AB'   20 EF                 	JR   NZ,COS$NEXT
  01AD'   3E FF                 	LD   A,0FFH		;all selected were ready, return true
  01AF'   C9                    	RET
                                
                                ;check for output device ready, including optional XON/XOFF support 
COSTER  01B0'   68                    COSTER:	LD   L,B		;make device code 16 bits
  01B1'   26 00                 	LD   H,0
  01B3'   E5                    	PUSH HL			;make it in stack
  01B4'   29                    	ADD  HL,HL		;create offset into device characteristics tbl
  01B5'   29                    	ADD  HL,HL
  01B6'   29                    	ADD  HL,HL
@CTBL  01B7'   11 0006*              	LD   DE,@CTBL+6		;make address of mode byte
  01BA'   19                    	ADD  HL,DE
  01BB'   7E                    	LD   A,(HL)
MB$XON$XOFF  01BC'   E6 10                 	AND  MB$XON$XOFF
  01BE'   E1                    	POP  HL			;recover console number in reg. HL
?COST  01BF'   CA 0000*              	JP   Z,?COST		;not a XON device, go get output status direct
XOFFLIST  01C2'   11 0187'              	LD   DE,XOFFLIST	;make pointer to proper XON/XOFF flag
  01C5'   19                    	ADD  HL,DE
CISTL  01C6'   CD 01DE'              	CALL CISTL		;see if this keyboard has character
  01C9'   7E                    	LD   A,(HL)		;get flag or read key if any
CIL  01CA'   C4 01F0'              	CALL NZ,CIL
DC1  01CD'   FE 11                 	CP   DC1		;if its a CTL-Q,
NOT$Q  01CF'   20 02                 	JR   NZ,NOT$Q
  01D1'   3E FF                 	LD   A,0FFH		;set the flag ready
NOT$QDC3  01D3'   FE 13                 NOT$Q:	CP   DC3		;if its a CTL-S,
NOT$S  01D5'   20 01                 	JR   NZ,NOT$S
  01D7'   AF                    	XOR  A			;clear the flag
NOT$S  01D8'   77                    NOT$S:	LD   (HL),A		;save the flag
COSTL  01D9'   CD 01E7'              	CALL COSTL		;get the actual output status
'ROOT MODULE OF RELOCATABLE BIOS FOR CP/M 3.0'	MACRO-80 3.44	09-Dec-81	PAGE	1-14


  01DC'   A6                    	AND  (HL)		;and mask with CTL-Q/CTL-S flag
  01DD'   C9                    	RET			;return this as the status
                                
CISTL  01DE'   C5                    CISTL:	PUSH BC			;get input status with regs. BC and HL saved
  01DF'   E5                    	PUSH HL
?CIST  01E0'   CD 0000*              	CALL ?CIST
  01E3'   E1                    	POP  HL
  01E4'   C1                    	POP  BC
  01E5'   B7                    	OR   A
  01E6'   C9                    	RET
                                
COSTL  01E7'   C5                    COSTL:	PUSH BC			;get output status, saving reg. BC & reg. HL
  01E8'   E5                    	PUSH HL
?COST  01E9'   CD 0000*              	CALL ?COST
  01EC'   E1                    	POP  HL
  01ED'   C1                    	POP  BC
  01EE'   B7                    	OR   A
  01EF'   C9                    	RET
                                
CIL  01F0'   C5                    CIL:	PUSH BC			;get input, saving reg. BC & reg. HL
  01F1'   E5                    	PUSH HL
?CI  01F2'   CD 0000*              	CALL ?CI
  01F5'   E1                    	POP  HL
  01F6'   C1                    	POP  BC
  01F7'   C9                    	RET
                                
                                
                                $EJECT
'ROOT MODULE OF RELOCATABLE BIOS FOR CP/M 3.0'	MACRO-80 3.44	09-Dec-81	PAGE	1-15


                                
  01F8'                         	DSEG
                                
SECTRN  00A8"                         SECTRN:
                                ;======
                                
                                ;Sector translate. Indexes skew table in reg. DE with sector in reg. BC.
                                ;Returns physical sector in reg. HL. If no skew table (reg. DE = 0) then
                                ;returns physical = logical.
                                
  00A8"   69                    	LD   L,C
  00A9"   60                    	LD   H,B
  00AA"   7A                    	LD   A,D
  00AB"   B3                    	OR   E
  00AC"   C8                    	RET  Z
  00AD"   EB                    	EX   DE,HL
  00AE"   09                    	ADD  HL,BC
  00AF"   6E                    	LD   L,(HL)
  00B0"   26 00                 	LD   H,0
  00B2"   C9                    	RET
                                
                                
                                $EJECT
'ROOT MODULE OF RELOCATABLE BIOS FOR CP/M 3.0'	MACRO-80 3.44	09-Dec-81	PAGE	1-16


                                
  00B3"                         	CSEG
                                
CONOST  01F8'                         CONOST:
                                ;======
                                
                                ;Console output status. Return true if all selected console output devices are
                                ;ready.
                                
@COVEC  01F8'   2A 0000*              	LD   HL,(@COVEC)	;get console output bit vector
OST$SCAN  01FB'   18 9D                 	JR   OST$SCAN
                                
                                
AUXIST  01FD'                         AUXIST:
                                ;======
                                
                                ;Auxiliary input status. Return true if any selected auxiliary input device has
                                ;an available character.
                                
@AIVEC  01FD'   2A 0000*              	LD   HL,(@AIVEC)	;get aux input bit vector
                                
IST$SCAN  0200'                         IST$SCAN:
  0200'   06 00                 	LD   B,0 		;start with device 15
CIS$NEXT  0202'                         CIS$NEXT:
  0202'   29                    	ADD  HL,HL		;check next bit
  0203'   3E 00                 	LD   A,0		;assume device not ready
CISTL  0205'   DC 01DE'              	CALL C,CISTL		;check status for this device
  0208'   B7                    	OR   A			;if any ready, return true
  0209'   C0                    	RET  NZ
  020A'   04                    	INC  B			;drop device number
  020B'   7C                    	LD   A,H		;see if any more selected devices
  020C'   B5                    	OR   L
CIS$NEXT  020D'   20 F3                 	JR   NZ,CIS$NEXT
  020F'   AF                    	XOR  A			;all selected devices were not ready,
  0210'   C9                    	RET			;return false
                                
                                
AUXOST  0211'                         AUXOST:
                                ;======
                                
                                ;Auxiliary output status. Return true if all selected auxiliary output devices
                                ;are ready.
                                
@AOVEC  0211'   2A 0000*              	LD   HL,(@AOVEC)	;get aux output bit vector
OST$SCAN  0214'   C3 019A'              	JP   OST$SCAN
                                
                                
DEVTBL  0217'                         DEVTBL:
                                ;======
                                
                                ;Return address of character device table.
                                
@CTBL  0217'   21 0000*              	LD   HL,@CTBL
  021A'   C9                    	RET
                                
'ROOT MODULE OF RELOCATABLE BIOS FOR CP/M 3.0'	MACRO-80 3.44	09-Dec-81	PAGE	1-17


                                
                                $EJECT
'ROOT MODULE OF RELOCATABLE BIOS FOR CP/M 3.0'	MACRO-80 3.44	09-Dec-81	PAGE	1-18


                                
GETDRV  021B'                         GETDRV:
                                ;======
                                
                                ;Return address of drive table.
                                
@DTBL  021B'   21 0000*              	LD   HL,@DTBL
                                
                                
MULTIO  021E'                         MULTIO:
                                ;======
                                
                                ;Set multiple sector count (not implemented).
                                
DUMMY  021E'   C9                    DUMMY:	RET
                                
                                
  021F'                         	DSEG
                                
FLUSH  00B3"                         FLUSH:
                                ;=====
                                
                                ;BIOS deblocking buffer flush. Not implemented.
                                
  00B3"   AF                    	XOR  A			;return with no error
  00B4"   C9                    	RET
                                
                                
                                $EJECT
'ROOT MODULE OF RELOCATABLE BIOS FOR CP/M 3.0'	MACRO-80 3.44	09-Dec-81	PAGE	1-19


                                
  00B5"                         	CSEG
                                
BNKSEL  021F'                         BNKSEL:
                                ;======
                                
                                ;Bank select. Select CPU bank for further execution.
                                
@CBNK  021F'   32 0225'              	LD   (@CBNK),A		;remember current bank
?BANK  0222'   C3 0000*              	JP   ?BANK		;and go exit through users 
                                				;physical bank select routine
                                  
                                
  0225'                         	DSEG
                                
SETBNK  00B5"                         SETBNK:
                                ;======
                                
                                ;Set disk memory bank. Saves bank number in @DBNK for future disk data
                                ;transfers.
                                
@DBNK  00B5"   32 00DD"              	LD   (@DBNK),A
  00B8"   C9                    	RET 	
                                
                                
                                ;error message components:
DRIVE$MSG  00B9"                         DRIVE$MSG:
ESCBEL  00B9"   1B 45 07              	DEFB ESC,'E',BEL
  00BC"   42 49 4F 53           	DEFM 'BIOS Error on '
  00C0"   20 45 72 72           
  00C4"   6F 72 20 6F           
  00C8"   6E 20                 
  00CA"   00                    	DEFB 0
TRACK$MSG  00CB"                         TRACK$MSG:
  00CB"   3A 20 54 2D           	DEFM ': T-'
  00CF"   00                    	DEFB 0
SECTOR$MSG  00D0"                         SECTOR$MSG:
  00D0"   2C 20 53 2D           	DEFM ', S-'
  00D4"   00                    	DEFB 0
                                
                                
@ADRV  00D5"                         @ADRV:	DEFS 1			;currently selected disk drive
@RDRV  00D6"                         @RDRV:	DEFS 1			;controller relative disk drive
@TRK  00D7"                         @TRK:	DEFS 2			;current track number
@SECT  00D9"                         @SECT:	DEFS 2			;current sector number
@DMA  00DB"                         @DMA:	DEFS 2			;current DMA address
@DBNK  00DD"   00                    @DBNK:	DEFB 0			;bank for DMA operations
                                
  00DE"                         	CSEG			;common memory
                                
@CBNK  0225'   00                    @CBNK:	DEFB 0			;bank for processor operations
                                
                                	END
'ROOT MODULE OF RELOCATABLE BIOS FOR CP/M 3.0'	MACRO-80 3.44	09-Dec-81	PAGE	S


Macros:

Symbols:
0015I'	?AUXI           0036I'	?AUXIS          0012I'	?AUXO           
0039I'	?AUXOS          0223*	?BANK           0051I'	?BNKSL          
0000I'	?BOOT           01F3*	?CI             0040*	?CINIT          
01E1*	?CIST           00F5*	?CO             0009I'	?CONIN          
000CI'	?CONO           0033I'	?CONOS          0006I'	?CONST          
01EA*	?COST           003FI'	?DEVIN          0042I'	?DRTBL          
003CI'	?DVTBL          0048I'	?FLUSH          0018I'	?HOME           
0004*	?INIT           0067*	?LDCCP          000FI'	?LIST           
002DI'	?LISTS          0045I'	?MLTIO          004BI'	?MOV            
004C*	?MOVE           0132I'	?PDEC           0161I'	?PDERR          
0120I'	?PMSG           0027I'	?READ           0073*	?RLCCP          
0030I'	?SCTRN          001BI'	?SLDSK          0054I'	?STBNK          
0024I'	?STDMA          0021I'	?STSEC          001EI'	?STTRK          
004EI'	?TIM            004F*	?TIME           005A'	?USER           
005B*	?USERF          0003I'	?WBOOT          002AI'	?WRITE          
0057I'	?XMOV           0058*	?XMOVE          00D5I"	@ADRV           
01FE*	@AIVEC          0212*	@AOVEC          0225I'	@CBNK           
00D9*	@CIVEC          01F9*	@COVEC          0218*	@CTBL           
00DDI"	@DBNK           00DBI"	@DMA            021C*	@DTBL           
0198*	@LOVEC          008C*	@MXTPA          00D6I"	@RDRV           
00D9I"	@SECT           00D7I"	@TRK            0104'	AUXIN           
01FD'	AUXIST          0211'	AUXOST          00FF'	AUXOUT          
0003 	BAUD110         0008 	BAUD1200        0004 	BAUD134         
0005 	BAUD150         0009 	BAUD1800        000F 	BAUD19200       
000A 	BAUD2400        0006 	BAUD300         000B 	BAUD3600        
000C 	BAUD4800        0001 	BAUD50          0007 	BAUD600         
000D 	BAUD7200        0002 	BAUD75          000E 	BAUD9600        
0000 	BAUDNONE        0007 	BEL             021F'	BNKSEL          
0000"	BOOT            0063'	BOOT$1          00D2'	BOOT$STACK      
0100 	CCP             010A'	CI$NEXT         011B'	CI$RDY          
01F0'	CIL             0202'	CIS$NEXT        01DE'	CISTL           
00E7'	CO$NEXT         00D8'	CONIN           01F8'	CONOST          
00DD'	CONOUT          00D2'	CONST           019C'	COS$NEXT        
01B0'	COSTER          01E7'	COSTL           000C"	D$INIT$LOOP     
002A"	D$INIT$NEXT     0011 	DC1             0013 	DC3             
0217'	DEVTBL          00B9"	DRIVE$MSG       021E'	DUMMY           
001B 	ESC             00B3"	FLUSH           021B'	GETDRV          
0032"	HOME            0107'	IN$SCAN         011F'	IPCHL           
0200'	IST$SCAN        00E2'	LIST            0197'	LISTST          
0003 	MB$IN$OUT       0001 	MB$INPUT        0002 	MB$OUTPUT       
0008 	MB$SERIAL       0004 	MB$SOFT$BAUD    0010 	MB$XON$XOFF     
021E'	MULTIO          0138'	NEXT            014B'	NEXTDIGIT       
00F9'	NO$OUT$DEVICE   0064"	NOT$FIRST$SELECT 00EC'	NOT$OUT$READY   
01D3'	NOT$Q           01D8'	NOT$S           019A'	OST$SCAN        
00E5'	OUT$SCAN        013A'	PDEC1           012F'	PMSG$EXIT       
0122'	PMSG$LOOP       0074"	READ            009C"	RW$COMMON       
00D0"	SECTOR$MSG      00A8"	SECTRN          0037"	SELDSK          
0078'	SET$JUMPS       00B5"	SETBNK          006F"	SETDMA          
006A"	SETSEC          0065"	SETTRK          0143'	STOPLOOP        
0157'	TABLE10         00CB"	TRACK$MSG       006C'	WBOOT           
0089"	WRITE           0187'	XOFFLIST        



No Fatal error(s)

 
   019A'	OST$SCAN        
00E5'	OUT$SCAN        0              ?PMSG:	PUSH BC			;saves reg. BC & reg. DE
  0121'   D5                    	PUSH DE
PMSG$LOOP  0122'                         PMSG$LOOP:
  0122'   7E                    	LD   A,(HL)
  0123'   B7                    	OR   A
PMSG$EXIT  0124'   28 09                 	JR   Z,PMSG$EXIT
  0126'   4F                    	LD   C,A
  0127'   E5                    	PUSH HL
?CONO  0128'   CD 000C'              	CALL ?CONO
  012B'   E1                    	POP  HL
  012C'   23           'SYSTEM CONTROL BLOCK DEFINITION FOR CP/M 3 BIOS'	MACRO-80 3.44	09-Dec-81	PAGE	1


                                ;******************************************************************************
                                ;*  S C B  *  C P M S Y S 4 a  *  T h o m a s   H o l t e   *   8 5 0 2 0 5   *
                                ;******************************************************************************
                                ;*									      *
                                ;*   S Y S T E M   C O N T R O L   B L O C K   D E F I N I T I O N   F O R    *
                                ;*   =====================================================================    *
                                ;*									      *
                                ;*  	       		    C P / M   3 . 0   B I O S			      *
                                ;*	                    =========================           	      *
                                ;*									      *
                                ;*									      *
                                ;*  Thomas Holte						 Version 1.0  *
                                ;*									      *
                                ;******************************************************************************
                                
                                	.Z80
                                
                                	TITLE 'SYSTEM CONTROL BLOCK DEFINITION FOR CP/M 3 BIOS'
                                
@CIVEC@COVEC@AIVEC@AOVEC@LOVEC@ERDME@DATE@HOUR@MIN                                	GLOBAL @CIVEC,@COVEC,@AIVEC,@AOVEC,@LOVEC,@ERDME,@DATE,@HOUR,@MIN
@MXTPA                                	GLOBAL @MXTPA
                                
                                
SCB$BASE  FE00                          SCB$BASE EQU 0FE00H		;base of the SCB
                                
@CIVECSCB$BASE  FE22                          @CIVEC  EQU  SCB$BASE+22H	;console   input  redirection vector
                                				;(word, R/W)
@COVECSCB$BASE  FE24                          @COVEC  EQU  SCB$BASE+24H       ;console   output redirection vector 
                                				;(word, R/W)
@AIVECSCB$BASE  FE26                          @AIVEC  EQU  SCB$BASE+26H	;auxiliary input  redirection vector
                                				;(word, R/W)
@AOVECSCB$BASE  FE28                          @AOVEC	EQU  SCB$BASE+28H	;auxiliary output redirection vector
                                				;(word, R/W)
@LOVECSCB$BASE  FE2A                          @LOVEC	EQU  SCB$BASE+2AH	;list	   output redirection vector
                                                                ;(word, R/W)
@ERDMESCB$BASE  FE4B                          @ERDME	EQU  SCB$BASE+4BH	;BDOS error mode (byte, R/O)
@DATESCB$BASE  FE58                          @DATE	EQU  SCB$BASE+58H	;date in days since 1 Jan 78 (word, R/W)
@HOURSCB$BASE  FE5A                          @HOUR	EQU  SCB$BASE+5AH	;hour   in BCD (byte, R/W)
@MINSCB$BASE  FE5B                          @MIN	EQU  SCB$BASE+5BH	;minute in BCD (byte, R/W)
@MXTPASCB$BASE  FE62                          @MXTPA	EQU  SCB$BASE+62H	;top of user TPA (address at 6, 7) (word, R/O)
                                
                                        END
'SYSTEM CONTROL BLOCK DEFINITION FOR CP/M 3 BIOS'	MACRO-80 3.44	09-Dec-81	PAGE	S


Macros:

Symbols:
FE26I 	@AIVEC          FE28I 	@AOVEC          FE22I 	@CIVEC          
FE24I 	@COVEC          FE58I 	@DATE           FE4BI 	@ERDME          
FE5AI 	@HOUR           FE2AI 	@LOVEC          FE5BI 	@MIN            
FE62I 	@MXTPA          FE00 	SCB$BASE        



No Fatal error(s)

 
 (address at 6, 7) (word, R/O)
                 	LD   BC,0		;same as set track zero
SETTRK  0035"   18 2E                 	JR   SETTRK
                                
                                
SELDSK  0037"                         SELDSK:
                              …‰ФЦTХ`d4•dT8=Y@AIVECЃђSХ‘PаdДхdT8I5@DATEЃPХT DФ”и5aQAP &юИ)*ИЁqВЏмЂ‚ћ¬Љ‡"юИi*ИЁqВOмЂ†ћ¬Љ‡XюЁ€*€±ДїмЂЉ¤€љ‹ZюЁ		кЄQВЇмЂћ¬Љ‡[ю€	©)СЖ/мЂљ°Ё ѓ8  ћ$ Зкj€‰Ё1Т~¦Ё¦Љ‡ ЗкjЉЉIqФа~Ё’›O §к‰)Ё±•°~Є¦Љ¤Ќ ЗкиIйк‘Т ~®¤’Ё‹W §л	©кС                              
                                        END
'SYSTEM CONTROL BLOCK DEFINITION FOR CP/M 3 BIOS'	MACRO-80 3.44	09-Dec-81	PAGE	S


Macros:

Symbols:
FE26I 	@AIVEC          FE28I 	@AOVEC          FE22I 	@CIVEC           26 00                 	LD   H,0		
  003E"   29                    	ADD  HL,HL
@DTBL  003F"   01 0000*              	LD   BC,@DTBL		;get pointer to dispatch table
  0042"   09                    	ADD  HL,BC
  0043"   7E                    	LD   A,(HL)		;point at disk descriptor
  0044"   23                    	INC  HL
  0045"   66                    	LD   H,(HL)
  0046"   6F                    	LD   L,A
  0047"   B4                    	OR   H			;if no entry in table, no disk
  0048"   C8                    	RET  Z
  0049"   7B                    	LD   A,E		;examine login bit
  004A"   E6 01                 	AND  1
NOT$FIRST$SELECT  004C"   20 16                 	JR   NZ,NOT$FIRST$SELECT
  004E"   E5                    	PUSH HL			;put pointer in stack & <HL>
  004F"   EB                    	EX   DE,HL
  0050"   21 FFFE               	LD   HL,-2		;get relative drive
  0053"   19                    	ADD  HL,DE
  0054"   7E                    	LD   A,(HL)
@RDRV  0055"   32 00D6"              	LD   (@RDRV),A
  0058"   21 FFFA               	LD   HL,-6		;find LOGIN addr
  005B"   19                    	ADD  HL,DE
  005C"   7E                    	LD   A,(HL)		;get address of LOGIN routine
  005D"   23                    	INC  HL
  005E"   66                    	LD   H,(HL)
  005F"   6F                    	LD   L,A
IPCHL  0060"   CD 011F'              	CALL IPCHL		;call LOGIN
  0063"   E1                    	POP  HL			;recover DPH pointer
NOT$FIRST$SELECT  0064у>ДУъ1аA!B ьян°Г ьунV1 ь>Ущ>TУъ! 88я6 н°>ЕУъ"ЕН`ь·В)э*'э 	"'э:&э<ю >2$эЇ2&эБЪ!5юын°! 7 DЂн°Г DЇ2йьнK$эy2льЛЛЛЛyжАO!йь:&эю8ЦЛЖЛ†±2кьуНыьНоьНоьЫAюП(юЛ р*'э@НоьНоьЫAюП(юЛ рнўм НоьНоьЫAюП(т лНоьНоьЫ@ж(Г)э>Й   Е ЫAЛG шБЙЫAюА(ЇУAхУBНоьНоьyУ@@НоьНоьнЈ цЙx± ыЙ    !йь Ђ н°>ДУъ!aэ < н°dЕ  :`8Е    ъБу@НэБжюHDBOOTER HARD-DISK ERROREnhanced BIOS written by Thomas Holte  (c) 1985                                  8Е    ъБу@НэБжюHDBOOTER иFиF;LиFиFиFиFALGLиFиFиFиFиFиFиFиFиFиFиFиFиFиFиFиFиFиFиFиFиFиFиF  ЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗ:оF·ВћFЕНNБy!ЪLюИ4ю Р5~·ИyюВµF5Йю
А6 Йyю	В’F Н’F:ЪLжВБFЙ!ЫL
ѕИЕOН»FБГПFлMDГПF2	GЙ>ГеF 
BDOS ERR: $Select$Perm.$  пFНПFьFГ GпFНПFGНПFю{•_zњWРЙ{…_zЊWРЙИ)ЏГ8GѕА#ИГ?GИw#ГJGJНN|µИ^#V###"ђL##"’L######л"ёL!LНIG*Lл!ҐLНIG*ЄL|!ЅL6я·К•G6 7ЙНNЇ*ђLw#w*’Lw#w#wЙ!ГL^#V#FЙНЄGН'N·ИOюЪGГG*гLН&I л!ГLs#r#pЙ*ђLN#FЕ*’L^#V#F*ГL:ЕLO}“|љyеТH*ҐLН%Gбг+гГрG*ҐLН.Gб}“|љyЪHг#геГHге*ҐLН%GбХЕел*ІLDM"ОLНNС*ђLs#rБС*’Ls#r#pБy“oxљgНkHDM*ёLлН0NMD"РLН!N*ЉLMDГ$N:ґLOГ&I!§LN:БL·ВyHG>–O:АLКђH·Г‡HЂЙ*ЯL ЙН’H	:ЅL·КЁHn`Й	~#foЙНrH2»LO НљH"ГL}ґЙ:§LO*ГLЇН7G"ГL2ЕL"ЖL:ЁLO:БLЎG2¶L!ГL¶wЙ*ЯL Й*ЯL ЙНоHл! ЙНцH~2БLл~2їLНжH:©L¦2АLЙНцH:БLЃwл:їLwЙИ|·g}oГ'IИ)Г4I:ЮLЕO! Н3IБyµoxґgЙ:ЮLOН&I}жЙ*ЊL:ЙL…oР$ЙНжH~жwЙ{•ozњgЙХ
 ^#VлСЙНЖG:µL·КЏI>НиLГ›IНЎI"ЊLНЪGНіG*ЬLГ§I*ћLНrI"ЉLЙ!гL~#ѕА<Й!яя"гLЙ*¬Lл*гL#"гLНkIЪґI:гLж‡ВУI2ЙL·АЕН}IБЙЕх:©L/Gy Oс ‘жБЙНцHAЕБЇ+ѕВ	JВяIy2»L:ЅL·xВJЕеo& :§LW>’OН&IE:©LёбЪьIНжHN/жЎ°БЙ*ЯL"еLy2зLНґIН—G Н»IН«IК›J*еLлНXI:зLO ~юеКJJy·К”JxюКЌJюК‚J–жВJJГЌJЕNНгIБ·ВJJ#ГhJЇ2	GGЙ>яGГеFН:JИНжH~хНXIл*ЯL НIGНфIOсw л! ‘КШJxТТJ>ЂFwx2јLЙ2јL~·А:»L·И:вLюИ6ЂЙе:јL·КэJ wЇ2јLбЙНжH~OНгIК!K>ЎwН:JНЁJНяHЇ2БLГеF4НфIOѕТ.K5ГйFНмJНїJГKНяH:БL!їLѕЪSKюЂВйFНяJ:	G·ВйFН®HКйFНАH:µL·ВТLН›IНЪGНіGГI:ЮL<КG=!ВLѕИwW*€LНMI_ХНSGбТG-И*€LMDН:I"€LЙ:єL2ЮLЙЇ2ИLГТK>ЂG=O*ЯL л~ ~Ўw#~ 2ИL~ЎwНcIНоH~ КТK~Ўp2јL!  "КL>я2бL*ЯL~ж=2єLюяКцK~2КLН›KНoK> *ЯLwЙ'BOOT LOADER MODULE FOR CP/M 3.0'	MACRO-80 3.44	09-Dec-81	PAGE	1


                                ;******************************************************************************
                                ;* H D B O O T  * C P M S Y S 4 b *  T h o m a s   H o l t e  *  8 5 1 0 2 3  *
                                ;******************************************************************************
                                ;*									      *
                                ;*  	 B O O T   L O A D E R   M O D U L E   F O R   C P / M   3 . 0	      *
                                ;*       =============================================================        *
                                ;*									      *
                                ;*									      *
                                ;*  Thomas Holte						 Version 1.0  *
                                ;*									      *
                                ;******************************************************************************
                                ;
                                ; Version um von Festplatten Laufwerk C: zu booten.
                                ;						V.Dose	15.9.93
                                
                                
                                	.Z80
                                
                                	TITLE 'BOOT LOADER MODULE FOR CP/M 3.0'
                                
                                ;ASCII control codes
BEL  0007                          BEL	EQU  07H		;bell
LF  000A                          LF	EQU  0AH		;line feed
CR  000D                          CR	EQU  0DH		;carriage return
SUB  001A                          SUB	EQU  1AH		;substitute
ESC  001B                          ESC	EQU  1BH		;escape
RS  001E                          RS	EQU  1EH		;record separator
                                
?INIT?LDCCP?RLCCP?TIME                                        GLOBAL ?INIT,?LDCCP,?RLCCP,?TIME
?PMSG?CONIN?USERF                                	EXTERNAL ?PMSG,?CONIN,?USERF
@CIVEC@COVEC@AIVEC@AOVEC@LOVEC                                	EXTERNAL @CIVEC,@COVEC,@AIVEC,@AOVEC,@LOVEC
@DATE@HOUR@MIN                                	EXTERNAL @DATE,@HOUR,@MIN
                                
BDOS  0005                          BDOS	EQU  0005H
                                
  0000'                         	DSEG			;init done from banked memory
                                
?INIT  0000"   21 8000               ?INIT:  LD   HL,8000H           ;assign console to CRT 
@CIVEC  0003"   22 0000*                      LD   (@CIVEC),HL
@COVEC  0006"   22 0000*                      LD   (@COVEC),HL
  0009"   21 4000               	LD   HL,4000H		;assign printer to LPT1
@LOVEC  000C"   22 0000*                      LD   (@LOVEC),HL
  000F"   21 1000                       LD   HL,1000H           ;assign AUX to TTY1
@AIVEC  0012"   22 0000*                      LD   (@AIVEC),HL
@AOVEC  0015"   22 0000*                      LD   (@AOVEC),HL
SIGNON$MSG  0018"   21 009B'              	LD   HL,SIGNON$MSG	;print signon message
?PMSG  001B"   C3 0000*              	JP   ?PMSG
                                
                                
  001E"                         	CSEG			;boot loading must be done from resident memory
                                
                                ;This version of the boot loader loads the CCP from a file called CCP.COM on
                                ;the system drive (C:).
                                
                                ;First time, load the C:CCP.COM file into TPA
?LDCCP  0000'   AF                    ?LDCCP:	XOR  A                  ;zero extent
CCP$FCB'BOOT LOADER MODULE FOR CP/M 3.0'	MACRO-80 3.44	09-Dec-81	PAGE	1-1


  0001'   32 014B'              	LD   (CCP$FCB+15),A
  0004'   21 0000               	LD   HL,0               ;start at beginning of file
FCB$NR  0007'   22 015C'              	LD   (FCB$NR),HL
CCP$FCB  000A'   11 013C'                   	LD   DE,CCP$FCB		;open file containing CCP
OPEN  000D'   CD 0087'                      CALL OPEN
  0010'   3C                    	INC  A                  ;error if no file ...
NO$CCP  0011'   28 2E                 	JR   Z,NO$CCP
  0013'   11 0100               	LD   DE,0100H 		;start of TPA
SETDMA  0016'   CD 008C'              	CALL SETDMA
  0019'   11 0080               	LD   DE,128  		;allow up to 16k bytes
SETMULTI  001C'   CD 0091'              	CALL SETMULTI
CCP$FCB  001F'   11 013C'              	LD   DE,CCP$FCB		;load the thing
READ  0022'   CD 0096'              	CALL READ		;now, copy CCP to secret bank for reloading
                                
                                ;move copy of CCP into secret bank:
  0025'   21 0100               	LD   HL,0100H		;source      address --> reg. HL
  0028'   11 3500               	LD   DE,3500H		;destination address --> reg. DE
  002B'   06 1E                      	LD   B,30		;record count        --> reg. B
LDLOOP  002D'   C5                    LDLOOP: PUSH BC			;save record count
  002E'   3E 10                 	LD   A,10H		;source      bank = 1
                                        			;destination bank = 0
  0030'   01 800F               	LD   BC,128 SHL 8+15	;byte count --> reg. B
                                	          		;function # --> reg. C
?USERF  0033'   CD 0000*              	CALL ?USERF		;move CCP record
  0036'   01 0080               	LD   BC,128		;record length --> reg. BC
  0039'   09                    	ADD  HL,BC		;bump source address
  003A'   EB                    	EX   DE,HL
  003B'   09                    	ADD  HL,BC		;bump destination address
  003C'   EB                    	EX   DE,HL
  003D'   C1                    	POP  BC			;restore record count
LDLOOP  003E'   10 ED                 	DJNZ LDLOOP		;move next record	
  0040'   C9                    	RET			;return to caller
                                	
                                ;here if we couldn't find the file:
NO$CCPCCP$MSG  0041'   21 0119'              NO$CCP:	LD   HL,CCP$MSG		;report this ...
?PMSG  0044'   CD 0000*              	CALL ?PMSG
?CONIN  0047'   CD 0000*              	CALL ?CONIN		;get response
?LDCCP  004A'   18 B4                 	JR   ?LDCCP		;and try again
                                
                                ;reload CCP:
?RLCCP  004C'   21 3500               ?RLCCP:	LD   HL,3500H		;source      address --> reg. HL
  004F'   11 0100               	LD   DE,0100H		;destination address --> reg. DE
  0052'   06 1E                      	LD   B,30		;record count        --> reg. B
RLLOOP  0054'   C5                    RLLOOP: PUSH BC			;save record count
  0055'   3E 01                 	LD   A,01H		;source      bank = 0
                                        			;destination bank = 1
  0057'   01 800F               	LD   BC,128 SHL 8+15	;byte count --> reg. B
                                	          		;function # --> reg. C
?USERF  005A'   CD 0000*              	CALL ?USERF		;move CCP record
  005D'   01 0080               	LD   BC,128		;record length --> reg. BC
  0060'   09                    	ADD  HL,BC		;bump source address
  0061'   EB                    	EX   DE,HL
  0062'   09                    	ADD  HL,BC		;bump destination address
  0063'   EB                    	EX   DE,HL
  0064'   C1                    	POP  BC			;restore record count
RLLOOP  0065'   10 ED                 	DJNZ RLLOOP		;move next record	
'BOOT LOADER MODULE FOR CP/M 3.0'	MACRO-80 3.44	09-Dec-81	PAGE	1-2


  0067'   C9                    	RET			;return to caller
                                	
                                
                                $EJECT
'BOOT LOADER MODULE FOR CP/M 3.0'	MACRO-80 3.44	09-Dec-81	PAGE	1-3


                                
                                ;External clock.
?TIME  0068'   E5                    ?TIME:	PUSH HL			;save reg. HL & DE
  0069'   D5                    	PUSH DE
  006A'   0C                            INC  C  		;time get/set flag ?
SET$TIM  006B'   28 07                 	JR   Z,SET$TIM		;set time
@DATE  006D'   21 0000*              	LD   HL,@DATE		;^(time & date buffer) --> reg. HL
  0070'   0E 12                 	LD   C,18		;function # 	       --> reg. C
GET$TIM  0072'   18 0D                 	JR   GET$TIM		;get time & date and return to caller
SET$TIM@DATE  0074'   2A 0000*              SET$TIM:LD   HL,(@DATE)		;date		       --> reg. HL
@HOUR  0077'   3A 0000*              	LD   A,(@HOUR)		;hours		       --> reg. D
  007A'   57                    	LD   D,A
@MIN  007B'   3A 0000*              	LD   A,(@MIN)		;minutes	       --> reg. E
  007E'   5F                    	LD   E,A
  007F'   0E 13                 	LD   C,19 		;function #	       --> reg. C
GET$TIM?USERF  0081'   CD 0000*              GET$TIM:CALL ?USERF		;set time & date and return to caller
  0084'   D1                    	POP  DE			;restore reg. HL & DE
  0085'   E1                    	POP  HL
  0086'   C9                    	RET
                                
                                
                                ;CP/M BDOS function interfaces
OPEN  0087'   0E 0F                 OPEN:	LD   C,15		;open file control block
BDOS  0089'   C3 0005               	JP   BDOS
SETDMA  008C'   0E 1A                 SETDMA:	LD   C,26		;set data transfer address
BDOS  008E'   C3 0005               	JP   BDOS
SETMULTI  0091'                         SETMULTI:
  0091'   0E 2C                 	LD   C,44		;set record count
BDOS  0093'   C3 0005               	JP   BDOS
READ  0096'   0E 14                 READ:	LD   C,20		;read records
BDOS  0098'   C3 0005               	JP   BDOS
                                	
                                
                                $EJECT
'BOOT LOADER MODULE FOR CP/M 3.0'	MACRO-80 3.44	09-Dec-81	PAGE	1-4


              …IР“УХ Sф”д•Hэ1B?RLCCPЃOХSQeАUрp  „ Ђ     B  Ђ   "  @  †НЂ0А 	h јeRАD   Љ® „iа6ГЂа€ Н±Ђ ›d@4р›eЂ  D 5ЈаЂЂfЂ    лєШ!k$CF@Yёpљ  ‚ Ф"  ЃѓМQр@3i    єБ.¶AЪЙrµA‚Ђ8„  ѓ СUn   qР  _ЩµlўбdѓЃм0( aЃ@ бc
 `P 4
Ѓ@ P(<)bЂЂ^ &€°ЂК 9bHЂЮ 7Ђ6S‚ЃDr)8’EI$“Ђ¦Y)•¤Рh(¬e9Н&уpЂД 7™„"I<¦ Ј€И`)‚Љ†ѓyґВsжГЎ”@G#ЃЁ4
Ѓ@ P(
Ђ РP4B$“Кb)Ид 7›„1РЂњoИeqћMЌ&Г( C!” Ђ@C'“@                         FR 1ъzrJtx џ¤§$ЄG@ 1ъb"„eџЁ&©ЈЗS 1ъ’b„u џЄ$¦ўЖ`Ђ1ъЄљ*’4hL  ¤«"ЎЖ…Ђ2
zІ*h !¤«"ЎЖЃА2zІ*eФ " Є"Ж^ *BzЄ”h4 &'«"ЎЖ_ "jJtа  ћ†ѓyґВsжГЎ”@G#ЃЁ4                               
                                $EJECT
'ROOT MODULE OF RELOCATABLE BIOS FOR CP/M 3.0'	MACRO-80 3.44	09-Dec-81	PAGE	1-16


                                
  00B3"                         	CSEG
                                
CONOST  01F8'                         CONOST:
                                ;======
                                
                                ;Console output status. Return true if all selected console output devices are
                                ;ready.
                                
@COVEC  01F8'   2A 0000*              	LD   HL,(@COVEC)	;get console output bit vector
OST$SCAN  01FB'   18 9D                 	JR   OST$SCAN
                                
                                
AUXIST  01FD'                         AUXIST:
                                ;======
                                
                                ;Auxiliary input status. Return true if any selected auxiliary input device has
                                ;an available character.
                                
@AIVEC  01FD'   2A 0000*              	LD   HL,(@AIVEC)	;get aux input bit vector
                                
IST$SCAN  0200'                         IST$SCAN:
  0200'   06 00                 	LD   B,0 		;start with device 15
CIS$NEXT  0202'                             
SIGNON$MSG  009B'                         SIGNON$MSG:
CRLFLFLFLF  009B'   0D 0A 0A 0A                   DEFB CR,LF,LF,LF,LF,LF,LF,LF,LF,RS,ESC,'R'
LFLFLFLF  009F'   0A 0A 0A 0A           
RSESC  00A3'   0A 1E 1B 52           
  00A7'   20 43 20 50           	DEFM ' C P / M   V e r s i o n   3 '
  00AB'   20 2F 20 4D           
  00AF'   20 20 20 56           
  00B3'   20 65 20 72           
  00B7'   20 73 20 69           
  00BB'   20 6F 20 6E           
  00BF'   20 20 20 33           
  00C3'   20                    
ESCCRLFLF  00C4'   1B 53 0D 0A           	DEFB ESC,'S',CR,LF,LF
  00C8'   0A                    
  00C9'   47 45 4E 49           	DEFM 'GENIE IIIs SYSTEM'
  00CD'   45 20 49 49           
  00D1'   49 73 20 53           
  00D5'   59 53 54 45           
  00D9'   4D                    
CRLF  00DA'   0D 0A                 	DEFB CR,LF
  00DC'   56 65 72 73           	DEFM 'Version b of BIOS (851120)'
  00E0'   69 6F 6E 20           
  00E4'   62 20 6F 66           
  00E8'   20 42 49 4F           
  00EC'   53 20 28 38           
  00F0'   35 31 31 32           
  00F4'   30 29                 
CRLF  00F6'   0D 0A                 	DEFB CR,LF
  00F8'   54 68 6F 6D           	DEFM 'Thomas Holte '
  00FC'   61 73 20 48           
  0100'   6F 6C 74 65           
  0104'   20                    
  0105'   98                    	DEFB 98H
  0106'   20 31 39 38           	DEFM ' 1985'
  010A'   35                    
CRLFLFLFLF  010B'   0D 0A 0A 0A           	DEFB CR,LF,LF,LF,LF,LF,LF,LF,LF,LF,LF,LF,LF,0
LFLFLFLF  010F'   0A 0A 0A 0A           
LFLFLFLF  0113'   0A 0A 0A 0A           
  0117'   0A 00                 
ENDMSG  0119'                         ENDMSG	EQU  $
                                
CCP$MSGCRLFCRLF  0119'   0D 0A 0D 0A           CCP$MSG:DEFB CR,LF,CR,LF
  011D'   42 49 4F 53           	DEFM 'BIOS Err on C: No CCP.COM file'
  0121'   20 45 72 72           
  0125'   20 6F 6E 20           
  0129'   43 3A 20 4E           
  012D'   6F 20 43 43           
  0131'   50 2E 43 4F           
  0135'   4D 20 66 69           
  0139'   6C 65                 
  013B'   00                    	DEFB 0
                                
CCP$FCB  013C'   03                    CCP$FCB:DEFB 3
  013D'   43 43 50 20           	DEFM 'CCP     COM'
'BOOT LOADER MODULE FOR CP/M 3.0'	MACRO-80 3.44	09-Dec-81	PAGE	1-5


  0141'   20 20 20 20           
  0145'   43 4F 4D              
                                	REPT 20
                                	DEFB 0
                                	ENDM
  0148'   00              +     	DEFB 0
  0149'   00              +     	DEFB 0
  014A'   00              +     	DEFB 0
  014B'   00              +     	DEFB 0
  014C'   00              +     	DEFB 0
  014D'   00              +     	DEFB 0
  014E'   00              +     	DEFB 0
  014F'   00              +     	DEFB 0
  0150'   00              +     	DEFB 0
  0151'   00              +     	DEFB 0
  0152'   00              +     	DEFB 0
  0153'   00              +     	DEFB 0
  0154'   00              +     	DEFB 0
  0155'   00              +     	DEFB 0
  0156'   00              +     	DEFB 0
  0157'   00              +     	DEFB 0
  0158'   00              +     	DEFB 0
  0159'   00              +     	DEFB 0
  015A'   00              +     	DEFB 0
  015B'   00              +     	DEFB 0
                                
FCB$NR  015C'   00 00 00              FCB$NR:	DEFB 0,0,0
                                
                                	END
'BOOT LOADER MODULE FOR CP/M 3.0'	MACRO-80 3.44	09-Dec-81	PAGE	S


Macros:

Symbols:
0048*	?CONIN          0000I"	?INIT           0000I'	?LDCCP          
0045*	?PMSG           004CI'	?RLCCP          0068I'	?TIME           
0082*	?USERF          0013*	@AIVEC          0016*	@AOVEC          
0004*	@CIVEC          0007*	@COVEC          0075*	@DATE           
0078*	@HOUR           000D*	@LOVEC          007C*	@MIN            
0005 	BDOS            0007 	BEL             013C'	CCP$FCB         
0119'	CCP$MSG         000D 	CR              0119'	ENDMSG          
001B 	ESC             015C'	FCB$NR          0081'	GET$TIM         
002D'	LDLOOP          000A 	LF              0041'	NO$CCP          
0087'	OPEN            0096'	READ            0054'	RLLOOP          
001E 	RS              0074'	SET$TIM         008C'	SETDMA          
0091'	SETMULTI        009B'	SIGNON$MSG      001A 	SUB             



No Fatal error(s)

 
   
0005 	BDOS            0007 	BEL             013C'	CC                  	END
'BOOT LOADER MODULE FOR CP/M 3.0'	MACRO-80 3.44	09-Dec-81	PAGE	S


Macros:

Symbols:
0048*	?CONIN          0000I"	?INIT           0000I'	?LDCCP          
0045*	?PMSG           004CI'	?RLCCP          0068I'	?TIME           
0082*	?USERF          0013*	@AIVEC          0016*	@AOVEC          
0004*	@CIVEC          0007*	@COVEC          0075*	@DATE     
  00D0"   2C 20 53 2D           	DEFM ', S-'
  00D4"   00                    	DEFB 0
                                
                                
@ADRV  00D5"                         @ADRV:	DEFS 1			;currently selected disk drive
@RDRV  00D6"                         @RDRV:	DEFS 1			;controller relative disk drive
@TRK  00D7"                         @TRK:	DEFS 2			;current track number
@SECT  00D9"                         @SECT:	DEFS 2			;current sector number
@DMA  00DB"                         @DMA:	DEFS 2			;current DMA address
@DBNK  00DD"   00                    @DBNK:	DEFB 0			;bank for DMA operations
                                
  00DE"                         	CSEG			;common memory
                                
@CBNK  0225'   00                    @CBNK:	DEFB 0			;bank for processor operations
                                
                                	END
'ROOT MODULE OF RELOCATABLE BIOS FOR CP/M 3.0'	MACRO-80 3.44	09-Dec-81	PAGE	S


Macro'CHARACTER I/O HANDLER FOR Z80 CHIP BASED SYSTEMS'	MACRO-80 3.44	09-Dec-81	PAGE	1


                                ;******************************************************************************
                                ;*  C H A R I O  *  C P M S Y S 4 c  *  T h o m a s   H o l t e * 8 5 0 7 1 7 *
                                ;******************************************************************************
                                ;*									      *
                                ;*    C H A R A C T E R   I / O   H A N D L E R   F O R   Z 8 0   C H I P     *
                                ;*    ===================================================================     *
                                ;*									      *
                                ;*  	       		    B A S E D   S Y S T E M			      *
                                ;*	                    =======================              	      *
                                ;*									      *
                                ;*									      *
                                ;*  Thomas Holte						 Version 1.0  *
                                ;*									      *
                                ;******************************************************************************
                                
                                	.Z80
                                
                                	TITLE 'CHARACTER I/O HANDLER FOR Z80 CHIP BASED SYSTEMS'
                                
                                ;Character I/O for the modular CP/M 3 BIOS
                                
                                ;ASCII control code
SUB  001A                          SUB	EQU  1AH		;substitute
                                
                         C      	INCLUDE MODEBAUD	;define mode bits and baud equates
                         C      ;******************************************************************************
                         C      ;*  M O D E B A U D * C P M S Y S 4 g * T h o m a s   H o l t e * 8 4 1 0 0 5 *
                         C      ;******************************************************************************
                         C      ;*									      *
                         C      ;*  	E Q U A T E S   F O R   M O D E   B Y T E   B I T   F I E L D S       *
                         C      ;*      ===============================================================       *
                         C      ;*									      *
                         C      ;*									      *
                         C      ;*  Thomas Holte						 Version 1.0  *
                         C      ;*									      *
                         C      ;******************************************************************************
                         C      
MB$INPUT  0001                   C      MB$INPUT     EQU 00000001B	;device may do input
MB$OUTPUT  0002                   C      MB$OUTPUT    EQU 00000010B	;device may do output
MB$IN$OUTMB$INPUTMB$OUTPUT  0003                   C      MB$IN$OUT    EQU MB$INPUT+MB$OUTPUT
MB$SOFT$BAUD  0004                   C      MB$SOFT$BAUD EQU 00000100B	;software selectable baud rates
MB$SERIAL  0008                   C      MB$SERIAL    EQU 00001000B	;device may use protocol
MB$XON$XOFF  0010                   C      MB$XON$XOFF  EQU 00010000B	;XON/XOFF protocol enabled
                         C      
BAUDNONE  0000                   C      BAUDNONE     EQU 0		;no baud rate associated with device
BAUD50  0001                   C      BAUD50       EQU 1		;50 baud
BAUD75  0002                   C      BAUD75       EQU 2		;75 baud
BAUD110  0003                   C      BAUD110      EQU 3		;110 baud
BAUD134  0004                   C      BAUD134      EQU 4		;134.5 baud
BAUD150  0005                   C      BAUD150      EQU 5		;150 baud
BAUD300  0006                   C      BAUD300      EQU 6		;300 baud
BAUD600  0007                   C      BAUD600      EQU 7		;600 baud
BAUD1200  0008                   C      BAUD1200     EQU 8		;1200 baud
BAUD1800  0009                   C      BAUD1800     EQU 9		;1800 baud
BAUD2400  000A                   C      BAUD2400     EQU 10		;2400 baud
BAUD3600  000B                   C      BAUD3600     EQU 11		;3600 baud
BAUD4800'CHARACTER I/O HANDLER FOR Z80 CHIP BASED SYSTEMS'	MACRO-80 3.44	09-Dec-81	PAGE	1-1


  000C                   C      BAUD4800     EQU 12		;4800 baud
BAUD7200  000D                   C      BAUD7200     EQU 13		;7200 baud
BAUD9600  000E                   C      BAUD9600     EQU 14		;9600 baud
BAUD19200  000F                   C      BAUD19200    EQU 15		;19.2k baud
                                
?CINIT?CI?CO?CIST?COST@CTBL                                	GLOBAL ?CINIT,?CI,?CO,?CIST,?COST,@CTBL
?USERF                                	EXTERNAL ?USERF
                                
MAX$DEVICES  0005                          MAX$DEVICES EQU 5
                                
                                
  0000'                         	CSEG
                                
?CINIT  0000'   79                    ?CINIT: LD   A,C		
MAX$DEVICES  0001'   FE 05                 	CP   MAX$DEVICES
  0003'   D0                    	RET  NC			;illegal device
  0004'   D6 02                         SUB  2          	;RS232C interface ?
  0006'   D8                    	RET  C 			;no initializing
  0007'   C8                    	RET  Z
  0008'   3D                    	DEC  A
  0009'   47                    	LD   B,A		;number of RS232C interface --> reg. B
  000A'   69                    	LD   L,C		;make 16 bits from device number
  000B'   26 00                 	LD   H,0
  000D'   29                    	ADD  HL,HL		;* 8
  000E'   29                    	ADD  HL,HL
  000F'   29                    	ADD  HL,HL
@CTBL  0010'   11 00BE'              	LD   DE,@CTBL+7		;get baud rate
  0013'   19                    	ADD  HL,DE
  0014'   6E                    	LD   L,(HL)
  0015'   26 00                 	LD   H,0		;get baud rate	
SPEED$TABLE  0017'   11 00E0'                      LD   DE,SPEED$TABLE     ;point to counter entry
  001A'   19                            ADD  HL,DE
  001B'   5E                            LD   E,(HL)             ;get baud rate factor
  001C'   3E C4                 	LD   A,11000100B        ;load data format
  001E'   0E 01                 	LD   C,1       		;function # --> reg. C
?USERF  0020'   C3 0000*                      JP   ?USERF		;init RS232C interface and return to caller
                                
                                ;character input
?CI  0023'   78                    ?CI:	LD   A,B
  0024'   B7                    	OR   A
CON$IN  0025'   28 16                 	JR   Z,CON$IN		;jump to console input
  0027'   3D                    	DEC  A
NULL$INPUT  0028'   28 18                 	JR   Z,NULL$INPUT	;can't read from centronics
  002A'   3D                    	DEC  A
NULL$INPUT  002B'   28 15                 	JR   Z,NULL$INPUT      	;can't read from centronics
  002D'   3D                    	DEC  A
RS$1IN  002E'   20 03                 	JR   NZ,RS$1IN
  0030'   47                    	LD   B,A		;RS232C interface 0
TTY$IN  0031'   18 05                 	JR   TTY$IN 
RS$1IN  0033'   3D                    RS$1IN:	DEC  A
NULL$INPUT  0034'   20 0C                 	JR   NZ,NULL$INPUT
  0036'   06 01                 	LD   B,1		;RS232C interface 1
TTY$IN  0038'   0E 08                 TTY$IN:	LD   C,8		;function # --> reg. C
?USERF  003A'   C3 0000*              	JP   ?USERF		;receive char from RS232C interface 
CON$IN  003D'   0E 03                 CON$IN: LD   C,3                ;function # --> reg. C
?USERF  003F'   C3 0000*              	JP   ?USERF           	;wait for keyboard character
'CHARACTER I/O HANDLER FOR Z80 CHIP BASED SYSTEMS'	MACRO-80 3.44	09-Dec-81	PAGE	1-2


                                
NULL$INPUT  0042'                         NULL$INPUT:
SUB  0042'   3E 1A                 	LD   A,SUB		;return a CTL-Z for no device
  0044'   C9                    	RET
                                
                                
                                ;character input status
?CIST  0045'   78                    ?CIST:  LD   A,B
  0046'   B7                    	OR   A
CON$ST  0047'   28 15                 	JR   Z,CON$ST		;jump to console input status
  0049'   3D                            DEC  A
NULL$STATUS  004A'   28 1C                 	JR   Z,NULL$STATUS      ;can't read from centronics
  004C'   3D                    	DEC  A
NULL$STATUS  004D'   28 19                 	JR   Z,NULL$STATUS      ;can't read from centronics
  004F'   3D                    	DEC  A
RS$1IST  0050'   20 03                 	JR   NZ,RS$1IST
  0052'   47                    	LD   B,A		;RS232C interface 0
TTY$IST  0053'   18 05                 	JR   TTY$IST
RS$1IST  0055'   3D                    RS$1IST:DEC  A
NULL$STATUS  0056'   20 10                 	JR   NZ,NULL$STATUS
  0058'   06 01                 	LD   B,1		;RS232C interface 1
TTY$IST  005A'   0E 07                 TTY$IST:LD   C,7		;function # --> reg. C
CON$ST  005C'   18 02                 	JR   CON$ST+2
CON$ST  005E'   0E 02                 CON$ST:	LD   C,2		;function # --> reg. C
?USERF  0060'   CD 0000*                      CALL ?USERF		;check input status
  0063'   B7                    	OR   A			;char ready
  0064'   C8                    	RET  Z
STAT$OK  0065'   3E FF                 STAT$OK:LD   A,0FFH
  0067'   C9                    	RET
                                
NULL$STATUS  0068'                         NULL$STATUS:
  0068'   AF                            XOR  A
  0069'   C9                    	RET
                                
                                
                                ;character output
?CO  006A'   78                    ?CO:	LD   A,B
  006B'   B7                            OR   A
  006C'   79                            LD   A,C		;char --> accu
CON$OUT  006D'   28 14                 	JR   Z,CON$OUT		;jump to console output
  006F'   05                            DEC  B
LST$OUT  0070'   28 16                 	JR   Z,LST$OUT 		;parallel printer 0
  0072'   05                            DEC  B
RS$0OUT  0073'   20 03                 	JR   NZ,RS$0OUT
  0075'   04                    	INC  B			;parallel printer 1
LST$OUT  0076'   18 10                 	JR   LST$OUT
RS$0OUT  0078'   05                    RS$0OUT:DEC  B
TTY$OUT  0079'   28 03                 	JR   Z,TTY$OUT		;RS232C interface 0
  007B'   05                    	DEC  B
  007C'   C0                    	RET  NZ
  007D'   04                    	INC  B			;RS232C interface 1
TTY$OUT  007E'   0E 0A                 TTY$OUT:LD   C,10		;function # --> reg. C
?USERF  0080'   C3 0000*                     	JP   ?USERF             ;transmit char to RS232C interface
CON$OUT  0083'   0E 04                 CON$OUT:LD   C,4  		;function # --> reg. C
?USERF  0085'   C3 0000*                    	JP   ?USERF		;display char
LST$OUT  0088'   0E 06                 LST$OUT:LD   C,6                ;function # --> reg. C
?USERF'CHARACTER I/O HANDLER FOR Z80 CHIP BASED SYSTEMS'	MACRO-80 3.44	09-Dec-81	PAGE	1-3


  008A'   C3 0000*                    	JP   ?USERF		;output char to printer
                                
                                
                                ;character output status
?COST  008D'   78                    ?COST:  LD   A,B
  008E'   B7                            OR   A
STAT$OK  008F'   28 D4                         JR   Z,STAT$OK
  0091'   3D                            DEC  A
PR$1ST  0092'   20 03                         JR   NZ,PR$1ST		;jump to list status
  0094'   47                    	LD   B,A		;parallel printer 0
LST$ST  0095'   18 16                 	JR   LST$ST
PR$1ST  0097'   3D                    PR$1ST: DEC  A
RS$0OST  0098'   20 04                 	JR   NZ,RS$0OST
  009A'   06 01                 	LD   B,1		;parallel printer 1
LST$ST  009C'   18 0F                 	JR   LST$ST
RS$0OST  009E'   3D                    RS$0OST:DEC  A
RS$1OST  009F'   20 03                 	JR   NZ,RS$1OST
  00A1'   47                    	LD   B,A		;RS232C interface 0
TTY$OST  00A2'   18 05                 	JR   TTY$OST
RS$1OST  00A4'   3D                    RS$1OST:DEC  A
NULL$STATUS  00A5'   20 C1                 	JR   NZ,NULL$STATUS
  00A7'   06 01                 	LD   B,1		;RS232C interface 1
TTY$OST  00A9'   0E 09                 TTY$OST:LD   C,9		;function # --> reg. C
LST$ST  00AB'   18 02                        	JR   LST$ST+2
LST$ST  00AD'   0E 05                 LST$ST:	LD   C,5		;function # --> reg. C
?USERF  00AF'   CD 0000*                      CALL ?USERF		;check output status
  00B2'   B7                            OR   A			;ok ?
NULL$STATUS  00B3'   20 B3                         JR   NZ,NULL$STATUS
STAT$OK  00B5'   18 AE                 	JR   STAT$OK
                                
                                
                                $EJECT
'CHARACTER I/O HANDLER FOR Z80 CHIP BASED SYSTEMS'	MACRO-80 3.44	09-Dec-81	PAGE	1-4


                                
@CTBL  00B7'   43 52 54 20           @CTBL:  DEFM 'CRT   '		;device 0, CRT
  00BB'   20 20                 
MB$IN$OUT  00BD'   03                    	DEFB MB$IN$OUT
BAUDNONE  00BE'   00                            DEFB BAUDNONE
  00BF'   4C 50 54 31           	DEFM 'LPT1  '		;device 1, LPT1
  00C3'   20 20                 
MB$OUTPUT  00C5'   02                    	DEFB MB$OUTPUT
BAUDNONE  00C6'   00                    	DEFB BAUDNONE
  00C7'   4C 50 54 32           	DEFM 'LPT2  '		;device 2, LPT2
  00CB'   20 20                 
MB$OUTPUT  00CD'   02                    	DEFB MB$OUTPUT
BAUDNONE  00CE'   00                    	DEFB BAUDNONE
  00CF'   54 54 59 31                …‰РТTђ`cф4”д•Hэ&?COЃOРТTХ Sф4х5HQ	2P 5р –Ђ _АVѓXШdHж‘0 R)„mр dЬ& o  dј>bЂ,0  р·‡ўЂАфP€ dpАz Ђ аCђЂЂl:v >2Oq@Tz(E‘иЂGGў Ђ† @а6  -Щзы%^Й<-П"Ђ P€ `@А@
(ЃX @p)‡X@АFЃ v р·5ў 0€ Ђ``= ИбЂ(ф@Б AАђАfШ°ёЃfWКEA Ђ@ 
A€Ђ@ 
AђЂ@ 
…‘€Ђ@
…‘ђЂ@    <ЃЃ` 8   #¤`э&: ЏРТS’U#Ё э%MR:Ф ПРУг± э=MR3`ЏХTСT‘Ј¶аQ	2p  ћOq@Tz(E‘иЂGGў Ђ† @а6  -Щзы%^Й<-П"Ђ P€ `@А@
(ЃX @p)‡X@АFЃ v р·5ў 0€ Ђ``= ИбЂ(ф@Б AАђАfШ°ёЃf1C'   CD 0091'              	CALL SETMULTI
CCP$FCB  001F'   11 013C'              	LD   DE,CCP$FCB		;load the thing
READ  0022'   CD 0096'              	CALL READ		;now, copy CCP to secret bank for reloading
                                
                                ;move copy of CCP into secret bank:
  0025'   21 0100               	LD   HL,0100H		;source      address --> reg. HL
  0028'   11 3500               	LD   DE,3500H		;destination address --> reg. DE
  002B'   06 1E                      	LD   B,30		;record count        --> reg. B
LDLOOP  002D'   C5                    LDLOOP: PUSH BC			;save record count
  002E'   3E 10                 	LD   A,10H		;source      bank = 1
                                        			;destination bank = 0
  0030'   01 800F               	LD   BC,128 SHL 8+15	;byte count --> reg. B
                                	          		;function # --> reg. C
?USERF  0033'   CD 0000*              	CALL ?USERF		;move CCP record
  0036'   01 0080               	LD   BC,128		;record length --> reg. BC
  0039'   09                    	ADD  HL,BC		;bump source address
  003A'   EB                    	EX   DE,HL
  003B'   09                    	ADD  HL,BC		;bump destination address
  003C'   EB                    	EX   DE,HL
  003D'   C1                    	POP  BC			;restore record count
LDLOOP  003E'   10 ED                 	DJNZ LDLOOP		;move next record	
  0040'   C9                    	RET			;return to caller
                          DEFB 'TTY1  '		;device 3, TTY1
  00D3'   20 20                 
MB$IN$OUTMB$SERIALMB$SOFT$BAUD  00D5'   0F                    	DEFB MB$IN$OUT+MB$SERIAL+MB$SOFT$BAUD
BAUD1200  00D6'   08                    	DEFB BAUD1200
  00D7'   54 54 59 32                   DEFB 'TTY2  '		;device 4, TTY2
  00DB'   20 20                 
MB$IN$OUTMB$SERIALMB$SOFT$BAUD  00DD'   0F                    	DEFB MB$IN$OUT+MB$SERIAL+MB$SOFT$BAUD
BAUD9600  00DE'   0E                    	DEFB BAUD9600
  00DF'   00                    	DEFB 0			;table terminator
                                
SPEED$TABLE  00E0'                         SPEED$TABLE:
  00E0'   00 02 03 0F           	DEFB 0,2,3,15,4,14,13,6,11,10,7,0,9,0,8,0
  00E4'   04 0E 0D 06           
  00E8'   0B 0A 07 00           
  00EC'   09 00 08 00           
                                
                                	END
'CHARACTER I/O HANDLER FOR Z80 CHIP BASED SYSTEMS'	MACRO-80 3.44	09-Dec-81	PAGE	S


Macros:

Symbols:
0023I'	?CI             0000I'	?CINIT          0045I'	?CIST           
006AI'	?CO             008DI'	?COST           00B0*	?USERF          
00B7I'	@CTBL           0003 	BAUD110         0008 	BAUD1200        
0004 	BAUD134         0005 	BAUD150         0009 	BAUD1800        
000F 	BAUD19200       000A 	BAUD2400        0006 	BAUD300         
000B 	BAUD3600        000C 	BAUD4800        0001 	BAUD50          
0007 	BAUD600         000D 	BAUD7200        0002 	BAUD75          
000E 	BAUD9600        0000 	BAUDNONE        003D'	CON$IN          
0083'	CON$OUT         005E'	CON$ST          0088'	LST$OUT         
00AD'	LST$ST          0005 	MAX$DEVICES     0003 	MB$IN$OUT       
0001 	MB$INPUT        0002 	MB$OUTPUT       0008 	MB$SERIAL       
0004 	MB$SOFT$BAUD    0010 	MB$XON$XOFF     0042'	NULL$INPUT      
0068'	NULL$STATUS     0097'	PR$1ST          009E'	RS$0OST         
0078'	RS$0OUT         0033'	RS$1IN          0055'	RS$1IST         
00A4'	RS$1OST         00E0'	SPEED$TABLE     0065'	STAT$OK         
001A 	SUB             0038'	TTY$IN          005A'	TTY$IST         
00A9'	TTY$OST         007E'	TTY$OUT         



No Fatal error(s)

 
   0003 	MB$IN$OUT       
0001 	MB$INPUT        0002 	MB$OUTPUT       0008 	MB$SERIAL       
0004 	MB$SO 0009 	BAUD1800        
000F 	BAUD19200       000A 	BAUD2400        0006 	BAUD300         
000B 	BAUD3600        000C 	BAUD4800        0001 	BAUD50          
0007 	BAUD600         000D 	BAUD7200        0002 	BAUD75          
000E 	BAUD9600        0000        SET$TIM:LD   HL,(@DATE)		;date		       --> reg. HL
@HOUR  0077'   3A 0000*              	LD   A,(@HOUR)		;hours		       --> reg. D
  007A'   57                    	LD   D,A
@MIN  007B'   3A 0000*              	LD   A,(@MIN)		;minutes	       --> reg. E
  007E'   5F                    	LD   E,A
  007F'   0E 13                 	LD   C,19 		;function #	       --> reg. C
GET$TIM?USERF  0081'   CD 0000*              GET$TIM:CALL ?USERF		;set time & date and return to caller
  0084'   D1                    	POP  DE			;restore reg. HL & DE
  0085'   E1                    	POP  HL
  0086'   C9                    	RET
                                
                                
                                ;CP/M BDOS function interfaces
OPEN  0087'   0E 0F                 OPEN:	LD   C,15		;open file control block
BDOS  0089'   C3 0005               	JP   BDOS
SETDMA  008C'   0E 1A                 SETDMA:	LD   C,26		;set data transfer address
BDOS  008E'   C3 0005               	JP   BDOS
SETMULTI  0091'                         SETMULTI:
  0091'   0E 2C                 	LD   C,44		;set record count
BDOS  0093'   C3 0005               	JP   BDOS
READ  0096'   0E 14                 READ:	LD   C,20		;read records
BDOS  0098'   C3 0005               	JP   BDOS
                                	
                                
                                $EJECT
'BOOT LOADER MODULE FOR CP/M 3.0'	MACRO-80 3.44	09-Dec-81	PAGE	1-4


              'MOVE MODULE FOR CP/M3 LINKED BIOS'	MACRO-80 3.44	09-Dec-81	PAGE	1


                                ;******************************************************************************
                                ;*  M O V E  *  C P M S Y S 4 d  *  T h o m a s   H o l t e   *  8 5 0 7 1 7  *
                                ;******************************************************************************
                                ;*									      *
                                ;*     M O V E   M O D U L E   F O R   C P / M 3   L I N K E D   B I O S      *
                                ;*     =================================================================      *
                                ;*									      *
                                ;*									      *
                                ;*  Thomas Holte						 Version 1.0  *
                                ;*									      *
                                ;******************************************************************************
                                
                                	.Z80
                                
                                	TITLE 'MOVE MODULE FOR CP/M3 LINKED BIOS'
                                
?MOVE?XMOVE?BANK?USERF                                        GLOBAL ?MOVE,?XMOVE,?BANK,?USERF
                                
$SYS0  00F9                          $SYS0	EQU  0F9H		;system byte 0
$SYS1  00FA                          $SYS1 	EQU  0FAH		;system byte 1
                                
                                
  0000'                         	CSEG
                                
?XMOVE  0000'   3E FF                 ?XMOVE: LD   A,0FFH		;remark interbank move
IBANK  0002'   32 0010'              	LD   (IBANK),A
  0005'   79                    	LD   A,C		;source bank number --> accu
  0006'   87                    	ADD  A,A		;source bank number --> upper nibble
  0007'   87                    	ADD  A,A
  0008'   87                    	ADD  A,A
  0009'   87                    	ADD  A,A
  000A'   80                    	ADD  A,B		;destination bank number --> lower nibble
BANK  000B'   32 000F'              	LD   (BANK),A		;store bank numbers
  000E'   C9                    	RET
BANK  000F'                         BANK:	DEFS 1			;bank numbers
IBANK  0010'   00                    IBANK:	DEFB 0			;flag for interbank move
                                
                                
?MOVE  0011'   EB                    ?MOVE:	EX   DE,HL		;we are passed source in DE and dest in HL
IBANK  0012'   3A 0010'              	LD   A,(IBANK)		;interbank move ?
  0015'   B7                    	OR   A
NIBANK  0016'   28 13                 	JR   Z,NIBANK		;jump if not
  0018'   AF                    	XOR  A			;clear interbank move flag
IBANK  0019'   32 0010'              	LD   (IBANK),A
BANK  001C'   3A 000F'              	LD   A,(BANK)		;get source and destination bank number
  001F'   C5                    	PUSH BC			;save byte count
  0020'   41                    	LD   B,C		;byte count --> reg. B
  0021'   0E 0F                 	LD   C,15		;function # --> reg. C
?USERF  0023'   CD 0072'              	CALL ?USERF		;perform interbank move
  0026'   C1                    	POP  BC			;restore byte count	
  0027'   09                    	ADD  HL,BC		;calc new source address
  0028'   EB                    	EX   DE,HL
  0029'   09                    	ADD  HL,BC		;calc new destination address
  002A'   C9                    	RET
NIBANK  002B'   ED B0                 NIBANK:	LDIR			;use Z80 block move instruction
  002D'   EB                            EX   DE,HL              ;need next addresses in same regs
'MOVE MODULE FOR CP/M3 LINKED BIOS'	MACRO-80 3.44	09-Dec-81	PAGE	1-1


  002E'   C9                            RET
                                
                                
?BANK  002F'   C5                    ?BANK:	PUSH BC			;save reg. BC
  0030'   0F                          	RRCA			;bank number --> highest two bits
  0031'   0F                    	RRCA
  0032'   E6 C0                 	AND  0C0H
  0034'   F6 01                 	OR   1
  0036'   4F                    	LD   C,A		;bank number --> reg. C
$SYS0  0037'   DB F9                 	IN   A,($SYS0)		;read system byte 0
  0039'   E6 3D                 	AND  00111101B		;disable character RAM
  003B'   B1                    	OR   C			;set bank number
$SYS0  003C'   D3 F9                        	OUT  ($SYS0),A		;write system byte 0
  003E'   C1                    	POP  BC			;restore reg. BC
  003F'   C9                    	RET
                                
                                ;table of driver entry vectors:
$VDINIT  0000                          $VDINIT	EQU  0    		;initialize the video controller chip M6845
$RSINIT  0001                          $RSINIT	EQU  1    		;initialize the RS-232-C interface
$KBCHAR  0002                          $KBCHAR	EQU  2    		;get a keyboard character if available
$KBWAIT  0003                          $KBWAIT	EQU  3     		;wait for a keyboard character
$VDCHAR  0004                          $VDCHAR	EQU  4    		;display a character
$PRSTAT  0005                          $PRSTAT	EQU  5    		;test printer status
$PRCHAR  0006                          $PRCHAR	EQU  6    		;output a character to the printer
$RSRCST  0007                          $RSRCST	EQU  7    		;get a character from the RS-232-C interface if
                                				;available
$RSRCV  0008                          $RSRCV	EQU  8    		;receive a character from the RS-232-C
                                				;interface
$RSTXST  0009                          $RSTXST	EQU  9    		;test the RS-232-C output status
$RSTX  000A                          $RSTX	EQU  10    		;transmit a character to the RS-232-C interface
$READ  000B                          $READ	EQU  11   		;read a disk sector
$WRITE  000C                          $WRITE	EQU  12   		;write a disk sector
$GETTIM  000D                          $GETTIM	EQU  13   		;get time and date in binary format
$SETTIM  000E                          $SETTIM	EQU  14   		;set time and date in binary format
$XMOVE  000F                          $XMOVE	EQU  15			;interbank move
$GTIME3  0012                          $GTIME3	EQU  18			;get time and date in CP/M 3 format
$STIME3  0013                          $STIME3	EQU  19			;set time and date in CP/M 3 format
$LDCHAR  0014                          $LDCHAR EQU  20			;load bit pattern for user definable char
$RSTCHR  0015                          $RSTCHR	EQU  21			;restore original character set
$SCRNIO  0016                          $SCRNIO	EQU  22			;direct screen I/O
$INIT  0017                          $INIT	EQU  23			;general initialization routine
$CLOCK  0018                          $CLOCK	EQU  24			;clock/display on/off
                                
                                
                                ;call ROM driver routines:
  0040'                         	DEFS 50			;space for temporary stack
?USERFSAVESP  0072'   ED 73 00AA'           ?USERF:	LD   (SAVESP),SP	;save stack pointer
?USERF  0076'   31 0072'              	LD   SP,?USERF  	;temporary stack --> stack pointer
  0079'   C5                            PUSH BC			;save register set
  007A'   D5                    	PUSH DE
  007B'   E5                    	PUSH HL
  007C'   DD E5                 	PUSH IX
  007E'   FD E5                 	PUSH IY
  0080'   F5                    	PUSH AF    		;save accu
$SYS0  0081'   DB F9                 	IN   A,($SYS0)		;read system byte 0
PORT  0083'   32 00AC'              	LD   (PORT),A		;remember port data
'MOVE MODULE FOR CP/M3 LINKED BIOS'	MACRO-80 3.44	09-Dec-81	PAGE	1-2


  0086'   E6 3D                 	AND  00111101B		;enable bank 0
                                				;disable character RAM
  0088'   F6 01                 	OR   00000001B		;enable common memory
$SYS0  008A'   D3 F9                 	OUT  ($SYS0),A		;write system byte 0
  008C'   F1                    	POP  AF    		;restore accu
  008D'   C7                           	RST  0     		;call driver routine
  008E'   FB                     	EI			;enable interrupts
  008F'   F5                    	PUSH AF    		;save accu
PORT  0090'   3A 00AC'              	LD   A,(PORT)		;select current CPU bank
$SYS0  0093'   D3 F9                 	OUT  ($SYS0),A
$SYS1  0095'   DB FA                 	IN   A,($SYS1)		;read system byte 1
  0097'   E6 D7                 	AND  11010111B		;disable graphic page
  0099'   F6 45                 	OR   01000101B		;disable memory mapped I/O
                                				;disable boot EPROM
                                				;7.2 MHz clock frequency
$SYS1  009B'   D3 FA                 	OUT  ($SYS1),A		;write system byte 1
  009D'   F1                    	POP  AF    		;restore accu
  009E'   FD E1                 	POP  IY			;restore register set
  00A0'   DD E1                 	POP  IX
  00A2'   E1                    	POP  HL
  00A3'   D1                    	POP  DE
  00A4'   C1                    	POP  BC
SAVESP  00A5'   ED 7B 00AA'           	LD   SP,(SAVESP)	;restore stack pointer
  00A9'   C9                    	RET			;return to caller
                                
SAVESP  00AA'                         SAVESP: DEFS 2			;temporary memory for stack pointer
PORT  00AC'                         PORT:	DEFS 1			;temporary memory for system byte 0
                                
                                	END
'MOVE MODULE FOR CP/M3 LINKED BIOS'	MACRO-80 3.44	09-Dec-81	PAGE	S


Macros:

Symbols:
0018 	$CLOCK          000D 	$GETTIM         0012 	$GTIME3         
0017 	$INIT           0002 	$KBCHAR         0003 	$KBWAIT         
0014 	$LDCHAR         0006 	$PRCHAR         0005 	$PRSTAT         
000B 	$READ           0001 	$RSINIT         0007 	$RSRCST         
0008 	$RSRCV          0015 	$RSTCHR         000A 	$RSTX           
0009 	$RSTXST         0016 	$SCRNIO         000E 	$SETTIM         
0013 	$STIME3         00F9 	$SYS0           00FA 	$SYS1           
0004 	$VDCHAR         0000 	$VDINIT         000C 	$WRITE          
000F 	$XMOVE          002FI'	?BANK           0011I'	?MOVE           
0072I'	?USERF          0000I'	?XMOVE          000F'	BANK            
0010'	IBANK           002B'	NIBANK          00AC'	PORT            
00AA'	SAVESP          



No Fatal error(s)

 
015 	$RSTCHR                          C      ;*									      *
                         C      ;*  Thomas Holte						 Version 1.0  *
                         C      ;*									      *
                         C      ;******************************************************************************
                         C      
MB$INPUT  0001                   C      MB$INPUT     EQU 00000001B	;device may do input
MB$OUTPUT  0002                   C      MB$OUTPUT    EQU 00000010B	;device may do output
MB$IN$OUTMB$INPUTMB$OUTPUT  0003                   C      MB$IN$OUT    EQU MB$INPUT+MB$OUTPUT
MB$SOFT$BAUD  0004                   C      MB$SOFT$BAUD EQU 00000100B	;software selectable baud rates
MB$SERIAL  0008                   C      MB$SERIAL    EQU 00001000B	;device may use protocol
MB$XON$XOFF  0010                   C      MB$XON$XOFF  EQU 00010000B	;XON/XOFF protocol enabled
                         C      
BAUDNONE  0000                   C      BAUDNONE     EQU 0		;no baud rate associated with device
BAUD50  0001                   C      BAUD50       EQU 1		;50 baud
BAUD75  0002                   C      BAUD75       EQU 2		;75 baud
BAUD110  0003                   C      BAUD110      EQU 3		;110 baud
BAUD134  0004                   C      BAUD134      EQU 4		;134.5 baud
BAUD150  0005                   C      BAUD150      EQU 5		;150 baud
BAUD300  0006                   C      BAUD300      EQU 6		;300 baud
BAUD600  0007                   C      BAUD600      EQU 7…IУSХ‘`SфФхdXэa5=Y?BANKЃЏХTСT‘Ґ  ZР	h  щю2ў ”:‡@Ёx&Z   uЋЁЂЬPWЊЁЂ к‡Ђ1H а{6№ 0A.°K%Ъ°uІX р{™Ђц “Ыo—0хbУ|°Y2Ч iОХ kђЄеn№_®W«mт2µЂaлШУ|јXп·ЁкЦ 4Я-·У™®ц"ґЯOл…єбpґX.УЭЄ dЛk %µ Тр
~„‚њ— §й©кИ±Ч ~Є¦Љ¤Ќ  Зл	©кИіЂ  ћ ИбЂ(ф@Б AАђАfШ°ёЃfTIME3         
0017 	$INIT           0002 	$KBCHAR         0003 	$KBWAIT         
0014 	$LDCHAR         0006 	$PRCHAR         0005 	$PRSTAT         
000B 	$READ           0001 	$RSINIT         0007 	$RSRCST         
0008 	$RSRCV          0015 	$RSTCHR       BAUD7200     EQU 13		;7200 baud
BAUD9600  000E                   C      BAUD9600     EQU 14		;9600 baud
BAUD19200  000F                   C      BAUD19200    EQU 15		;19.2k baud
                                
?CINIT?CI?CO?CIST?COST@CTBL                                	GLOBAL ?CINIT,?CI,?CO,?CIST,?COST,@CTBL
?USERF                                	EXTERNAL ?USERF
                                
MAX$DEVICES  0005                          MAX$DEVICES EQU 5
                                
                                
  0000'                         	CSEG
                                
?CINIT  0000'   79                    ?CINIT: LD   A,C		
MAX$DEVICES  0001'   FE 05                 	CP   MAX$DEVICES
  0003'   D0                    	RET  NC			;illegal device
  0004'   D6 02                         SUB  2          	;RS232C interface ?
  0006'   D8                    	RET  C 			;no initializing
  0007'   C8                    	RET  Z
  0008'   3D                    	DEC  A
  0009'   47                    	LD   B,A		;number of RS232C interface --> reg. B
  000A'   69                    	LD   L,C		;make 16 bits from device number
  000B'   26 00                 	LD   H,0
  000D'   29                    	ADD  HL,HL		;* 8
  000E'   29                    	ADD  HL,HL
  000F'   29                    	ADD  HL,HL
@CTBL  0010'   11 00BE'              	LD   DE,@CTBL+7		;get baud rate
  0013'   19                    	ADD  HL,DE
  0014'   6E        	MACRO-80 3.44	09-Dec-81	PAGE	1


                                ;******************************************************************************
                                ;*  D R V T B L  *  C P M S Y S 4 e  *  T h o m a s   H o l t e * 8 5 0 9 2 5 *
                                ;******************************************************************************
                                ;*									      *
                                ;*  			     D R I V E   T A B L E			      *
                                ;*                           =====================                            *
                                ;*									      *
                                ;*									      *
                                ;*  Thomas Holte						 Version 1.0  *
                                ;*									      *
                                ;******************************************************************************
                                
                                	.Z80
                                
@DTBL                                	GLOBAL @DTBL
MF0MF1DS0DS1RAMDRIVEP                                        EXTERNAL MF0,MF1,DS0,DS1,RAM,DRIVEP
                                
                                
@DTBLMF0MF1DS0  0000'   0000* 0000*           @DTBL:	DEFW MF0,MF1,DS0,DS1,0,0,0,0
DS1  0004'   0000* 0000*           
  0008'   0000 0000             
  000C'   0000 0000             
  0010'   0000 0000             	DEFW 0,0,0,0,RAM,0,0,DRIVEP
RAM  0014'   0000 0000             
  0018'   0000* 0000            
DRIVEP  001C'   0000 0000*            
                                
                                	END
	MACRO-80 3.44	09-Dec-81	PAGE	S


Macros:

Symbols:
0000I'	@DTBL           001E*	DRIVEP          0004*	DS0             
0006*	DS1             0000*	MF0             0002*	MF1             
0018*	RAM             



No Fatal error(s)

 
      
  0010'   0000 0000          …‘••“ TED$Й@ ФЂ                                    : P“##АI%YB2 СМ# АLЖ2  УQЊ# @5Ж20 ФђSg   ћbУ|°Y2Ч iОХ kђAMDRIVEP                                        EXTERNAL MF0,MF1,DS0,DS1,RAM,DRIVEP
                                
                                
@DTBLMF0MF1DS0  0000'   0000* 0000*           @DTBL:	DEFW MF0,MF1,DS0,DS1,0,0,0,0
DS1  0004'   0000* 0000*           
  0008'   0000 0000             
  000C'   0000 0000             
  0010'   0000 0000          L$STATUS  004A'   28 1C                 	JR   Z,NULL$STATUS      ;can't read from centronics
  004C'   3D                    	DEC  A
NULL$STATUS  004D'   28 19                 	JR   Z,NULL$STATUS      ;can't read from centronics
  004F'   3D                    	DEC  A
RS$1IST  0050'   20 03                 	JR   NZ,RS$1IST
  0052'   47                    	LD   B,A		;RS232C interface 0
TTY$IST  0053'   18 05                 	JR   TTY$IST
RS$1IST  0055'   3D                    RS$1IST:DEC  A
NULL$STATUS  0056'   20 10                 	JR   NZ,NULL$STATUS
  0058'   06 01                 	LD   B,1		;RS232C interface 1
TTY$IST  005A'   0E 07                 TTY$IST:LD   C,7		;function # --> reg. C
CON$ST  005C'   18 02                 	JR   CON$ST+2
CON$ST  005E'   0E 02                 CON$ST:	LD   C,2		;function # --> reg. C
?USERF  0060'   CD 0000*                      CALL ?USERF		;check input status
  0063'   B7                    	OR   A			;char ready
  0064'   C8                    	RET  Z
STAT$OK  0065'   3E FF                 STAT$OK:LD   A,0FFH
  0067'   C9                    	RET
                                
NULL$STATUS  0068'                         NULL$STATUS:
  0068'   AF                            XOR  A
  0069'   C9                    	RET
                                
                                
                                ;character output
?CO  006A'   78                    ?CO:	LD   A,B
  006B'   B7                  'CP/M 3 DISKETTE HANDLER'	MACRO-80 3.44	09-Dec-81	PAGE	1


                                ;******************************************************************************
                                ;*  D I S K I O  *  C P M S Y S 4 f  *	T h o m a s   H o l t e * 8 5 0 9 2 5 *
                                ;******************************************************************************
                                ;*									      *
                                ;*			    D I S K   H A N D L E R			      *
                                ;*			    =======================			      *
                                ;*									      *
                                ;*									      *
                                ;*  Thomas Holte						 Version 1.0  *
                                ;*									      *
                                ;******************************************************************************
                                
                                ;------------------------------------------------------------------------------
                                ; Anmerkungen:
                                ;
                                ; Aus verschiedenen Versionen zusammengelegt und Ansteuerung f}r Hard-Disk
                                ; entfernt um Pseudo-Laufwerke zur Formatkonvertirung einzubinden. In den
                                ; Originaldateien  DISKIO.MAC, TABLES.MAC und DRIVER.MAC sind dir Werte f}r
                                ; das High-Density Format 'FRITZ' als Standartwerte einzutragen. Zur
                                ; Portabilitaet waere eine identische Formatdefinition von Vorteil. Beim HD
                                ; Format habe ich die Formatgr|~e durch Versuche festgelegt. Die Systemspur
                                ; beinhaltet auf/f}r meine CPU 280 eine Formatangabe, so da~ das Format auf
                                ; meinem anderen Rechner automatisch erkannt wird. Da nicht von High Density
                                ; gebootet wird k|nnte man die Systemspur auch entfallen lassen. (siehe vorher).
                                ;
                                ; Fritz Chwolka, Saarstr.34, 5173 Aldenhoven (02464)8920
                                ;
                                ; Hier m|chte ich mich noch f}r das Entgegenkommen des Herrn Holte bedanken,
                                ; welcher mir seine Originaldisketten zur Systemerstellung vertrauensvoll
                                ; zusandte, wobei ich anschlie~end das Systembios bei Herrn Holte erstandt.
                                ; Das BIOS darf unter beibehalten der COPYRIGHT - Meldung des Herrn HOLTE
                                ; weitergegeben werden.
                                ; Die Copyrechte der Firma Digital Research betreff dem CPM+ , hier speziell
                                ; der ???????.SPR Dateien ist von obigen Aussagen unbeeintr{chtigt. Sie
                                ; sollten auf jeden Fall eine Systemdiskette von Digital Research erworben
                                ; haben, um so als Lizensnehmer die SPR-Systemdateien der Firma Digital
                                ; Research zu nutzen.
                                ; Bei Problemen oder Fragen bin ich unter obiger Adresse immer erreichbar und
                                ; freue mich f}r jede Zuschrift.
                                ;
                                ; 1989 F.Chwolka
                                ;
                                ; Zus{tzlich rumgepfuscht hat Volker Dose. Zum einen um eine Harddisk
                                ; mit OMTI-Controller lesen zu k|nnen. 
                                ; Die Harddiskroutine f}r 10MByte Platte mit 2 K|pfen und 612 Cylindern
                                ; wird jetzt eingebunden. Die Routinen sind die BIOS Sources von
                                ; Helmut Bernhardt aus HD2.MAC. Der DPB wurde mit XCPM3.LIB aus 
                                ; HDDTBL.ASM errechnet.
                                ; Ausserdem soll die RAM-Floppy 770Kbyte Speicher bekommen, da bei mir
                                ; der Helmutsche 1MB-Umbau eingebaut ist. Daf}r war es notwendig die
                                ; XMOVE-Funktion in DRIVER.MAC zu {ndern.
                                ;
                                ; Au~erdem noch verschieden Kleinigkeiten in DRIVER.MAC
                                ;
                                ; Jetzt ist ein 8 Zoll Laufwerk als logisches Laufwerk E: eingetragen.
                                ; Format IBM 3740 Standard 77 Tr. SS SD
'CP/M 3 DISKETTE HANDLER'	MACRO-80 3.44	09-Dec-81	PAGE	1-1


                                ; Zur Zeit ist LW E: wieder raus.
                                ;
                                ; Die Benutzung des IX-Registers in den Routinen zum Lesen und Schreiben
                                ; vom/auf das logische Laufwerk P: vertr{gt sich nicht mit dem ZPM3, welchem
                                ; ich den Vorzug gebe. IX ist also durch IY vertauscht worden.
                                ; Das neueste ist jetzt die Aufteilung der HardDisk in zwei logische
                                ; Laufwerke C: und D:.					19.6.93
                                ;
                                ; Es ist jetzt eine Tandon Festplatte mit 20 MB Kapazit{t eingebaut, also
                                ; Einteilung in C: mit 7 MB und D: mit 14 MB.
                                ;							15.9.93
                                ; Auf Seagate ST 225 mit 2 Partitionen a 10.4 MB eingestellt.
                                ; Ramdisk auf 55K
                                ;							21.12.93
                                ;-----------------------------------------------------------------------------
                                
                                
SBANK  0003                          SBANK	equ	3	;Erste Bank, die von der RAMDisk benutzt wird
                                
                                	.Z80
                                
                                	TITLE 'CP/M 3 DISKETTE HANDLER'
                                
  0000'                         	DSEG
                                
                                ;Disk drive dispatching tables for linked BIOS
                                ;GLOBAL DS0,MF0,MF1,FD0,IBMPC,KDS,RAM,RAIR,ALPHAP3,DRIVEP
                                
MF0MF1DS0DS1RAMDRIVEP                                	GLOBAL	MF0,MF1,DS0,DS1,RAM,DRIVEP
                                
                                ;Variables containing parameters passed by BDOS
@DTBL@ADRV@RDRV@DMA@TRK@SECT@DBNK@CBNK                                	EXTERNAL @DTBL,@ADRV,@RDRV,@DMA,@TRK,@SECT,@DBNK,@CBNK
                                
                                ;System control block variables
@ERDME                                	EXTERNAL @ERDME		; BDOS error mode
                                
?PMSG                                	EXTERNAL ?PMSG		; Print message ^HL up to 0, saves reg. BC & DE
?PDERR                                	EXTERNAL ?PDERR		; Print BIOS disk error header
?CONIN?CONO                                	EXTERNAL ?CONIN,?CONO	; Con in and out
?CONST                                	EXTERNAL ?CONST		; Get console status
                                
?BANK?USERF                                	EXTERNAL ?BANK,?USERF
                                ;Harddiskroutinen aus HD2.MAC
                                
HDWRITHDREADHDLOGIHDINITHD1INI                                        external hdwrit,hdread,hdlogi,hdinit,hd1ini
                                
                                 
                                ;ASCII control codes:
SUB  001A                          SUB	EQU	1AH		; Substitute
ESC  001B                          ESC	EQU	1BH		; Escape
                                
                                
                                
                                ;**Extended Disk Parameter Headers (XDPHs)
                                
                                
'CP/M 3 DISKETTE HANDLER'	MACRO-80 3.44	09-Dec-81	PAGE	1-2


                                ;Double Density
FD$WRITE  0000"   0A50"                 	DEFW	FD$WRITE
FD$READ  0002"   09F4"                 	DEFW	FD$READ
FD$LOGIN  0004"   0AB2"                 	DEFW	FD$LOGIN
FD$INIT  0006"   0AB2"                 	DEFW	FD$INIT
  0008"   00                    	DEFB	0		; Relative drive zero
  0009"   00                    	DEFB	0		; Drive type
                                				; 0 = floppy disk
                                				; 1 = floppy disk (special format)
                                				; 2 = Winchester
                                				; 3 = Winchester (cartridge)
                                				; 4 = RAM disk
MF0  000A"   0000                  MF0:	DEFW	0		; No translation table
  000C"   0000 0000             	DEFW	0,0,0,0		; BDOS scratch area
  0010"   0000 0000             
  0014"   00 00                 	DEFB	0,0		; Media flag
DPB01  0016"   0000'                 	DEFW	DPB01		; Disk parameter block
  0018"   FFFE FFFE             	DEFW	0FFFEH,0FFFEH	; CSV, ALV, DIRBCB, DTABCB, HASH
  001C"   FFFE FFFE             	DEFW	0FFFEH,0FFFEH	; Alloc'd by GENCPM
  0020"   FFFE                  	DEFW	0FFFEH
  0022"   00                    	DEFB	0		; Hash bank
                                
FD$WRITE  0023"   0A50"                 	DEFW	FD$WRITE
FD$READ  0025"   09F4"                 	DEFW	FD$READ
FD$LOGIN  0027"   0AB2"                 	DEFW	FD$LOGIN
FD$INIT  0029"   0AB2"                 	DEFW	FD$INIT
  002B"   01 00                 	DEFB	1,0		; Relative drive one
MF1  002D"   0000                  MF1:	DEFW	0		; No translation table
  002F"   0000 0000             	DEFW	0,0,0,0		; BDOS scratch area
  0033"   0000 0000             
  0037"   00 00                 	DEFB	0,0		; Media flag
DPB01  0039"   0000'                 	DEFW	DPB01		; Disk parameter block
  003B"   FFFE FFFE             	DEFW	0FFFEH,0FFFEH	; CSV, ALV, DIRBCB, DTABCB, HASH
  003F"   FFFE FFFE             	DEFW	0FFFEH,0FFFEH	; Alloc'd by GENCPM
  0043"   FFFE                  	DEFW	0FFFEH
  0045"   00                    	DEFB	0		; Hash bank
                                
                                ;8 Zoll Floppy Laufwerk
                                ;
                                ;	DEFW	FD$WRITE
                                ;	DEFW	FD$READ
                                ;	DEFW	FD$LOGIN
                                ;	DEFW	FD$INIT
                                ;	DEFB	4,0		; Relative drive four (first 8 inch)
                                ;FD0:	DEFW	XLT3		; translation table
                                ;	DEFW	0,0,0,0		; BDOS scratch area
                                ;	DEFB	0,0		; Media flag
                                ;	DEFW	DPB3		; Disk parameter block
                                ;	DEFW	0FFFEH,0FFFEH	; CSV, ALV, DIRBCB, DTABCB, HASH
                                ;	DEFW	0FFFEH,0FFFFH	; Alloc'd by GENCPM
                                ;	DEFW	0FFFEH
                                ;	DEFB	0		; Hash bank
                                
                                
                                
                                ;EJECT
'CP/M 3 DISKETTE HANDLER'	MACRO-80 3.44	09-Dec-81	PAGE	1-3


                                ;RAM disk:
                                ;--------:
M$WRITE  0046"   0AD2"                 	DEFW	M$WRITE
M$READ  0048"   0ACE"                 	DEFW	M$READ
FD$LOGIN  004A"   0AB2"                 	DEFW	FD$LOGIN
M$INIT0  004C"   09D1"                 	DEFW	M$INIT0
  004E"   00 04                 	DEFB	0,4
RAM  0050"   0000                  RAM:	DEFW	0		; No translation table
  0052"   0000 0000             	DEFW	0,0,0,0		; BDOS scratch area
  0056"   0000 0000             
  005A"   00 00                 	DEFB	0,0		; Media flag
DPBC  005C"   0011'                 	DEFW	DPBC		; Disk parameter block
  005E"   0000                  	DEFW	0		; No CSV
  0060"   FFFE FFFE             	DEFW	0FFFEH,0FFFEH	; ALV, DIRBCB alloc'd by GENCPM
  0064"   FFFF                  	DEFW	0FFFFH		; No data buffer
  0066"   FFFE                  	DEFW	0FFFEH		; HASH alloc'd by GENCPM
  0068"   00                    	DEFB	0		; Hash bank
                                
                                ;
                                ;XDPH f}r Harddisk Partition 1 C:
HDWRIT  0069"   0000*                 	DEFW	hdwrit
HDREAD  006B"   0000*                 	DEFW	hdread
FD$LOGIN  006D"   0AB2"                 	DEFW	FD$LOGIN
HDINIT  006F"   0000*                 	DEFW	hdinit
  0071"   00                    	DEFB	0		;relative Drive zero
  0072"   02                    	DEFB	2		;drive type
                                				; 0 : floppy disk
                                				; 1 : floppy disk (special format)
                                				; 2 : Winchester
                                				; 3 : Winchester (cartridge)
                                				; 4 : Ramdisk
DS0  0073"   0000                  DS0:	DEFW	0		;no translation table
  0075"   0000 0000             	DEFW	0,0,0,0		;BDOS scratch area
  0079"   0000 0000             
  007D"   00 00                 	DEFB	0,0		;media flag
DPBHD1  007F"   0033'                 	DEFW	DPBHD1		;disk parameter block
  0081"   0000                  	DEFW	0		;no CSV
  0083"   FFFE FFFE             	DEFW	0FFFEH,0FFFEH	;ALV, DIRBCB, DTABCB, HASH
  0087"   FFFE FFFE             	DEFW	0FFFEH,0FFFEH	;allocated by GENCPM
  008B"   00                    	DEFB	0		;hash bank
                                							
                                ;
                                ;XDPH f}r Harddisk Partition 2 D:
HDWRIT  008C"   0000*                 	DEFW	hdwrit
HDREAD  008E"   0000*                 	DEFW	hdread
FD$LOGIN  0090"   0AB2"                 	DEFW	FD$LOGIN
HDINIT  0092"   0000*                 	DEFW	hdinit
  0094"   01                    	DEFB	1		;relative Drive zero
  0095"   02                    	DEFB	2		;drive type
                                				; 0 : floppy disk
                                				; 1 : floppy disk (special format)
                                				; 2 : Winchester
                                				; 3 : Winchester (cartridge)
                                				; 4 : Ramdisk
DS1  0096"   0000                  DS1:	DEFW	0		;no translation table
  0098"   0000 0000             	DEFW	0,0,0,0		;BDOS scratch area
'CP/M 3 DISKETTE HANDLER'	MACRO-80 3.44	09-Dec-81	PAGE	1-4


  009C"   0000 0000             
  00A0"   00 00                 	DEFB	0,0		;media flag
DPBHD2  00A2"   0044'                 	DEFW	DPBHD2		;disk parameter block
  00A4"   0000                  	DEFW	0		;no CSV
  00A6"   FFFE FFFE             	DEFW	0FFFEH,0FFFEH	;ALV, DIRBCB, DTABCB, HASH
  00AA"   FFFE FFFE             	DEFW	0FFFEH,0FFFEH	;allocated by GENCPM
  00AE"   00                    	DEFB	0		;hash bank
                                							
                                
                                
                                
                                ;----------------------------------------------------------------
                                ; Formatdefinitionen:
                                ; F}r Sonderformate wird Drive B als relatives laufwerk genutzt.
                                ;----------------------------------------------------------------
                                
                                ;EJECT
                                ;virtual disk drive P:
                                ;--------------------:
P$WRITE  00AF"   0B0E"                 	DEFW	P$WRITE
P$READ  …IРФУ`4Фc5ЖDS0ЂСМ`5$ШI%YBP5U —  e ­и¬‚µђP                ья?ЯПчуэья e ­и¬‚µђP               ья?ЯПчуэья m ­њ¬‚¶€H              D   ?ЯПчыэья     І
                  ¦`  щююїџпзш4Ђf°d›А                ЁЂ  щююїџпзшаЂЅd¬‚Ђ ®            R ’Аux±?А P  @@0 A@°`4BA0 T,CA°аt<DB1 ”L'
EB±`ґ\/FC9rXєјYЂм ьєфhЂЂ  ь»0h‚Ђ  	v€,»D&Z  P а(~ p    _Ђ@`p Ь            Pш~ Ђ    ЃВ (|?Аoр    Ђa >‚џа7ш  ЂЂ@@9v€Hи:[ІВ Љ  Еj€wH Щ  „"  ]lhЃТЙrЛЅG@ t  З@ <t  2Дм±;,NЛ¬E@  8НЬБ#-љ·aaА¦Hи  
lР  UіB„Аh¤“BБ'бЮН  ;д1›ЌB™єМ(ћ!Б!¬ЬvyY[Р$|dЋ·ЁIuѕBKг­ъO`¦Xќ–'e‰Щbu€«…ЃЊЬ$2ЩЎKvx
dЋ°иPрP+fв0ЎVН
 ўђ_џ„fc{7"…wИc7H…3uQ<C‚CYє\(тю,ІІЂPлf…?ЂЈа xЙfЂ q@љ  ¬Эtх'і@ ‹ш‚Шs7Щ2маЎуь0WЊ°8Xл*…1Ђht:!ЛЎHg«ґ·љB…YD(FЉBР= :Абkq вЃАпW[Е››‚•м™p@[фCЅC Gи‡(µёћ‡@ЃЂс\ 	r„r@X
 v¬;HўХ Ѓ@ХЂ‡…№_®‘HhЂ@ jАCґАlfL№4/8…и0Ѕ,Є‚ц^ВЫA{И/†bPМn’ѓ2рfuТљ°3bn Б$Шl2™М&Бђдi;D1` @T9Lf± Њ@t7›ДѓIњР, 
fSРЮrДCyј@h4™НА Ђ€e;LfQёЮtNЖI°Вb6EЂ  Ђo1љМ¦AyђКl2ќ¦AИКc7њЊ‚А Ђ€a:D#)ЊЮr2Жу ЂМo:›Њ‚А Ђ a9N‡‘”дr7њ„C©ИТn3€FS	ђX з3 ЂИa:DC©ИТn3€FS	ђX M†Г)њВlF“±”@# C‘„ЖkДCyј@h4™НА Ђ¦e1ќз! Њ@t7›ДѓIњР, †S±¤ЖeЌзA„мa4›&#a”X ОF“Ў”@p9О†SРКd'3Y”иt2‹ №ИТt2€Ж©°и 7›„CIМЦ 2Ќ'c(°  "N†ИКc7њЊ‚qји 3О¦г °  (NF“Ўд@e9Ќз!ђкr4›Њв№ИТt2‹ aјжt'CЂИu9MЖqЬдi:EЂHКt9D‚Ијњ)Д  Рl€ Њ  Sф$дёХшV?CONINЌbSф4фдшХ V?CONSTЌ?…cхDU%(ХU?PMSGЌ…гхU4U$hА @ADRVЊ  T4$дёЧ U@DBNKЌsDDФА @DTBLЌ<…dU$DФXТИU@RDRVЌt…T4T5HЦёT@TRKЏ\ЂdE$•dUуDS0ЏK 4E3А HD1INIЌI d„D”д•HА HDLOGIЌG d„E$THФ`HDWRITЏ 4ФcсhMF1Џ( 5$ЩА  ћHКt9D‚Ијњ)Д  Рl€ Њ  Sф$дёХшV?CONINЌbSф4фдшХ V?CONSTЌ?…cхDU%(ХU?PMSGЌ…гхU4U$hА @ADRVЊ  T4$дёЧ U@DBNKЌsDDФА @DTB MODULE FOR CP/M3 LINKED BIOS'	MACRO-80 3.44	09-Dec-81	PAGE	1-2


  0086'   E6 3D                 	AND  00111101B		;enable bank 0
                                				;disable character RAM
  0088'   F6 01                 	OR   00000001B		;enable co00B1"   0B08"                 	DEFW	P$READ
FD$LOGIN  00B3"   0AB2"                 	DEFW	FD$LOGIN
FD$INIT  00B5"   0AB2"                 	DEFW	FD$INIT
  00B7"   01 01                 	DEFB	1,1		; Relative drive one
DRIVEPXLTF  00B9"   00D7"                 DRIVEP:	DEFW	XLTF       	; Translation table
  00BB"   0000 0000             	DEFW	0,0,0,0		; BDOS scratch area
  00BF"   0000 0000             
  00C3"   00 00                 	DEFB	0,0		; Media flag
DPBF  00C5"   0022'                 	DEFW	DPBF		; Disk parameter block
CSVFALVF  00C7"   010B" 014B"           	DEFW	CSVF,ALVF	; Checksumm vector, allocation vector
DIBCBHDTBCBH  00CB"   01AF" 01B1"           	DEFW	DIBCBH,DTBCBH	; BCB list header
  00CF"   FFFE                  	DEFW	0FFFEH		; No HASH
  00D1"   00                    	DEFB	0		; Hash bank
PDCT  00D2"   70                    PDCT:	DEFB	01110000B
  00D3"   C0                    	DEFB	11000000B
  00D4"   02 0A 50              	DEFB	2,10,80
                                
                                ;sector translation tables:
                                ;Drive E:
                                ;8" Drive 
                                ;XLT3:	defb	0,6,12,18,24,4,10,16,22,2,8,14,20
                                ;	defb	1,7,13,19,25,5,11,17,23,3,9,15,21
                                
                                
                                ; Drive P:
XLTF  00D7"   00 01 02 03           XLTF:	DEFB	0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16
  00DB"   04 05 06 07           
  00DF"   08 09 0A 0B           
  00E3"   0C 0D 0E 0F           
  00E7"   10                    
  00E8"   11 12 13 14           	DEFB	17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33
  00EC"   15 16 17 18           
  00F0"   19 1A 1B 1C           
  00F4"   1D 1E 1F 20           
  00F8"   21                    
  00F9"   22 23 24 25           	DEFB	34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51
'CP/M 3 DISKETTE HANDLER'	MACRO-80 3.44	09-Dec-81	PAGE	1-5


  00FD"   26 27 28 29           
  0101"   2A 2B 2C 2D           
  0105"   2E 2F 30 31           
  0109"   32 33                 
                                
                                
                                ;checksum vectors
CSVF  010B"                         CSVF:   DEFS    64
                                
                                  
                                ;allocation vectors:
ALVF  014B"                         ALVF:	DEFS	100
                                
                                ;BCB list header:
DIBCBHDIRBCB  01AF"   01B3"                 DIBCBH:	DEFW	DIRBCB
DTBCBHDTABCB  01B1"   01C2"                 DTBCBH:	DEFW	DTABCB
                                
                                ;directory control block:
DIRBCB  01B3"   FF                    DIRBCB:	DEFB	0FFH
  01B4"                         	DEFS	9
DIRBUF  01BD"   01D1"                 	DEFW	DIRBUF
  01BF"   00                    	DEFB	0
  01C0"   0000                  	DEFW	0
                                
                                ;data control block:
DTABCB  01C2"   FF                    DTABCB:	DEFB	0FFH
  01C3"                         	DEFS	9
DTABUF  01CC"   05D1"                 	DEFW	DTABUF
  01CE"   00                    	DEFB	0
  01CF"   0000                  	DEFW	0
                                
                                ;directory buffer:
DIRBUF  01D1"                         DIRBUF:	DEFS	1024
                                
                                ;data buffer:
DTABUF  05D1"                         DTABUF:	DEFS	1024
                                
                                
                                ;EJECT
  09D1"                         	CSEG			; DPB must be resident
                                
                                
                                ;Disk Parameter Blocks (DPB)
                                
                                ;Double Density Holte:
                                ;--------------------:
DPB01  0000'   0050                  DPB01:	DEFW	80		; 128 byte records per track
  0002'   04 0F                 	DEFB	4,15		; Block shift and mask
  0004'   00                    	DEFB	0		; Extent mask
  0005'   0185                  	DEFW	389		; Maximum block number
  0007'   00BF                  	DEFW	191		; Maximum directory entry number
  0009'   E0 00                 	DEFB	0E0H,0		; Alloc vector for directory
  000B'   0030                  	DEFW	48		; Checksum size
  000D'   0002                  	DEFW	2		; Offset for system tracks
  000F'   02 03                 	DEFB	2,3		; Physical sector size shift and mask
                                
'CP/M 3 DISKETTE HANDLER'	MACRO-80 3.44	09-Dec-81	PAGE	1-6


                                ;8 Zoll IBM 3740 SS SD:
                                ;---------------------:
                                ;DPB3:	DEFW	26		; 128 byte records per track
                                ;	DEFB	3,7		; Block shift and mask
                                ;	DEFB	0		; Extent mask
                                ;	DEFW	242		; Maximum block number
                                ;	DEFW	63		; Maximum directory entry number
                                ;	DEFB	0C0H,0		; Alloc vector for directory
                                ;	DEFW	16		; Checksum size
                                ;	DEFW	2		; Offset for system tracks
                                ;	DEFB	0,0		; Physical sector size shift and mask
                                
                                
                                ;RAMDISK:
                                ;-------:
DPBC  0011'   01BF                  DPBC:	DEFW	447		; 128 byte records per track
  0013'   03 07                 	DEFB	3,7		; Block shift and mask
  0015'   00                    	DEFB	0		; Extent mask
  0016'   0037                  	DEFW	55		; Maximum block number(385 bei 770k, 330 wenn
                                				; Bank 2 (bzw. bei 256k Memory 110/55 k)
                                				; als Data-Buffer benutzt wird )
  0018'   001F                  	DEFW	31		; Maximum directory entry number
  001A'   80 00                 	DEFB	080H,0		; Alloc vector for directory
  001C'   8000                  	DEFW	8000H		; Checksum size
  001E'   0000                  	DEFW	0		; Offset for system tracks
  0020'   00 00                 	DEFB	0,0		; Physical sector size shift and mask
                                
                                ;VIRTUELLES DRIVE -P-:
                                ;--------------------:
DPBF  0022'   0050                  DPBF:	DEFW	80		; 128 byte records per track
  0024'   05 1F                 	DEFB	5,31		; Block shift and mask
  0026'   03                    	DEFB	3		; Extent mask
  0027'   00BF                  	DEFW	191		; Maximum block number
  0029'   00FF                  	DEFW	255		; Maximum directory entry number
  002B'   C0 00                 	DEFB	192,0		; Alloc vector for directory
  002D'   0040                  	DEFW	64		; Checksumm size
  002F'   0003                  	DEFW	3		; Offset for system tracks
  0031'   03 07                 	DEFB	3,7		; Physical sector size shift and mask
                                
                                ;:---------------------------------:
                                ;:HARDISK 10MByte, Partition 1 C:  :
                                ;:---------------------------------:
                                ;:Seagate 21,4 MB Hartddisk        :
                                ;:---------------------------------:
                                
DPBHD1  0033'   10 01                 DPBHD1:	DEFB  	010H,001H   ;SPT= 136      128 Byte records/track
  0035'   05                    	DEFB	005H        ;BSH=   5      block shift factor  
  0036'   1F                            DEFB    01FH        ;BLM=  31      block mask   
  0037'   01                    	DEFB	001H        ;EXM=   1      extend mask  
  0038'   1F 0A                         DEFB    01FH,00AH   ;DSM=2591	   maximum block number 
  003A'   FF 03                 	DEFB	0FFH,003H   ;DRM=1024      maximum directory number
  003C'   FF                    	DEFB	0FFH        ;AL0= 255      allocation vector 0
  003D'   00                            DEFB    000H        ;AL1= 000      allocation vector 1
  003E'   00 80                 	DEFB	000H,080H   ;CKS=   0      checksum size is zero
                                                            ;              ,permanently mounted
  0040'   02 00                 	DEFB	002H,000H   ;OFF=   2      reserved tracks 
'CP/M 3 DISKETTE HANDLER'	MACRO-80 3.44	09-Dec-81	PAGE	1-7


  0042'   02                     	DEFB	002H        ;PSH=   2      physical sector shift
  0043'   03                    	DEFB	003H        ;PHM=   3      physical record mask 
                                
                                ;das hei~t auf Deutsch:
                                ;			512 Bytes/Sector
                                ;			 68 Sectoren/Zylinder (2 K|pfe*17 Sec/Cyl)
                                ;			615 Cylinder/Laufwerk
                                ;			4KB Blockgr|~e
                                ;		       2048 Directory Eintr{ge
                                ;			  2 Reservierte Systemspur
                                ;		      8000h Flag f}r nonremovable medium 			
                                
                                ;:------------------------------------:
                                ;:HARDISK 10MByte Partition 2 D:      :
                                ;:------------------------------------:
DPBHD2  0044'   10 01                 DPBHD2:	DEFB  	010H,001H   ;SPT= 136      128 Byte records/track
  0046'   05                    	DEFB	005H        ;BSH=   5      block shift factor  
  0047'   1F                            DEFB    01FH        ;BLM=  31      block mask   
  0048'   01                    	DEFB	001H        ;EXM=   1      extend mask  
  0049'   39 0A                         DEFB    039H,00AH   ;DSM=2617      maximum block number 
  004B'   FF 03                 	DEFB	0FFH,003H   ;DRM=1024      maximum directory number
  004D'   FF                    	DEFB	0FFH        ;AL0= 255      allocation vector 0
  004E'   00                            DEFB    000H        ;AL1= 000      allocation vector 1
  004F'   00 80                 	DEFB	000H,080H   ;CKS=   0      checksum size is zero
                                                            ;              ,permanently mounted
  0051'   33 01                 	DEFB	033H,001H   ;OFF= 307      reserved tracks 
  0053'   02                     	DEFB	002H        ;PSH=   2      physical sector shift
  0054'   03                    	DEFB	003H        ;PHM=   3      physical record mask 
                                
                                ;das hei~t auf Deutsch:
                                ;			512 Bytes/Sector
                                ;			 68 Sectoren/Zylinder (2 K|pfe*17 Sec/Cyl)
                                ;			615 Cylinder/Laufwerk
                                ;			4KB Blockgr|~e
                                ;		       2048 Directory Eintr{ge
                                ;			307 Reservierte Systemspuren
                                ;		      8000h Flag f}r nonremovable medium 			
                                
                                
                                	
                                
  0055'                                   DSEG
                                
                                ;EJECT
                                ;RAM disk init routine:
                                ;---------------------:
POWUP  111D                          POWUP	EQU	111DH		; Power up/reset marker
                                
M$INIT0POWUP  09D1"   3A 111D               M$INIT0:LD	A,(POWUP)	; Power up ?
  09D4"   B7                    	OR	A
  09D5"   C8                    	RET	Z
                                
                                ;clear RAM disk:
                                ;modfied for 256k ram
                                ;
  09D6"   0E 20                 	LD	C,32		; Entry count		 --> reg. C
'CP/M 3 DISKETTE HANDLER'	MACRO-80 3.44	09-Dec-81	PAGE	1-8


  09D8"   11 0080               	LD	DE,128		; ^first directory entry --> reg. DE
CLRNXT  09DB"   C5                    CLRNXT:	PUSH	BC		; Save remaining entry count
  09DC"   D5                    	PUSH	DE		; Save ^directory entry
CLRBYT  09DD"   21 09F3"              	LD	HL,CLRBYT	; ^E5		   --> reg. HL
  09E0"   01 010F               	LD	BC,1 SHL 8+15	; Byte count	   --> reg. B
                                				; Function #	   --> reg. C
SBANK  09E3"   3E 03                 	LD	A,SBANK		; Source      bank # = 0
                                				; Destination bank # = 2
?USERF  09E5"   CD 0000*              	CALL	?USERF		; Clear current entry
  09E8"   E1                    	POP	HL		; ^current directory entry --> reg. HL
  09E9"   11 0020               	LD	DE,32		; Offset to next entry	   --> reg. DE
  09EC"   19                    	ADD	HL,DE		; Add offset
  09ED"   EB                    	EX	DE,HL		; ^next directory entry    --> reg. DE
  09EE"   C1                    	POP	BC		; Restore entry count
  09EF"   0D                    	DEC	C		; Decrement it
CLRNXT  09F0"   20 E9                 	JR	NZ,CLRNXT	; Clear next entry
  09F2"   C9                    	RET
CLRBYT  09F3"   E5                    CLRBYT:	DEFB	0E5H
                                          
                                
                                
                                ;EJECT
                                
  09F4"                                   DSEG
                                
                                
                                ;EJECT
                                ;disk read routine:
FD$READ@SECT  09F4"   3A 0000*              FD$READ:LD	A,(@SECT)	; Sector number 	--> reg. B
  09F7"   47                    	LD	B,A
@TRK  09F8"   3A 0000*              	LD	A,(@TRK)	; Track number		--> reg. E
  09FB"   5F                    	LD	E,A
FD$REA1@RDRV  09FC"   3A 0000*              FD$REA1:LD	A,(@RDRV)	; Relative drive number --> reg. C
  09FF"   4F                    	LD	C,A
@DBNK  0A00"   3A 0000*              	LD	A,(@DBNK)	; DMA bank --> accu (upper nibble)
  0A03"   CB 27                 	SLA	A
  0A05"   CB 27                 	SLA	A
  0A07"   CB 27                 	SLA	A
  0A09"   CB 27                 	SLA	A
  0A0B"   B1                    	OR	C		; Set drive number
@DMA  0A0C"   2A 0000*              	LD	HL,(@DMA)	; User buffer address	--> reg. HL
  0A0F"   0E 0B                 	LD	C,11		; Function number	--> reg. C
?USERF  0A11"   CD 0000*              	CALL	?USERF		; Read physical disk sector
DISK$STATUS  0A14"   32 0ACD"              	LD	(DISK$STATUS),A	; Save status for error messages
  0A17"   B7                    	OR	A		; Any errors ?
RDERR  0A18"   C2 0A1C"              	JP	NZ,RDERR
  0A1B"   C9                    	RET
                                
                                ;suppress error message if BDOS is returning errors to application ...
RDERR@ERDME  0A1C"   3A 0000*              RDERR:	LD	A,(@ERDME)
  0A1F"   3C                    	INC	A
R$HARD$ERROR  0A20"   28 2B                 	JR	Z,R$HARD$ERROR
                                
                                ;had permanent error, print message like:
                                ;	BIOS Error on d: T-nn, S-nn, <type>, Retry ?
?PDERR  0A22"   CD 0000*              	CALL	?PDERR		; Print message header
DISK$STATUS'CP/M 3 DISKETTE HANDLER'	MACRO-80 3.44	09-Dec-81	PAGE	1-9


  0A25"   2A 0ACD"              	LD	HL,(DISK$STATUS) ; Get status byte from last error
  0A28"   26 00                 	LD	H,0
  0A2A"   2D                    	DEC	L
  0A2B"   29                    	ADD	HL,HL		; Make byte offset
R$ERROR$TABLE  0A2C"   01 0B4D"              	LD	BC,R$ERROR$TABLE ; Point at table of message addresses
  0A2F"   09                    	ADD	HL,BC
  0A30"   7E                    	LD	A,(HL)		; Get specific message address
  0A31"   23                    	INC	HL
  0A32"   66                    	LD	H,(HL)
  0A33"   6F                    	LD	L,A
?PMSG  0A34"   CD 0000*              	CALL	?PMSG		; Print message
ERROR$MSG  0A37"   21 0CF9"              	LD	HL,ERROR$MSG	; Print "<BEL>, Retry (Y/N) ? "
?PMSG  0A3A"   CD 0000*              	CALL	?PMSG
U$CONIN$ECHO  0A3D"   CD 0AB3"              	CALL	U$CONIN$ECHO	; Get operator response
  0A40"   4F                    	LD	C,A		; Save response
MSG$END  0A41"   21 0D09"              	LD	HL,MSG$END	; Disable status line
?PMSG  0A44"   CD 0000*              	CALL	?PMSG
  0A47"   79                    	LD	A,C		; Restore response
  0A48"   FE 59                 	CP	'Y'		; Yes, then retry 10 more times
FD$READ  0A4A"   CA 09F4"              	JP	Z,FD$READ
R$HARD$ERROR  0A4D"                         R$HARD$ERROR:			; Otherwise,
  0A4D"   3E 01                 	LD	A,1		; Return hard error to BDOS
  0A4F"   C9                    	RET
                                
                                
                                ;EJECT
                                ;disk write routine:
FD$WRITE  0A50"                         FD$WRITE:
@SECT  0A50"   3A 0000*              	LD	A,(@SECT)	; Sector number 	--> reg. B
  0A53"   47                    	LD	B,A
@TRK  0A54"   3A 0000*              	LD	A,(@TRK)	; Track number		--> reg. E
  0A57"   5F                    	LD	E,A
FD$WRI1@RDRV  0A58"   3A 0000*              FD$WRI1:LD	A,(@RDRV)	; Relative drive number --> reg. C
  0A5B"   4F                    	LD	C,A
@DBNK  0A5C"   3A 0000*              	LD	A,(@DBNK)	; DMA bank --> accu (upper nibble)
  0A5F"   CB 27                 	SLA	A
  0A61"   CB 27                 	SLA	A
  0A63"   CB 27                 	SLA	A
  0A65"   CB 27                 	SLA	A
  0A67"   B1                    	OR	C		; Set drive number
@DMA  0A68"   2A 0000*              	LD	HL,(@DMA)	; User buffer address	--> reg. HL
  0A6B"   0E 0C                 	LD	C,12		; Function number	--> reg. C
?USERF  0A6D"   CD 0000*              	CALL	?USERF		; Write physical disk sector
DISK$STATUS  0A70"   32 0ACD"              	LD	(DISK$STATUS),A	; Save status for error messages
  0A73"   B7                    	OR	A		; Any errors ?
WRERR  0A74"   C2 0A78"              	JP	NZ,WRERR
  0A77"   C9                    	RET
                                
                                ;suppress error message if BDOS is returning errors to application ...
WRERR@ERDME  0A78"   3A 0000*              WRERR:	LD	A,(@ERDME)
  0A7B"   3C                    	INC	A
W$HARD$ERROR  0A7C"   28 2B                 	JR	Z,W$HARD$ERROR
                                
                                ;had permanent error, print message like:
                                ;	BIOS Error on d: T-nn, S-nn, <type>, Retry ?
?PDERR  0A7E"   CD 0000*              	CALL	?PDERR		; Print message header
DISK$STATUS'CP/M 3 DISKETTE HANDLER'	MACRO-80 3.44	09-Dec-81	PAGE	1-10


  0A81"   2A 0ACD"              	LD	HL,(DISK$STATUS) ; Get status byte from last error
  0A84"   26 00                 	LD	H,0
  0A86"   2D                    	DEC	L
  0A87"   29                    	ADD	HL,HL		; Make byte offset
W$ERROR$TABLE  0A88"   01 0B5F"              	LD	BC,W$ERROR$TABLE ; Point at table of message addresses
  0A8B"   09                    	ADD	HL,BC
  0A8C"   7E                    	LD	A,(HL)		; Get specific message address
  0A8D"   23                    	INC	HL
  0A8E"   66                    	LD	H,(HL)
  0A8F"   6F                    	LD	L,A
?PMSG  0A90"   CD 0000*              	CALL	?PMSG		; Print message
ERROR$MSG  0A93"   21 0CF9"              	LD	HL,ERROR$MSG	; Print "<BEL>, Retry (Y/N) ? "
?PMSG  0A96"   CD 0000*              	CALL	?PMSG
U$CONIN$ECHO  0A99"   CD 0AB3"              	CALL	U$CONIN$ECHO	; Get operator response
  0A9C"   4F                    	LD	C,A		; Save response
MSG$END  0A9D"   21 0D09"              	LD	HL,MSG$END	; Disable status line
?PMSG  0AA0"   CD 0000*              	CALL	?PMSG
  0AA3"   79                    	LD	A,C		; Restore response
  0AA4"   FE 59                 	CP	'Y'		; Yes, then retry 10 more times
FD$WRITE  0AA6"   CA 0A50"              	JP	Z,FD$WRITE
W$HARD$ERROR  0AA9"                         W$HARD$ERROR:			; Otherwise,
DISK$STATUS  0AA9"   3A 0ACD"              	LD	A,(DISK$STATUS)	; Return hard error to BDOS
  0AAC"   FE 05                 	CP	5		; Diskette write protected ?
  0AAE"   3E 01                 	LD	A,1		; Common error code
  0AB0"   C0                    	RET	NZ
  0AB1"   3C                    	INC	A
                                
FD$LOGIN  0AB2"                         FD$LOGIN:
FD$INIT  0AB2"                         FD$INIT:
  0AB2"   C9                    	RET
                                
U$CONIN$ECHO  0AB3"                         U$CONIN$ECHO:			; Get console input, echo it, and shift to
                                				; Upper case
?CONST  0AB3"   CD 0000*              	CALL	?CONST		; See if any character already struck
  0AB6"   B7                    	OR	A
U$C1  0AB7"   28 05                 	JR	Z,U$C1
?CONIN  0AB9"   CD 0000*              	CALL	?CONIN		; Yes, eat and try again
U$CONIN$ECHO  0ABC"   18 F5                 	JR	U$CONIN$ECHO
U$C1?CONIN  0ABE"   CD 0000*              U$C1:	CALL	?CONIN
  0AC1"   F5                    	PUSH	AF
  0AC2"   4F                    	LD	C,A
?CONO  0AC3"   CD 0000*              	CALL	?CONO
  0AC6"   F1                    	POP	AF
  0AC7"   FE 41                 	CP	'A'
  0AC9"   D8                    	RET	C
  0ACA"   E6 DF                 	AND	0DFH		; Make upper case
  0ACC"   C9                    	RET
                                
DISK$STATUS  0ACD"                         DISK$STATUS:
  0ACD"                         	DEFS	1		; Last error status code for messages
                                ;EJECT
                                
                                
                                
                                
                                ;EJECT
'CP/M 3 DISKETTE HANDLER'	MACRO-80 3.44	09-Dec-81	PAGE	1-11


                                ;RAM disk I/O routines
M$READ  0ACE"   3E FF                 M$READ:	LD	A,0FFH		; Switch on read flag
TASKM  0AD0"   18 01                 	JR	TASKM
M$WRITE  0AD2"   AF                    M$WRITE:XOR	A		; Clear read flag
TASKMRDFLAG  0AD3"   32 0B07"              TASKM:	LD	(RDFLAG),A
@TRK  0AD6"   3A 0000*              	LD	A,(@TRK)	; Track # --> accu
SBANK  0AD9"   C6 03                 	ADD	A,SBANK		; Calc source bank #
  0ADB"   87                    	ADD	A,A
  0ADC"   87                    	ADD	A,A
  0ADD"   87                    	ADD	A,A
  0ADE"   87                    	ADD	A,A
@DBNK  0ADF"   21 0000*              	LD	HL,@DBNK	; Get destination bank #
  0AE2"   86                    	ADD	A,(HL)
  0AE3"   F5                    	PUSH	AF		; Save bank numbers
@DMA  0AE4"   ED 5B 0000*           	LD	DE,(@DMA)	; DMA address --> reg. DE
@SECT  0AE8"   2A 0000*              	LD	HL,(@SECT)	; Sector #    --> reg. HL
  0AEB"   23                    	INC	HL		; Adjust it
  0AEC"   06 07                 	LD	B,7		; Sector # * 128
  0AEE"   29                    	ADD	HL,HL
  0AEF"   10 FD                 	DJNZ	$-1
  0AF1"   01 800F               	LD	BC,128 SHL 8+15	; Sector length --> reg. B
                                				; Function #	--> reg. C
RDFLAG  0AF4"   3A 0B07"              	LD	A,(RDFLAG)	; Read or write ?
  0AF7"   B7                    	OR	A
TASKM1  0AF8"   20 07                 	JR	NZ,TASKM1	; Jump if read
  0AFA"   F1                    	POP	AF		; Restore bank numbers
  0AFB"   07                    	RLCA			; Swap bank numbers
  0AFC"   07                    	RLCA
  0AFD"   07                    	RLCA
  0AFE"   07                    	RLCA
  0AFF"   F5                    	PUSH	AF		; Push bank numbers again
  0B00"   EB                    	EX	DE,HL
TASKM1  0B01"   F1                    TASKM1:	POP	AF		; Restore bank numbers
?USERF  0B02"   CD 0000*              	CALL	?USERF		; Transfer "sector"
  0B05"   AF                    	XOR	A
  0B06"   C9                    	RET
RDFLAG  0B07"                         RDFLAG:	DEFS	1
                                
                                
                                
                                
                                ;EJECT
                                ;------------------:
                                ;virtual disk drive:
                                ;
                                ; Drive Controll Table mu~ f}r Konfig eine feste Adresse haben.
                                
DCT  10D7                          DCT	EQU	10D7H		; Drive control table (SYSTAB)
                                
P$READFD$READ  0B08"   FD 21 09F4"           P$READ:	LD	IY,FD$READ	; Read	routine vector	   --> reg. IY
P$TASK  0B0C"   18 04                 	JR	P$TASK
P$WRITEFD$WRITE  0B0E"   FD 21 0A50"           P$WRITE:LD	IY,FD$WRITE	; Write routine vector	   --> reg. IY
P$TASKDRIVEP  0B12"   3A 00B7"              P$TASK:	LD	A,(DRIVEP-2)	; Relative drive number    --> accu
  0B15"   87                    	ADD	A,A		; *2
  0B16"   4F                    	LD	C,A		; Save it
  0B17"   87                    	ADD	A,A		; *4
'CP/M 3 DISKETTE HANDLER'	MACRO-80 3.44	09-Dec-81	PAGE	1-12


  0B18"   81                    	ADD	A,C		; *6
  0B19"   06 00                 	LD	B,0		; Relative drive # * 6	   --> reg. BC
  0B1B"   4F                    	LD	C,A
DCT  0B1C"   21 10D7               	LD	HL,DCT		; ^drive control table	   --> reg. HL
  0B1F"   09                    	ADD	HL,BC		; Calc real pointer
  0B20"   E5                    	PUSH	HL		; Save DCT pointer
TDCT  0B21"   11 0B48"              	LD	DE,TDCT		; ^temporary storage area  --> reg. DE
  0B24"   01 0005               	LD	BC,5		; Number of bytes	   --> reg. BC
  0B27"   ED B0                 	LDIR			; Save disk parameters of drive B:
PDCT  0B29"   21 00D2"              	LD	HL,PDCT		; ^parameters for drive P: --> reg. HL
  0B2C"   D1                    	POP	DE		; DCT pointer		   --> reg. DE
  0B2D"   D5                    	PUSH	DE		; Save DCT pointer again
  0B2E"   01 0005               	LD	BC,5		; Number of bytes	   --> reg. BC
  0B31"   ED B0                 	LDIR			; Load disk parameters of drive P:
P$RET  0B33"   21 0B39"              	LD	HL,P$RET	; Return address	   --> reg. HL
  0B36"   E5                    	PUSH	HL		; Push it
  0B37"   FD E9                 	JP	(IY)		; Jump to driver
P$RETTDCT  0B39"   21 0B48"              P$RET:	LD	HL,TDCT		; Restore original disk parameters
  0B3C"   D1                    	POP	DE
  0B3D"   01 0005               	LD	BC,5
  0B40"   ED B0                 	LDIR
PDCT  0B42"   21 00D3"              	LD	HL,PDCT+1	; Get drive status
  0B45"   CB C6                 	SET	0,(HL)		; Set init bit
  0B47"   C9                    	RET
TDCT  0B48"                         TDCT:	DEFS	5		; Temporary storage area
                                
                                
                                ;EJECT
                                ;tables of pointers to error message strings
R$ERROR$TABLE  0B4D"                         R$ERROR$TABLE:
R1MSG  0B4D"   0B71"                 	DEFW	R1MSG
R2MSG  0B4F"   0B83"                 	DEFW	R2MSG
R3MSG  0B51"   0B96"                 	DEFW	R3MSG
R4MSG  0B53"   0BAA"                 	DEFW	R4MSG
R5MSG  0B55"   0BC1"                 	DEFW	R5MSG
R6MSG  0B57"   0BC2"                 	DEFW	R6MSG
R7MSG  0B59"   0BDA"                 	DEFW	R7MSG
R8MSG  0B5B"   0BF2"                 	DEFW	R8MSG
R9MSG  0B5D"   0C0D"                 	DEFW	R9MSG
                                
W$ERROR$TABLE  0B5F"                         W$ERROR$TABLE:
W1MSG  0B5F"   0C25"                 	DEFW	W1MSG
W2MSG  0B61"   0C37"                 	DEFW	W2MSG
W3MSG  0B63"   0C4A"                 	DEFW	W3MSG
W4MSG  0B65"   0C5E"                 	DEFW	W4MSG
W5MSG  0B67"   0C75"                 	DEFW	W5MSG
W6MSG  0B69"   0C90"                 	DEFW	W6MSG
W7MSG  0B6B"   0CAC"                 	DEFW	W7MSG
W8MSG  0B6D"   0CC4"                 	DEFW	W8MSG
W9MSG  0B6F"   0CE0"                 	DEFW	W9MSG
                                
R1MSG  0B71"   20 49 6C 6C           R1MSG:	DEFM	' Illegal drive #,'
  0B75"   65 67 61 6C           
  0B79"   20 64 72 69           
  0B7D"   76 65 20 23           
  0B81"   2C                    
'CP/M 3 DISKETTE HANDLER'	MACRO-80 3.44	09-Dec-81	PAGE	1-13


  0B82"   00                    	DEFB	0
R2MSG  0B83"   20 54 72 61           R2MSG:	DEFM	' Track # too high,'
  0B87"   63 6B 20 23           
  0B8B"   20 74 6F 6F           
  0B8F"   20 68 69 67           
  0B93"   68 2C                 
  0B95"   00                    	DEFB	0
R3MSG  0B96"   20 53 65 63           R3MSG:	DEFM	' Sector # too high,'
  0B9A"   74 6F 72 20           
  0B9E"   23 20 74 6F           
  0BA2"   6F 20 68 69           
  0BA6"   67 68 2C              
  0BA9"   00                    	DEFB	0
R4MSG  0BAA"   20 44 65 76           R4MSG:	DEFM	' Device not available,'
  0BAE"   69 63 65 20           
  0BB2"   6E 6F 74 20           
  0BB6"   61 76 61 69           
  0BBA"   6C 61 62 6C           
  0BBE"   65 2C                 
  0BC0"   00                    	DEFB	0
R5MSG  0BC1"   00                    R5MSG:	DEFB	0
R6MSG  0BC2"   20 4C 6F 63           R6MSG:	DEFM	' Locked/deleted record,'
  0BC6"   6B 65 64 2F           
  0BCA"   64 65 6C 65           
  0BCE"   74 65 64 20           
  0BD2"   72 65 63 6F           
  0BD6"   72 64 2C              
  0BD9"   00                    	DEFB	0
R7MSG  0BDA"   20 44 61 74           R7MSG:	DEFM	' Data record not found,'
  0BDE"   61 20 72 65           
  0BE2"   63 6F 72 64           
  0BE6"   20 6E 6F 74           
  0BEA"   20 66 6F 75           
  0BEE"   6E 64 2C              
  0BF1"   00                    	DEFB	0
R8MSG  0BF2"   20 50 61 72           R8MSG:	DEFM	' Parity error during read,'
  0BF6"   69 74 79 20           
  0BFA"   65 72 72 6F           
  0BFE"   72 20 64 75           
  0C02"   72 69 6E 67           
  0C06"   20 72 65 61           
  0C0A"   64 2C                 
  0C0C"   00                    	DEFB	0
R9MSG  0C0D"   20 4C 6F 73           R9MSG:	DEFM	' Lost data during read,'
  0C11"   74 20 64 61           
  0C15"   74 61 20 64           
  0C19"   75 72 69 6E           
  0C1D"   67 20 72 65           
  0C21"   61 64 2C              
  0C24"   00                    	DEFB	0
                                
W1MSG  0C25"   20 49 6C 6C           W1MSG:	DEFM	' Illegal drive #,'
  0C29"   65 67 61 6C           
  0C2D"   20 64 72 69           
  0C31"   76 65 20 23           
  0C35"   2C                    
'CP/M 3 DISKETTE HANDLER'	MACRO-80 3.44	09-Dec-81	PAGE	1-14


  0C36"   00                    	DEFB	0
W2MSG  0C37"   20 54 72 61           W2MSG:	DEFM	' Track # too high,'
  0C3B"   63 6B 20 23           
  0C3F"   20 74 6F 6F           
  0C43"   20 68 69 67           
  0C47"   68 2C                 
  0C49"   00                    	DEFB	0
W3MSG  0C4A"   20 53 65 63           W3MSG:	DEFM	' Sector # too high,'
  0C4E"   74 6F 72 20           
  0C52"   23 20 74 6F           
  0C56"   6F 20 68 69           
  0C5A"   67 68 2C              
  0C5D"   00                    	DEFB	0
W4MSG  0C5E"   20 44 65 76           W4MSG:	DEFM	' Device not available,'
  0C62"   69 63 65 20           
  0C66"   6E 6F 74 20           
  0C6A"   61 76 61 69           
  0C6E"   6C 61 62 6C           
  0C72"   65 2C                 
  0C74"   00                    	DEFB	0
W5MSG  0C75"   20 57 72 69           W5MSG:	DEFM	' Write protected diskette,'
  0C79"   74 65 20 70           
  0C7D"   72 6F 74 65           
  0C81"   63 74 65 64           
  0C85"   20 64 69 73           
  0C89"   6B 65 74 74           
  0C8D"   65 2C                 
  0C8F"   00                    	DEFB	0
W6MSG  0C90"   20 57 72 69           W6MSG:	DEFM	' Write fault on disk drive,'
  0C94"   74 65 20 66           
  0C98"   61 75 6C 74           
  0C9C"   20 6F 6E 20           
  0CA0"   64 69 73 6B           
  0CA4"   20 64 72 69           
  0CA8"   76 65 2C              
  0CAB"   00                    	DEFB	0
W7MSG  0CAC"   20 44 61 74           W7MSG:	DEFM	' Data record not found,'
  0CB0"   61 20 72 65           
  0CB4"   63 6F 72 64           
  0CB8"   20 6E 6F 74           
  0CBC"   20 66 6F 75           
  0CC0"   6E 64 2C              
  0CC3"   00                    	DEFB	0
W8MSG  0CC4"   20 50 61 72           W8MSG:	DEFM	' Parity error during write,'
  0CC8"   69 74 79 20           
  0CCC"   65 72 72 6F           
  0CD0"   72 20 64 75           
  0CD4"   72 69 6E 67           
  0CD8"   20 77 72 69           
  0CDC"   74 65 2C              
  0CDF"   00                    	DEFB	0
W9MSG  0CE0"   20 4C 6F 73           W9MSG:	DEFM	' Lost data during write,'
  0CE4"   74 20 64 61           
  0CE8"   74 61 20 64           
  0CEC"   75 72 69 6E           
  0CF0"   67 20 77 72           
'CP/M 3 DISKETTE HANDLER'	MACRO-80 3.44	09-Dec-81	PAGE	1-15


  0CF4"   69 74 65 2C           
  0CF8"   00                    	DEFB	0
                                
ERROR$MSG  0CF9"                         ERROR$MSG:
  0CF9"   20 52 65 74           	DEFM	' Retry (Y/N) ? '
  0CFD"   72 79 20 28           
  0D01"   59 2F 4E 29           
  0D05"   20 3F 20              
  0D08"   00                    	DEFB	0
                                
MSG$ENDSUBESC  0D09"   1A 1B 44 00           MSG$END:DEFB	SUB,ESC,'D',0
                                
                                	END
'CP/M 3 DISKETTE HANDLER'	MACRO-80 3.44	09-Dec-81	PAGE	S


Macros:

Symbols:
0000*	?BANK           0ABF*	?CONIN          0AC4*	?CONO           
0AB4*	?CONST          0A7F*	?PDERR          0AA1*	?PMSG           
0B03*	?USERF          0000*	@ADRV           0000*	@CBNK           
0AE0*	@DBNK           0AE6*	@DMA            0000*	@DTBL           
0A79*	@ERDME          0A59*	@RDRV           0AE9*	@SECT           
0AD7*	@TRK            014B"	ALVF            09F3"	CLRBYT          
09DB"	CLRNXT          010B"	CSVF            10D7 	DCT             
01AF"	DIBCBH          01B3"	DIRBCB          01D1"	DIRBUF          
0ACD"	DISK$STATUS     0000'	DPB01           0011'	DPBC            
0022'	DPBF            0033'	DPBHD1          0044'	DPBHD2          
00B9I"	DRIVEP          0073I"	DS0             0096I"	DS1             
01C2"	DTABCB          05D1"	DTABUF          01B1"	DTBCBH          
0CF9"	ERROR$MSG       001B 	ESC             0AB2"	FD$INIT         
0AB2"	FD$LOGIN        09FC"	FD$REA1         09F4"	FD$READ         
0A58"	FD$WRI1         0A50"	FD$WRITE        0000*	HD1INI          
0092*	HDINIT          0000*	HDLOGI          008E*	HDREAD          
008C*	HDWRIT          09D1"	M$INIT0         0ACE"	M$READ          
0AD2"	M$WRITE         000AI"	MF0             002DI"	MF1             
0D09"	MSG$END         0B08"	P$READ          0B39"	P$RET           
0B12"	P$TASK          0B0E"	P$WRITE         00D2"	PDCT            
111D 	POWUP           0B4D"	R$ERROR$TABLE   0A4D"	R$HARD$ERROR    
0B71"	R1MSG           0B83"	R2MSG           0B96"	R3MSG           
0BAA"	R4MSG           0BC1"	R5MSG           0BC2"	R6MSG           
0BDA"	R7MSG           0BF2"	R8MSG           0C0D"	R9MSG           
0050I"	RAM             0A1C"	RDERR           0B07"	RDFLAG          
0003 	SBANK           001A 	SUB             0AD3"	TASKM           
0B01"	TASKM1          0B48"	TDCT            0ABE"	U$C1            
0AB3"	U$CONIN$ECHO    0B5F"	W$ERROR$TABLE   0AA9"	W$HARD$ERROR    
0C25"	W1MSG           0C37"	W2MSG           0C4A"	W3MSG           
0C5E"	W4MSG           0C75"	W5MSG           0C90"	W6MSG           
0CAC"	W7MSG           0CC4"	W8MSG           0CE0"	W9MSG           
0A78"	WRERR           00D7"	XLTF            



No Fatal error(s)

 
   0B07"	RDFLAG          
0003 	SBANK           001A 	SUB             0AD3"	TASKM  0B08"	P$READ          0B39"	P$RET           
0B12"	P$TASK          0B0E"	P$WRITE         00D2"	PDCT            
111D 	POWUP           0B4D"	R$ERROR$TABLE   0A4D"	R$HARD$ERROR    
0B71"	R1MSG           0B83"	R2MSG           0B96"	R3MSG           
0BAA"	R4MSG           0BC1"	R5MSG           0BC2"	R6MSG           
0BDA"	R7MSG           0BF2"	R8MSG           0C0D"	R9MSG                                       ;das hei~t auf Deutsch:
                                ;			512 Bytes/Sector
                                ;			 68 Sectoren/Zylinder (2 K|pfe*17 Sec/Cyl)
                                ;			615 Cylinder/Laufwerk
                                ;			4KB Blockgr|~e
                                ;		       2048 Directory Eintr{ge
                                ;			  2 Reservierte Systemspur
                                ;		      8000h Flag f}r nonremovable medium 			
                                
                                ;:------------------------------------:
                                ;:HARDISK 10MByte Partition 2 D:      :
                                ;:------------------------------------:
DPBHD2  0044'   10 01                 DPBHD2:	DEFB  	010H,001H   ;SPT= 136      128 Byte records/track
  0046'   05                    	DEFB	005H        ;BSH=   5      block shift factor  
  0047'   1F                            DEFB    01FH  'hard-disk handler'	MACRO-80 3.44	09-Dec-81	PAGE	1


                                	title	'hard-disk handler'
                                
                                ;************************************************
                                ;*	H D  2 . M A C	Version : 3.2		*
                                ;*	Created	:	19-oct-87		*
                                ;*	by	:	Peter Petersen		*
                                ;*	Rev	:	22-oct-87..17-aug-89	*
                                ;*	weiter dran geschnitzt:			*
                                ;*	...08.07.90	H. Bernhardt		*
                                ;*      November 92     V.Dose                  *
                                ;*            pderr ge{ndert f}r Genie IIIs     *
                                ;*            angepasst an Harddisk 10 MByte    *
                                ;*	30.7.93		V.DOSE			*
                                ;*	      angepasst an 20 MByte Platte      *
                                ;*	      TANDON TM 262			*		
                                ;*	21.12.93	E.SCHROEER		*
                                ;*	      angepasst an 20 MByte Platte	*
                                ;*	      SEAGATE ST 225 Typ MFM/RLL	*		
                                ;*                                              *
                                ;************************************************
                                
                                ; CP/M-80 Version 3     ---  Modular BIOS  ---
                                
                                ; Harddisk I/O routines for standardized BIOS interface
                                ; DPH und DPB in DTBL.ASM
                                
TRUE  FFFF                          true	equ	-1
FALSE  0000                          false	equ	 0
BEL  0007                          bel     equ    07h
SUB  001A                          sub     equ    1AH
ESC  001B                          esc     equ    1BH
                                
                                   
HDWRITHDREADHDLOGIHDINITHD1INI                                	public	hdwrit,hdread,hdlogi,hdinit,hd1ini
                                
                                ; Variables containing parameters passed by BDOS
                                
@ADRV@RDRV@DBNK@DMA@TRK@SECT                                	external	@adrv,@rdrv,@dbnk,@dma,@trk,@sect
@CBNK@ERDME?PDERR                                	external	@cbnk,@erdme,?pderr
?BANK                                	external        ?bank	        	;log. Bank (in A) einschalten
                                
                                ; Utility routines in standard BIOS
                                
?PMSG                                	external	?pmsg		; print message @<HL> up to 0,
                                	            			; saves <BC> & <DE>
?CONIN?CONO                                        external        ?conin,?cono    ; console input and output
?CONST                                        external        ?const          ; get console status
                                
                                ; definition of hd-controller port-addresses and control-data
                                
HDPORT  0040                          hdport	equ	040h		; hd-controller base address
                                
HDSTATHDPORT  0041                          hdstat	equ	hdport+1	; hard disk status port
HDRESHDPORT  0041                          hdres	equ	hdport+1	; hard disk reset function
HDSELHDPORT  0042                          hdsel	equ	hdport+2	; hard disk select function
HDCONFHDPORT  0042                          hdconf	equ	hdport+2	; hard disk configuration port
HDMASKHDPORT'hard-disk handler'	MACRO-80 3.44	09-Dec-81	PAGE	1-1


  0043                          hdmask	equ	hdport+3	; hard disk DMA- and Interrupt-mask
                                
                                        .z80
  0000'                         	cseg			; residente Ruinen zum
                                  				; Verholen von/zu Banks
HDRD@DMA  0000'   2A 0000*              hdrd:	ld	hl,(@dma)	; set buffer address
@DBNK  0003'   3A 0000*              	ld	a,(@dbnk)
?BANK  0006'   CD 0000*              	call	?bank
HDPORT  0009'   01 0040               	ld	bc,hdport	; get hd port address
  000C'   ED B2                 	inir			; 512 Beitz reinziehen
  000E'   ED B2                 	inir
TERMCMD1  0010'   18 1B                 	jr	termcmd1	; if yes quit loop
                                
HDWR@DMA  0012'   2A 0000*              hdwr:	ld	hl,(@dma)	; set buffer address
@DBNK  0015'   3A 0000*              	ld	a,(@dbnk)
?BANK  0018'   CD 0000*              	call	?bank
HDPORT  001B'   0E 40                 	ld	c,hdport	; get hd port address
  001D'   ED A3                 	outi			; get first data byte
HDWRLPHDSTAT  001F'   DB 41                 hdwrlp:	in	a,(hdstat)	; get hdc status
  0021'   FE CF                 	cp	0cfh		; test if transfer is terminated
TERMCMD1  0023'   28 08                 	jr	z,termcmd1	; if yes quit loop
  0025'   FE C9                 	cp	0c9h		; data requested  ?
HDWRLP  0027'   20 F6                 	jr	nz,hdwrlp	; loop if not
WR_DAT  0029'   ED A3                 wr_dat:	outi			; write data
HDWRLP  002B'   18 F2                 	jr	hdwrlp		; and loop
                                
TERMCMD1  002D'                         termcmd1:			; aus dem Common heraus noch
  002D'   AF                    	xor	a		; schnell Bank 0 einschalten
?BANK  002E'   CD 0000*              	call	?bank
TERMCMD  0031'   C3 0035"              	jp	termcmd		; und den Job abschliessen
                                
  0034'                         	dseg
                                
                                ; harddisk READ and WRITE entry points.
                                ; these entries are called with the following arguments :
                                ;	 relative drive number	in @rdrv	 (8 bits)
                                ;	 absolute drive number	in @adrv	 (8 bits)
                                ;	 disk transfer address	in @dma		(16 bits)
                                ;	 disk transfer bank	in @dbnk	 (8 bits)
                                ;	 disk track address	in @trk		(16 bits)
                                ;	 disk sector address	in @sect	(16 bits)
                                ;	 pointer to XDPH	in <DE>
                                ; they transfer the appropriate data, perform retries
                                ; if necessary, then return an error code in <A>
                                
HDREADREADMSG  0000"   21 0140"              hdread:	ld	hl,readmsg	; point at ' Read '
HDRW_COMMON  0003"   CD 00A1"              	call	hdrw_common	; prepare command descriptor
  0006"   F3                    	di			; disable interrupts
  0007"   01 0508               	ld	bc,0508h	; get length and command
HDSCMD  000A"   CD 010D"              	call	hdscmd		; send command
RD1HDSTAT  000D"   DB 41                 rd1:	in	a,(hdstat)	; get hdc status
  000F"   FE CF                 	cp	0cfh		; test if status is to send
TERMCMD  0011"   CA 0035"              	jp	z,termcmd	; skip if yes
  0014"   FE CB                 	cp	0cbh		; test transfer direction
RD1  0016"   20 F5                 	jr	nz,rd1		; loop until o. k.
HDRD  0018"   C3 0000'              	jp	hdrd		; sektor holen
'hard-disk handler'	MACRO-80 3.44	09-Dec-81	PAGE	1-2


                                
HDWRITWRITEMSG  001B"   21 0148"              hdwrit:	ld	hl,writemsg	; point to ' Write '
HDRW_COMMON  001E"   CD 00A1"              	call	hdrw_common
  0021"   F3                    	di			; disable interrupts
  0022"   01 050A               	ld	bc,050ah	; get length and command
HDSCMD  0025"   CD 010D"              	call	hdscmd		; send command
WR1HDSTAT  0028"   DB 41                 wr1:	in	a,(hdstat)	; get hdc status
  002A"   FE CF                 	cp	0cfh		; test if status is to send
TERMCMD  002C"   28 07                 	jr	z,termcmd	; skip if yes
  002E"   FE C9                 	cp	0c9h		; test transfer direction
WR1  0030"   20 F6                 	jr	nz,wr1		; loop until o. k.
HDWR  0032"   C3 0012'              	jp	hdwr		; sektkorken wegdruecken
                                
TERMCMD  0035"                         termcmd:
  0035"   FB                    	ei			; test termination of command
  0036"   06 00                 	ld	b,0		; set retry count to 256
TR1HDSTAT  0038"   DB 41                 tr1:	in	a,(hdstat)	; get hdc status
  003A"   FE CF                 	cp	0cfh		; ready to read status  ?
TR2  003C"   28 07                 	jr	z,tr2		; skip if o. k.
TR1  003E"   10 F8                 	djnz	tr1		; else retry b times
                                
HDMSG2  0040"   21 0162"              	ld	hl,hdmsg2	; print error mesage
TR3  0043"   18 08                 	jr	tr3
                                
TR2HDPORT  0045"   DB 40                 tr2:	in	a,(hdport)	; get command status
  0047"   E6 02                 	and	2		; to test completion
  0049"   C8                    	ret	z
                                
HDMSG1  004A"   21 0151"              	ld	hl,hdmsg1	; else print terminate error
TR3HDRES  004D"   D3 41                 tr3:	out	(hdres),a	; reset hdc
DSKERR  004F"   CD 00CD"              	call	dskerr		; print bios error message
  0052"   3E 01                 	ld	a,1
  0054"   C9                    	ret
                                
HDINITHDRES  0055"   D3 41                 hdinit:	out	(hdres),a	; reset hard-disk controller
GET_STHDSTAT  0057"   DB 41                 get_st:	in	a,(hdstat)	; get status
  0059"   FE C0                 	cp	0c0h		; test if hdc is idle
GET_ST  005B"   20 FA                 	jr	nz,get_st	; else loop until hdc is idle
                                
SETMSK  005D"   AF                    setmsk:	xor	a		; clear accu and send mask to disable
HDMASK  005E"   D3 43                 	out	(hdmask),a	; interrupt and dma from hard-disk
                                
W0HDSTAT  0060"   DB 41                 w0:	in	a,(hdstat)	; get status
  0062"   FE C0                 	cp	0c0h		; and wait until hdc is idle
W0  0064"   20 FA                 	jr	nz,w0
                                
                                ;	init hd controller with hd-drive-characteristics
                                
TRPARAIFIELD  0066"   21 0139"              trpara:	ld	hl,ifield	; point to init-parameter field
  0069"   01 050C               	ld	bc,050ch	; get command to set hd characteristics
HDSCMD  006C"   CD 010D"              	call	hdscmd		; send command
HD_CHARACT  006F"   21 0131"              	ld	hl,hd_charact	; point to table of hd characteristics
HDPORT  0072"   0E 40                 	ld	c,hdport	; get hd port
  0074"   06 08                 	ld	b,8		; get length of table
TR_P1HDSTAT  0076"   DB 41                 tr_p1:	in	a,(hdstat)	; get hdc status
  0078"   FE C9                 	cp	0c9h		; request for data --> hdc  ?
TR_P1'hard-disk handler'	MACRO-80 3.44	09-Dec-81	PAGE	1-3


  007A"   20 FA                 	jr	nz,tr_p1	; loop until hdc requests for data
NX1  007C"   18 03                 	jr	nx1		; else send data from data table
                                
NXTBYTWCR  007E"   CD 0106"              nxtbyt:	call	wcr		; wait for controller ready
NX1  0081"   7E                    nx1:	ld	a,(hl)		; get byte from table
  0082"   ED 79                 	out	(c),a		; send byte to hd controller
  0084"   23                    	inc	hl		; increment pointer
NXTBYT  0085"   10 F7                 	djnz	nxtbyt		; loop until done
                                
                                ;	test if command successfully completed
                                
RDY1HDSTAT  0087"   DB 41  …‰Ъ\™`d„Eu$•H!IHDLOGIЃ’S’U d„C”д™DРФРZ  *  @ 4   ђ Х“µdЉЁ к‚ 3h8 8ЂнQ¶И/жx юd€ОХaдЇfСђ5 —  r 7PЂ<А Ђ+7Ђ¶И/ж{+Ђ?™b«Ђ r@7PЂ<А  +7Ђ¶И/жx юd€М:$ ы dу<P>9€0mђА&@‡(ЂґИ,Эљ > ІZdЩьА>•н2l‚ю`BrYё4CЊ@AД 0!¶A2D А›ЃЂOОУИЊ чmђ_Мсй¶@e•Е †™C”@X{  CћАX{  EЏЂ]¤°  т2ЕА а,0ЛІГ°И :  БА¬л–-<±`$t  ?џв +Д|}ІY   « і@ nм й`nа dі@ ё 
Н  Vnу z“Щ  ЕьAl9›м–Щ–G>™-ІщЂ(4И!‡іL„!ЕЂ,ЬyiђёьУ ВvH    ЂЂF` М3      ђ E‚‘”Вd ‚№ИТt2€  rA„дd'3XЂЉr9О@ 9Юm6MЖAPКr6љMЖЎ”@E9Ќз LКa3N†QLЁ †ўhЂd1Т4 ИЂЙx?BANKЌ| cф4фд”иЧи?CONOЌvЂcф4фе5HЦР?PDERRЌtЂSхХ4xА @ADRVЊ  T4$дёИ°@DBNKЊ‰ЂDDФЦp@ERDMEЊ  T$E%hХИ@SECTЌS DE$ёсXHD1INIЏ*Ђd„D”д•HчXHDLOGIЏ  d„E$THрШHDWRITњ   ћrA„дd'3XЂЉ        M$WRITE:XOR	A		; Clear read flag
TASKMRDFLAG  0AD3"   32 0B07"              TASKM:	LD	(RDFLAG),A
@TRK  0AD6"   3A 0000*              	LD	A,(@TRK)	; Track # --> accu
SBANK  0AD9"   C6 03                 	ADD	A,SBANK		; Calc source bank #
  0ADB"   87                    	ADD	A,A
  0ADC"   87                    	ADD	A,A
  0ADD"   87                    	ADD	A,A
  0ADE"   87                    	ADD	A,A
@DBNK  0ADF"   21 0000*              	LD	HL,@DBNK	; Get destination bank #
  0AE2"   86                    	ADD	A,(HL)
  0AE3"   F5                    	PUSH	AF		; Save bank numbers
@DMA  0AE4"   ED 5B 0000*           	LD	DE,(@DMA)	; DMA address --> reg. DE
@SECT  0AE8"   2A 0000*              	LD	HL,(@SECT)	; Sector #    --> reg. HL
  0AEB"   23                    	INC	HL		; Adjust it
  0AEC"   06 07                 	LD	B,7		; Sector # * 128
  0AEE"   29                    	ADD	HL,HL
  0AEF"   10 FD                 	DJNZ	$-1
  0AF1"   01 800F               	LD	BC,128 SHL 8+15	; Sector length --> reg. B
                                				; Function #	--> reg. C
RDFLAG  0AF4"   3A 0B07"              	LD	A,(RDFLAG)	; Read or write ?
  0AF7"   B7                    	OR	A
TASKM1  0AF8"   20 07                 	JR               rdy1:	in	a,(hdstat)	; get hdc status
  0089"   FE CF                 	cp	0cfh		; test if status is to be send
RDY1  008B"   20 FA                 	jr	nz,rdy1		; loop until o. k.
HDPORT  008D"   DB 40                 	in	a,(hdport)	; get command status state
  008F"   CB 57                 	bit	2,a		; test if correctly terminated
PRI_OK  0091"   28 08                 	jr	z,pri_ok	; skip if o. k.
HDRES  0093"   D3 41                 	out	(hdres),a	; reset controller
HDMSG1  0095"   21 0151"              	ld	hl,hdmsg1	; else print hd-init-error
PRINT  0098"   C3 00E8"              	jp	print		; and return
                                
PRI_OKINIOK  009B"   21 017B"              pri_ok:	ld	hl,iniok	; print init o. k.
PRINT  009E"   C3 00E8"              	jp	print
                                
                                
                                ;	prepare command descriptor block setting cylinder,
                                ;	sector and head addresses
                                ;
                                ;  Byte  |  D7  | D6  | D5  | D4  | D3  | D2  | D1  | D0  |
                                ;----------------------------------------------------------
                                ;   0    |  Command-Class   |       Operation-Code        |
                                ;   1    | cyl10   0    LUN |         Head Number         |   head
                                ;   2    | cyl9  cyl8 |         Sector Number             |   sect
                                ;   3    |      Cylinder Number, Low Byte (cyl7-0)        |   cylind
                                ;   4    |     Interleave or Block Count (always 1)       |   bcount
                                ;   5    |          Control Byte  (always 2)              |   termin
                                ;
                                
                                
HDRW_COMMON  00A1"                         hdrw_common:
HDC_RW  00A1"   22 013E"              	ld	(hdc_rw),hl	; save name of operation
@TRK  00A4"   ED 4B 0000*           	ld	bc,(@trk)	; get track #
  00A8"   79                    	ld	a,c		; get lsb of track #
CYLIND  00A9"   32 012E"              	ld	(cylind),a	; set lsb of track #
  00AC"   0E 00                 	ld	c,0
  00AE"   CB 18                 	rr	b		; move high byte of track #
  00B0"   CB 19                 	rr	c		; into bits 7 and 6 of C
  00B2"   CB 18                 	rr	b
  00B4"   CB 19                 	rr	c
  00B6"   06 00                 	ld	b,0		; head count
@SECT  00B8"   3A 0000*              	ld	a,(@sect)	; sector # (only low byte significant)
FDHEAD  00BB"   FE 11                 fdhead:	cp	17		; find head #
HDS0  00BD"   38 05                 	jr	c,hds0		; if head 0
  00BF"   D6 11                 	sub	17		; else convert to sector # and head #
  00C1"   04                    	inc	b		; next head, if more than 26 secs
FDHEAD  00C2"   18 F7                 	jr	fdhead
HDS0'hard-disk handler'	MACRO-80 3.44	09-Dec-81	PAGE	1-4


  00C4"   B1                    hds0:	or	c
SECT  00C5"   32 012D"              	ld	(sect),a	; set sector and track msb
  00C8"   78                    	ld	a,b		; head #
HEAD  00C9"   32 012C"              	ld	(head),a
  00CC"   C9                    	ret
                                	
                                ; suppress error message if BDOS is returning errors to application...
                                
DSKERR  00CD"                         dskerr:
@ERDME  00CD"   3A 0000*              	ld	a,(@erdme) 
  00D0"   FE FF                 	cp	0ffh 
PR_ERR  00D2"   20 05                 	jr	nz,pr_err
  00D4"   F1                    	pop	af		; correct stack
HARDERROR  00D5"                         harderror:
  00D5"   3E 01                 	ld	a,1		; get hard-error code
  00D7"   FB                    	ei			; enable interrupts
  00D8"   C9                    	ret			; and return to bdos
                                
                                ; Had permanent error, print message like :
                                ; BIOS Err on d: T-nn, S-mm, <operation> <type>, Retry ?
                                
PR_ERR?PDERR  00D9"   CD 0000*              pr_err:	call	?pderr		; print message header
HDC_RW  00DC"   2A 013E"                      ld      hl,(hdc_rw)     ; READ oder WRITE
?PMSG  00DF"   CD 0000*                      call    ?pmsg  
FRAGEAB  00E2"   CD 00EC"                      call    frageab         ; Eingabe holen
MSGEND  00E5"   21 0196"                      ld      hl,msgend       ; Statuszeile aus
PRINT?PMSG  00E8"   CD 0000*              print:  call    ?pmsg  
HDLOGI  00EB"   C9                    hdlogi:	ret			; dummy vector, hard-disk login
                                
                                ; get console input, echo it and shift to uppercase
                                
FRAGEAB?CONST  00EC"   CD 0000*              frageab:  call ?const
  00EF"   B7                              or   a
ISTDA  00F0"   28 05                           jr   z,istda
?CONIN  00F2"   CD 0000*                        call ?conin
FRAGEAB  00F5"   18 F5                           jr   frageab
ISTDA?CONIN  00F7"   CD 0000*              istda:    call ?conin
  00FA"   F5                              push af
  00FB"   4F                              ld   c,a
?CONO  00FC"   CD 0000*                        call ?cono
  00FF"   F1                              pop  af
  0100"   FE 41                           cp   'A'
  0102"   D8                              ret  c
  0103"   E6 DF                           and  0dfh
  0105"   C9                              ret
                                     
                                
                                
                                ; hard disk subroutines
                                
                                ; wait controller ready
WCRHDSTAT  0106"   DB 41                 wcr:	in	a,(hdstat)	; get hd controller status
  0108"   CB 47                 	bit	0,a		; test for data request
WCR  010A"   28 FA                 	jr	z,wcr		; quit if request
  010C"   C9                    	ret
                                
'hard-disk handler'	MACRO-80 3.44	09-Dec-81	PAGE	1-5


                                ;hd send command	hl -->	parameterlist
                                ;			b  -->	count
                                ;			c  -->	command
HDSCMDHDSTAT  010D"   DB 41                 hdscmd:	in	a,(hdstat)	; get hdc status
  010F"   FE C0                 	cp	0c0h		; to test if hdc is idle
HDC_ID  0111"   28 04                 	jr	z,hdc_id	; skip if o. k.
HDRES  0113"   D3 41                 	out	(hdres),a	; else reset hdc
HDSCMD  0115"   18 F6                 	jr	hdscmd		; and try again
HDC_IDHDSEL  0117"   D3 42                 hdc_id:	out	(hdsel),a	; select hd controller
CFIELD  0119"   21 012C"              	ld	hl,cfield	; set pointer to command field
WCR  011C"   CD 0106"              	call	wcr		; wait for controller ready
  011F"   79                    	ld	a,c		; get command
HDPORT  0120"   D3 40                 	out	(hdport),a	; to send it
NXTPARWCR  0122"   CD 0106"              nxtpar:	call	wcr		; wait for controller ready
  0125"   7E                    	ld	a,(hl)		; fetch next parameter
HDPORT  0126"   D3 40                 	out	(hdport),a	; to send it
  0128"   23                    	inc	hl		; increment parameter pointer
NXTPAR  0129"   10 F7                 	djnz	nxtpar		; and loop until done
HD1INI  012B"   C9                    hd1ini:	ret
                                
                                ;  hard disk data area
CFIELD  012C"                         cfield:				; hdc command field
HEAD  012C"   00                    head:	db	0		; selected head, lun and c10
SECT  012D"   00                    sect:	db	0		; sector #, c8 and c9
CYLIND  012E"   00                    cylind:	db	0		; cylinder #  < modulo 256 >
BCOUNT  012F"   01                    bcount:	db	1		; block count
TERMIN  0130"   02                    termin:	db	2		; step rate --> 25 us
                                
HD_CHARACT  0131"                         hd_charact:			; drive characteristics
                                				; 614 cylinders, 4 heads 
  0131"   02                    	db	2		; last cylinder  (msb)
  0132"   66                    	db	102		; last cylinder  (lsb)
  0133"   04                    	db	4		; 4 heads
  0134"   02 66                 	db	2,102		; start cyl reduced wr current
  0136"   02 66                 	db	2,102		; start cyl wr precomp
  0138"   00                    	db	0		; always zero
                                
IFIELD  0139"   00 00 00 00           ifield:	db	0,0,0,0,0	; hard disk init-parameter field
  013D"   00                    
                                
                                ;	error message components
HDC_RWREADMSG  013E"   0140"                 hdc_rw:		dw	readmsg
READMSG  0140"   2C 20 52 65           readmsg:	db	', Read ',0
  0144"   61 64 20 00           
WRITEMSG  0148"   2C 20 57 72           writemsg:	db	', Write ',0
  014C"   69 74 65 20           
  0150"   00                    
HDMSG1  0151"   07                    hdmsg1:		db	7
  0152"   48 61 72 64           		db	'Hard Disk Error'
  0156"   20 44 69 73           
  015A"   6B 20 45 72           
  015E"   72 6F 72              
  0161"   00                    		db	0
HDMSG2  0162"   07                    hdmsg2:		db	7
  0163"   43 6F 6D 6D           		db	'Command Terminate Error'
  0167"   61 6E 64 20           
'hard-disk handler'	MACRO-80 3.44	09-Dec-81	PAGE	1-6


  016B"   54 65 72 6D           
  016F"   69 6E 61 74           
  0173"   65 20 45 72           
  0177"   72 6F 72              
  017A"   00                    		db	0
INIOK  017B"   53 65 61 67           iniok:		db	'Seagate ST 225 - 21.4 MB'
  017F"   61 74 65 20           
  0183"   53 54 20 32           
  0187"   32 35 20 2D           
  018B"   20 32 31 2E           
  018F"   34 20 4D 42           
  0193"   0D 0A 00              		db	13,10,0		
MSGENDSUBESC  0196"   1A 1B 44 00           msgend:         db      sub,esc,'D',0
                                       
                                
                                
                                
                                	end
'hard-disk handler'	MACRO-80 3.44	09-Dec-81	PAGE	S


Macros:

Symbols:
002F*	?BANK           00F8*	?CONIN          00FD*	?CONO           
00ED*	?CONST          00DA*	?PDERR          00E9*	?PMSG           
0000*	@ADRV           0000*	@CBNK           0016*	@DBNK           
0013*	@DMA            00CE*	@ERDME          0000*	@RDRV           
00B9*	@SECT           00A6*	@TRK            012F"	BCOUNT          
0007 	BEL             012C"	CFIELD          012E"	CYLIND          
00CD"	DSKERR          001B 	ESC             0000 	FALSE           
00BB"	FDHEAD          00EC"	FRAGEAB         0057"	GET_ST          
00D5"	HARDERROR       012BI"	HD1INI          0042 	HDCONF          
0117"	HDC_ID          013E"	HDC_RW          0055I"	HDINIT          
00EBI"	HDLOGI          0043 	HDMASK          0151"	HDMSG1          
0162"	HDMSG2          0040 	HDPORT          0000'	HDRD            
0000I"	HDREAD          0041 	HDRES           00A1"	HDRW_COMMON     
00C4"	HDS0            010D"	HDSCMD          0042 	HDSEL           
0041 	HDSTAT          0012'	HDWR            001BI"	HDWRIT          
001F'	HDWRLP          0131"	HD_CHARACT      012C"	HEAD            
0139"	IFIELD          017B"	INIOK           00F7"	ISTDA           
0196"	MSGEND          0081"	NX1             007E"	NXTBYT          
0122"	NXTPAR          00E8"	PRINT           009B"	PRI_OK          
00D9"	PR_ERR          000D"	RD1             0087"	RDY1            
0140"	READMSG         012D"	SECT            005D"	SETMSK          
001A 	SUB             0035"	TERMCMD         002D'	TERMCMD1        
0130"	TERMIN          0038"	TR1             0045"	TR2             
004D"	TR3             0066"	TRPARA          FFFF 	TRUE            
0076"	TR_P1           0060"	W0              0106"	WCR             
0028"	WR1             0148"	WRITEMSG        0029'	WR_DAT          



No Fatal error(s)

 
   
00D9"	PR_ERR          000D"	RD1 
0000I"	HDREAD          0041 	HDRES           00A1"	HDRW_COMMON     
00C4"	HDS0            010D"	HDSCMD          0042 	HDSEL              



No Fatal error(s)

 
   0B07"	RDFLAG          
0003 	SBANK           001A 	SUB             0AD3"	TASKM  0B08"	P$READ          0B39"	P$RET           
0B12"	P$TASK          0B0E"	P$WRITE         00D2"	PDCT            
111D 	POWUP           0B4D"	R$ERROR$TABLE   0A4D"	R$HARD$ERROR    
0B71"	R1MSG           0B83"	R2MSG           0B96"	R3MSG           
0BAA"	R4MSG           0BC1"	R5MSG           0BC2"	R6MSG           
0BDA"	R7MSG           0BF2"	R8MSG           0C0D"	R9MSG                                       ;das hei~t auf Deutsch:
                                ;			512 Bytes/Sector
                                ;			 68 Sectoren/Zylinder (2 K|pfe*17 Sec/Cyl)
                                ;			615 Cylinder/Laufwerk
                                ;			4KB Blockgr|~e
                                ;		       2048 Directory Eintr{ge
                                ;			  2 Reservierte Systemspur
                                ;		      8000h Flag f}r nonremovable medium 			
                                
                                ;:------------------------------------:
                                ;:HARDISK 10MByte Partition 2 D:      :
                                ;:------------------------------------:
DPBHD2  0044'   10 01                 DPBHD2:	DEFB  	010H,001H   ;SPT= 136      128 Byte records/track
  0046'   05                    	DEFB	005H        ;BSH=   5      block shift factor  
  0047'   1F                            DEFB    01FH  equ    1BH
                                
                                   
HDWRITHDREADHDLOGIHDINITHD1INI                                	public	hdwrit,hdread,hdlogi,hdinit,hd1ini
                                
                                ; Variables containing parameters passed by BDOS
                                
@ADRV@RDRV@DBNK@DMA@TRK@SECT                                	external	@adrv,@rdrv,@dbnk,@dma,@trk,@sect
@CBNK@ERDME?PDERR                                	external	@cbnk,@erdme,?pderr
?BANK                                	external        ?bank	        	;log. Bank (in A) einschalten
                                
                                ; Utility routines in standard BIOS
                                
?PMSG                                	external	?pmsg		; print message @<HL> up to 0,
                                	            			; saves <BC> & <DE>
?CONIN?CONO                                        external        ?conin,?cono    ; console input and output
?CONST                                        external        ?const          ; get console status
                                
                                ; definition of hd-controller port-addresses and control-data
                                
HDPORT  0040                          hdport	equ	040h		; hd-controller base address
                                
HDSTATHDPORT  0041                          hdstat	equ	hdport+1	; hard disk status port
HDRESHDPORT  0041                          hdres	equ	hdport+1	; hard disk reset function
HDSELHDPORT  0042                          hdsel	equ	hdport+2	; hard disk select function
HDCONFHDPORT  0042                          hdconf	equ	hdport+2	; hard disk configuration port
HDMASKHDPORT'hard-disk handler'	MACRO-80 3.44	09-Dec-81	PAGE	1-1


  0043                          hdmask	equ	hdport+3	; hard disk DMA- and Interrupt-mask
                                
                                        .z80
  0000'                         	cseg			; residente Ruinen zum
                                  				; Verholen von/zu Banks
HDRD@DMA  0000'   2A 0000*              hdrd:	ld	hl,(@dma)	; set buffer address
@DBNK  0003'   3A 0000*              	ld	a,(@dbnk)
?BANK  0006'   CD 0000*              	call	?bank
HDPORT  0009'   01 0040               	ld	bc,hdport	; get hd port address
  000C'   ED B2                 	inir			; 512 Beitz reinziehen
  000E'   ED B2                 	inir
TERMCMD1  0010'   18 1B                 	jr	termcmd1	; if yes quit loop
                                
HDWR@DMA  0012'   2A 0000*              hdwr:	ld	hl,(@dma)	; set buffer address
@DBNK  0015'   3A 0000*              	ld	a,(@dbnk)
?BANK  0018'   CD 0000*              	call	?bank
HDPORT  001B'   0E 40                 	ld	c,hdport	; get hd port address
  001D'   ED A3                 	outi			; get first data byte
HDWRLPHDSTAT  001F'   DB 41                 hdwrlp:	in	a,(hdstat)	; get hdc status
  0021'   FE CF                 	cp	0cfh		; test if transfer is terminated
TERMCMD1  0023'   28 08                 	jr	z,termcmd1	; if yes quit loop
  0025'   FE C9                 	cp	0c9h		; data requested  ?
HDWRLP  0027'   20 F6                 	jr	nz,hdwrlp	; loop if not
WR_DAT  0029'   ED A3                 wr_dat:	outi			; write data
HDWRLP  002B'   18 F2                 	jr	hdwrlp		; and loop
                                
TERMCMD1  002D'                         termcmd1:			; aus dem Common heraus noch
  002D'   AF                    	xor	a		; schnell Bank 0 einschalten
?BANK  002E'   CD 0000*              	call	?bank
TERMCMD  0031'   C3 0035"              	jp	termcmd		; und den Job abschliessen
                                
  0034'                         	dseg
                                
                                ; harddisk READ and WRITE entry points.
                                ; these entries are called with th з                                                                                                                                                                                                                                                                   л"Ылy2ЯюЪ7 !  "Ѕ:Ъ2Ж:ж=К7 !” ~·К7 №КН#Г* {2Г!  "z"Э9"Л1м !dеyю3Т\ K!м Гn юЂТ‚ЦbЪ&юТ&!R_ ^#V*Ылй Е!p		^#VлН¦Б:з·АГј!"( COPR. '82 DRI 151282ЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗЗИ^ dяяjЋ”љ +5ёМ(.7@‰Џ•›ў‘«±ЅЗЫднUуООд&ОО%*gyДк‚&оч&%2ОGPФвоо+QB4    ``lюА!Ге*Ы^#VХ#^#VблеЇw# Н’ Н’ Н’ Н’Н™ю:беВТНsКЦAЪюТ<w#НsК ю.Крю;К!Н?ВЬГбе	 	 ю;К!Н?ВъБХН™НsбА!  ·ИюИлЙББ!яяЙбе 	Н?В+>ђбе 	wГНsИю ЪъВXю*К]w#·Й6?#т]Й	 .,:;[]=<>| е!eѕКѓ45#Вx·бИюaШю{ТЏж_жЙp#В’Йю К™ю	К™ЙеНи:МЖA2'НтБГт!эяГЕН%"¬Гя  !  9"1!>еНХН%:жх2ѕН·В5:Яю!ФКНс=ВдgoЙ  ЗЗЗЗЗЗЗЗЗЗ  :ЯO*ЫлГ7 *ШЂ Г/*Ш"Й*"ШГ[Б<И:жђgЙе:Яю!ФеН,С*щл}DЙ!~6 ·АГ	я!ЛеНSНЊЪrхOН сЙНЁАюВЃНаГbюКbюКbЙюИю
Ию	ИюИю Й:·ВНяжЙG:ПжxЙНЁВ›:·ВТНЁА:юКТНяжИН	яюВы!ѕВа6 Н	яюВс:ПжКВЇЦИ<НГа!G:ПТ
>ѕИxюКюКw>ЙЇwЙМ%ДяЙ:ПжВ7!Ф>®жwЙЇЙ:Я=КяxжВяГя:·Вr:ПжGЕ:Я=ДЅБЕН9Бx·ВrЕ:Ф·ДяБy!·юИ4ю Р5~·ИyюВ‰5ЙюА6 ЙyНЊТ х^НIсц@O:Я=КЇ:ПжВIyю	ВI НI:·жВµЙНЛ НяГя#НIНи:·!ѕР НIГШНI
ГI!У
ѕИЕOН БГт*є}ґКS~#·В!  "є"јАГSzіВ-*Ш"Ы##"є>2Я:·2*ЫN#еЇG2№ВHЕеНбБюКWю
КWюВ|:К<К€:W:·єКH2x·КyГдюВ“:Л<Кex·КH~+Г8юВЁЕx2еНиЇ2ГJюВёеЕЇНБбГHюВПб:!·ѕТ-5НГГѕюВЫНРбГ-юВ#Ї2ЕНРБбеЕx·К#NСХzђWЕе:єЬЏбБГме:·КJ!·–2НГ!5ВГJхx№Ъ4сЕеНяГJс#wЕеOНЏбБ:ПжВK~юxВTюКВГHбp!  "єГIНяГЛy<Кѓ<Кz<К€ГяН›В&ГЛН›·ИНSГЛН6яГЛН9яГЛлMDГт:ПТИ!Ее:юКНя·ИН	яюКы2ЇЙГЛН°2zЙ>ГЛzЈ<*ПКГл"ПЙ!УzЈ<~КЛsЙл^#V#N#Fлx±ИЕеN:ЯюoКНяГН б#БГч    CP/M Error On  : $Disk I/O$Invalid Drive$Read/Only File$Read/Only Disk$File Exists$? in Filename$  ГЌГЌ>я2Лa.я"z:М2н:з<Ды:ЯюК^юК^Гd{•_zњWРЙ{…_zЊWРЙИ)ЏГГНх	4А#4А#4ЙНЮлГхНх	РЙНЮГЩѕА#ИГлИw#ГцJНя|µИ^#V#"Ћ##"ђ##"’###"”#"–##л"ї!Нх*л!ҐНх*Є|!Е6я·КJ6 7ЙНяЇ*ђw#w*’w#w#wЙ>2ЦН'яГqЇ2ЦН*я·ИOН‚yюЪЌГЌ<А*€НЫ
ИНpб:Яю0И!М:ЖѕВ®НС:Ц·АГЌЇ2ЮЙ*бНi
"¶ л!Нs#r#pЙ*ђN#FЕ*’^#V#F*Н:ПO}“|љyеТч*ҐН°бг+гГа*ҐН№б}“|љyЪ	г#геГчге*ҐН°бХЕел*ІDM"юНяС*ђs#rБС*’s#r#pБy“oxљgН[	DM*їлН0яMD" Н!я*ЉMDГ$я:ґOГi
!§N:К·Вi	G>–O:ИКЂ	·Гw	ЂЙ*Ы ЙН‚		:Е·К	n`Й	~#foЙНb	2ДO НЉ	"Н}ґЙ:§O*НЇНВ"Н2П"У:ЁO:КЎG2ё!Н¶wЙ*Ы ~‡хzWсw+ВЯ	zЙНэ	#~Й*Ы! Й*Ы Й*Ы ЙН
л! ЙН
~2Кл~·В+
Н-OНД~юЃЪ2
>Ђ2ЗНэ	:©¦2ИЙН
:Кw:ЯюТP
4л~юЂР:ЗwЙНэ	r##rЙp#ИГb
И|·g}oГj
*Њ  Ї†#В
ЁGВ|
ЙНп	*–ѕДЎ
:Ч·И*ЫЇwЙ*Ыл*юН=Тµ
*’НЫ
Ибб>
ГЛИ)ГЅ
€:ЛO! Нј
µґЙ*†:ЛOНi
}жЙНю
Нр
РГЃ	 ~ЙНШ
ИГ|*Њ:Ш…oР$Й*Ы ~ЙН	6 ЙНэ	~жwЙН	цЂwЙ*бл*Ћ{–#zћЙН'Шr+sЙ{•ozњgЙю*¶л*°|жgН=РЕНv
*љл*¶БК„КЏѕИНШ
 Н>я2Ю2њН¦НГ
ГфѕwИ*–>¶wЙwЙ:Ж†НЙ
*¬#л*Ћs#rЙ*ђНЫ
И’ГЖ
:±жЂА!д:ЯG~ёИ#·ВА<Й*–#~·Й!dе!сНјК·
!шНјК&бЙ!Ю~·И6 НЂ!  "бЇ2ШЙ*–NНп	qЙ* Г* Г*ћ}¤<ИеМНлбА6яЙХ
 ^#VлСЙНі>ГFНч
НD>!  "»*ћН*ШГ[Н+"ЉЙ*Њл*ЉЂ НKя!z~<И:бжwЙН ##>яw#wЙН‚	Г—Н„Аб>	ГЛ!б~#ѕА<Й!яя"бЙНЄГЬ*¬л*б#"бН=Ъќ:бж‡ВВ2Ш·АЕН6Б:Ю·АГFНМ:Ю·ИНСНйГ6yж<_W`iНi
DM*њ	~ВюЙХНкжюБ±ВwЙ:уШхН†DM*њT]	сКKялГKяЕНNБ:уж@АЕН†л*њБе"њНNб"њЙНю
 ЕСИХ:Е·КkЕеN ГqЕN#Fеy°КЂ*Є}‘|Фб#БГX*ЄНi
#ЙНК6 ННН†DM*њ6 #x±ВЈ*”w*®л*њs#rНL*Ћ6#6 Нќ*ў"УяН¤Н”КНю
л*У|Ґ<лД >!ѕКО>еѕКО> ѕК
>¦ВНNН4ГО ~*”wГ:ВГЛЕх:©/Gy Oс ‘жБЙН
AЕБЇ+ѕВBВ8y2Д:Е·xВOЕеo& :§W>’OНi
E:©ёбЪ5Нэ	N/жЎ°БЙ*Ы"гy2еН>я2ВЙГЌНsНќНіМLЇ2вНЩВ  Н¤Н”К *глюеКАХН'СТ Ню
:еO ~юеМSy·Кю?КxюКюКфюМ–жВ-ГЕNНG:в<КDЇ2бxБ·В™#ГПЇ2В2zGЙж?ЙНSНќ>яGГЛx·В™~·В™:б·К™2вГ°Б™ЕА##~·АН[е*Я$Вa*б"ЯбЙНЦ	ШН‹ИК„Нж
*ЫН!К~ГЉН™ГlН‹КНю
6еН> Н-Н¶ Н™Г‡PY*Є{•zњТЦЕХBKНкТОСБy°КўХЕНкТОБСГў<НбСЙy°Вє!  ЙЂНшК>~ ЕGж°wБ#ГеХ *Ы	#~Ц$М+лНю
БЙіцЙ*ЫН!А>	Г#>?–жИВ#·Й*Ы~ 	wЙНН0"гН*гНyНђВ}Н0Н‹ИНж
НЯН¶ Н™В^ГНЦ	2ХН‹И НшНх:Хж@К•еН
~б#wН>Н™КГ{Н>ИН _е++VХНю
л*Ы НхН-OСбs++r л! ‘КЩxТЧ>Ђ¶wЙ~·А6 :Д·И6ЂЙ~#¶+Аw#w+Йе ~юЃЪжwбЙЇ2zНШ
АН	жЂАН„К№НэOFЕqНфyёЬДН3Нэ	БNpГДН†И НЇ:Е·КZ~·ВMw·ВS~ѕВ№ГoНжлНжлѕВ№#ѕВ№#В?лмя	еН-СНїwЕ 	л	БК КЎѕЪ ·ВЎНЬлwНю
 ~жwН Н2Г>НyГ&ѕАлѕлАЙ!яя"ЯЙ*Я>ьҐo+"бЙН1Н—ДС*Ые!…"ЫНsН™б"ЫИ r#~хеж?w#>r#В=JМ§·
КН4   НббсwН¶ Г Нэ	~OНК™еЕНБб:z<И>Ўw##~2ЙВ_4~ж?К€НКН>Вx:Б<К€НЭК€Г{НҐНяН
Ї2КГЛН	:Йw++~=жwГП4Н-OѕТ«5:Б<КП4НфНДГ{НЉ>я2БН
:К!ЗѕЪШюЂВПН3:z·ВПНћ	КПН°	НЪ@
ВцНRНКН_Г@
!  "»>НГ@
:ёG:µO х:ЅюЪ=2Ѕс7АЇЙсК)y·ИцЙy/W!К:ѕюЪ#†юЂЪ?>ЂЕF6Еех:Ё_/ Gб:Б·К^:ЗўјЪ_|ђO»ЪfKyбБpБ!ѕVђєТuWy/ў2ЅК&х:Б·КЊНєНRсgН[	|юOДEяЇЙН	жwЙН	ж@х~ц@wсЙ> 2БНч
:Ч·>В*ЫНй
НЉНиН
:КюЂЪЭН3:z·АНћ	Кы!МєНлКц>я2№ ГOНb	2Д  ·КOНЉ	DMН }ґВ>ГЛ"Н"»Ї2№:М2єл*Ы 	:Е·:ДКEНsГMO 		s#rЕН°	:Яю(В±y==В±Бх*Не!µ^WХ*ћ=2№wНXСХЇw#т|WВ|*У"НЕННКБНj*НСХ:ЁҐ ВЊбб"ННRС:КWХНЪвКИ>НГвНRНКНБЕ:Н!Ё¦КЯ НjБx!ЗѕЪпw4ВчНљНЎМљГ@
Е*Ыл!! ~жх~#~жO~жр#¶G~жьб.|ВЙ!  w:ЯюcК‡ХН„СКw! x–ж?Вw! ~№КЅНВwЕН-Б№ТlСХВlСГПqOНфНДГЅЕХНСБ.:z<КЙНК! еVq##~_Хж@°wНЎ:z<ВёСбБЕеХ.КВНЭ.КВББНяБЇГЛСгr##sбБ}ГЛяН МґЙ Н М­ЙлN ! ~жЂЃO> €G~жЂG! ~‡‡‡‡·ЂGх~жoс> ЌЙ_y–W#xћ#хІWс{ћЙs+p+qЙНх	еr#r#rН‹КSНю
 НабеНФ"Н™> 2zГ4бЙл  На!! q#p#wЙ2МwW*€НЫ
_ХНябТ†-Й!Жs:Ж!ЛѕВЌюяАНfИНђ*–~жх†wсД¦НГ
ЙЇ2ЧГГЂ*Ы л#~ 2Ч~ЎwН!  "ЯЇ2б=2Э*Ы~2гж=2ГюяКж2ЖНЂ:а*ЫwНіМНьГ6НКИ6 Н*беНLНќ НЄ!Ю~·К+6 б:Яю0ИНсГСН'Ъб"бЙ!р~·И6 *€>=)ТXхе!ЛНfН_Дьбс·ВCГЂ* }¤<И ~·Й*”~жЙ Г{Н§·А>ХфеХ НNяНлСбВхбЙНю
	ОХГ„:бжюИG*Њ` ~Ц!Аx‡_‡‡ѓ<Ѓ_ЇЙНХА*”y¦ВШ
<Й:©ца/GНэ	~ А##~ж?Й НЛАН	ж@АНэ	F6 е##N6 ЕН†ДyЇ2zБбp##qЙ:ЎГЛ!яяНфЇ2Ъ!Ђ "ШГRН|:Ж2ЪЙННҐН:а·КN>ю2а<2бНЎН|!бѕИw:аююИНС>Ђ2Ч*Ы6 НsН™Н¤Н|ЙН”ИН
~<ВЊwб:ЧТ§*Ы
 ~жЂВ§2ЧГ&Ня@НЗМtђГЖ
Н¬НяН–
Н:z<ИГґлЇх~ю?ВаНЂНр ГфНэ	~ю?КпНННҐсхК*бе>ьҐo"бН6б"бс!_еКЌ:еOНsГ™*г"ЫцГОН8ГcН¬НЊ
ГґН¬НЊ
Г­НННҐННКНЎН”·К`Н-ѕТ}хсФЭН”ИНяPН¬ НЗАНyГЎ>O2{Н&Г“Н8Г:*€ГГ:ЖГЛл"ШГRНЂ*њГГ*†ГГНН8НqГНЂ*"zЙ:ГюяВХ:аГЛж2аЙН¬НЊ
ГОН¬НЊ
ГЧН¬Г(л}/_|/*€¤W}Ј_*†л"€}Јo|ўg"†>я2ЛЙ{·К&юЃТ&2жЙ{2зЙН|*њлН†  ·КDТ<Г8+}ґВ7*Є#}‘o|g:§OЇНВл*Љs#r#wЙ!і~цЂwВИ~ц@wГИН6НHяНq*€>=)ТЇхе_Н|:Яю0К НГЄНє:Г<В­Нбс·В‡ЙНHяНq:µ·И>Гл~юcРл!њ…oл#~ююТЯл^#VлГГG#~И#~Й!еле##N#F#^#V#~#foг~еo‡…! я…oг#~бгЙл*ЛщлЙНҐНяН В&Ню
 НаНх	НЪ&ІК&Нж
Н>НиН‹КН№Ъdх Н-сКjНю
6еН¶ Н>Н™ГFН
Нb	НУН-ѕwхН
~<слДЬ:Д·МЬ НЇл~жw#w#6 ##НхН-ГaНю
	л*Ы	Й НЇ~ж?GёА++NНИѕЙ<!Е4КЬ‡5Н‚	O 	>№Иp#ГжН|НmГЛНҐННZ
Н†ИН‚	 Нb
е Н§·ВСлГхб Гb
!фНB6 яГNя НNя!флНBГЛГх!  лГхzЈ<*¬КГл"¬Й!яя"z:Э·К{*Ы:гw :Ч¶w*Лщ*z}DЙе                                                                     яя                       #cdfg !"()         * хНК:Н_ 2ы{Ў2Н"ьН+"ЉНС~<КjсхюТ5НК–ЇНЪюКB~·Кj6 *Не:ПхНСлНх!Л:МѕДi>МвБСНБНЂсюРхюВ~!№:ёѕТ€Н6я>Г‹<wЇНвНСНх6 :ы<Ђ !Ђя=В л*ЉсюВґ"ЊЙл*ШЂ юКKялНKяНЪ6яЙ:µG/OЙ*ьМЙ *ьЙхНКс=Кjф_НЪ##юГх:±Ъ->я2$Г-юВл:$<ВлбГ~Ї2$*ьЙ !  "є"±++ЙНч
!ЯЙНҐГч
Н Г†                                                                                    ЇЙ     1                                                 $  њЂ               яяя        яяяяя  Г{  еХНNбќ НKя"УбЙ·ИюЪJ>К">2њлНТИл:ЯюКNю#К=юТN>2њеН!бВNЇ2њ~2ќ#л!  ж ВЊЕКtКt)ЏхxЪuс)ЏхжЦ ТO с	О БВ_"ћ!ќж¶wж ВЙжOж?WжGzжа±O:©ТДхxGyOсГµxж¶w qЙ*ў}ґ<ЙНТИ:њ<И:е·И*Ћ^#Vл=Вх*¬"Э*ўDM*Эл*беН=СµИеле+))	 ќ®жВP Нћ Кg лб#г+}ґгелВ ббН”АНіА>я2њ*Ћ^#Vл+НФЇЙ:а<Кђ <В' Нћ В' ~жВ' *блб+"бБ}жюИ{жь_}жьoН=µИНМ:њ<МќЇЙ~юхВ' лб"ЯГ) :њ·ИOцђG® Ае#НлбЙНТИ!Щќ еХЕНKя*ўеНю
НN*б))СБСХЕНKяБбСГKя BI"B" ‘$ђ„$ Ђ@"          UUUUUUUUUUUUUUUUUA Hђ„ЂBI $"   Ђ@„!  @HII D‘"BB  "$	"H BD‰!$„  H$‰ђBD!!$D	 ‘ D €„  $"BHD!	$	HHA€II "„‰!‘!‰!‘! ЂB"D‘ Ђђ!B"I$$’A"D$!!$H€ 	$             „$‘!	   H‘  B‚BD$A ЂD‚BAH’D$ IH$   B!$$H‚!€ ђH"$’! Ђ A €$A	"$B ЂЂ"D„$ђ$Ѓ $@‘ Dђ  D  €‘B!$ђ@H@‘$$’DD!$Ђ$  „ђI$DH "H‰$A’@! „@€€€Ђ  Ѓ„!$ "	$$‘ ‚@DђЂ D„! ‰!$‰!$Ѓ$A ђDD"@$BDђЂ"$„"I$’HBI„  Ђ! Ђ 	$$’D	$’@IЃ$‘ €H  Ђ  "	 BH$D‚H‚@‰ „’ $‰	  ‚@A$Ђ	I"I$‰$ €DD’H„‘$’I$’ „@ B ЂD„$DђЃ I’I	!$„„$ЃBD‘$€ $ „@€ЂBB$H „€I	$„€B I    Ђ„D ЂI‚’"@ 	!@$          A	!  „„B$A ђђ@ €‘$’$’	A$€ЂЃ	$@ „" B"@   D! ‚  	A$‘$€D’! I"! ’BI$’	! ’@ђ"$I!$’I$’H‘	„H$’I"I$’I$BHD’I  „ђ‰$Ђ@@’HHI$H"H     ђ’	$I$’ђ’I$ Ђ B ! ’I""	 BDBA€$Ђ„@               ђ„’B‘B"$€B@DЃђЂЃ!	!	ђ‘ $$ђ          @          ‚@!„!DD@ЂЂ @  Ђ @I!  @’ €$"$‚A  BD$Ђ ‰ ‘$ ‚!	$	HHA€II "„‰!‘!‰!‘! ЂB"D‘ Ђђ!B"I$$’A"D$!!$H€ 	$             „$‘!	   H‘  B‚BD$A ЂD‚BAH’D$ IH$   B!$$H‚!€ ђH"$’! Ђ A €$A	"$B ЂЂ"D„$ђ$Ѓ $@‘ Dђ  D  €‘B!$ђ@H@‘$$’DD!$Ђ$  „ђI$DH "H‰$A’@! „@€€€Ђ  Ѓ„!$ "	$$‘ ‚@DђЂ D„! ‰!$‰!$Ѓ$A ђDD"@$BDђЂ"$„"I$’HBI„  Ђ! Ђ 	$$’D	$’@IЃ$‘ €H e following arguments :
                                ;	 relative drive number	in @rdrv	 (8 bits)
                                ;	 absolute drive number	in @adrv	 (8 bits)
                                ;	 disk transfer address	in @dma		(16 bits)
                                ;	 disk transfer bank	in @dbnk	 (8 bits)
                                ;	 disk track address	in @trk		(16 bits)
                                ;	 disk sector address	in @sect	(16 bits)
                                ;	 pointer to XDPH	in <DE>
                                ; they transfer the appropriate data, perform retries
                                ; if necessary, then return an error code in <A>
                                
HDREADREADMSG  0000"   21 0140"              hdread:	ld	hl,readmsg	; point at ' Read '
HDRW_COMMON  0003"   CD 00A1"              	call	hdrw_common	; prepare command descriptor
  0006"   F3                    	di			; disable interrupts
  0007"   01 0508               	ld	bc,0508h	; get length and command
HDSCMD  000A"   CD 010D"              	call	hdscmd		; send command
RD1HDSTAT  000D"   DB 41                 rd1:	in	a,(hdstat)	; get hdc status
  000F"   FE CF                 	cp	0cfh		; test if status is to send
TERMCMD  0011"   CA 0035"              	jp	z,termcmd	; skip if yes
  0014"   FE CB                 	cp	0cbh		; test transfer direction
RD1  0016"   20 F5                 	jr	nz,rd1		; loop until o. k.
HDRD  0018"   C3 0000'           ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее