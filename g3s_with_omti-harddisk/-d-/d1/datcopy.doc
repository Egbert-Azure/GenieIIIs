                                 DaTCopy.DOC
                                 -----------
                  Documentation for DaTCopy.RSX dtd 5-24-91
                          and DaTPIP.RSX dtd 5-24-91
                           G. R. Welles - 11/20/91


DaTCopy.RSX allows file copy programs to pass the CP/M+ update file date/time 
stamp (DaT) from the source to the destination file.  DaTPIP.RSX is DaTCopy 
modified to work with PIP.COM.

They replace my DATECOPY.RSX (1-10-90) and DATEPIP.RSX (1-14-90).  These new 
version have been fixed to work on Osborne Executive computers and similar 
machines which use interrupts to maintain the system time.  Since they can be 
patched to filter dates, they also supersede my DATENULL.RSX (12-5-89).

While intended for use with copy programs, it can be applied to any program 
where you wish the output file to bear the same date as the source.  For 
instance applied to an assembler the .HEX output files would bear the same 
date and time as the .ASM source.  In brief tests with Eric Meyer's VDE(M) 
word processor indicate that it is possible to edit a file without changing 
its DaT stamp, while if the edited file is saved under a new name that will 
bear the current DaT.  Thus CP/M+ Create DaT stamping can be maintained a word 
processor.  Normally any update of the file would causes a new "creation date" 
to be recorded.

These features combined with DaTCopy.RSX's ability to filter the dates it 
copies, means greater control over CP/M+ date stamping.

In its distributed form it discards and sets as blank all dates on or before 
December 15, 1982.  In effect clearing bad DaT stamps set when the Osborne 
Executive clock was left at the default system date of December 15, 1982.  
This value can be changed (see patching below) to range from copying any CP/M 
date (ie from 1/1/78) to copying no dates and thus setting blank dates on all 
output files.

This last option, setting all blank dates, is most appropriate for library 
extracting utilities such as NULU and LGET which don't pass member dates to 
CP/M+.

                                 How It Works

DaTCopy.RSX works by playing how it expects application programs to handle 
files and how CP/M+ handles the date stamping of those files.  It tricks the 
system into stamping any new files made with the date/time of the file most 
recently opened by the application program.

Since the source file is not always the file most recently opened prior to 
making the destination file, DaTCopy.RSX will not work with all application 
programs.  Nor will it necessarily work the same way with different options 
within the same program.  You may get some unexpected, but not always unhappy 
results.

In the case of NULU, newly created or updated library files (.LBR) will 
continue to be stamped with the current system date/time as usual, and only 
extracted files will be affected by DaTCopy.RSX, which should be patched to 
filter all dates.

DaTPIP.RSX for PIP.COM and works by getting its file date on the compute file 
size call.  It may produce the results you seek with other programs.

For further information see the DaTCopy.MAC source code and please feel free 
to incorporate it's code in your own programs, reducing the need for this RSX.

Gary R. Welles
P.O. Box 1, Old Mystic, CT  06372-0001
X.400: C=US; A=MCI; S=Welles; G=Gary; D.ID=1178863
Internet: 117-8863@MCIMail.com
Dialcom: 31060:MCI221
Telex: UW 650 117 8863


                                 INSTALLATION

To use this RSX it must be installed on an application program using CP/M+ 
GENCOM utility:

    A>GENCOM program DaTCopy.RSX       ;ie. A>GENCOM NSWP DaTCopy

    A>GENCOM PIP.com DaTPIP.RSX

You can remove ALL RSXs with GENCOM and thus restore your program to its 
original form.  The removed RSXs will be lost, so be certain that you have a 
copy of any RSX's you wish to reattach before proceeding:

    A>GENCOM program                    ;ie. A>GENCOM NSWP



                                   PATCHING

Address 0130h+0131h in DaTCopy.RSX contains a the hex value of the CP/M Date 
date to be filtered in Lo/Hi order.  It can be patched using SID, EDFILE or 
the like to change the range of dates either copied or set as blank on output 
files.

The default value 1507h filters dates on before 12/15/82.  Altering the high 
byte value at 0131h by 01h changes the dates filtered by 256 days.  The low 
value at 0130h, 01h = 1 day.  Remember this is hex notation where 0Ah=10 and 
15h=21.

Changing the values to 0000h disables the filter and the RSX will pass along 
any date it finds, while values of FFFFh will cause it filter all dates.

GENCOM places a 100h byte header on an application program and installs the 
DaTCopy.RSX at the end of program.  Therefore the installed location of the 
above patch will be shifted to an address near the end of your program file.  
Search near the end of the file and you'll see the RSX name "DaTCopy".  The 
patch point immediately follows my name and the date.  EDFILE's Z and - 
commands will get you there quickly.

Alternatively, you can patch a copy of DaTCopy.RSX and as long as you don't 
change its name, "A>GENCOM program DaTCopy" will replace the one on your 
program the newly patched DaTCopy.RSX.


                            >> IMPORTANT NOTES <<

Because of the 100h byte RSX header, patch points in an application program 
will be shifted by that amount.  So a patch point at say address 0114h in NULU 
will now be at address 0214h.  Same goes for auto patching and installation 
programs.  You may have to remove DaTCopy.RSX with GENCOM, patch the 
application, then use GENCOM to reinstall the RSX.

In order for a date to be copied with a file, the destination disk must BOTH 
have its directory initialized using INITDIR.COM and have the Update or Create 
stamp mode set with SET.COM.
