.pl 72
HI-TECÈ Softwarå haó graciouslù converteä theiò CP/Í baseä Ã 
compileò intï -freeware-®  Iæ yoõ haven'ô haä thå chancå tï plaù 
witè C¬ oò havå noô beeî satisfieä witè otheò implementationó oæ 
Ã undeò CP/M¬ thió onå ió wortè youò whilå tï investigateº iô 
produceó verù welì optimizeä anä fasô code.

Iî playinç witè it¬ however¬ É diä finä á fe÷ subtlå problems®  

Thió releaså addresseó thå following:
   ï Fasteò consolå I/Ï º thå variouó routineó thaô outpuô tï the
       consolå anä scaî foò inpuô useä thå BDOÓ routines¬ whicè 
       arå notoriouslù slow®  Theså havå beeî replaceä witè BIOÓ 
       baseä equivalents.  Yoõ shoulä noticå fasteò outpuô 
       immediately.
   ï ZSDOÓ datå supporô º aó supplied¬ HI-TECÈ Ã supportó CP/M« 
       dateó iî stat(© anä thå variouó timå functions®  Theså 
       havå beeî updateä tï allo÷ ZSDOÓ calló aó well®  Therå may
       bå problemó witè theù waù stat(© iî particulaò workó now
       undeò CP/M+®  I'ä appreciatå somå feedbacë oî thaô one.
   ï Addeä functionsº althougè describeä iî thå manual¬ memchr(© 
       anä memmove(© werå noô includeä iî thå library®  Theù no÷ 
       are.
   ï Z-Systeí TCAĞ supporô º thå basiã Z-Systeí calló foò cursoò 
       controì arå no÷ supported®  Theså worë witè aî internaì 
       TCAĞ (seå Jaù Sage'ó articleó iî Thå Computeò Journal)¬ so
       eveî Vanillá CP/Í useró caî uså these®  Aó á sidå effect...
   ï Basiã Z-Systeí supporô º á includå filå <z3.h¾ ió provideä 
       tï givå accesó tï thå Z3ENÖ structure.
   ï argv[0İ º thå namå oæ thå filå ió no÷ properlù returneä 
       undeò Z-Systeí aó argv[0]®  Thió ió passeä aó á 
       DU:filenamå specification¬ suitablå foò pushinç ontï the
       shelì stack¬ oò useä with...
   ï Morå standarä filenamå parsinç º thå routinå thaô parseó DU:
       specificationó (oò aó HI-TECÈ haä themº u:d:filename© haó 
       beeî updateä tï allo÷ á morå standarä syntax®  Noteº thió 
       ió á changå tï thå library¬ noô thå compiler¬ sï thå 
       compileò itselæ stilì expectó thingó thå samå way.
   ï exit(© anä erroò codeó º thå exit(© anä _exit(© routineó now
       placå theiò returî valuå iî thå ZCPR³ prograí erroò flag¬ 
       suitablå foò testinç witè IF.

Futurå releaseó oæ LIBÚ wilì include Z³ nameä directorù parsing¬ 
invokinç erroò handlers¬ exec()-typå routineó supportinç Z³ 
programs¬ supporô foò redirectablå I/Ï anä more.

Installation:
   Firstº makå á BACKUĞ oæ LIBC.LIB®  Thió ió stilì aî earlù 
releaså anä somå thingó neeä work (likå supporô foò redirectablå 
I/O.)

   Thå moduleó supplieä aó .OBÊ fileó neeä tï bå addeä oò 
replaceä iî LIBC.LIB®  Uså thå HI-TECÈ librariaî tï dï this:

libò ò libc.liâ write.obê stat.obê time.obê getfcb.obê bmove.obj
memchr.obê signal.obê _exit.obê start2.obê getch.obj

    Iæ you'rå usinç Vanillá CP/M¬ yoõ maù wisè tï modifù anä 
re-assemblå ZCRTCPM.AÓ tï suiô youò setup®  Otherwiså jusô renamå 
ZCRTCPM.OBÊ tï CRTCPM.OBJ.

Thå otheò routineó arå alreadù includeä iî LIBZ.LIB®  Thå only 
changå yoõ neeä tï makå tï uså theí ió tï adä á -LÚ tï youò 
compilå switcheó tï forcå á searcè oæ LIBZ.LIÂ anä tï calì them!

Iæ yoõ wisè tï modifù theí thå sourcå ió includeä tï alì oæ theí 
(theù arå slightlù modifieä froí VLIB1.³ bù Richarä Conn)

Thå followinç arå thå routineó includeä iî LIBZ.LIB:

z3vinit(void)»          /ª Initializå VLIÂ pointeò */
cls(void);		/ª cleaò screeî */
ereol(void);		/ª eraså tï enä oæ linå */
gotoxy(int¬ int);	/ª movå cursoò */
tinit(void);		/ª initializå terminaì */
dinit(void);		/ª deinitializå terminaì */
stndout(void);		/ª enteò standouô modå */
stndend(void);		/ª enä standouô modå */

Notå thaô envptò ió á globaì variablå thaô pointó tï thå 
environmenô descriptor®  Yoõ maù wisè tï dï somethinç like:

#definå isquiet()	(envptr->quiet)
#definå iswheel()	(*envptr->wheel)

tï tesô foò Z³ 'privileges'®  (Iî fact¬ theså arå alreadù iî 
z3.h.)

Therå ió alsï á globaì variablå foò thå internaì environmenô 
descriptor¬ _intenv®  Yoõ caî checë tï seå whetheò youò prograí 
ió 'seeing§ aî externaì environmenô (aó yoõ woulä undeò Z3³ anä 
later¬ oò á Z3INS'ä program© oò thå internaì environmenô (undeò 
CP/Í oò aî uninstalleä prograí undeò Z30):

    iæ (envptò =½ _intenv)
      printf("internaì environmenô iî use!");
    else
      printf("environmenô aô %04x"¬ envptr);


Iæ yoõ havå commentó abouô thió library¬ additions¬ oò generaì 
questionó abouô thió library¬ droğ må aî E-Maiì at:

          brian-cpm@GEnie.GEIS.com

